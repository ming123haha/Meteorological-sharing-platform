{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from \"../../core/Logger.js\";\nimport { isSome as e, isNone as i } from \"../../core/maybe.js\";\nimport { BufferObject as r } from \"./BufferObject.js\";\nimport { webglDebugEnabled as h } from \"./checkWebGLError.js\";\nimport { ContextType as s } from \"./context-util.js\";\nimport { ResourceType as n, ColorAttachment as c, DepthStencilTargetType as o, PixelFormat as _, PixelType as a, DepthStencilAttachment as l, RenderbufferFormat as T, FramebufferTarget as E, TextureType as d, Usage as u, BufferType as f, TargetType as m, SizedPixelFormat as A, TextureSamplingMode as p, TextureWrapMode as R } from \"./enums.js\";\nimport { Renderbuffer as g } from \"./Renderbuffer.js\";\nimport { Texture as N } from \"./Texture.js\";\nimport { getGpuMemoryUsage as F } from \"./Util.js\";\n\nclass x {\n  constructor(t, i, r = null, h = null) {\n    if (this._context = t, this._glName = null, this._depthAttachment = null, this._stencilAttachment = null, this._colorAttachments = new Map(), this._depthStencilTexture = null, this._initialized = !1, this._desc = { ...i\n    }, t.instanceCounter.increment(n.FramebufferObject, this), e(r)) {\n      Array.isArray(r) || (r = [r]);\n\n      for (let t = 0; t < r.length; ++t) {\n        const e = r[t],\n              i = c.COLOR_ATTACHMENT0 + t;\n        let h;\n        C(e) ? (b(e) ? (h = e.descriptor, this._colorAttachments.set(i, e)) : (h = e, this._colorAttachments.set(i, new N(this._context, h))), U(h, this._desc)) : (D(e) ? (h = e.descriptor, this._colorAttachments.set(i, e)) : (h = e, this._colorAttachments.set(i, new g(this._context, h))), H(h, this._desc)), this._validateColorAttachmentPoint(i);\n      }\n    }\n\n    if (e(h)) {\n      let t, e;\n      if (C(h)) this._context.capabilities.depthTexture || console.error(\"Setting the depth/stencil texture as an attachment requires WEBGL_depth_texture or WebGL2\"), b(h) ? (e = h.descriptor, this._depthStencilTexture = h) : (e = h, this._depthStencilTexture = new N(this._context, e)), U(e, this._desc);else {\n        D(h) ? (e = h.descriptor, t = h) : (e = h, t = new g(this._context, e));\n        const i = this._desc.depthStencilTarget ?? o.DEPTH_STENCIL_RENDER_BUFFER;\n        i === o.STENCIL_RENDER_BUFFER ? this._stencilAttachment = t : i === o.DEPTH_RENDER_BUFFER || i === o.DEPTH_STENCIL_RENDER_BUFFER ? this._depthAttachment = t : console.error('If a Renderbuffer is provided, \"depthStencilTarget\" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'), this._desc.depthStencilTarget = i, H(e, this._desc);\n      }\n    }\n  }\n\n  dispose() {\n    if (!this._desc) return;\n\n    const t = this._context.getBoundFramebufferObject();\n\n    if (this._disposeColorAttachments(), this._disposeDepthStencilAttachments(), this._glName) {\n      this._context.gl.deleteFramebuffer(this._glName), this._glName = null;\n    }\n\n    this._context.bindFramebuffer(t), this._context.instanceCounter.decrement(n.FramebufferObject, this), this._desc = null;\n  }\n\n  get glName() {\n    return this._glName;\n  }\n\n  get descriptor() {\n    return this._desc;\n  }\n\n  get colorTexture() {\n    const t = this._colorAttachments.get(c.COLOR_ATTACHMENT0);\n\n    return t && b(t) ? t : null;\n  }\n\n  get colorAttachment() {\n    return this._colorAttachments.get(c.COLOR_ATTACHMENT0);\n  }\n\n  get depthStencilAttachment() {\n    return this._depthStencilTexture || this._depthAttachment || this._stencilAttachment;\n  }\n\n  get depthStencilTexture() {\n    return this._depthStencilTexture;\n  }\n\n  get width() {\n    return this._desc.width ?? 0;\n  }\n\n  get height() {\n    return this._desc.height ?? 0;\n  }\n\n  get gpuMemoryUsage() {\n    return [...this._colorAttachments].reduce((t, [e, i]) => t + F(i), 0) + F(this.depthStencilAttachment);\n  }\n\n  getColorTexture(t) {\n    const e = this._colorAttachments.get(t);\n\n    return e && b(e) ? e : null;\n  }\n\n  attachColorTexture(t, e = c.COLOR_ATTACHMENT0) {\n    if (!t) return;\n\n    this._validateColorAttachmentPoint(e);\n\n    U(t.descriptor, this._desc), this._disposeColorAttachments(), this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(t.glName, e)), this._colorAttachments.set(e, t);\n  }\n\n  detachColorTexture(t = c.COLOR_ATTACHMENT0) {\n    const e = this._colorAttachments.get(t);\n\n    if (b(e)) {\n      const i = e;\n      return this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(null, t)), this._colorAttachments.delete(t), i;\n    }\n  }\n\n  setColorTextureTarget(t, e = c.COLOR_ATTACHMENT0) {\n    const i = this._colorAttachments.get(e);\n\n    b(i) && this._framebufferTexture2D(i.glName, e, t);\n  }\n\n  attachDepthStencilTexture(t) {\n    if (i(t)) return;\n    const e = t.descriptor;\n    e.pixelFormat !== _.DEPTH_STENCIL && console.error(\"Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!\"), e.dataType !== a.UNSIGNED_INT_24_8 && console.error(\"Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!\"), this._context.capabilities.depthTexture || console.error(\"Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!\"), U(e, this._desc), this._desc.depthStencilTarget && this._desc.depthStencilTarget !== o.DEPTH_STENCIL_TEXTURE && (this._desc.depthStencilTarget = o.DEPTH_STENCIL_TEXTURE), this._disposeDepthStencilAttachments(), this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(t.glName, l)), this._depthStencilTexture = t;\n  }\n\n  detachDepthStencilTexture() {\n    const t = this._depthStencilTexture;\n    return t && this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(null, l)), this._depthStencilTexture = null, t;\n  }\n\n  attachDepthStencilBuffer(t) {\n    if (i(t)) return;\n    const e = t.descriptor;\n\n    if (e.internalFormat !== T.DEPTH_STENCIL && e.internalFormat !== T.DEPTH_COMPONENT16 && console.error(\"Depth/Stencil buffer must have correct internalFormat\"), H(e, this._desc), this._disposeDepthStencilAttachments(), this._desc.depthStencilTarget = e.internalFormat === T.DEPTH_STENCIL ? o.DEPTH_STENCIL_RENDER_BUFFER : o.DEPTH_RENDER_BUFFER, this._initialized) {\n      this._context.bindFramebuffer(this);\n\n      const e = this._context.gl,\n            i = this._desc.depthStencilTarget === o.DEPTH_RENDER_BUFFER ? e.DEPTH_ATTACHMENT : e.DEPTH_STENCIL_ATTACHMENT;\n      e.framebufferRenderbuffer(E.FRAMEBUFFER, i, e.RENDERBUFFER, t.glName);\n    }\n\n    this._depthAttachment = t;\n  }\n\n  detachDepthStencilBuffer() {\n    const t = this._context.gl,\n          e = this._depthAttachment;\n\n    if (e && this._initialized) {\n      this._context.bindFramebuffer(this);\n\n      const e = this._desc.depthStencilTarget === o.DEPTH_RENDER_BUFFER ? t.DEPTH_ATTACHMENT : t.DEPTH_STENCIL_ATTACHMENT;\n      t.framebufferRenderbuffer(E.FRAMEBUFFER, e, t.RENDERBUFFER, null);\n    }\n\n    return this._depthAttachment = null, e;\n  }\n\n  detachAll() {\n    this._colorAttachments.forEach((t, e) => this._detachColorAttachment(e)), this.detachDepthStencilBuffer(), this.detachDepthStencilTexture();\n  }\n\n  copyToTexture(t, e, i, r, h, s, n) {\n    (t < 0 || e < 0 || h < 0 || s < 0) && console.error(\"Offsets cannot be negative!\"), (i <= 0 || r <= 0) && console.error(\"Copy width and height must be greater than zero!\");\n    const c = this._desc,\n          o = n.descriptor;\n    n.descriptor.target !== d.TEXTURE_2D && console.error(\"Texture target must be TEXTURE_2D!\"), (null == c?.width || null == c?.height || null == o?.width || null == o?.height || t + i > c.width || e + r > c.height || h + i > o.width || s + r > o.height) && console.error(\"Bad dimensions, the current input values will attempt to read or copy out of bounds!\");\n\n    const _ = this._context,\n          a = _.bindTexture(n, N.TEXTURE_UNIT_FOR_UPDATES);\n\n    _.setActiveTexture(N.TEXTURE_UNIT_FOR_UPDATES), _.bindFramebuffer(this), _.gl.copyTexSubImage2D(d.TEXTURE_2D, 0, h, s, t, e, i, r), _.bindTexture(a, N.TEXTURE_UNIT_FOR_UPDATES);\n  }\n\n  readPixels(t, e, i, r, h, s, n) {\n    (i <= 0 || r <= 0) && console.error(\"Copy width and height must be greater than zero!\"), n || console.error(\"Target memory is not initialized!\"), this._context.bindFramebuffer(this);\n\n    this._context.gl.readPixels(t, e, i, r, h, s, n);\n  }\n\n  async readPixelsAsync(t, e, i, n, c, o, _) {\n    if (this._context.type !== s.WEBGL2) return h() && console.warn(\"Attempting to read pixels using pixel buffer object without WebGL2\"), void this.readPixels(t, e, i, n, c, o, _);\n    const a = this._context.gl,\n          l = r.createPixelPack(this._context, u.STREAM_READ, _.byteLength);\n    this._context.bindBuffer(l), this._context.bindFramebuffer(this), a.readPixels(t, e, i, n, c, o, 0), this._context.unbindBuffer(f.PIXEL_PACK_BUFFER), await l.getSubDataAsync(_), l.dispose();\n  }\n\n  resize(t, e) {\n    const i = this._desc;\n\n    if (i.width !== t || i.height !== e) {\n      if (!this._initialized) return i.width = t, i.height = e, this._colorAttachments.forEach(i => {\n        i && i.resize(t, e);\n      }), void (this._depthStencilTexture && this._depthStencilTexture.resize(t, e));\n      i.width = t, i.height = e, this._colorAttachments.forEach(i => {\n        i && i.resize(t, e);\n      }), null != this._depthStencilTexture ? this._depthStencilTexture.resize(t, e) : (this._depthAttachment || this._stencilAttachment) && (this._depthAttachment && this._depthAttachment.resize(t, e), this._stencilAttachment && this._stencilAttachment.resize(t, e)), this._context.getBoundFramebufferObject() === this && this._context.bindFramebuffer(null), this._initialized = !1;\n    }\n  }\n\n  initializeAndBind(t = E.FRAMEBUFFER) {\n    const e = this._context.gl;\n    if (this._initialized) return void e.bindFramebuffer(t, this.glName);\n    this._glName && e.deleteFramebuffer(this._glName);\n    const i = this._context,\n          r = e.createFramebuffer(),\n          s = this._desc,\n          n = s.colorTarget ?? m.RENDER_BUFFER,\n          l = s.width ?? 1,\n          u = s.height ?? 1;\n    if (e.bindFramebuffer(t, r), 0 === this._colorAttachments.size) if (n === m.TEXTURE || n === m.CUBEMAP) this._colorAttachments.set(c.COLOR_ATTACHMENT0, S(i, s, this.descriptor.colorTarget === m.CUBEMAP ? d.TEXTURE_CUBE_MAP : d.TEXTURE_2D));else {\n      const t = new g(i, {\n        internalFormat: A.RGBA4,\n        width: l,\n        height: u\n      });\n\n      this._colorAttachments.set(c.COLOR_ATTACHMENT0, t);\n    }\n\n    this._colorAttachments.forEach((i, r) => {\n      i && (b(i) ? this._framebufferTexture2D(i.glName, r, P(i), t) : e.framebufferRenderbuffer(t, r, e.RENDERBUFFER, i.glName));\n    });\n\n    const f = s.depthStencilTarget ?? o.NONE;\n\n    switch (f) {\n      case o.DEPTH_RENDER_BUFFER:\n      case o.DEPTH_STENCIL_RENDER_BUFFER:\n        {\n          this._depthAttachment || (this._depthAttachment = new g(i, {\n            internalFormat: s.depthStencilTarget === o.DEPTH_RENDER_BUFFER ? T.DEPTH_COMPONENT16 : T.DEPTH_STENCIL,\n            width: l,\n            height: u\n          }));\n          const r = f === o.DEPTH_RENDER_BUFFER ? e.DEPTH_ATTACHMENT : e.DEPTH_STENCIL_ATTACHMENT;\n          e.framebufferRenderbuffer(t, r, e.RENDERBUFFER, this._depthAttachment.glName);\n          break;\n        }\n\n      case o.STENCIL_RENDER_BUFFER:\n        this._stencilAttachment || (this._stencilAttachment = new g(i, {\n          internalFormat: T.STENCIL_INDEX8,\n          width: l,\n          height: u\n        })), e.framebufferRenderbuffer(t, e.STENCIL_ATTACHMENT, e.RENDERBUFFER, this._stencilAttachment.glName);\n        break;\n\n      case o.DEPTH_STENCIL_TEXTURE:\n        if (!this._depthStencilTexture) {\n          i.capabilities.depthTexture || console.error(\"Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!\");\n          const t = {\n            target: d.TEXTURE_2D,\n            pixelFormat: _.DEPTH_STENCIL,\n            dataType: a.UNSIGNED_INT_24_8,\n            samplingMode: p.NEAREST,\n            wrapMode: R.CLAMP_TO_EDGE,\n            width: l,\n            height: u\n          };\n          this._depthStencilTexture = new N(i, t);\n        }\n\n        this._framebufferTexture2D(this._depthStencilTexture.glName, e.DEPTH_STENCIL_ATTACHMENT, P(this._depthStencilTexture), t);\n\n    }\n\n    if (h()) {\n      e.checkFramebufferStatus(t) !== e.FRAMEBUFFER_COMPLETE && console.error(\"Framebuffer is incomplete!\");\n    }\n\n    this._glName = r, this._initialized = !0;\n  }\n\n  _framebufferTexture2D(t, e = c.COLOR_ATTACHMENT0, i = d.TEXTURE_2D, r = E.FRAMEBUFFER, h = 0) {\n    this._context.gl.framebufferTexture2D(r, e, i, t, h);\n  }\n\n  _detachColorAttachment(t) {\n    h() && console.warn(\"Detaching an FBO attachment can be a slow due to invalidating framebuffer completeness!\");\n\n    const e = this._context.gl,\n          i = this._colorAttachments.get(t);\n\n    return b(i) ? this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(null, t)) : this._initialized && (this._context.bindFramebuffer(this), e.framebufferRenderbuffer(E.FRAMEBUFFER, t, e.RENDERBUFFER, null)), this._colorAttachments.delete(t), i;\n  }\n\n  _disposeColorAttachments() {\n    this._colorAttachments.forEach((t, e) => {\n      this._detachColorAttachment(e), t.dispose();\n    }), this._colorAttachments.clear();\n  }\n\n  _disposeDepthStencilAttachments() {\n    const t = this._context.gl;\n\n    if (this._depthAttachment) {\n      if (this._initialized) {\n        this._context.bindFramebuffer(this);\n\n        const e = this._desc.depthStencilTarget === o.DEPTH_RENDER_BUFFER ? t.DEPTH_ATTACHMENT : t.DEPTH_STENCIL_ATTACHMENT;\n        t.framebufferRenderbuffer(E.FRAMEBUFFER, e, t.RENDERBUFFER, null);\n      }\n\n      this._depthAttachment.dispose(), this._depthAttachment = null;\n    }\n\n    this._stencilAttachment && (this._initialized && (this._context.bindFramebuffer(this), t.framebufferRenderbuffer(E.FRAMEBUFFER, t.STENCIL_ATTACHMENT, t.RENDERBUFFER, null)), this._stencilAttachment.dispose(), this._stencilAttachment = null), this._depthStencilTexture && (this._initialized && (this._context.bindFramebuffer(this), this._framebufferTexture2D(null, t.DEPTH_STENCIL_ATTACHMENT)), this._depthStencilTexture.dispose(), this._depthStencilTexture = null);\n  }\n\n  _validateColorAttachmentPoint(e) {\n    if (-1 === x._MAX_COLOR_ATTACHMENTS) {\n      const t = this._context.capabilities.drawBuffers;\n\n      if (t) {\n        const e = this._context.gl;\n        x._MAX_COLOR_ATTACHMENTS = e.getParameter(t.MAX_COLOR_ATTACHMENTS);\n      } else x._MAX_COLOR_ATTACHMENTS = 1;\n    }\n\n    const i = e - c.COLOR_ATTACHMENT0;\n    i + 1 > x._MAX_COLOR_ATTACHMENTS && t.getLogger(\"esri.views.webgl.FrameBufferObject\").error(\"esri.FrameBufferObject\", `illegal attachment point for color attachment: ${i + 1}. Implementation supports up to ${x._MAX_COLOR_ATTACHMENTS} color attachments`);\n  }\n\n}\n\nfunction b(t) {\n  return null != t && \"type\" in t && \"texture\" === t.type;\n}\n\nfunction D(t) {\n  return null != t && \"type\" in t && \"renderbuffer\" === t.type;\n}\n\nfunction C(t) {\n  return b(t) || null != t && \"pixelFormat\" in t;\n}\n\nfunction S(t, e, i) {\n  return new N(t, {\n    target: i,\n    pixelFormat: _.RGBA,\n    dataType: a.UNSIGNED_BYTE,\n    samplingMode: p.NEAREST,\n    wrapMode: R.CLAMP_TO_EDGE,\n    width: e.width,\n    height: e.height\n  });\n}\n\nfunction U(t, e) {\n  t.target !== d.TEXTURE_2D && t.target !== d.TEXTURE_CUBE_MAP && console.error(\"Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!\"), void 0 !== e.width && e.width >= 0 && void 0 !== e.height && e.height >= 0 ? e.width === t.width && e.height === t.height || console.error(\"Color attachment texture must match the framebuffer's!\") : (e.width = t.width, e.height = t.height);\n}\n\nfunction H(t, e) {\n  void 0 !== e.width && e.width >= 0 && void 0 !== e.height && e.height >= 0 ? e.width === t.width && e.height === t.height || console.error(\"Renderbuffer dimensions must match the framebuffer's!\") : (e.width = t.width, e.height = t.height);\n}\n\nfunction P(t) {\n  return t.descriptor.target === d.TEXTURE_CUBE_MAP ? d.TEXTURE_CUBE_MAP_POSITIVE_X : d.TEXTURE_2D;\n}\n\nx._MAX_COLOR_ATTACHMENTS = -1;\nexport { x as FramebufferObject };","map":{"version":3,"names":["t","isSome","e","isNone","i","BufferObject","r","webglDebugEnabled","h","ContextType","s","ResourceType","n","ColorAttachment","c","DepthStencilTargetType","o","PixelFormat","_","PixelType","a","DepthStencilAttachment","l","RenderbufferFormat","T","FramebufferTarget","E","TextureType","d","Usage","u","BufferType","f","TargetType","m","SizedPixelFormat","A","TextureSamplingMode","p","TextureWrapMode","R","Renderbuffer","g","Texture","N","getGpuMemoryUsage","F","x","constructor","_context","_glName","_depthAttachment","_stencilAttachment","_colorAttachments","Map","_depthStencilTexture","_initialized","_desc","instanceCounter","increment","FramebufferObject","Array","isArray","length","COLOR_ATTACHMENT0","C","b","descriptor","set","U","D","H","_validateColorAttachmentPoint","capabilities","depthTexture","console","error","depthStencilTarget","DEPTH_STENCIL_RENDER_BUFFER","STENCIL_RENDER_BUFFER","DEPTH_RENDER_BUFFER","dispose","getBoundFramebufferObject","_disposeColorAttachments","_disposeDepthStencilAttachments","gl","deleteFramebuffer","bindFramebuffer","decrement","glName","colorTexture","get","colorAttachment","depthStencilAttachment","depthStencilTexture","width","height","gpuMemoryUsage","reduce","getColorTexture","attachColorTexture","_framebufferTexture2D","detachColorTexture","delete","setColorTextureTarget","attachDepthStencilTexture","pixelFormat","DEPTH_STENCIL","dataType","UNSIGNED_INT_24_8","DEPTH_STENCIL_TEXTURE","detachDepthStencilTexture","attachDepthStencilBuffer","internalFormat","DEPTH_COMPONENT16","DEPTH_ATTACHMENT","DEPTH_STENCIL_ATTACHMENT","framebufferRenderbuffer","FRAMEBUFFER","RENDERBUFFER","detachDepthStencilBuffer","detachAll","forEach","_detachColorAttachment","copyToTexture","target","TEXTURE_2D","bindTexture","TEXTURE_UNIT_FOR_UPDATES","setActiveTexture","copyTexSubImage2D","readPixels","readPixelsAsync","type","WEBGL2","warn","createPixelPack","STREAM_READ","byteLength","bindBuffer","unbindBuffer","PIXEL_PACK_BUFFER","getSubDataAsync","resize","initializeAndBind","createFramebuffer","colorTarget","RENDER_BUFFER","size","TEXTURE","CUBEMAP","S","TEXTURE_CUBE_MAP","RGBA4","P","NONE","STENCIL_INDEX8","STENCIL_ATTACHMENT","samplingMode","NEAREST","wrapMode","CLAMP_TO_EDGE","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","framebufferTexture2D","clear","_MAX_COLOR_ATTACHMENTS","drawBuffers","getParameter","MAX_COLOR_ATTACHMENTS","getLogger","RGBA","UNSIGNED_BYTE","TEXTURE_CUBE_MAP_POSITIVE_X"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/webgl/FramebufferObject.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from\"../../core/Logger.js\";import{isSome as e,isNone as i}from\"../../core/maybe.js\";import{BufferObject as r}from\"./BufferObject.js\";import{webglDebugEnabled as h}from\"./checkWebGLError.js\";import{ContextType as s}from\"./context-util.js\";import{ResourceType as n,ColorAttachment as c,DepthStencilTargetType as o,PixelFormat as _,PixelType as a,DepthStencilAttachment as l,RenderbufferFormat as T,FramebufferTarget as E,TextureType as d,Usage as u,BufferType as f,TargetType as m,SizedPixelFormat as A,TextureSamplingMode as p,TextureWrapMode as R}from\"./enums.js\";import{Renderbuffer as g}from\"./Renderbuffer.js\";import{Texture as N}from\"./Texture.js\";import{getGpuMemoryUsage as F}from\"./Util.js\";class x{constructor(t,i,r=null,h=null){if(this._context=t,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachments=new Map,this._depthStencilTexture=null,this._initialized=!1,this._desc={...i},t.instanceCounter.increment(n.FramebufferObject,this),e(r)){Array.isArray(r)||(r=[r]);for(let t=0;t<r.length;++t){const e=r[t],i=c.COLOR_ATTACHMENT0+t;let h;C(e)?(b(e)?(h=e.descriptor,this._colorAttachments.set(i,e)):(h=e,this._colorAttachments.set(i,new N(this._context,h))),U(h,this._desc)):(D(e)?(h=e.descriptor,this._colorAttachments.set(i,e)):(h=e,this._colorAttachments.set(i,new g(this._context,h))),H(h,this._desc)),this._validateColorAttachmentPoint(i)}}if(e(h)){let t,e;if(C(h))this._context.capabilities.depthTexture||console.error(\"Setting the depth/stencil texture as an attachment requires WEBGL_depth_texture or WebGL2\"),b(h)?(e=h.descriptor,this._depthStencilTexture=h):(e=h,this._depthStencilTexture=new N(this._context,e)),U(e,this._desc);else{D(h)?(e=h.descriptor,t=h):(e=h,t=new g(this._context,e));const i=this._desc.depthStencilTarget??o.DEPTH_STENCIL_RENDER_BUFFER;i===o.STENCIL_RENDER_BUFFER?this._stencilAttachment=t:i===o.DEPTH_RENDER_BUFFER||i===o.DEPTH_STENCIL_RENDER_BUFFER?this._depthAttachment=t:console.error('If a Renderbuffer is provided, \"depthStencilTarget\" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),this._desc.depthStencilTarget=i,H(e,this._desc)}}}dispose(){if(!this._desc)return;const t=this._context.getBoundFramebufferObject();if(this._disposeColorAttachments(),this._disposeDepthStencilAttachments(),this._glName){this._context.gl.deleteFramebuffer(this._glName),this._glName=null}this._context.bindFramebuffer(t),this._context.instanceCounter.decrement(n.FramebufferObject,this),this._desc=null}get glName(){return this._glName}get descriptor(){return this._desc}get colorTexture(){const t=this._colorAttachments.get(c.COLOR_ATTACHMENT0);return t&&b(t)?t:null}get colorAttachment(){return this._colorAttachments.get(c.COLOR_ATTACHMENT0)}get depthStencilAttachment(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}get depthStencilTexture(){return this._depthStencilTexture}get width(){return this._desc.width??0}get height(){return this._desc.height??0}get gpuMemoryUsage(){return[...this._colorAttachments].reduce(((t,[e,i])=>t+F(i)),0)+F(this.depthStencilAttachment)}getColorTexture(t){const e=this._colorAttachments.get(t);return e&&b(e)?e:null}attachColorTexture(t,e=c.COLOR_ATTACHMENT0){if(!t)return;this._validateColorAttachmentPoint(e);U(t.descriptor,this._desc),this._disposeColorAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,e)),this._colorAttachments.set(e,t)}detachColorTexture(t=c.COLOR_ATTACHMENT0){const e=this._colorAttachments.get(t);if(b(e)){const i=e;return this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,t)),this._colorAttachments.delete(t),i}}setColorTextureTarget(t,e=c.COLOR_ATTACHMENT0){const i=this._colorAttachments.get(e);b(i)&&this._framebufferTexture2D(i.glName,e,t)}attachDepthStencilTexture(t){if(i(t))return;const e=t.descriptor;e.pixelFormat!==_.DEPTH_STENCIL&&console.error(\"Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!\"),e.dataType!==a.UNSIGNED_INT_24_8&&console.error(\"Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!\"),this._context.capabilities.depthTexture||console.error(\"Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!\"),U(e,this._desc),this._desc.depthStencilTarget&&this._desc.depthStencilTarget!==o.DEPTH_STENCIL_TEXTURE&&(this._desc.depthStencilTarget=o.DEPTH_STENCIL_TEXTURE),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,l)),this._depthStencilTexture=t}detachDepthStencilTexture(){const t=this._depthStencilTexture;return t&&this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,l)),this._depthStencilTexture=null,t}attachDepthStencilBuffer(t){if(i(t))return;const e=t.descriptor;if(e.internalFormat!==T.DEPTH_STENCIL&&e.internalFormat!==T.DEPTH_COMPONENT16&&console.error(\"Depth/Stencil buffer must have correct internalFormat\"),H(e,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=e.internalFormat===T.DEPTH_STENCIL?o.DEPTH_STENCIL_RENDER_BUFFER:o.DEPTH_RENDER_BUFFER,this._initialized){this._context.bindFramebuffer(this);const e=this._context.gl,i=this._desc.depthStencilTarget===o.DEPTH_RENDER_BUFFER?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(E.FRAMEBUFFER,i,e.RENDERBUFFER,t.glName)}this._depthAttachment=t}detachDepthStencilBuffer(){const t=this._context.gl,e=this._depthAttachment;if(e&&this._initialized){this._context.bindFramebuffer(this);const e=this._desc.depthStencilTarget===o.DEPTH_RENDER_BUFFER?t.DEPTH_ATTACHMENT:t.DEPTH_STENCIL_ATTACHMENT;t.framebufferRenderbuffer(E.FRAMEBUFFER,e,t.RENDERBUFFER,null)}return this._depthAttachment=null,e}detachAll(){this._colorAttachments.forEach(((t,e)=>this._detachColorAttachment(e))),this.detachDepthStencilBuffer(),this.detachDepthStencilTexture()}copyToTexture(t,e,i,r,h,s,n){(t<0||e<0||h<0||s<0)&&console.error(\"Offsets cannot be negative!\"),(i<=0||r<=0)&&console.error(\"Copy width and height must be greater than zero!\");const c=this._desc,o=n.descriptor;n.descriptor.target!==d.TEXTURE_2D&&console.error(\"Texture target must be TEXTURE_2D!\"),(null==c?.width||null==c?.height||null==o?.width||null==o?.height||t+i>c.width||e+r>c.height||h+i>o.width||s+r>o.height)&&console.error(\"Bad dimensions, the current input values will attempt to read or copy out of bounds!\");const _=this._context,a=_.bindTexture(n,N.TEXTURE_UNIT_FOR_UPDATES);_.setActiveTexture(N.TEXTURE_UNIT_FOR_UPDATES),_.bindFramebuffer(this),_.gl.copyTexSubImage2D(d.TEXTURE_2D,0,h,s,t,e,i,r),_.bindTexture(a,N.TEXTURE_UNIT_FOR_UPDATES)}readPixels(t,e,i,r,h,s,n){(i<=0||r<=0)&&console.error(\"Copy width and height must be greater than zero!\"),n||console.error(\"Target memory is not initialized!\"),this._context.bindFramebuffer(this);this._context.gl.readPixels(t,e,i,r,h,s,n)}async readPixelsAsync(t,e,i,n,c,o,_){if(this._context.type!==s.WEBGL2)return h()&&console.warn(\"Attempting to read pixels using pixel buffer object without WebGL2\"),void this.readPixels(t,e,i,n,c,o,_);const a=this._context.gl,l=r.createPixelPack(this._context,u.STREAM_READ,_.byteLength);this._context.bindBuffer(l),this._context.bindFramebuffer(this),a.readPixels(t,e,i,n,c,o,0),this._context.unbindBuffer(f.PIXEL_PACK_BUFFER),await l.getSubDataAsync(_),l.dispose()}resize(t,e){const i=this._desc;if(i.width!==t||i.height!==e){if(!this._initialized)return i.width=t,i.height=e,this._colorAttachments.forEach((i=>{i&&i.resize(t,e)})),void(this._depthStencilTexture&&this._depthStencilTexture.resize(t,e));i.width=t,i.height=e,this._colorAttachments.forEach((i=>{i&&i.resize(t,e)})),null!=this._depthStencilTexture?this._depthStencilTexture.resize(t,e):(this._depthAttachment||this._stencilAttachment)&&(this._depthAttachment&&this._depthAttachment.resize(t,e),this._stencilAttachment&&this._stencilAttachment.resize(t,e)),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}}initializeAndBind(t=E.FRAMEBUFFER){const e=this._context.gl;if(this._initialized)return void e.bindFramebuffer(t,this.glName);this._glName&&e.deleteFramebuffer(this._glName);const i=this._context,r=e.createFramebuffer(),s=this._desc,n=s.colorTarget??m.RENDER_BUFFER,l=s.width??1,u=s.height??1;if(e.bindFramebuffer(t,r),0===this._colorAttachments.size)if(n===m.TEXTURE||n===m.CUBEMAP)this._colorAttachments.set(c.COLOR_ATTACHMENT0,S(i,s,this.descriptor.colorTarget===m.CUBEMAP?d.TEXTURE_CUBE_MAP:d.TEXTURE_2D));else{const t=new g(i,{internalFormat:A.RGBA4,width:l,height:u});this._colorAttachments.set(c.COLOR_ATTACHMENT0,t)}this._colorAttachments.forEach(((i,r)=>{i&&(b(i)?this._framebufferTexture2D(i.glName,r,P(i),t):e.framebufferRenderbuffer(t,r,e.RENDERBUFFER,i.glName))}));const f=s.depthStencilTarget??o.NONE;switch(f){case o.DEPTH_RENDER_BUFFER:case o.DEPTH_STENCIL_RENDER_BUFFER:{this._depthAttachment||(this._depthAttachment=new g(i,{internalFormat:s.depthStencilTarget===o.DEPTH_RENDER_BUFFER?T.DEPTH_COMPONENT16:T.DEPTH_STENCIL,width:l,height:u}));const r=f===o.DEPTH_RENDER_BUFFER?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(t,r,e.RENDERBUFFER,this._depthAttachment.glName);break}case o.STENCIL_RENDER_BUFFER:this._stencilAttachment||(this._stencilAttachment=new g(i,{internalFormat:T.STENCIL_INDEX8,width:l,height:u})),e.framebufferRenderbuffer(t,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,this._stencilAttachment.glName);break;case o.DEPTH_STENCIL_TEXTURE:if(!this._depthStencilTexture){i.capabilities.depthTexture||console.error(\"Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!\");const t={target:d.TEXTURE_2D,pixelFormat:_.DEPTH_STENCIL,dataType:a.UNSIGNED_INT_24_8,samplingMode:p.NEAREST,wrapMode:R.CLAMP_TO_EDGE,width:l,height:u};this._depthStencilTexture=new N(i,t)}this._framebufferTexture2D(this._depthStencilTexture.glName,e.DEPTH_STENCIL_ATTACHMENT,P(this._depthStencilTexture),t)}if(h()){e.checkFramebufferStatus(t)!==e.FRAMEBUFFER_COMPLETE&&console.error(\"Framebuffer is incomplete!\")}this._glName=r,this._initialized=!0}_framebufferTexture2D(t,e=c.COLOR_ATTACHMENT0,i=d.TEXTURE_2D,r=E.FRAMEBUFFER,h=0){this._context.gl.framebufferTexture2D(r,e,i,t,h)}_detachColorAttachment(t){h()&&console.warn(\"Detaching an FBO attachment can be a slow due to invalidating framebuffer completeness!\");const e=this._context.gl,i=this._colorAttachments.get(t);return b(i)?this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,t)):this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(E.FRAMEBUFFER,t,e.RENDERBUFFER,null)),this._colorAttachments.delete(t),i}_disposeColorAttachments(){this._colorAttachments.forEach(((t,e)=>{this._detachColorAttachment(e),t.dispose()})),this._colorAttachments.clear()}_disposeDepthStencilAttachments(){const t=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);const e=this._desc.depthStencilTarget===o.DEPTH_RENDER_BUFFER?t.DEPTH_ATTACHMENT:t.DEPTH_STENCIL_ATTACHMENT;t.framebufferRenderbuffer(E.FRAMEBUFFER,e,t.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),t.framebufferRenderbuffer(E.FRAMEBUFFER,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,t.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)}_validateColorAttachmentPoint(e){if(-1===x._MAX_COLOR_ATTACHMENTS){const t=this._context.capabilities.drawBuffers;if(t){const e=this._context.gl;x._MAX_COLOR_ATTACHMENTS=e.getParameter(t.MAX_COLOR_ATTACHMENTS)}else x._MAX_COLOR_ATTACHMENTS=1}const i=e-c.COLOR_ATTACHMENT0;i+1>x._MAX_COLOR_ATTACHMENTS&&t.getLogger(\"esri.views.webgl.FrameBufferObject\").error(\"esri.FrameBufferObject\",`illegal attachment point for color attachment: ${i+1}. Implementation supports up to ${x._MAX_COLOR_ATTACHMENTS} color attachments`)}}function b(t){return null!=t&&\"type\"in t&&\"texture\"===t.type}function D(t){return null!=t&&\"type\"in t&&\"renderbuffer\"===t.type}function C(t){return b(t)||null!=t&&\"pixelFormat\"in t}function S(t,e,i){return new N(t,{target:i,pixelFormat:_.RGBA,dataType:a.UNSIGNED_BYTE,samplingMode:p.NEAREST,wrapMode:R.CLAMP_TO_EDGE,width:e.width,height:e.height})}function U(t,e){t.target!==d.TEXTURE_2D&&t.target!==d.TEXTURE_CUBE_MAP&&console.error(\"Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!\"),void 0!==e.width&&e.width>=0&&void 0!==e.height&&e.height>=0?e.width===t.width&&e.height===t.height||console.error(\"Color attachment texture must match the framebuffer's!\"):(e.width=t.width,e.height=t.height)}function H(t,e){void 0!==e.width&&e.width>=0&&void 0!==e.height&&e.height>=0?e.width===t.width&&e.height===t.height||console.error(\"Renderbuffer dimensions must match the framebuffer's!\"):(e.width=t.width,e.height=t.height)}function P(t){return t.descriptor.target===d.TEXTURE_CUBE_MAP?d.TEXTURE_CUBE_MAP_POSITIVE_X:d.TEXTURE_2D}x._MAX_COLOR_ATTACHMENTS=-1;export{x as FramebufferObject};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}