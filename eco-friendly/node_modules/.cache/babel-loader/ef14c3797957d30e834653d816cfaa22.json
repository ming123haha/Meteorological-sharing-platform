{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { addFrameTask as e } from \"../../../core/scheduling.js\";\nimport t from \"./GamepadInputDevice.js\";\nimport { extractState as s, stateIdle as i, stateEqual as n } from \"./GamepadState.js\";\n\nclass a {\n  constructor(e, t) {\n    this.element = e, this.input = t, this._hasEventListeners = !1, this._onConnectGamepad = e => {\n      this._connectGamepad(e.gamepad);\n    }, this._onDisconnectGamepad = e => {\n      const t = e.gamepad,\n            i = t.index,\n            n = this.inputDevices[i];\n      n && (this._emitGamepadEvent(t, s(n), !1), this.inputDevices.splice(i, 1), this.latestUpdate.splice(i, 1), this.input.gamepad.devices.remove(n), this.ensurePollingState());\n    }, this.frameTask = null, this.latestUpdate = new Array(), this.inputDevices = new Array(), this.callback = null;\n    const i = (\"getGamepads\" in window.navigator),\n          n = window.isSecureContext;\n    this.supported = i && n, this.supported && (this._forEachGamepad(e => this._connectGamepad(e)), window.addEventListener(\"gamepadconnected\", this._onConnectGamepad), window.addEventListener(\"gamepaddisconnected\", this._onDisconnectGamepad), this.ensurePollingState());\n  }\n\n  destroy() {\n    this.hasEventListeners = !1, this.supported && (window.removeEventListener(\"gamepadconnected\", this._onConnectGamepad), window.removeEventListener(\"gamepaddisconnected\", this._onDisconnectGamepad));\n  }\n\n  set hasEventListeners(e) {\n    this._hasEventListeners !== e && (this._hasEventListeners = e, this.ensurePollingState());\n  }\n\n  get eventsEnabled() {\n    return this.supported && this.inputDevices.length > 0 && this._hasEventListeners;\n  }\n\n  set onEvent(e) {\n    this.callback = e;\n  }\n\n  _connectGamepad(e) {\n    const s = new t(e);\n    \"unknown\" !== s.deviceType && (this.inputDevices[e.index] = s, this.input.gamepad.devices.add(s)), this.ensurePollingState();\n  }\n\n  ensurePollingState() {\n    this.eventsEnabled ? this._startPolling() : this._stopPolling();\n  }\n\n  _startPolling() {\n    null == this.frameTask && (this.frameTask = e({\n      update: () => this._readGamepadState()\n    }));\n  }\n\n  _stopPolling() {\n    null != this.frameTask && (this.frameTask.remove(), this.frameTask = null, this.latestUpdate = new Array());\n  }\n\n  _readGamepadState() {\n    const e = document.hasFocus(),\n          t = this.element.contains(document.activeElement),\n          a = \"document\" === this.input.gamepad.enabledFocusMode && !e || \"view\" === this.input.gamepad.enabledFocusMode && !t;\n\n    this._forEachGamepad(e => {\n      const t = this.inputDevices[e.index];\n      if (!t) return;\n      const d = this.latestUpdate[e.index],\n            o = s(t),\n            r = a || i(o);\n\n      if (d) {\n        if (d.timestamp === e.timestamp) return;\n        if (!d.active && r) return;\n        if (n(d.state, o)) return;\n      }\n\n      this._emitGamepadEvent(e, o, !r);\n    });\n  }\n\n  _forEachGamepad(e) {\n    const t = window.navigator.getGamepads();\n\n    for (let s = 0; s < t.length; s++) {\n      const i = t[s];\n      this._validate(i) && e(i);\n    }\n  }\n\n  _emitGamepadEvent(e, t, s) {\n    const i = this.latestUpdate[e.index],\n          n = i && i.active;\n    if (!n && !s) return;\n    const a = !n && s ? \"start\" : n && s ? \"update\" : \"end\";\n    this.latestUpdate[e.index] = {\n      timestamp: e.timestamp,\n      state: t,\n      active: s\n    }, this.callback && this.callback({\n      device: this.inputDevices[e.index],\n      state: t,\n      action: a\n    });\n  }\n\n  _validate(e) {\n    if (!e) return !1;\n    if (!e.connected) return !1;\n\n    for (let t = 0; t < e.axes.length; t++) if (isNaN(e.axes[t])) return !1;\n\n    return !0;\n  }\n\n}\n\nexport { a as GamepadSource };","map":{"version":3,"names":["addFrameTask","e","t","extractState","s","stateIdle","i","stateEqual","n","a","constructor","element","input","_hasEventListeners","_onConnectGamepad","_connectGamepad","gamepad","_onDisconnectGamepad","index","inputDevices","_emitGamepadEvent","splice","latestUpdate","devices","remove","ensurePollingState","frameTask","Array","callback","window","navigator","isSecureContext","supported","_forEachGamepad","addEventListener","destroy","hasEventListeners","removeEventListener","eventsEnabled","length","onEvent","deviceType","add","_startPolling","_stopPolling","update","_readGamepadState","document","hasFocus","contains","activeElement","enabledFocusMode","d","o","r","timestamp","active","state","getGamepads","_validate","device","action","connected","axes","isNaN","GamepadSource"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/input/gamepad/GamepadSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{addFrameTask as e}from\"../../../core/scheduling.js\";import t from\"./GamepadInputDevice.js\";import{extractState as s,stateIdle as i,stateEqual as n}from\"./GamepadState.js\";class a{constructor(e,t){this.element=e,this.input=t,this._hasEventListeners=!1,this._onConnectGamepad=e=>{this._connectGamepad(e.gamepad)},this._onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this.inputDevices[i];n&&(this._emitGamepadEvent(t,s(n),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(n),this.ensurePollingState())},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;const i=\"getGamepads\"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this._forEachGamepad((e=>this._connectGamepad(e))),window.addEventListener(\"gamepadconnected\",this._onConnectGamepad),window.addEventListener(\"gamepaddisconnected\",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener(\"gamepadconnected\",this._onConnectGamepad),window.removeEventListener(\"gamepaddisconnected\",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e}_connectGamepad(e){const s=new t(e);\"unknown\"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState()}ensurePollingState(){this.eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){null==this.frameTask&&(this.frameTask=e({update:()=>this._readGamepadState()}))}_stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this.element.contains(document.activeElement),a=\"document\"===this.input.gamepad.enabledFocusMode&&!e||\"view\"===this.input.gamepad.enabledFocusMode&&!t;this._forEachGamepad((e=>{const t=this.inputDevices[e.index];if(!t)return;const d=this.latestUpdate[e.index],o=s(t),r=a||i(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n(d.state,o))return}this._emitGamepadEvent(e,o,!r)}))}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this._validate(i)&&e(i)}}_emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],n=i&&i.active;if(!n&&!s)return;const a=!n&&s?\"start\":n&&s?\"update\":\"end\";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a})}_validate(e){if(!e)return!1;if(!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}}export{a as GamepadSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}