{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../../Color.js\";\nimport { isSome as t, get as s, none as r, isNone as a, unwrapOr as i } from \"../../../../core/maybe.js\";\nimport { pt2px as o } from \"../../../../core/screenUtils.js\";\nimport { c as n, i as c, h as l, j as h } from \"../../../../chunks/mat4.js\";\nimport { c as d } from \"../../../../chunks/mat4f64.js\";\nimport { l as p, o as m, c as u, E as y, a as f, s as _ } from \"../../../../chunks/vec3.js\";\nimport { d as b, O as g, Z as P, f as R, c as v } from \"../../../../chunks/vec3f64.js\";\nimport { O as x, c as S } from \"../../../../chunks/vec4f64.js\";\nimport { projectPointToVector as L, computeTranslationToOriginAndRotation as C } from \"../../../../geometry/projection.js\";\nimport { create as w, size as E, containsPoint as U, center as j } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { defaultPrimitive as B } from \"../../../../symbols/support/ObjectSymbol3DLayerResource.js\";\nimport { objectSymbolLayerPrimitiveBoundingBox as T, objectSymbolLayerSizeWithResourceSize as G } from \"../../../../symbols/support/symbolLayerUtils3D.js\";\nimport { perLodInstanceElevationAligner as O } from \"./ElevationAligners.js\";\nimport { needsElevationUpdates3D as D, evaluateElevationInfoAtPoint as I, SampleElevationInfo as z } from \"./elevationAlignmentUtils.js\";\nimport { ElevationContext as M } from \"./ElevationContext.js\";\nimport A from \"./Graphics3DLodInstanceGraphicLayer.js\";\nimport { Graphics3DSymbolLayer as F } from \"./Graphics3DSymbolLayer.js\";\nimport { validateSymbolLayerSize as V, mixinColorAndOpacity as k, computeObjectScale as W, computeObjectRotation as H } from \"./graphicUtils.js\";\nimport { ApplyRendererDiffResult as q } from \"./interfaces.js\";\nimport { LoadStatus as N } from \"./Loadable.js\";\nimport { makeLodResources as $, fillEstimatedMinScreenSpaceRadius as Z } from \"./lodResourceUtils.js\";\nimport { fetch as J } from \"./objectResourceUtils.js\";\nimport { placePointOnGeometry as K, extendPointGraphicElevationContext as Q } from \"./pointUtils.js\";\nimport { isValidPrimitive as X, primitiveLodResources as Y } from \"./primitiveObjectSymbolUtils.js\";\nimport { defaultSymbolLayerMemoryComplexity as ee } from \"./symbolComplexity.js\";\nimport { initFastSymbolUpdatesState as te, updateFastSymbolUpdatesState as se, evaluateModelTransform as re, evaluateModelTransformScale as ae } from \"../support/FastSymbolUpdates.js\";\nimport { CullFaceOptions as ie } from \"../../webgl-engine/lib/basicInterfaces.js\";\nimport { VertexAttribute as oe } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { LodRenderer as ne } from \"../../webgl-engine/lib/lodRendering/LodRenderer.js\";\nimport { materialsFromLodResources as ce, texturesFromLodResources as le, geometriesFromLodResources as he, geometriesFromLodLevelResources as de } from \"../../webgl-engine/lib/lodRendering/LodResources.js\";\nimport { DefaultMaterial as pe } from \"../../webgl-engine/materials/DefaultMaterial.js\";\n\nclass me extends F {\n  constructor(e, t, s, r) {\n    super(e, t, s, r), this._resources = null, this._optionalFields = new Array(), this._instanceIndexToGraphicUid = new Map(), this.hasLoadedPBRTextures = !1, this._disposeResourceHandles = new Array(), this.ensureDrapedStatus(!1), this.hasLoadedPBRTextures = s.physicalBasedRenderingEnabled;\n  }\n\n  getCachedSize() {\n    const [e, s, r] = t(this._resources) ? this._resources.symbolSize : [1, 1, 1];\n    return {\n      width: e,\n      depth: s,\n      height: r\n    };\n  }\n\n  async doLoad(e) {\n    if (!this._drivenProperties.size) {\n      if (V(this.symbolLayer)) throw new Error();\n    }\n\n    const t = this.symbolLayer;\n\n    if (this.isPrimitive) {\n      const s = t.resource ? t.resource.primitive : B;\n      this._resources = await this._createResourcesForPrimitive(s, e);\n    } else this._resources = await this._createResourcesForUrl(t.resource.href, e);\n\n    this.layerOpacityChanged(), this.slicePlaneEnabledChanged(), this.physicalBasedRenderingChanged(), this.complexity = this.computeComplexity();\n  }\n\n  get extentPadding() {\n    return t(this._resources) ? this._resources.extentPadding : 0;\n  }\n\n  get isPrimitive() {\n    return !(this.symbolLayer.resource && this.symbolLayer.resource.href);\n  }\n\n  get lodRenderer() {\n    return s(this._resources, \"lodRenderer\");\n  }\n\n  _setMaterialTransparencyParams(e, t = s(this.symbolLayer, \"material\", \"color\")) {\n    const r = this._getCombinedOpacity(t),\n          a = r < 1 || this.needsDrivenTransparentPass;\n\n    return e.transparent = a, e.opacity = r, e.cullFace = a ? ie.None : ie.Back, e;\n  }\n\n  async _createResourcesForPrimitive(s, a) {\n    if (!X(s)) throw new Error(`Unknown object symbol primitive: ${s}`);\n    const i = this.symbolLayer,\n          n = w(T(s)),\n          c = b(E(n)),\n          l = b(G(c, i)),\n          h = p(l),\n          d = !1,\n          m = !1,\n          u = {\n      usePBR: this._context.physicalBasedRenderingEnabled,\n      isSchematic: !0,\n      ambient: g,\n      diffuse: g,\n      hasSlicePlane: this._context.slicePlaneEnabled,\n      hasSliceHighlight: !1,\n      castShadows: this.symbolLayer.castShadows,\n      offsetTransparentBackfaces: !this.symbolLayer.isPrimitive\n    },\n          y = u.usePBR;\n\n    this._setMaterialTransparencyParams(u);\n\n    const f = this.symbol;\n\n    if (\"point-3d\" === f.type && f.verticalOffset) {\n      const {\n        screenLength: e,\n        minWorldLength: t,\n        maxWorldLength: s\n      } = f.verticalOffset;\n      u.verticalOffset = {\n        screenLength: o(e),\n        minWorldLength: t || 0,\n        maxWorldLength: null != s ? s : 1 / 0\n      }, u.castShadows = !1;\n    }\n\n    if (this._context.screenSizePerspectiveEnabled && (u.screenSizePerspective = this._context.sharedResources.screenSizePerspectiveSettings), this._drivenProperties.color) u.externalColor = x;else {\n      const s = t(i.material) && i.material.color,\n            r = t(s) ? e.toUnitRGBA(s) : x;\n      u.externalColor = r;\n    }\n    this._fastUpdates = te(this._context.renderer, this._fastVisualVariableConvertOptions(n, l, c, r)), u.instanced = [\"transformation\"], this._fastUpdates.enabled ? (Object.assign(u, this._fastUpdates.materialParameters), u.instanced.push(\"featureAttribute\"), this._optionalFields.push(\"featureAttribute\")) : this._hasPerInstanceColor() && (u.instanced.push(\"color\"), this._optionalFields.push(\"color\"));\n\n    const _ = new pe(u),\n          P = Y(s, _);\n\n    if (!P) throw new Error(`Unknown object symbol primitive: ${s}`);\n    const R = ce(P).map(e => ({\n      opacity: 1,\n      transparent: e.parameters.transparent\n    })),\n          v = await this._createStageResources(P, y);\n    return {\n      lodResources: P,\n      lodRenderer: await this._createLodRenderer(P, a),\n      stageResources: v,\n      symbolSize: l,\n      extentPadding: h,\n      isEsriSymbolResource: d,\n      isWosr: m,\n      originalMaterialParameters: R,\n      physicalBasedRenderingEnabled: y,\n      resourceBoundingBox: n,\n      resourceSize: c,\n      pivotOffset: r\n    };\n  }\n\n  async _createResourcesForUrl(e, t) {\n    const a = [\"transformation\"],\n          i = {\n      materialParamsMixin: {\n        instanced: a,\n        hasSlicePlane: this._context.slicePlaneEnabled,\n        castShadows: this.symbolLayer.castShadows\n      },\n      streamDataRequester: this._context.streamDataRequester,\n      cache: this._context.sharedResources.objectResourceCache\n    };\n    this._fastUpdates = te(this._context.renderer, this._fastVisualVariableConvertOptions(r, r, r, r)), this._fastUpdates.enabled ? (Object.assign(i.materialParamsMixin, this._fastUpdates.materialParameters), a.push(\"featureAttribute\"), this._optionalFields.push(\"featureAttribute\")) : this._hasPerInstanceColor() && (a.push(\"color\"), this._optionalFields.push(\"color\"));\n    const n = this.symbol;\n\n    if (\"point-3d\" === n.type && n.verticalOffset) {\n      const {\n        screenLength: e,\n        minWorldLength: t,\n        maxWorldLength: s\n      } = n.verticalOffset;\n      i.materialParamsMixin.verticalOffset = {\n        screenLength: o(e),\n        minWorldLength: t || 0,\n        maxWorldLength: null != s ? s : 1 / 0\n      }, i.materialParamsMixin.castShadows = !1;\n    }\n\n    i.signal = t, i.usePBR = this._context.physicalBasedRenderingEnabled;\n    const c = i.usePBR,\n          l = await J(e, i),\n          h = l.isEsriSymbolResource,\n          d = l.isWosr;\n\n    this._addDisposeResource(() => l.remove());\n\n    const m = $(l.lods);\n    Z(m), m.levels.sort((e, t) => e.minScreenSpaceRadius - t.minScreenSpaceRadius), m.levels[0].minScreenSpaceRadius = Math.min(2, m.levels[0].minScreenSpaceRadius);\n\n    const u = this._context,\n          y = this.symbolLayer.material,\n          f = this._getExternalColorParameters(y),\n          _ = s(this.symbolLayer, \"material\", \"color\"),\n          g = this._getCombinedOpacity(_, {\n      hasIntrinsicColor: !0\n    }),\n          P = this.needsDrivenTransparentPass,\n          R = ce(m),\n          v = ce(m).map(e => ({\n      opacity: e.parameters.opacity || 1,\n      transparent: e.parameters.transparent\n    }));\n\n    R.forEach(e => {\n      const t = e.parameters;\n      e.setParameters(f);\n      const s = t.opacity * g,\n            r = s < 1 || P || t.transparent;\n      e.setParameters({\n        opacity: s,\n        transparent: r\n      }), u.screenSizePerspectiveEnabled && e.setParameters({\n        screenSizePerspective: u.sharedResources.screenSizePerspectiveSettings\n      });\n    });\n    const x = l.referenceBoundingBox,\n          S = b(E(x)),\n          L = b(m.levels[0].pivotOffset),\n          C = b(G(S, this.symbolLayer)),\n          w = p(C);\n    se(this._fastUpdates, this._context.renderer, this._fastVisualVariableConvertOptions(x, C, S, L)) && R.forEach(e => e.setParameters(this._fastUpdates.materialParameters));\n    const U = await this._createStageResources(m, c);\n    return {\n      lodResources: m,\n      lodRenderer: await this._createLodRenderer(m, t),\n      stageResources: U,\n      symbolSize: C,\n      extentPadding: w,\n      isEsriSymbolResource: h,\n      isWosr: d,\n      originalMaterialParameters: v,\n      physicalBasedRenderingEnabled: c,\n      resourceBoundingBox: x,\n      resourceSize: S,\n      pivotOffset: L\n    };\n  }\n\n  _addDisposeResource(e) {\n    this._disposeResourceHandles.push(e);\n  }\n\n  async _createStageResources(e, t) {\n    const s = this._context.stage,\n          r = ce(e);\n    t !== this._context.physicalBasedRenderingEnabled && this.physicalBasedRenderingChanged(), s.addMany(r), this._addDisposeResource(() => s.removeMany(r));\n    const a = le(e);\n    s.addMany(a), this._addDisposeResource(() => s.removeMany(a)), await s.load(a);\n    const i = he(e);\n    return s.addMany(i), this._addDisposeResource(() => s.removeMany(i)), {\n      materials: r,\n      textures: a,\n      geometries: i\n    };\n  }\n\n  async _createLodRenderer(e, t) {\n    const s = this._context.stage,\n          r = {\n      layerUid: this._context.layer.uid,\n      graphicUid: e => this._instanceIndexToGraphicUid.get(e),\n      notifyGraphicGeometryChanged: e => this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(e)),\n      notifyGraphicVisibilityChanged: e => this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(e))\n    },\n          a = this._fastUpdates.enabled ? {\n      applyTransform: (e, t, s) => {\n        e.getFeatureAttribute(t, _e), n(s, re(this._fastUpdates.materialParameters, _e, s));\n      },\n      scaleFactor: (e, t, s) => (t.getFeatureAttribute(s, _e), ae(e, this._fastUpdates.materialParameters, _e))\n    } : null,\n          i = new ne(e, this._optionalFields, r, a);\n    return i.slicePlaneEnabled = this._context.slicePlaneEnabled, this._addDisposeResource(() => {\n      s.removeRenderPlugin(i);\n    }), await s.addRenderPlugin(i.slots, i, t), i;\n  }\n\n  _getExternalColorParameters(s) {\n    const r = {};\n    return this._drivenProperties.color ? r.externalColor = x : t(s) && t(s.color) ? r.externalColor = e.toUnitRGBA(s.color) : (r.externalColor = x, r.colorMixMode = \"ignore\"), r;\n  }\n\n  destroy() {\n    super.destroy(), this._cleanupResources();\n  }\n\n  _cleanupResources() {\n    this._disposeResourceHandles.forEach(e => e()), this._disposeResourceHandles.length = 0, this._resources = null;\n  }\n\n  createGraphics3DGraphic(e) {\n    const t = e.graphic;\n    if (!this._validateGeometry(t.geometry)) return null;\n    const s = K(t.geometry);\n    if (a(s)) return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`), null;\n    const r = this.setGraphicElevationContext(t, new M()),\n          i = e.renderingInfo;\n    return this._createAs3DShape(t, s, i, r, t.uid);\n  }\n\n  notifyDestroyGraphicLayer(e) {\n    this._instanceIndexToGraphicUid.delete(e.instanceIndex);\n  }\n\n  graphicLayerToGraphicId() {\n    return 0;\n  }\n\n  layerOpacityChanged() {\n    if (a(this._resources)) return !0;\n    const e = this._drivenProperties.opacity,\n          t = !this.isPrimitive,\n          r = this._resources.stageResources.materials,\n          i = this._resources.originalMaterialParameters;\n\n    for (let a = 0; a < r.length; a++) {\n      const o = r[a],\n            n = s(this.symbolLayer, \"material\", \"color\"),\n            c = i[a],\n            l = this._getCombinedOpacity(n, {\n        hasIntrinsicColor: t\n      }) * c.opacity,\n            h = l < 1 || e || c.transparent;\n      o.setParameters({\n        opacity: l,\n        transparent: h\n      }), this.isPrimitive && o.setParameters({\n        cullFace: h ? ie.None : ie.Back\n      });\n    }\n\n    return !0;\n  }\n\n  layerElevationInfoChanged(e, t) {\n    return this.updateGraphics3DGraphicElevationInfo(e, t, D);\n  }\n\n  slicePlaneEnabledChanged() {\n    if (a(this._resources)) return !0;\n    this._resources.lodRenderer.slicePlaneEnabled = this._context.slicePlaneEnabled;\n\n    for (const e of this._resources.stageResources.materials) e.setParameters({\n      hasSlicePlane: this._context.slicePlaneEnabled\n    });\n\n    return !0;\n  }\n\n  physicalBasedRenderingChanged() {\n    if (a(this._resources)) return !0;\n    const {\n      stageResources: e,\n      isWosr: t\n    } = this._resources;\n\n    for (const s of e.materials) this.isPrimitive ? s.setParameters({\n      usePBR: this._context.physicalBasedRenderingEnabled,\n      isSchematic: !0\n    }) : t || s.setParameters({\n      usePBR: this._context.physicalBasedRenderingEnabled,\n      isSchematic: !1\n    });\n\n    return !1 !== this.hasLoadedPBRTextures || !0 !== this._context.physicalBasedRenderingEnabled || (this.hasLoadedPBRTextures = !0, !1);\n  }\n\n  pixelRatioChanged() {\n    return !0;\n  }\n\n  applyRendererDiff(e, t) {\n    if (a(this._resources)) return q.Recreate_Symbol;\n    const {\n      stageResources: {\n        materials: s\n      },\n      lodRenderer: r,\n      resourceBoundingBox: i,\n      symbolSize: o,\n      resourceSize: n,\n      pivotOffset: c\n    } = this._resources;\n\n    for (const a in e.diff) {\n      if (\"visualVariables\" !== a) return q.Recreate_Symbol;\n      if (!se(this._fastUpdates, t, this._fastVisualVariableConvertOptions(i, o, n, c))) return q.Recreate_Symbol;\n\n      for (const e of s) e.setParameters(this._fastUpdates.materialParameters);\n\n      r.notifyShaderTransformationChanged();\n    }\n\n    return q.Fast_Update;\n  }\n\n  computeComplexity() {\n    if (a(this._resources)) return super.computeComplexity();\n    return {\n      primitivesPerFeature: de(this._resources.lodResources.levels[0]).reduce((e, t) => e + t.indices.get(oe.POSITION).length, 0) / 3,\n      primitivesPerCoordinate: 0,\n      drawCallsPerFeature: 0,\n      estimated: !1,\n      memory: ee(this.symbol, this.symbolLayer)\n    };\n  }\n\n  _hasLodRenderer() {\n    return t(this._resources);\n  }\n\n  _createAs3DShape(e, s, r, i, o) {\n    if (!this._hasLodRenderer() || a(this._resources)) return null;\n    const n = this.getFastUpdateAttrValues(e),\n          c = !this._fastUpdates.enabled && this._hasPerInstanceColor() ? k(r.color, r.opacity) : null,\n          l = this._context.clippingExtent;\n    if (L(s, ue, this._context.elevationProvider.spatialReference), t(l) && !U(l, ue)) return null;\n\n    const h = this._requiresTerrainElevation(i),\n          d = this._computeGlobalTransform(s, i, fe, be),\n          p = this._computeLocalTransform(this._resources, this.symbolLayer, r, ye),\n          m = this._resources.lodRenderer.instanceData,\n          u = m.addInstance();\n\n    this._instanceIndexToGraphicUid.set(u, o), m.setLocalTransform(u, p, !1), m.setGlobalTransform(u, d), n && m.setFeatureAttribute(u, n), c && m.setColor(u, c);\n    const y = new A(this, u, O, i);\n    return h && (y.alignedSampledElevation = be.sampledElevation), y.needsElevationUpdates = D(i.mode), Q(y, s, this._context.elevationProvider), y;\n  }\n\n  _computeGlobalTransform(e, t, s, r) {\n    return I(e, this._context.elevationProvider, t, this._context.renderCoordsHelper, r), ue[0] = e.x, ue[1] = e.y, ue[2] = r.z, C(e.spatialReference, ue, s, this._context.renderCoordsHelper.spatialReference), s;\n  }\n\n  _computeLocalTransform(e, t, s, r) {\n    return c(r), this._applyObjectRotation(s, !1, r), this._applyObjectRotation(t, !0, r), this._applyObjectScale(e, s, r), this._applyAnchor(e, t, r), r;\n  }\n\n  _applyObjectScale(e, t, s) {\n    if (this._fastUpdates.enabled && this._fastUpdates.requiresShaderTransformation) return;\n    const r = this._drivenProperties.size && t.size ? t.size : e.symbolSize,\n          a = W(r, e.symbolSize, e.resourceSize, this._context.renderCoordsHelper.unitInMeters);\n    1 === a[0] && 1 === a[1] && 1 === a[2] || l(s, s, a);\n  }\n\n  prepareSymbolLayerPatch(e) {\n    if (\"partial\" !== e.diff.type) return;\n    const t = e.diff.diff;\n    this._preparePatchTransform(e, t), this._preparePatchColor(e, t);\n  }\n\n  updateGeometry(e, t) {\n    if (a(this._resources)) return !0;\n    const s = t && K(t);\n    if (a(s)) return !1;\n    const r = this.getGeometryElevationMode(t);\n    return e.elevationContext.mode === r && (this._computeGlobalTransform(s, e.elevationContext, fe, be), this._requiresTerrainElevation(e.elevationContext) && (e.alignedSampledElevation = be.sampledElevation), this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex, fe, !0), Q(e, s, this._context.elevationProvider), !0);\n  }\n\n  _preparePatchTransform(e, t) {\n    if (!(t.heading || t.tilt || t.roll || t.width || t.height || t.depth || t.anchor || t.anchorPosition)) return;\n    if (a(this._resources)) return;\n\n    const s = (e, t, s) => i(null != e && \"complete\" === e.type ? e.newValue : t, s),\n          r = s(t.heading, this.symbolLayer.heading, 0),\n          o = s(t.tilt, this.symbolLayer.tilt, 0),\n          n = s(t.roll, this.symbolLayer.roll, 0),\n          c = s(t.width, this.symbolLayer.width, void 0),\n          l = s(t.height, this.symbolLayer.height, void 0),\n          h = s(t.depth, this.symbolLayer.depth, void 0),\n          d = s(t.anchor, this.symbolLayer.anchor, void 0),\n          p = s(t.anchorPosition, this.symbolLayer.anchorPosition, void 0);\n\n    delete t.heading, delete t.tilt, delete t.roll, delete t.width, delete t.height, delete t.depth, delete t.anchor, delete t.anchorPosition;\n    const m = {\n      heading: r,\n      tilt: o,\n      roll: n,\n      anchor: d,\n      anchorPosition: p\n    },\n          u = this._resources;\n    this.loadStatus === N.LOADED && e.symbolLayerStatePatches.push(() => {\n      u.symbolSize = b(G(u.resourceSize, {\n        width: c,\n        height: l,\n        depth: h,\n        isPrimitive: this.symbolLayer.isPrimitive\n      }));\n    }), e.graphics3DGraphicPatches.push((e, t) => {\n      const s = this._computeLocalTransform(u, m, t, ye),\n            r = e.instanceIndex;\n\n      u.lodRenderer.instanceData.setLocalTransform(r, s, !0);\n    });\n  }\n\n  _preparePatchColor(s, r) {\n    if (!r.material || \"partial\" !== r.material.type) return;\n    const i = r.material.diff;\n    if (!i.color || \"complete\" !== i.color.type || null == i.color.newValue || null == i.color.oldValue) return;\n    const o = i.color.newValue,\n          n = t(o) ? e.toUnitRGBA(o) : x;\n    delete i.color;\n    const c = this._resources;\n    a(c) || s.graphics3DGraphicPatches.push(e => {\n      let t;\n      this._hasPerInstanceColor() ? (c.lodRenderer.instanceData.setColor(e.instanceIndex, n), t = this._setMaterialTransparencyParams({}, o)) : t = this._setMaterialTransparencyParams({\n        externalColor: n\n      }, o);\n\n      for (const s of c.stageResources.materials) s.setParameters(t);\n    });\n  }\n\n  _requiresTerrainElevation(e) {\n    return \"absolute-height\" !== e.mode;\n  }\n\n  _applyObjectRotation(e, t, s) {\n    if (!(this._fastUpdates.enabled && this._fastUpdates.requiresShaderTransformation && t)) return H(e.heading, e.tilt, e.roll, s);\n  }\n\n  _computeAnchor(e, s, r) {\n    const a = v();\n\n    switch (r.anchor) {\n      case \"center\":\n        u(a, j(e)), m(a, a);\n        break;\n\n      case \"top\":\n        {\n          const t = j(e);\n\n          _(a, -t[0], -t[1], -e[5]);\n\n          break;\n        }\n\n      case \"bottom\":\n        {\n          const t = j(e);\n\n          _(a, -t[0], -t[1], -e[2]);\n\n          break;\n        }\n\n      case \"relative\":\n        {\n          const t = j(e),\n                s = E(e),\n                i = r.anchorPosition,\n                o = i ? R(i.x, i.y, i.z) : P;\n          y(a, s, o), f(a, a, t), m(a, a);\n          break;\n        }\n\n      default:\n        t(s) ? m(a, s) : u(a, P);\n    }\n\n    return a;\n  }\n\n  _applyAnchor(e, t, s) {\n    if (this._fastUpdates.enabled && this._fastUpdates.requiresShaderTransformation) return;\n\n    const r = this._computeAnchor(e.resourceBoundingBox, e.pivotOffset, t);\n\n    r && h(s, s, r);\n  }\n\n  _hasPerInstanceColor() {\n    return this._drivenProperties.color || this._drivenProperties.opacity;\n  }\n\n  _fastVisualVariableConvertOptions(e, s, r, a) {\n    const i = t(e) ? b(E(e)) : g,\n          o = t(e) ? this._computeAnchor(e, a, this.symbolLayer) : P,\n          n = this._context.renderCoordsHelper.unitInMeters,\n          c = W(t(s) ? s : void 0, s, r, n),\n          l = R(this.symbolLayer.tilt || 0, this.symbolLayer.roll || 0, this.symbolLayer.heading || 0);\n    return {\n      modelSize: i,\n      symbolSize: t(s) ? s : g,\n      unitInMeters: n,\n      transformation: {\n        anchor: o,\n        scale: c,\n        rotation: l\n      }\n    };\n  }\n\n}\n\nconst ue = v(),\n      ye = d(),\n      fe = d(),\n      _e = S(),\n      be = new z();\n\nexport { me as Graphics3DObjectSymbolLayer };","map":{"version":3,"names":["e","isSome","t","get","s","none","r","isNone","a","unwrapOr","i","pt2px","o","c","n","h","l","j","d","p","m","u","E","y","f","_","b","O","g","Z","P","R","v","x","S","projectPointToVector","L","computeTranslationToOriginAndRotation","C","create","w","size","containsPoint","U","center","defaultPrimitive","B","objectSymbolLayerPrimitiveBoundingBox","T","objectSymbolLayerSizeWithResourceSize","G","perLodInstanceElevationAligner","needsElevationUpdates3D","D","evaluateElevationInfoAtPoint","I","SampleElevationInfo","z","ElevationContext","M","A","Graphics3DSymbolLayer","F","validateSymbolLayerSize","V","mixinColorAndOpacity","k","computeObjectScale","W","computeObjectRotation","H","ApplyRendererDiffResult","q","LoadStatus","N","makeLodResources","$","fillEstimatedMinScreenSpaceRadius","fetch","J","placePointOnGeometry","K","extendPointGraphicElevationContext","Q","isValidPrimitive","X","primitiveLodResources","Y","defaultSymbolLayerMemoryComplexity","ee","initFastSymbolUpdatesState","te","updateFastSymbolUpdatesState","se","evaluateModelTransform","re","evaluateModelTransformScale","ae","CullFaceOptions","ie","VertexAttribute","oe","LodRenderer","ne","materialsFromLodResources","ce","texturesFromLodResources","le","geometriesFromLodResources","he","geometriesFromLodLevelResources","de","DefaultMaterial","pe","me","constructor","_resources","_optionalFields","Array","_instanceIndexToGraphicUid","Map","hasLoadedPBRTextures","_disposeResourceHandles","ensureDrapedStatus","physicalBasedRenderingEnabled","getCachedSize","symbolSize","width","depth","height","doLoad","_drivenProperties","symbolLayer","Error","isPrimitive","resource","primitive","_createResourcesForPrimitive","_createResourcesForUrl","href","layerOpacityChanged","slicePlaneEnabledChanged","physicalBasedRenderingChanged","complexity","computeComplexity","extentPadding","lodRenderer","_setMaterialTransparencyParams","_getCombinedOpacity","needsDrivenTransparentPass","transparent","opacity","cullFace","None","Back","usePBR","_context","isSchematic","ambient","diffuse","hasSlicePlane","slicePlaneEnabled","hasSliceHighlight","castShadows","offsetTransparentBackfaces","symbol","type","verticalOffset","screenLength","minWorldLength","maxWorldLength","screenSizePerspectiveEnabled","screenSizePerspective","sharedResources","screenSizePerspectiveSettings","color","externalColor","material","toUnitRGBA","_fastUpdates","renderer","_fastVisualVariableConvertOptions","instanced","enabled","Object","assign","materialParameters","push","_hasPerInstanceColor","map","parameters","_createStageResources","lodResources","_createLodRenderer","stageResources","isEsriSymbolResource","isWosr","originalMaterialParameters","resourceBoundingBox","resourceSize","pivotOffset","materialParamsMixin","streamDataRequester","cache","objectResourceCache","signal","_addDisposeResource","remove","lods","levels","sort","minScreenSpaceRadius","Math","min","_getExternalColorParameters","hasIntrinsicColor","forEach","setParameters","referenceBoundingBox","stage","addMany","removeMany","load","materials","textures","geometries","layerUid","layer","uid","graphicUid","notifyGraphicGeometryChanged","notifyGraphicVisibilityChanged","applyTransform","getFeatureAttribute","_e","scaleFactor","removeRenderPlugin","addRenderPlugin","slots","colorMixMode","destroy","_cleanupResources","length","createGraphics3DGraphic","graphic","_validateGeometry","geometry","logger","warn","setGraphicElevationContext","renderingInfo","_createAs3DShape","notifyDestroyGraphicLayer","delete","instanceIndex","graphicLayerToGraphicId","layerElevationInfoChanged","updateGraphics3DGraphicElevationInfo","pixelRatioChanged","applyRendererDiff","Recreate_Symbol","diff","notifyShaderTransformationChanged","Fast_Update","primitivesPerFeature","reduce","indices","POSITION","primitivesPerCoordinate","drawCallsPerFeature","estimated","memory","_hasLodRenderer","getFastUpdateAttrValues","clippingExtent","ue","elevationProvider","spatialReference","_requiresTerrainElevation","_computeGlobalTransform","fe","be","_computeLocalTransform","ye","instanceData","addInstance","set","setLocalTransform","setGlobalTransform","setFeatureAttribute","setColor","alignedSampledElevation","sampledElevation","needsElevationUpdates","mode","renderCoordsHelper","_applyObjectRotation","_applyObjectScale","_applyAnchor","requiresShaderTransformation","unitInMeters","prepareSymbolLayerPatch","_preparePatchTransform","_preparePatchColor","updateGeometry","getGeometryElevationMode","elevationContext","heading","tilt","roll","anchor","anchorPosition","newValue","loadStatus","LOADED","symbolLayerStatePatches","graphics3DGraphicPatches","oldValue","_computeAnchor","modelSize","transformation","scale","rotation","Graphics3DObjectSymbolLayer"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectSymbolLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import{isSome as t,get as s,none as r,isNone as a,unwrapOr as i}from\"../../../../core/maybe.js\";import{pt2px as o}from\"../../../../core/screenUtils.js\";import{c as n,i as c,h as l,j as h}from\"../../../../chunks/mat4.js\";import{c as d}from\"../../../../chunks/mat4f64.js\";import{l as p,o as m,c as u,E as y,a as f,s as _}from\"../../../../chunks/vec3.js\";import{d as b,O as g,Z as P,f as R,c as v}from\"../../../../chunks/vec3f64.js\";import{O as x,c as S}from\"../../../../chunks/vec4f64.js\";import{projectPointToVector as L,computeTranslationToOriginAndRotation as C}from\"../../../../geometry/projection.js\";import{create as w,size as E,containsPoint as U,center as j}from\"../../../../geometry/support/aaBoundingBox.js\";import{defaultPrimitive as B}from\"../../../../symbols/support/ObjectSymbol3DLayerResource.js\";import{objectSymbolLayerPrimitiveBoundingBox as T,objectSymbolLayerSizeWithResourceSize as G}from\"../../../../symbols/support/symbolLayerUtils3D.js\";import{perLodInstanceElevationAligner as O}from\"./ElevationAligners.js\";import{needsElevationUpdates3D as D,evaluateElevationInfoAtPoint as I,SampleElevationInfo as z}from\"./elevationAlignmentUtils.js\";import{ElevationContext as M}from\"./ElevationContext.js\";import A from\"./Graphics3DLodInstanceGraphicLayer.js\";import{Graphics3DSymbolLayer as F}from\"./Graphics3DSymbolLayer.js\";import{validateSymbolLayerSize as V,mixinColorAndOpacity as k,computeObjectScale as W,computeObjectRotation as H}from\"./graphicUtils.js\";import{ApplyRendererDiffResult as q}from\"./interfaces.js\";import{LoadStatus as N}from\"./Loadable.js\";import{makeLodResources as $,fillEstimatedMinScreenSpaceRadius as Z}from\"./lodResourceUtils.js\";import{fetch as J}from\"./objectResourceUtils.js\";import{placePointOnGeometry as K,extendPointGraphicElevationContext as Q}from\"./pointUtils.js\";import{isValidPrimitive as X,primitiveLodResources as Y}from\"./primitiveObjectSymbolUtils.js\";import{defaultSymbolLayerMemoryComplexity as ee}from\"./symbolComplexity.js\";import{initFastSymbolUpdatesState as te,updateFastSymbolUpdatesState as se,evaluateModelTransform as re,evaluateModelTransformScale as ae}from\"../support/FastSymbolUpdates.js\";import{CullFaceOptions as ie}from\"../../webgl-engine/lib/basicInterfaces.js\";import{VertexAttribute as oe}from\"../../webgl-engine/lib/VertexAttribute.js\";import{LodRenderer as ne}from\"../../webgl-engine/lib/lodRendering/LodRenderer.js\";import{materialsFromLodResources as ce,texturesFromLodResources as le,geometriesFromLodResources as he,geometriesFromLodLevelResources as de}from\"../../webgl-engine/lib/lodRendering/LodResources.js\";import{DefaultMaterial as pe}from\"../../webgl-engine/materials/DefaultMaterial.js\";class me extends F{constructor(e,t,s,r){super(e,t,s,r),this._resources=null,this._optionalFields=new Array,this._instanceIndexToGraphicUid=new Map,this.hasLoadedPBRTextures=!1,this._disposeResourceHandles=new Array,this.ensureDrapedStatus(!1),this.hasLoadedPBRTextures=s.physicalBasedRenderingEnabled}getCachedSize(){const[e,s,r]=t(this._resources)?this._resources.symbolSize:[1,1,1];return{width:e,depth:s,height:r}}async doLoad(e){if(!this._drivenProperties.size){if(V(this.symbolLayer))throw new Error}const t=this.symbolLayer;if(this.isPrimitive){const s=t.resource?t.resource.primitive:B;this._resources=await this._createResourcesForPrimitive(s,e)}else this._resources=await this._createResourcesForUrl(t.resource.href,e);this.layerOpacityChanged(),this.slicePlaneEnabledChanged(),this.physicalBasedRenderingChanged(),this.complexity=this.computeComplexity()}get extentPadding(){return t(this._resources)?this._resources.extentPadding:0}get isPrimitive(){return!(this.symbolLayer.resource&&this.symbolLayer.resource.href)}get lodRenderer(){return s(this._resources,\"lodRenderer\")}_setMaterialTransparencyParams(e,t=s(this.symbolLayer,\"material\",\"color\")){const r=this._getCombinedOpacity(t),a=r<1||this.needsDrivenTransparentPass;return e.transparent=a,e.opacity=r,e.cullFace=a?ie.None:ie.Back,e}async _createResourcesForPrimitive(s,a){if(!X(s))throw new Error(`Unknown object symbol primitive: ${s}`);const i=this.symbolLayer,n=w(T(s)),c=b(E(n)),l=b(G(c,i)),h=p(l),d=!1,m=!1,u={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,ambient:g,diffuse:g,hasSlicePlane:this._context.slicePlaneEnabled,hasSliceHighlight:!1,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!this.symbolLayer.isPrimitive},y=u.usePBR;this._setMaterialTransparencyParams(u);const f=this.symbol;if(\"point-3d\"===f.type&&f.verticalOffset){const{screenLength:e,minWorldLength:t,maxWorldLength:s}=f.verticalOffset;u.verticalOffset={screenLength:o(e),minWorldLength:t||0,maxWorldLength:null!=s?s:1/0},u.castShadows=!1}if(this._context.screenSizePerspectiveEnabled&&(u.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._drivenProperties.color)u.externalColor=x;else{const s=t(i.material)&&i.material.color,r=t(s)?e.toUnitRGBA(s):x;u.externalColor=r}this._fastUpdates=te(this._context.renderer,this._fastVisualVariableConvertOptions(n,l,c,r)),u.instanced=[\"transformation\"],this._fastUpdates.enabled?(Object.assign(u,this._fastUpdates.materialParameters),u.instanced.push(\"featureAttribute\"),this._optionalFields.push(\"featureAttribute\")):this._hasPerInstanceColor()&&(u.instanced.push(\"color\"),this._optionalFields.push(\"color\"));const _=new pe(u),P=Y(s,_);if(!P)throw new Error(`Unknown object symbol primitive: ${s}`);const R=ce(P).map((e=>({opacity:1,transparent:e.parameters.transparent}))),v=await this._createStageResources(P,y);return{lodResources:P,lodRenderer:await this._createLodRenderer(P,a),stageResources:v,symbolSize:l,extentPadding:h,isEsriSymbolResource:d,isWosr:m,originalMaterialParameters:R,physicalBasedRenderingEnabled:y,resourceBoundingBox:n,resourceSize:c,pivotOffset:r}}async _createResourcesForUrl(e,t){const a=[\"transformation\"],i={materialParamsMixin:{instanced:a,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows},streamDataRequester:this._context.streamDataRequester,cache:this._context.sharedResources.objectResourceCache};this._fastUpdates=te(this._context.renderer,this._fastVisualVariableConvertOptions(r,r,r,r)),this._fastUpdates.enabled?(Object.assign(i.materialParamsMixin,this._fastUpdates.materialParameters),a.push(\"featureAttribute\"),this._optionalFields.push(\"featureAttribute\")):this._hasPerInstanceColor()&&(a.push(\"color\"),this._optionalFields.push(\"color\"));const n=this.symbol;if(\"point-3d\"===n.type&&n.verticalOffset){const{screenLength:e,minWorldLength:t,maxWorldLength:s}=n.verticalOffset;i.materialParamsMixin.verticalOffset={screenLength:o(e),minWorldLength:t||0,maxWorldLength:null!=s?s:1/0},i.materialParamsMixin.castShadows=!1}i.signal=t,i.usePBR=this._context.physicalBasedRenderingEnabled;const c=i.usePBR,l=await J(e,i),h=l.isEsriSymbolResource,d=l.isWosr;this._addDisposeResource((()=>l.remove()));const m=$(l.lods);Z(m),m.levels.sort(((e,t)=>e.minScreenSpaceRadius-t.minScreenSpaceRadius)),m.levels[0].minScreenSpaceRadius=Math.min(2,m.levels[0].minScreenSpaceRadius);const u=this._context,y=this.symbolLayer.material,f=this._getExternalColorParameters(y),_=s(this.symbolLayer,\"material\",\"color\"),g=this._getCombinedOpacity(_,{hasIntrinsicColor:!0}),P=this.needsDrivenTransparentPass,R=ce(m),v=ce(m).map((e=>({opacity:e.parameters.opacity||1,transparent:e.parameters.transparent})));R.forEach((e=>{const t=e.parameters;e.setParameters(f);const s=t.opacity*g,r=s<1||P||t.transparent;e.setParameters({opacity:s,transparent:r}),u.screenSizePerspectiveEnabled&&e.setParameters({screenSizePerspective:u.sharedResources.screenSizePerspectiveSettings})}));const x=l.referenceBoundingBox,S=b(E(x)),L=b(m.levels[0].pivotOffset),C=b(G(S,this.symbolLayer)),w=p(C);se(this._fastUpdates,this._context.renderer,this._fastVisualVariableConvertOptions(x,C,S,L))&&R.forEach((e=>e.setParameters(this._fastUpdates.materialParameters)));const U=await this._createStageResources(m,c);return{lodResources:m,lodRenderer:await this._createLodRenderer(m,t),stageResources:U,symbolSize:C,extentPadding:w,isEsriSymbolResource:h,isWosr:d,originalMaterialParameters:v,physicalBasedRenderingEnabled:c,resourceBoundingBox:x,resourceSize:S,pivotOffset:L}}_addDisposeResource(e){this._disposeResourceHandles.push(e)}async _createStageResources(e,t){const s=this._context.stage,r=ce(e);t!==this._context.physicalBasedRenderingEnabled&&this.physicalBasedRenderingChanged(),s.addMany(r),this._addDisposeResource((()=>s.removeMany(r)));const a=le(e);s.addMany(a),this._addDisposeResource((()=>s.removeMany(a))),await s.load(a);const i=he(e);return s.addMany(i),this._addDisposeResource((()=>s.removeMany(i))),{materials:r,textures:a,geometries:i}}async _createLodRenderer(e,t){const s=this._context.stage,r={layerUid:this._context.layer.uid,graphicUid:e=>this._instanceIndexToGraphicUid.get(e),notifyGraphicGeometryChanged:e=>this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(e)),notifyGraphicVisibilityChanged:e=>this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(e))},a=this._fastUpdates.enabled?{applyTransform:(e,t,s)=>{e.getFeatureAttribute(t,_e),n(s,re(this._fastUpdates.materialParameters,_e,s))},scaleFactor:(e,t,s)=>(t.getFeatureAttribute(s,_e),ae(e,this._fastUpdates.materialParameters,_e))}:null,i=new ne(e,this._optionalFields,r,a);return i.slicePlaneEnabled=this._context.slicePlaneEnabled,this._addDisposeResource((()=>{s.removeRenderPlugin(i)})),await s.addRenderPlugin(i.slots,i,t),i}_getExternalColorParameters(s){const r={};return this._drivenProperties.color?r.externalColor=x:t(s)&&t(s.color)?r.externalColor=e.toUnitRGBA(s.color):(r.externalColor=x,r.colorMixMode=\"ignore\"),r}destroy(){super.destroy(),this._cleanupResources()}_cleanupResources(){this._disposeResourceHandles.forEach((e=>e())),this._disposeResourceHandles.length=0,this._resources=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;const s=K(t.geometry);if(a(s))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const r=this.setGraphicElevationContext(t,new M),i=e.renderingInfo;return this._createAs3DShape(t,s,i,r,t.uid)}notifyDestroyGraphicLayer(e){this._instanceIndexToGraphicUid.delete(e.instanceIndex)}graphicLayerToGraphicId(){return 0}layerOpacityChanged(){if(a(this._resources))return!0;const e=this._drivenProperties.opacity,t=!this.isPrimitive,r=this._resources.stageResources.materials,i=this._resources.originalMaterialParameters;for(let a=0;a<r.length;a++){const o=r[a],n=s(this.symbolLayer,\"material\",\"color\"),c=i[a],l=this._getCombinedOpacity(n,{hasIntrinsicColor:t})*c.opacity,h=l<1||e||c.transparent;o.setParameters({opacity:l,transparent:h}),this.isPrimitive&&o.setParameters({cullFace:h?ie.None:ie.Back})}return!0}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,D)}slicePlaneEnabledChanged(){if(a(this._resources))return!0;this._resources.lodRenderer.slicePlaneEnabled=this._context.slicePlaneEnabled;for(const e of this._resources.stageResources.materials)e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled});return!0}physicalBasedRenderingChanged(){if(a(this._resources))return!0;const{stageResources:e,isWosr:t}=this._resources;for(const s of e.materials)this.isPrimitive?s.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}):t||s.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!1});return!1!==this.hasLoadedPBRTextures||!0!==this._context.physicalBasedRenderingEnabled||(this.hasLoadedPBRTextures=!0,!1)}pixelRatioChanged(){return!0}applyRendererDiff(e,t){if(a(this._resources))return q.Recreate_Symbol;const{stageResources:{materials:s},lodRenderer:r,resourceBoundingBox:i,symbolSize:o,resourceSize:n,pivotOffset:c}=this._resources;for(const a in e.diff){if(\"visualVariables\"!==a)return q.Recreate_Symbol;if(!se(this._fastUpdates,t,this._fastVisualVariableConvertOptions(i,o,n,c)))return q.Recreate_Symbol;for(const e of s)e.setParameters(this._fastUpdates.materialParameters);r.notifyShaderTransformationChanged()}return q.Fast_Update}computeComplexity(){if(a(this._resources))return super.computeComplexity();return{primitivesPerFeature:de(this._resources.lodResources.levels[0]).reduce(((e,t)=>e+t.indices.get(oe.POSITION).length),0)/3,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:ee(this.symbol,this.symbolLayer)}}_hasLodRenderer(){return t(this._resources)}_createAs3DShape(e,s,r,i,o){if(!this._hasLodRenderer()||a(this._resources))return null;const n=this.getFastUpdateAttrValues(e),c=!this._fastUpdates.enabled&&this._hasPerInstanceColor()?k(r.color,r.opacity):null,l=this._context.clippingExtent;if(L(s,ue,this._context.elevationProvider.spatialReference),t(l)&&!U(l,ue))return null;const h=this._requiresTerrainElevation(i),d=this._computeGlobalTransform(s,i,fe,be),p=this._computeLocalTransform(this._resources,this.symbolLayer,r,ye),m=this._resources.lodRenderer.instanceData,u=m.addInstance();this._instanceIndexToGraphicUid.set(u,o),m.setLocalTransform(u,p,!1),m.setGlobalTransform(u,d),n&&m.setFeatureAttribute(u,n),c&&m.setColor(u,c);const y=new A(this,u,O,i);return h&&(y.alignedSampledElevation=be.sampledElevation),y.needsElevationUpdates=D(i.mode),Q(y,s,this._context.elevationProvider),y}_computeGlobalTransform(e,t,s,r){return I(e,this._context.elevationProvider,t,this._context.renderCoordsHelper,r),ue[0]=e.x,ue[1]=e.y,ue[2]=r.z,C(e.spatialReference,ue,s,this._context.renderCoordsHelper.spatialReference),s}_computeLocalTransform(e,t,s,r){return c(r),this._applyObjectRotation(s,!1,r),this._applyObjectRotation(t,!0,r),this._applyObjectScale(e,s,r),this._applyAnchor(e,t,r),r}_applyObjectScale(e,t,s){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const r=this._drivenProperties.size&&t.size?t.size:e.symbolSize,a=W(r,e.symbolSize,e.resourceSize,this._context.renderCoordsHelper.unitInMeters);1===a[0]&&1===a[1]&&1===a[2]||l(s,s,a)}prepareSymbolLayerPatch(e){if(\"partial\"!==e.diff.type)return;const t=e.diff.diff;this._preparePatchTransform(e,t),this._preparePatchColor(e,t)}updateGeometry(e,t){if(a(this._resources))return!0;const s=t&&K(t);if(a(s))return!1;const r=this.getGeometryElevationMode(t);return e.elevationContext.mode===r&&(this._computeGlobalTransform(s,e.elevationContext,fe,be),this._requiresTerrainElevation(e.elevationContext)&&(e.alignedSampledElevation=be.sampledElevation),this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex,fe,!0),Q(e,s,this._context.elevationProvider),!0)}_preparePatchTransform(e,t){if(!(t.heading||t.tilt||t.roll||t.width||t.height||t.depth||t.anchor||t.anchorPosition))return;if(a(this._resources))return;const s=(e,t,s)=>i(null!=e&&\"complete\"===e.type?e.newValue:t,s),r=s(t.heading,this.symbolLayer.heading,0),o=s(t.tilt,this.symbolLayer.tilt,0),n=s(t.roll,this.symbolLayer.roll,0),c=s(t.width,this.symbolLayer.width,void 0),l=s(t.height,this.symbolLayer.height,void 0),h=s(t.depth,this.symbolLayer.depth,void 0),d=s(t.anchor,this.symbolLayer.anchor,void 0),p=s(t.anchorPosition,this.symbolLayer.anchorPosition,void 0);delete t.heading,delete t.tilt,delete t.roll,delete t.width,delete t.height,delete t.depth,delete t.anchor,delete t.anchorPosition;const m={heading:r,tilt:o,roll:n,anchor:d,anchorPosition:p},u=this._resources;this.loadStatus===N.LOADED&&e.symbolLayerStatePatches.push((()=>{u.symbolSize=b(G(u.resourceSize,{width:c,height:l,depth:h,isPrimitive:this.symbolLayer.isPrimitive}))})),e.graphics3DGraphicPatches.push(((e,t)=>{const s=this._computeLocalTransform(u,m,t,ye),r=e.instanceIndex;u.lodRenderer.instanceData.setLocalTransform(r,s,!0)}))}_preparePatchColor(s,r){if(!r.material||\"partial\"!==r.material.type)return;const i=r.material.diff;if(!i.color||\"complete\"!==i.color.type||null==i.color.newValue||null==i.color.oldValue)return;const o=i.color.newValue,n=t(o)?e.toUnitRGBA(o):x;delete i.color;const c=this._resources;a(c)||s.graphics3DGraphicPatches.push((e=>{let t;this._hasPerInstanceColor()?(c.lodRenderer.instanceData.setColor(e.instanceIndex,n),t=this._setMaterialTransparencyParams({},o)):t=this._setMaterialTransparencyParams({externalColor:n},o);for(const s of c.stageResources.materials)s.setParameters(t)}))}_requiresTerrainElevation(e){return\"absolute-height\"!==e.mode}_applyObjectRotation(e,t,s){if(!(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation&&t))return H(e.heading,e.tilt,e.roll,s)}_computeAnchor(e,s,r){const a=v();switch(r.anchor){case\"center\":u(a,j(e)),m(a,a);break;case\"top\":{const t=j(e);_(a,-t[0],-t[1],-e[5]);break}case\"bottom\":{const t=j(e);_(a,-t[0],-t[1],-e[2]);break}case\"relative\":{const t=j(e),s=E(e),i=r.anchorPosition,o=i?R(i.x,i.y,i.z):P;y(a,s,o),f(a,a,t),m(a,a);break}default:t(s)?m(a,s):u(a,P)}return a}_applyAnchor(e,t,s){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const r=this._computeAnchor(e.resourceBoundingBox,e.pivotOffset,t);r&&h(s,s,r)}_hasPerInstanceColor(){return this._drivenProperties.color||this._drivenProperties.opacity}_fastVisualVariableConvertOptions(e,s,r,a){const i=t(e)?b(E(e)):g,o=t(e)?this._computeAnchor(e,a,this.symbolLayer):P,n=this._context.renderCoordsHelper.unitInMeters,c=W(t(s)?s:void 0,s,r,n),l=R(this.symbolLayer.tilt||0,this.symbolLayer.roll||0,this.symbolLayer.heading||0);return{modelSize:i,symbolSize:t(s)?s:g,unitInMeters:n,transformation:{anchor:o,scale:c,rotation:l}}}}const ue=v(),ye=d(),fe=d(),_e=S(),be=new z;export{me as Graphics3DObjectSymbolLayer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}