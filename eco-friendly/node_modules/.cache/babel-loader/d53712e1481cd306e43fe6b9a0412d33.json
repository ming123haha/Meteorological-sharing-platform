{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/Handles.js\";\nimport { timeoutHandle as t } from \"../../../../core/handleUtils.js\";\nimport { isSome as r } from \"../../../../core/maybe.js\";\nimport { isAborted as o, createAbortError as s, onAbort as i } from \"../../../../core/promiseUtils.js\";\nimport { DefaultLoadingContext as a } from \"../../glTF/DefaultLoadingContext.js\";\nimport { load as n } from \"../../glTF/loader.js\";\nimport { load as l } from \"./wosrLoader.js\";\n\nclass c {\n  constructor() {\n    this.gltfCache = new Map(), this.wosrCache = new Map(), this.evictHandles = new e();\n  }\n\n  loadGLTF(e, t, r) {\n    const o = r ? `gltfPBR:${e}` : `gltf:${e}`;\n    return this._fromCache(this.gltfCache, o, t => n(new a(t.streamDataRequester), e, t, r), t);\n  }\n\n  loadWOSR(e, t) {\n    const r = `wosr:${e}:${t.disableTextures}`;\n    return this._fromCache(this.wosrCache, r, t => l(e, t), t);\n  }\n\n  destroy() {\n    this.evictHandles.destroy(), this.gltfCache.clear(), this.wosrCache.clear();\n  }\n\n  get size() {\n    return this.wosrCache.size + this.gltfCache.size;\n  }\n\n  _fromCache(e, t, a, n) {\n    return new Promise((l, c) => {\n      if (o(n)) return void c(s());\n      const m = i(n, () => {\n        this._remove(e, t), c(s());\n      }),\n            h = e.get(t);\n      if (h) return this.evictHandles.remove(t), h.refCount++, void h.item.then(l, c);\n      const f = new AbortController(),\n            d = { ...n,\n        signal: f.signal\n      },\n            C = {\n        refCount: 1,\n        abortController: f,\n        item: a(d).then(r => (C.abortController = null, r.remove = () => this._remove(e, t), r))\n      };\n      e.set(t, C), C.item.then(e => {\n        r(m) && m.remove(), l(e);\n      }, e => {\n        r(m) && m.remove(), c(e);\n      });\n    });\n  }\n\n  _remove(e, o) {\n    const s = e.get(o);\n    s && (s.refCount--, 0 === s.refCount && this.evictHandles.add(t(() => {\n      e.delete(o), r(s.abortController) && s.abortController.abort();\n    }, h), o));\n  }\n\n}\n\nconst m = 1e4;\nlet h = m;\nconst f = {\n  overrideEvictDelay: e => (h = e, {\n    remove() {\n      h = m;\n    }\n\n  })\n};\nexport { c as ObjectResourceCache, f as test };","map":{"version":3,"names":["e","timeoutHandle","t","isSome","r","isAborted","o","createAbortError","s","onAbort","i","DefaultLoadingContext","a","load","n","l","c","constructor","gltfCache","Map","wosrCache","evictHandles","loadGLTF","_fromCache","streamDataRequester","loadWOSR","disableTextures","destroy","clear","size","Promise","m","_remove","h","get","remove","refCount","item","then","f","AbortController","d","signal","C","abortController","set","add","delete","abort","overrideEvictDelay","ObjectResourceCache","test"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/graphics/ObjectResourceCache.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Handles.js\";import{timeoutHandle as t}from\"../../../../core/handleUtils.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{isAborted as o,createAbortError as s,onAbort as i}from\"../../../../core/promiseUtils.js\";import{DefaultLoadingContext as a}from\"../../glTF/DefaultLoadingContext.js\";import{load as n}from\"../../glTF/loader.js\";import{load as l}from\"./wosrLoader.js\";class c{constructor(){this.gltfCache=new Map,this.wosrCache=new Map,this.evictHandles=new e}loadGLTF(e,t,r){const o=r?`gltfPBR:${e}`:`gltf:${e}`;return this._fromCache(this.gltfCache,o,(t=>n(new a(t.streamDataRequester),e,t,r)),t)}loadWOSR(e,t){const r=`wosr:${e}:${t.disableTextures}`;return this._fromCache(this.wosrCache,r,(t=>l(e,t)),t)}destroy(){this.evictHandles.destroy(),this.gltfCache.clear(),this.wosrCache.clear()}get size(){return this.wosrCache.size+this.gltfCache.size}_fromCache(e,t,a,n){return new Promise(((l,c)=>{if(o(n))return void c(s());const m=i(n,(()=>{this._remove(e,t),c(s())})),h=e.get(t);if(h)return this.evictHandles.remove(t),h.refCount++,void h.item.then(l,c);const f=new AbortController,d={...n,signal:f.signal},C={refCount:1,abortController:f,item:a(d).then((r=>(C.abortController=null,r.remove=()=>this._remove(e,t),r)))};e.set(t,C),C.item.then((e=>{r(m)&&m.remove(),l(e)}),(e=>{r(m)&&m.remove(),c(e)}))}))}_remove(e,o){const s=e.get(o);s&&(s.refCount--,0===s.refCount&&this.evictHandles.add(t((()=>{e.delete(o),r(s.abortController)&&s.abortController.abort()}),h),o))}}const m=1e4;let h=m;const f={overrideEvictDelay:e=>(h=e,{remove(){h=m}})};export{c as ObjectResourceCache,f as test};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}