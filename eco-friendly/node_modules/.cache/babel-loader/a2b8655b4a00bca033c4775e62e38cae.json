{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { smoothstep as t, clamp as s } from \"../../../../core/mathUtils.js\";\nimport { isNone as e, disposeMaybe as i, releaseMaybe as a } from \"../../../../core/maybe.js\";\nimport { n as r, s as h, e as o } from \"../../../../chunks/vec3.js\";\nimport { c } from \"../../../../chunks/vec3f64.js\";\nimport { ViewingMode as n } from \"../../../ViewingMode.js\";\nimport { ReadShadowMapBindParameters as m } from \"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { createQuadVAO as p } from \"./glUtil3D.js\";\nimport { ShadowHighlightPassParameters as _, ShadowHighlightTechnique as d } from \"../shaders/ShadowHighlightTechnique.js\";\nimport { vertexCount as u } from \"../../../webgl/Util.js\";\nconst l = .001953125,\n      g = 4e4,\n      w = 5e4;\n\nclass v {\n  constructor(t, s) {\n    this._rctx = t, this._viewingMode = s, this._maxOpacity = 1, this._passParameters = new _(), this._drawParameters = new m(), this._vao = p(this._rctx);\n  }\n\n  get technique() {\n    return e(this._technique) && (this._technique = new d({\n      rctx: this._rctx,\n      viewingMode: this._viewingMode\n    })), this._technique;\n  }\n\n  render(t, s) {\n    if (!t.shadowMap.enabled || !t.linearDepthTexture || !this.isVisible) return;\n    const e = this.technique;\n    this._drawParameters.origin = t.camera.center, this._rctx.bindFramebuffer(s), this._rctx.bindTechnique(e, this._passParameters, t).bindDraw(this._drawParameters, t), this._rctx.bindVAO(this._vao), this._rctx.drawArrays(e.primitiveType, 0, u(this._vao, \"geometry\"));\n  }\n\n  get gpuMemoryUsage() {\n    return this._vao?.size ?? 0;\n  }\n\n  setDefaultOptions(t) {\n    this._passParameters = { ...this._passParameters,\n      ...t\n    }, this._updateMaxOpacity();\n  }\n\n  updateParameters(e, i) {\n    this._passParameters.opacityElevation = 1 - t(g, w, e.relativeElevation);\n    const a = this._viewingMode === n.Global ? r(y, e.center) : h(y, 0, 0, 1),\n          c = o(a, i);\n    this._passParameters.dayNightTerminator = t(0, 1, s(30 * c, 0, 1));\n  }\n\n  dispose() {\n    this._vao = i(this._vao), this._technique = a(this._technique);\n  }\n\n  get isVisible() {\n    const {\n      opacityElevation: t,\n      dayNightTerminator: s\n    } = this._passParameters;\n    return this._maxOpacity * t * s >= l;\n  }\n\n  _updateMaxOpacity() {\n    const t = Math.max(this._passParameters.shadowOpacity, this._passParameters.occludedShadowOpacity);\n    this._maxOpacity = t * this._passParameters.shadowColor[3];\n  }\n\n}\n\nconst y = c();\nexport { v as ShadowHighlight };","map":{"version":3,"names":["smoothstep","t","clamp","s","isNone","e","disposeMaybe","i","releaseMaybe","a","n","r","h","o","c","ViewingMode","ReadShadowMapBindParameters","m","createQuadVAO","p","ShadowHighlightPassParameters","_","ShadowHighlightTechnique","d","vertexCount","u","l","g","w","v","constructor","_rctx","_viewingMode","_maxOpacity","_passParameters","_drawParameters","_vao","technique","_technique","rctx","viewingMode","render","shadowMap","enabled","linearDepthTexture","isVisible","origin","camera","center","bindFramebuffer","bindTechnique","bindDraw","bindVAO","drawArrays","primitiveType","gpuMemoryUsage","size","setDefaultOptions","_updateMaxOpacity","updateParameters","opacityElevation","relativeElevation","Global","y","dayNightTerminator","dispose","Math","max","shadowOpacity","occludedShadowOpacity","shadowColor","ShadowHighlight"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/webgl-engine/lib/ShadowHighlight.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{smoothstep as t,clamp as s}from\"../../../../core/mathUtils.js\";import{isNone as e,disposeMaybe as i,releaseMaybe as a}from\"../../../../core/maybe.js\";import{n as r,s as h,e as o}from\"../../../../chunks/vec3.js\";import{c}from\"../../../../chunks/vec3f64.js\";import{ViewingMode as n}from\"../../../ViewingMode.js\";import{ReadShadowMapBindParameters as m}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{createQuadVAO as p}from\"./glUtil3D.js\";import{ShadowHighlightPassParameters as _,ShadowHighlightTechnique as d}from\"../shaders/ShadowHighlightTechnique.js\";import{vertexCount as u}from\"../../../webgl/Util.js\";const l=.001953125,g=4e4,w=5e4;class v{constructor(t,s){this._rctx=t,this._viewingMode=s,this._maxOpacity=1,this._passParameters=new _,this._drawParameters=new m,this._vao=p(this._rctx)}get technique(){return e(this._technique)&&(this._technique=new d({rctx:this._rctx,viewingMode:this._viewingMode})),this._technique}render(t,s){if(!t.shadowMap.enabled||!t.linearDepthTexture||!this.isVisible)return;const e=this.technique;this._drawParameters.origin=t.camera.center,this._rctx.bindFramebuffer(s),this._rctx.bindTechnique(e,this._passParameters,t).bindDraw(this._drawParameters,t),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(e.primitiveType,0,u(this._vao,\"geometry\"))}get gpuMemoryUsage(){return this._vao?.size??0}setDefaultOptions(t){this._passParameters={...this._passParameters,...t},this._updateMaxOpacity()}updateParameters(e,i){this._passParameters.opacityElevation=1-t(g,w,e.relativeElevation);const a=this._viewingMode===n.Global?r(y,e.center):h(y,0,0,1),c=o(a,i);this._passParameters.dayNightTerminator=t(0,1,s(30*c,0,1))}dispose(){this._vao=i(this._vao),this._technique=a(this._technique)}get isVisible(){const{opacityElevation:t,dayNightTerminator:s}=this._passParameters;return this._maxOpacity*t*s>=l}_updateMaxOpacity(){const t=Math.max(this._passParameters.shadowOpacity,this._passParameters.occludedShadowOpacity);this._maxOpacity=t*this._passParameters.shadowColor[3]}}const y=c();export{v as ShadowHighlight};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}