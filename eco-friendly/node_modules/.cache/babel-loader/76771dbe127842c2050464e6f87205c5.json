{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { neverReached as e } from \"../../../../core/compilerUtils.js\";\nimport { getOrCreateMapValue as t } from \"../../../../core/MapUtils.js\";\nimport { isDataProtocol as r, dataComponents as s, dataToArrayBuffer as n, makeAbsolute as o } from \"../../../../core/urlUtils.js\";\nimport { Version as a } from \"../../../../core/Version.js\";\nimport { z as i, m as u, j as c, e as p, h as f } from \"../../../../chunks/mat4.js\";\nimport { c as d, b as m } from \"../../../../chunks/mat4f64.js\";\nimport { g as l } from \"../../../../chunks/quat.js\";\nimport { a as h } from \"../../../../chunks/quatf64.js\";\nimport { BufferViewUint32 as y, BufferViewUint16 as b, BufferViewUint8 as T, BufferViewVec3f as O, BufferViewVec4f as w, BufferViewVec2f as N, BufferViewVec4u8 as x, BufferViewVec4u16 as S, BufferViewVec3u8 as C, BufferViewVec3u16 as _, BufferViewVec2u32 as U, BufferViewVec2u16 as I, BufferViewVec2i16 as g, BufferViewVec2u8 as A, BufferViewVec2i8 as E } from \"../../../../geometry/support/buffer/BufferView.js\";\nimport { m as L } from \"../../../../chunks/scalar.js\";\nimport { BinaryStreamReader as B } from \"./BinaryStreamReader.js\";\nimport { AttributeType as R } from \"./enums.js\";\nimport { material as D, textureSampler as G } from \"./fillDefaults.js\";\nimport { splitURI as v } from \"./pathUtils.js\";\nimport { DataType as j } from \"../../../webgl/enums.js\";\nconst M = {\n  MAGIC: 1179937895,\n  CHUNK_TYPE_JSON: 1313821514,\n  CHUNK_TYPE_BIN: 5130562,\n  MIN_HEADER_LENGTH: 20\n};\n\nclass F {\n  constructor(e, t, r, s, n) {\n    this.context = e, this.errorContext = t, this.uri = r, this.json = s, this.glbBuffer = n, this.bufferLoaders = new Map(), this.textureLoaders = new Map(), this.textureCache = new Map(), this.materialCache = new Map(), this.nodeParentMap = new Map(), this.nodeTransformCache = new Map(), this.baseUri = v(this.uri).dirPart, this._checkVersionSupported(), this._checkRequiredExtensionsSupported(), t.errorUnsupportedIf(null == s.scenes, \"Scenes must be defined.\"), t.errorUnsupportedIf(null == s.meshes, \"Meshes must be defined\"), t.errorUnsupportedIf(null == s.nodes, \"Nodes must be defined.\"), this._computeNodeParents();\n  }\n\n  static async load(e, t, o, a) {\n    if (r(o)) {\n      const r = s(o);\n      if (\"model/gltf-binary\" !== r.mediaType) try {\n        const s = JSON.parse(r.isBase64 ? atob(r.data) : r.data);\n        return new F(e, t, o, s);\n      } catch {}\n      const a = n(o);\n      if (F._isGLBData(a)) return this._fromGLBData(e, t, o, a);\n    }\n\n    if (o.endsWith(\".gltf\")) {\n      const r = await e.loadJSON(o, a);\n      return new F(e, t, o, r);\n    }\n\n    const i = await e.loadBinary(o, a);\n    if (F._isGLBData(i)) return this._fromGLBData(e, t, o, i);\n    const u = await e.loadJSON(o, a);\n    return new F(e, t, o, u);\n  }\n\n  static _isGLBData(e) {\n    const t = new B(e);\n    return t.remainingBytes() >= 4 && t.readUint32() === M.MAGIC;\n  }\n\n  static async _fromGLBData(e, t, r, s) {\n    const n = await F._parseGLBData(t, s);\n    return new F(e, t, r, n.json, n.binaryData);\n  }\n\n  static async _parseGLBData(e, t) {\n    const r = new B(t);\n    e.assert(r.remainingBytes() >= 12, \"GLB binary data is insufficiently large.\");\n    const s = r.readUint32(),\n          n = r.readUint32(),\n          o = r.readUint32();\n    e.assert(s === M.MAGIC, \"Magic first 4 bytes do not fit to expected GLB value.\"), e.assert(t.byteLength >= o, \"GLB binary data is smaller than header specifies.\"), e.errorUnsupportedIf(2 !== n, \"An unsupported GLB container version was detected. Only version 2 is supported.\");\n    let a,\n        i,\n        u = 0;\n\n    for (; r.remainingBytes() >= 8;) {\n      const t = r.readUint32(),\n            s = r.readUint32();\n      0 === u ? (e.assert(s === M.CHUNK_TYPE_JSON, \"First GLB chunk must be JSON.\"), e.assert(t >= 0, \"No JSON data found.\"), a = await q(r.readUint8Array(t))) : 1 === u ? (e.errorUnsupportedIf(s !== M.CHUNK_TYPE_BIN, \"Second GLB chunk expected to be BIN.\"), i = r.readUint8Array(t)) : e.warnUnsupported(\"More than 2 GLB chunks detected. Skipping.\"), u += 1;\n    }\n\n    return a || e.error(\"No GLB JSON chunk detected.\"), {\n      json: a,\n      binaryData: i\n    };\n  }\n\n  async getBuffer(e, t) {\n    const r = this.json.buffers[e],\n          s = this.errorContext;\n    if (null == r.uri) return s.assert(null != this.glbBuffer, \"GLB buffer not present\"), this.glbBuffer;\n    const n = await this._getBufferLoader(e, t);\n    return s.assert(n.byteLength === r.byteLength, \"Buffer byte lengths should match.\"), n;\n  }\n\n  async _getBufferLoader(e, t) {\n    const r = this.bufferLoaders.get(e);\n    if (r) return r;\n    const s = this.json.buffers[e],\n          n = this.context.loadBinary(this._resolveUri(s.uri), t).then(e => new Uint8Array(e));\n    return this.bufferLoaders.set(e, n), n;\n  }\n\n  async getAccessor(e, t) {\n    const r = this.errorContext;\n    r.errorUnsupportedIf(!this.json.accessors, \"Accessors missing.\");\n    const s = this.json.accessors[e];\n    r.errorUnsupportedIf(null == s?.bufferView, \"Some accessor does not specify a bufferView.\"), r.errorUnsupportedIf(s.type in [R.MAT2, R.MAT3, R.MAT4], `AttributeType ${s.type} is not supported`);\n    const n = this.json.bufferViews[s.bufferView],\n          o = await this.getBuffer(n.buffer, t),\n          a = H[s.type],\n          i = Y[s.componentType],\n          u = a * i,\n          c = n.byteStride || u;\n    return {\n      raw: o.buffer,\n      byteStride: c,\n      byteOffset: o.byteOffset + (n.byteOffset || 0) + (s.byteOffset || 0),\n      entryCount: s.count,\n      isDenselyPacked: c === u,\n      componentCount: a,\n      componentByteSize: i,\n      componentType: s.componentType,\n      min: s.min,\n      max: s.max,\n      normalized: !!s.normalized\n    };\n  }\n\n  async getIndexData(e, t) {\n    if (null == e.indices) return null;\n    const r = await this.getAccessor(e.indices, t);\n    if (r.isDenselyPacked) switch (r.componentType) {\n      case j.UNSIGNED_BYTE:\n        return new Uint8Array(r.raw, r.byteOffset, r.entryCount);\n\n      case j.UNSIGNED_SHORT:\n        return new Uint16Array(r.raw, r.byteOffset, r.entryCount);\n\n      case j.UNSIGNED_INT:\n        return new Uint32Array(r.raw, r.byteOffset, r.entryCount);\n    } else switch (r.componentType) {\n      case j.UNSIGNED_BYTE:\n        return L(this._wrapAccessor(T, r));\n\n      case j.UNSIGNED_SHORT:\n        return L(this._wrapAccessor(b, r));\n\n      case j.UNSIGNED_INT:\n        return L(this._wrapAccessor(y, r));\n    }\n  }\n\n  async getPositionData(e, t) {\n    const r = this.errorContext;\n    r.errorUnsupportedIf(null == e.attributes.POSITION, \"No POSITION vertex data found.\");\n    const s = await this.getAccessor(e.attributes.POSITION, t);\n    return r.errorUnsupportedIf(s.componentType !== j.FLOAT, \"Expected type FLOAT for POSITION vertex attribute, but found \" + X[s.componentType]), r.errorUnsupportedIf(3 !== s.componentCount, \"POSITION vertex attribute must have 3 components, but found \" + s.componentCount.toFixed()), this._wrapAccessor(O, s);\n  }\n\n  async getNormalData(e, t) {\n    const r = this.errorContext;\n    r.assert(null != e.attributes.NORMAL, \"No NORMAL vertex data found.\");\n    const s = await this.getAccessor(e.attributes.NORMAL, t);\n    return r.errorUnsupportedIf(s.componentType !== j.FLOAT, \"Expected type FLOAT for NORMAL vertex attribute, but found \" + X[s.componentType]), r.errorUnsupportedIf(3 !== s.componentCount, \"NORMAL vertex attribute must have 3 components, but found \" + s.componentCount.toFixed()), this._wrapAccessor(O, s);\n  }\n\n  async getTangentData(e, t) {\n    const r = this.errorContext;\n    r.assert(null != e.attributes.TANGENT, \"No TANGENT vertex data found.\");\n    const s = await this.getAccessor(e.attributes.TANGENT, t);\n    return r.errorUnsupportedIf(s.componentType !== j.FLOAT, \"Expected type FLOAT for TANGENT vertex attribute, but found \" + X[s.componentType]), r.errorUnsupportedIf(4 !== s.componentCount, \"TANGENT vertex attribute must have 4 components, but found \" + s.componentCount.toFixed()), new w(s.raw, s.byteOffset, s.byteStride, s.byteOffset + s.byteStride * s.entryCount);\n  }\n\n  async getTextureCoordinates(e, t) {\n    const r = this.errorContext;\n    r.assert(null != e.attributes.TEXCOORD_0, \"No TEXCOORD_0 vertex data found.\");\n    const s = await this.getAccessor(e.attributes.TEXCOORD_0, t);\n    return r.errorUnsupportedIf(2 !== s.componentCount, \"TEXCOORD_0 vertex attribute must have 2 components, but found \" + s.componentCount.toFixed()), s.componentType === j.FLOAT ? this._wrapAccessor(N, s) : (r.errorUnsupportedIf(!s.normalized, \"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\"), J(s));\n  }\n\n  async getVertexColors(e, t) {\n    const r = this.errorContext;\n    r.assert(null != e.attributes.COLOR_0, \"No COLOR_0 vertex data found.\");\n    const s = await this.getAccessor(e.attributes.COLOR_0, t);\n\n    if (r.errorUnsupportedIf(4 !== s.componentCount && 3 !== s.componentCount, \"COLOR_0 attribute must have 3 or 4 components, but found \" + s.componentCount.toFixed()), 4 === s.componentCount) {\n      if (s.componentType === j.FLOAT) return this._wrapAccessor(w, s);\n      if (s.componentType === j.UNSIGNED_BYTE) return this._wrapAccessor(x, s);\n      if (s.componentType === j.UNSIGNED_SHORT) return this._wrapAccessor(S, s);\n    } else if (3 === s.componentCount) {\n      if (s.componentType === j.FLOAT) return this._wrapAccessor(O, s);\n      if (s.componentType === j.UNSIGNED_BYTE) return this._wrapAccessor(C, s);\n      if (s.componentType === j.UNSIGNED_SHORT) return this._wrapAccessor(_, s);\n    }\n\n    r.errorUnsupported(\"Unsupported component type for COLOR_0 attribute: \" + X[s.componentType]);\n  }\n\n  hasPositions(e) {\n    return void 0 !== e.attributes.POSITION;\n  }\n\n  hasNormals(e) {\n    return void 0 !== e.attributes.NORMAL;\n  }\n\n  hasVertexColors(e) {\n    return void 0 !== e.attributes.COLOR_0;\n  }\n\n  hasTextureCoordinates(e) {\n    return void 0 !== e.attributes.TEXCOORD_0;\n  }\n\n  hasTangents(e) {\n    return void 0 !== e.attributes.TANGENT;\n  }\n\n  async getMaterial(e, t, r) {\n    let s = this.materialCache.get(e.material);\n\n    if (!s) {\n      const n = null != e.material ? D(this.json.materials[e.material]) : D(),\n            o = n.pbrMetallicRoughness,\n            a = this.hasVertexColors(e),\n            i = this.getTexture(o.baseColorTexture, t),\n            u = this.getTexture(n.normalTexture, t),\n            c = r ? this.getTexture(n.occlusionTexture, t) : null,\n            p = r ? this.getTexture(n.emissiveTexture, t) : null,\n            f = r ? this.getTexture(o.metallicRoughnessTexture, t) : null,\n            d = null != e.material ? e.material : -1;\n      s = {\n        alphaMode: n.alphaMode,\n        alphaCutoff: n.alphaCutoff,\n        color: o.baseColorFactor,\n        doubleSided: !!n.doubleSided,\n        colorTexture: await i,\n        normalTexture: await u,\n        name: n.name,\n        id: d,\n        occlusionTexture: await c,\n        emissiveTexture: await p,\n        emissiveFactor: n.emissiveFactor,\n        metallicFactor: o.metallicFactor,\n        roughnessFactor: o.roughnessFactor,\n        metallicRoughnessTexture: await f,\n        hasVertexColors: a,\n        ESRI_externalColorMixMode: n.extras.ESRI_externalColorMixMode\n      };\n    }\n\n    return s;\n  }\n\n  async getTexture(e, r) {\n    if (!e) return null;\n    this.errorContext.errorUnsupportedIf(0 !== (e.texCoord || 0), \"Only TEXCOORD with index 0 is supported.\");\n    const s = e.index,\n          n = this.errorContext,\n          o = this.json.textures[s],\n          a = G(null != o.sampler ? this.json.samplers[o.sampler] : {});\n    n.errorUnsupportedIf(null == o.source, \"Source is expected to be defined for a texture.\");\n    const i = this.json.images[o.source],\n          u = await this._loadTextureImageData(s, o, r);\n    return t(this.textureCache, s, () => {\n      const e = e => 33071 === e || 33648 === e || 10497 === e,\n            t = e => (n.error(`Unexpected TextureSampler WrapMode: ${e}. Using default REPEAT(10497).`), 10497);\n\n      return {\n        data: u,\n        wrapS: e(a.wrapS) ? a.wrapS : t(a.wrapS),\n        wrapT: e(a.wrapT) ? a.wrapT : t(a.wrapT),\n        minFilter: a.minFilter,\n        name: i.name,\n        id: s\n      };\n    });\n  }\n\n  getNodeTransform(e) {\n    if (void 0 === e) return V;\n    let t = this.nodeTransformCache.get(e);\n\n    if (!t) {\n      const r = this.getNodeTransform(this._getNodeParent(e)),\n            s = this.json.nodes[e];\n      s.matrix ? t = u(d(), r, s.matrix) : s.translation || s.rotation || s.scale ? (t = m(r), s.translation && c(t, t, s.translation), s.rotation && (k[3] = l(k, s.rotation), p(t, t, k[3], k)), s.scale && f(t, t, s.scale)) : t = r, this.nodeTransformCache.set(e, t);\n    }\n\n    return t;\n  }\n\n  _wrapAccessor(e, t) {\n    return new e(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * (t.entryCount - 1) + t.componentByteSize * t.componentCount);\n  }\n\n  _resolveUri(e) {\n    return o(e, this.baseUri);\n  }\n\n  _getNodeParent(e) {\n    return this.nodeParentMap.get(e);\n  }\n\n  _checkVersionSupported() {\n    const e = a.parse(this.json.asset.version, \"glTF\");\n    P.validate(e);\n  }\n\n  _checkRequiredExtensionsSupported() {\n    const e = this.json,\n          t = this.errorContext;\n    e.extensionsRequired && 0 !== e.extensionsRequired.length && t.errorUnsupported(\"gltf loader was not able to load unsupported feature. Required extensions: \" + e.extensionsRequired.join(\", \"));\n  }\n\n  _computeNodeParents() {\n    this.json.nodes.forEach((e, t) => {\n      e.children && e.children.forEach(e => {\n        this.nodeParentMap.set(e, t);\n      });\n    });\n  }\n\n  async _loadTextureImageData(e, t, r) {\n    const s = this.textureLoaders.get(e);\n    if (s) return s;\n\n    const n = this._createTextureLoader(t, r);\n\n    return this.textureLoaders.set(e, n), n;\n  }\n\n  async _createTextureLoader(e, t) {\n    const r = this.json.images[e.source];\n    if (r.uri) return this.context.loadImage(this._resolveUri(r.uri), t);\n    const s = this.errorContext;\n    s.errorUnsupportedIf(null == r.bufferView, \"Image bufferView must be defined.\"), s.errorUnsupportedIf(null == r.mimeType, \"Image mimeType must be defined.\");\n    const n = this.json.bufferViews[r.bufferView],\n          o = await this.getBuffer(n.buffer, t);\n    return s.errorUnsupportedIf(null != n.byteStride, \"byteStride not supported for image buffer\"), z(new Uint8Array(o.buffer, o.byteOffset + (n.byteOffset || 0), n.byteLength), r.mimeType);\n  }\n\n}\n\nconst P = new a(2, 0, \"glTF\"),\n      V = i(d(), Math.PI / 2),\n      k = h(),\n      H = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4\n},\n      Y = {\n  [j.BYTE]: 1,\n  [j.UNSIGNED_BYTE]: 1,\n  [j.SHORT]: 2,\n  [j.UNSIGNED_SHORT]: 2,\n  [j.FLOAT]: 4,\n  [j.UNSIGNED_INT]: 4\n};\n\nfunction J(t) {\n  switch (t.componentType) {\n    case j.BYTE:\n      return new E(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * t.entryCount);\n\n    case j.UNSIGNED_BYTE:\n      return new A(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * t.entryCount);\n\n    case j.SHORT:\n      return new g(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * t.entryCount);\n\n    case j.UNSIGNED_SHORT:\n      return new I(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * t.entryCount);\n\n    case j.UNSIGNED_INT:\n      return new U(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * t.entryCount);\n\n    case j.FLOAT:\n      return new N(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * t.entryCount);\n\n    default:\n      return void e(t.componentType);\n  }\n}\n\nasync function q(e) {\n  return new Promise((t, r) => {\n    const s = new Blob([e]),\n          n = new FileReader();\n    n.onload = () => {\n      const e = n.result;\n      t(JSON.parse(e));\n    }, n.onerror = e => {\n      r(e);\n    }, n.readAsText(s);\n  });\n}\n\nasync function z(e, t) {\n  return new Promise((r, s) => {\n    const n = new Blob([e], {\n      type: t\n    }),\n          o = URL.createObjectURL(n),\n          a = new Image();\n    a.addEventListener(\"load\", () => {\n      URL.revokeObjectURL(o), \"decode\" in a ? a.decode().then(() => r(a), () => r(a)) : r(a);\n    }), a.addEventListener(\"error\", e => {\n      URL.revokeObjectURL(o), s(e);\n    }), a.src = o;\n  });\n}\n\nconst X = {\n  5120: \"BYTE\",\n  5121: \"UNSIGNED_BYTE\",\n  5122: \"SHORT\",\n  5123: \"UNSIGNED_SHORT\",\n  5125: \"UNSIGNED_INT\",\n  5126: \"FLOAT\"\n};\nexport { F as Resource };","map":{"version":3,"names":["neverReached","e","getOrCreateMapValue","t","isDataProtocol","r","dataComponents","s","dataToArrayBuffer","n","makeAbsolute","o","Version","a","z","i","m","u","j","c","p","h","f","d","b","g","l","BufferViewUint32","y","BufferViewUint16","BufferViewUint8","T","BufferViewVec3f","O","BufferViewVec4f","w","BufferViewVec2f","N","BufferViewVec4u8","x","BufferViewVec4u16","S","BufferViewVec3u8","C","BufferViewVec3u16","_","BufferViewVec2u32","U","BufferViewVec2u16","I","BufferViewVec2i16","BufferViewVec2u8","A","BufferViewVec2i8","E","L","BinaryStreamReader","B","AttributeType","R","material","D","textureSampler","G","splitURI","v","DataType","M","MAGIC","CHUNK_TYPE_JSON","CHUNK_TYPE_BIN","MIN_HEADER_LENGTH","F","constructor","context","errorContext","uri","json","glbBuffer","bufferLoaders","Map","textureLoaders","textureCache","materialCache","nodeParentMap","nodeTransformCache","baseUri","dirPart","_checkVersionSupported","_checkRequiredExtensionsSupported","errorUnsupportedIf","scenes","meshes","nodes","_computeNodeParents","load","mediaType","JSON","parse","isBase64","atob","data","_isGLBData","_fromGLBData","endsWith","loadJSON","loadBinary","remainingBytes","readUint32","_parseGLBData","binaryData","assert","byteLength","q","readUint8Array","warnUnsupported","error","getBuffer","buffers","_getBufferLoader","get","_resolveUri","then","Uint8Array","set","getAccessor","accessors","bufferView","type","MAT2","MAT3","MAT4","bufferViews","buffer","H","Y","componentType","byteStride","raw","byteOffset","entryCount","count","isDenselyPacked","componentCount","componentByteSize","min","max","normalized","getIndexData","indices","UNSIGNED_BYTE","UNSIGNED_SHORT","Uint16Array","UNSIGNED_INT","Uint32Array","_wrapAccessor","getPositionData","attributes","POSITION","FLOAT","X","toFixed","getNormalData","NORMAL","getTangentData","TANGENT","getTextureCoordinates","TEXCOORD_0","J","getVertexColors","COLOR_0","errorUnsupported","hasPositions","hasNormals","hasVertexColors","hasTextureCoordinates","hasTangents","getMaterial","materials","pbrMetallicRoughness","getTexture","baseColorTexture","normalTexture","occlusionTexture","emissiveTexture","metallicRoughnessTexture","alphaMode","alphaCutoff","color","baseColorFactor","doubleSided","colorTexture","name","id","emissiveFactor","metallicFactor","roughnessFactor","ESRI_externalColorMixMode","extras","texCoord","index","textures","sampler","samplers","source","images","_loadTextureImageData","wrapS","wrapT","minFilter","getNodeTransform","V","_getNodeParent","matrix","translation","rotation","scale","k","asset","version","P","validate","extensionsRequired","length","join","forEach","children","_createTextureLoader","loadImage","mimeType","Math","PI","SCALAR","VEC2","VEC3","VEC4","BYTE","SHORT","Promise","Blob","FileReader","onload","result","onerror","readAsText","URL","createObjectURL","Image","addEventListener","revokeObjectURL","decode","src","Resource"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/glTF/internal/Resource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{neverReached as e}from\"../../../../core/compilerUtils.js\";import{getOrCreateMapValue as t}from\"../../../../core/MapUtils.js\";import{isDataProtocol as r,dataComponents as s,dataToArrayBuffer as n,makeAbsolute as o}from\"../../../../core/urlUtils.js\";import{Version as a}from\"../../../../core/Version.js\";import{z as i,m as u,j as c,e as p,h as f}from\"../../../../chunks/mat4.js\";import{c as d,b as m}from\"../../../../chunks/mat4f64.js\";import{g as l}from\"../../../../chunks/quat.js\";import{a as h}from\"../../../../chunks/quatf64.js\";import{BufferViewUint32 as y,BufferViewUint16 as b,BufferViewUint8 as T,BufferViewVec3f as O,BufferViewVec4f as w,BufferViewVec2f as N,BufferViewVec4u8 as x,BufferViewVec4u16 as S,BufferViewVec3u8 as C,BufferViewVec3u16 as _,BufferViewVec2u32 as U,BufferViewVec2u16 as I,BufferViewVec2i16 as g,BufferViewVec2u8 as A,BufferViewVec2i8 as E}from\"../../../../geometry/support/buffer/BufferView.js\";import{m as L}from\"../../../../chunks/scalar.js\";import{BinaryStreamReader as B}from\"./BinaryStreamReader.js\";import{AttributeType as R}from\"./enums.js\";import{material as D,textureSampler as G}from\"./fillDefaults.js\";import{splitURI as v}from\"./pathUtils.js\";import{DataType as j}from\"../../../webgl/enums.js\";const M={MAGIC:1179937895,CHUNK_TYPE_JSON:1313821514,CHUNK_TYPE_BIN:5130562,MIN_HEADER_LENGTH:20};class F{constructor(e,t,r,s,n){this.context=e,this.errorContext=t,this.uri=r,this.json=s,this.glbBuffer=n,this.bufferLoaders=new Map,this.textureLoaders=new Map,this.textureCache=new Map,this.materialCache=new Map,this.nodeParentMap=new Map,this.nodeTransformCache=new Map,this.baseUri=v(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),t.errorUnsupportedIf(null==s.scenes,\"Scenes must be defined.\"),t.errorUnsupportedIf(null==s.meshes,\"Meshes must be defined\"),t.errorUnsupportedIf(null==s.nodes,\"Nodes must be defined.\"),this._computeNodeParents()}static async load(e,t,o,a){if(r(o)){const r=s(o);if(\"model/gltf-binary\"!==r.mediaType)try{const s=JSON.parse(r.isBase64?atob(r.data):r.data);return new F(e,t,o,s)}catch{}const a=n(o);if(F._isGLBData(a))return this._fromGLBData(e,t,o,a)}if(o.endsWith(\".gltf\")){const r=await e.loadJSON(o,a);return new F(e,t,o,r)}const i=await e.loadBinary(o,a);if(F._isGLBData(i))return this._fromGLBData(e,t,o,i);const u=await e.loadJSON(o,a);return new F(e,t,o,u)}static _isGLBData(e){const t=new B(e);return t.remainingBytes()>=4&&t.readUint32()===M.MAGIC}static async _fromGLBData(e,t,r,s){const n=await F._parseGLBData(t,s);return new F(e,t,r,n.json,n.binaryData)}static async _parseGLBData(e,t){const r=new B(t);e.assert(r.remainingBytes()>=12,\"GLB binary data is insufficiently large.\");const s=r.readUint32(),n=r.readUint32(),o=r.readUint32();e.assert(s===M.MAGIC,\"Magic first 4 bytes do not fit to expected GLB value.\"),e.assert(t.byteLength>=o,\"GLB binary data is smaller than header specifies.\"),e.errorUnsupportedIf(2!==n,\"An unsupported GLB container version was detected. Only version 2 is supported.\");let a,i,u=0;for(;r.remainingBytes()>=8;){const t=r.readUint32(),s=r.readUint32();0===u?(e.assert(s===M.CHUNK_TYPE_JSON,\"First GLB chunk must be JSON.\"),e.assert(t>=0,\"No JSON data found.\"),a=await q(r.readUint8Array(t))):1===u?(e.errorUnsupportedIf(s!==M.CHUNK_TYPE_BIN,\"Second GLB chunk expected to be BIN.\"),i=r.readUint8Array(t)):e.warnUnsupported(\"More than 2 GLB chunks detected. Skipping.\"),u+=1}return a||e.error(\"No GLB JSON chunk detected.\"),{json:a,binaryData:i}}async getBuffer(e,t){const r=this.json.buffers[e],s=this.errorContext;if(null==r.uri)return s.assert(null!=this.glbBuffer,\"GLB buffer not present\"),this.glbBuffer;const n=await this._getBufferLoader(e,t);return s.assert(n.byteLength===r.byteLength,\"Buffer byte lengths should match.\"),n}async _getBufferLoader(e,t){const r=this.bufferLoaders.get(e);if(r)return r;const s=this.json.buffers[e],n=this.context.loadBinary(this._resolveUri(s.uri),t).then((e=>new Uint8Array(e)));return this.bufferLoaders.set(e,n),n}async getAccessor(e,t){const r=this.errorContext;r.errorUnsupportedIf(!this.json.accessors,\"Accessors missing.\");const s=this.json.accessors[e];r.errorUnsupportedIf(null==s?.bufferView,\"Some accessor does not specify a bufferView.\"),r.errorUnsupportedIf(s.type in[R.MAT2,R.MAT3,R.MAT4],`AttributeType ${s.type} is not supported`);const n=this.json.bufferViews[s.bufferView],o=await this.getBuffer(n.buffer,t),a=H[s.type],i=Y[s.componentType],u=a*i,c=n.byteStride||u;return{raw:o.buffer,byteStride:c,byteOffset:o.byteOffset+(n.byteOffset||0)+(s.byteOffset||0),entryCount:s.count,isDenselyPacked:c===u,componentCount:a,componentByteSize:i,componentType:s.componentType,min:s.min,max:s.max,normalized:!!s.normalized}}async getIndexData(e,t){if(null==e.indices)return null;const r=await this.getAccessor(e.indices,t);if(r.isDenselyPacked)switch(r.componentType){case j.UNSIGNED_BYTE:return new Uint8Array(r.raw,r.byteOffset,r.entryCount);case j.UNSIGNED_SHORT:return new Uint16Array(r.raw,r.byteOffset,r.entryCount);case j.UNSIGNED_INT:return new Uint32Array(r.raw,r.byteOffset,r.entryCount)}else switch(r.componentType){case j.UNSIGNED_BYTE:return L(this._wrapAccessor(T,r));case j.UNSIGNED_SHORT:return L(this._wrapAccessor(b,r));case j.UNSIGNED_INT:return L(this._wrapAccessor(y,r))}}async getPositionData(e,t){const r=this.errorContext;r.errorUnsupportedIf(null==e.attributes.POSITION,\"No POSITION vertex data found.\");const s=await this.getAccessor(e.attributes.POSITION,t);return r.errorUnsupportedIf(s.componentType!==j.FLOAT,\"Expected type FLOAT for POSITION vertex attribute, but found \"+X[s.componentType]),r.errorUnsupportedIf(3!==s.componentCount,\"POSITION vertex attribute must have 3 components, but found \"+s.componentCount.toFixed()),this._wrapAccessor(O,s)}async getNormalData(e,t){const r=this.errorContext;r.assert(null!=e.attributes.NORMAL,\"No NORMAL vertex data found.\");const s=await this.getAccessor(e.attributes.NORMAL,t);return r.errorUnsupportedIf(s.componentType!==j.FLOAT,\"Expected type FLOAT for NORMAL vertex attribute, but found \"+X[s.componentType]),r.errorUnsupportedIf(3!==s.componentCount,\"NORMAL vertex attribute must have 3 components, but found \"+s.componentCount.toFixed()),this._wrapAccessor(O,s)}async getTangentData(e,t){const r=this.errorContext;r.assert(null!=e.attributes.TANGENT,\"No TANGENT vertex data found.\");const s=await this.getAccessor(e.attributes.TANGENT,t);return r.errorUnsupportedIf(s.componentType!==j.FLOAT,\"Expected type FLOAT for TANGENT vertex attribute, but found \"+X[s.componentType]),r.errorUnsupportedIf(4!==s.componentCount,\"TANGENT vertex attribute must have 4 components, but found \"+s.componentCount.toFixed()),new w(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount)}async getTextureCoordinates(e,t){const r=this.errorContext;r.assert(null!=e.attributes.TEXCOORD_0,\"No TEXCOORD_0 vertex data found.\");const s=await this.getAccessor(e.attributes.TEXCOORD_0,t);return r.errorUnsupportedIf(2!==s.componentCount,\"TEXCOORD_0 vertex attribute must have 2 components, but found \"+s.componentCount.toFixed()),s.componentType===j.FLOAT?this._wrapAccessor(N,s):(r.errorUnsupportedIf(!s.normalized,\"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\"),J(s))}async getVertexColors(e,t){const r=this.errorContext;r.assert(null!=e.attributes.COLOR_0,\"No COLOR_0 vertex data found.\");const s=await this.getAccessor(e.attributes.COLOR_0,t);if(r.errorUnsupportedIf(4!==s.componentCount&&3!==s.componentCount,\"COLOR_0 attribute must have 3 or 4 components, but found \"+s.componentCount.toFixed()),4===s.componentCount){if(s.componentType===j.FLOAT)return this._wrapAccessor(w,s);if(s.componentType===j.UNSIGNED_BYTE)return this._wrapAccessor(x,s);if(s.componentType===j.UNSIGNED_SHORT)return this._wrapAccessor(S,s)}else if(3===s.componentCount){if(s.componentType===j.FLOAT)return this._wrapAccessor(O,s);if(s.componentType===j.UNSIGNED_BYTE)return this._wrapAccessor(C,s);if(s.componentType===j.UNSIGNED_SHORT)return this._wrapAccessor(_,s)}r.errorUnsupported(\"Unsupported component type for COLOR_0 attribute: \"+X[s.componentType])}hasPositions(e){return void 0!==e.attributes.POSITION}hasNormals(e){return void 0!==e.attributes.NORMAL}hasVertexColors(e){return void 0!==e.attributes.COLOR_0}hasTextureCoordinates(e){return void 0!==e.attributes.TEXCOORD_0}hasTangents(e){return void 0!==e.attributes.TANGENT}async getMaterial(e,t,r){let s=this.materialCache.get(e.material);if(!s){const n=null!=e.material?D(this.json.materials[e.material]):D(),o=n.pbrMetallicRoughness,a=this.hasVertexColors(e),i=this.getTexture(o.baseColorTexture,t),u=this.getTexture(n.normalTexture,t),c=r?this.getTexture(n.occlusionTexture,t):null,p=r?this.getTexture(n.emissiveTexture,t):null,f=r?this.getTexture(o.metallicRoughnessTexture,t):null,d=null!=e.material?e.material:-1;s={alphaMode:n.alphaMode,alphaCutoff:n.alphaCutoff,color:o.baseColorFactor,doubleSided:!!n.doubleSided,colorTexture:await i,normalTexture:await u,name:n.name,id:d,occlusionTexture:await c,emissiveTexture:await p,emissiveFactor:n.emissiveFactor,metallicFactor:o.metallicFactor,roughnessFactor:o.roughnessFactor,metallicRoughnessTexture:await f,hasVertexColors:a,ESRI_externalColorMixMode:n.extras.ESRI_externalColorMixMode}}return s}async getTexture(e,r){if(!e)return null;this.errorContext.errorUnsupportedIf(0!==(e.texCoord||0),\"Only TEXCOORD with index 0 is supported.\");const s=e.index,n=this.errorContext,o=this.json.textures[s],a=G(null!=o.sampler?this.json.samplers[o.sampler]:{});n.errorUnsupportedIf(null==o.source,\"Source is expected to be defined for a texture.\");const i=this.json.images[o.source],u=await this._loadTextureImageData(s,o,r);return t(this.textureCache,s,(()=>{const e=e=>33071===e||33648===e||10497===e,t=e=>(n.error(`Unexpected TextureSampler WrapMode: ${e}. Using default REPEAT(10497).`),10497);return{data:u,wrapS:e(a.wrapS)?a.wrapS:t(a.wrapS),wrapT:e(a.wrapT)?a.wrapT:t(a.wrapT),minFilter:a.minFilter,name:i.name,id:s}}))}getNodeTransform(e){if(void 0===e)return V;let t=this.nodeTransformCache.get(e);if(!t){const r=this.getNodeTransform(this._getNodeParent(e)),s=this.json.nodes[e];s.matrix?t=u(d(),r,s.matrix):s.translation||s.rotation||s.scale?(t=m(r),s.translation&&c(t,t,s.translation),s.rotation&&(k[3]=l(k,s.rotation),p(t,t,k[3],k)),s.scale&&f(t,t,s.scale)):t=r,this.nodeTransformCache.set(e,t)}return t}_wrapAccessor(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}_resolveUri(e){return o(e,this.baseUri)}_getNodeParent(e){return this.nodeParentMap.get(e)}_checkVersionSupported(){const e=a.parse(this.json.asset.version,\"glTF\");P.validate(e)}_checkRequiredExtensionsSupported(){const e=this.json,t=this.errorContext;e.extensionsRequired&&0!==e.extensionsRequired.length&&t.errorUnsupported(\"gltf loader was not able to load unsupported feature. Required extensions: \"+e.extensionsRequired.join(\", \"))}_computeNodeParents(){this.json.nodes.forEach(((e,t)=>{e.children&&e.children.forEach((e=>{this.nodeParentMap.set(e,t)}))}))}async _loadTextureImageData(e,t,r){const s=this.textureLoaders.get(e);if(s)return s;const n=this._createTextureLoader(t,r);return this.textureLoaders.set(e,n),n}async _createTextureLoader(e,t){const r=this.json.images[e.source];if(r.uri)return this.context.loadImage(this._resolveUri(r.uri),t);const s=this.errorContext;s.errorUnsupportedIf(null==r.bufferView,\"Image bufferView must be defined.\"),s.errorUnsupportedIf(null==r.mimeType,\"Image mimeType must be defined.\");const n=this.json.bufferViews[r.bufferView],o=await this.getBuffer(n.buffer,t);return s.errorUnsupportedIf(null!=n.byteStride,\"byteStride not supported for image buffer\"),z(new Uint8Array(o.buffer,o.byteOffset+(n.byteOffset||0),n.byteLength),r.mimeType)}}const P=new a(2,0,\"glTF\"),V=i(d(),Math.PI/2),k=h(),H={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},Y={[j.BYTE]:1,[j.UNSIGNED_BYTE]:1,[j.SHORT]:2,[j.UNSIGNED_SHORT]:2,[j.FLOAT]:4,[j.UNSIGNED_INT]:4};function J(t){switch(t.componentType){case j.BYTE:return new E(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case j.UNSIGNED_BYTE:return new A(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case j.SHORT:return new g(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case j.UNSIGNED_SHORT:return new I(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case j.UNSIGNED_INT:return new U(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case j.FLOAT:return new N(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);default:return void e(t.componentType)}}async function q(e){return new Promise(((t,r)=>{const s=new Blob([e]),n=new FileReader;n.onload=()=>{const e=n.result;t(JSON.parse(e))},n.onerror=e=>{r(e)},n.readAsText(s)}))}async function z(e,t){return new Promise(((r,s)=>{const n=new Blob([e],{type:t}),o=URL.createObjectURL(n),a=new Image;a.addEventListener(\"load\",(()=>{URL.revokeObjectURL(o),\"decode\"in a?a.decode().then((()=>r(a)),(()=>r(a))):r(a)})),a.addEventListener(\"error\",(e=>{URL.revokeObjectURL(o),s(e)})),a.src=o}))}const X={5120:\"BYTE\",5121:\"UNSIGNED_BYTE\",5122:\"SHORT\",5123:\"UNSIGNED_SHORT\",5125:\"UNSIGNED_INT\",5126:\"FLOAT\"};export{F as Resource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}