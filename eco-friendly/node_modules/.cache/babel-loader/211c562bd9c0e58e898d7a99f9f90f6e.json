{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../Graphic.js\";\nimport r from \"../../core/Error.js\";\nimport { unwrap as o, isNone as s, isSome as i } from \"../../core/maybe.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { subclass as n } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { combinedViewLayerTimeExtentProperty as l } from \"../../layers/support/commonProperties.js\";\nimport { getDefaultDatumTransformationForDataset as p, projectExtent as u } from \"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";\nimport { getFetchPopupTemplate as c } from \"./support/popupUtils.js\";\n\nconst f = f => {\n  let m = class extends f {\n    constructor() {\n      super(...arguments), this._rasterFieldPrefix = \"Raster.\", this.layer = null, this.view = null, this.tileInfo = null;\n    }\n\n    get fullExtent() {\n      return this._getfullExtent();\n    }\n\n    _getfullExtent() {\n      return this.projectFullExtent(this.view.spatialReference);\n    }\n\n    get hasTilingEffects() {\n      return this.layer.renderer && \"dynamicRangeAdjustment\" in this.layer.renderer && this.layer.renderer.dynamicRangeAdjustment;\n    }\n\n    get datumTransformation() {\n      return p(o(this.layer.fullExtent), this.view.spatialReference, !0);\n    }\n\n    supportsSpatialReference(e) {\n      return !!this.projectFullExtent(e);\n    }\n\n    projectFullExtent(e) {\n      const t = o(this.layer.fullExtent),\n            r = p(t, e, !1);\n      return u(t, e, r);\n    }\n\n    async fetchPopupFeatures(e, o) {\n      const {\n        layer: a\n      } = this;\n      if (!e) throw new r(\"imageryTileLayerView:fetchPopupFeatures\", \"Nothing to fetch without area\", {\n        layer: a\n      });\n      const {\n        popupEnabled: n\n      } = a,\n            l = c(a, o);\n      if (!n || s(l)) throw new r(\"imageryTileLayerView:fetchPopupFeatures\", \"Missing required popupTemplate or popupEnabled\", {\n        popupEnabled: n,\n        popupTemplate: l\n      });\n      const p = [],\n            {\n        value: u,\n        magdirValue: f\n      } = await a.identify(e, {\n        timeExtent: this.timeExtent\n      });\n      let m = \"\";\n\n      if (u && u.length) {\n        m = \"imagery-tile\" === a.type && a.hasStandardTime() && null != u[0] ? u.map(e => a.getStandardTimeValue(e)).join(\", \") : u.join(\", \");\n        const e = {\n          ObjectId: 0\n        };\n        e[\"Raster.ServicePixelValue\"] = m;\n        const r = a.rasterInfo.attributeTable;\n\n        if (i(r)) {\n          const {\n            fields: t,\n            features: o\n          } = r,\n                s = t.find(({\n            name: e\n          }) => \"value\" === e.toLowerCase()),\n                i = s ? o.find(e => String(e.attributes[s.name]) === m) : null;\n          if (i) for (const r in i.attributes) if (i.attributes.hasOwnProperty(r)) {\n            e[this._rasterFieldPrefix + r] = i.attributes[r];\n          }\n        }\n\n        const o = a.rasterInfo.dataType;\n        \"vector-magdir\" !== o && \"vector-uv\" !== o || (e[\"Raster.Magnitude\"] = f?.[0], e[\"Raster.Direction\"] = f?.[1]);\n        const s = new t(this.fullExtent.clone(), null, e);\n        s.layer = a, s.sourceLayer = s.layer, p.push(s);\n      }\n\n      return p;\n    }\n\n  };\n  return e([a()], m.prototype, \"layer\", void 0), e([a(l)], m.prototype, \"timeExtent\", void 0), e([a()], m.prototype, \"view\", void 0), e([a()], m.prototype, \"fullExtent\", null), e([a()], m.prototype, \"tileInfo\", void 0), e([a({\n    readOnly: !0\n  })], m.prototype, \"hasTilingEffects\", null), m = e([n(\"esri.views.layers.ImageryTileLayerView\")], m), m;\n};\n\nexport { f as default };","map":{"version":3,"names":["_","e","t","r","unwrap","o","isNone","s","isSome","i","property","a","subclass","n","combinedViewLayerTimeExtentProperty","l","getDefaultDatumTransformationForDataset","p","projectExtent","u","getFetchPopupTemplate","c","f","m","constructor","arguments","_rasterFieldPrefix","layer","view","tileInfo","fullExtent","_getfullExtent","projectFullExtent","spatialReference","hasTilingEffects","renderer","dynamicRangeAdjustment","datumTransformation","supportsSpatialReference","fetchPopupFeatures","popupEnabled","popupTemplate","value","magdirValue","identify","timeExtent","length","type","hasStandardTime","map","getStandardTimeValue","join","ObjectId","rasterInfo","attributeTable","fields","features","find","name","toLowerCase","String","attributes","hasOwnProperty","dataType","clone","sourceLayer","push","prototype","readOnly","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{unwrap as o,isNone as s,isSome as i}from\"../../core/maybe.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as l}from\"../../layers/support/commonProperties.js\";import{getDefaultDatumTransformationForDataset as p,projectExtent as u}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as c}from\"./support/popupUtils.js\";const f=f=>{let m=class extends f{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return p(o(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(e){return!!this.projectFullExtent(e)}projectFullExtent(e){const t=o(this.layer.fullExtent),r=p(t,e,!1);return u(t,e,r)}async fetchPopupFeatures(e,o){const{layer:a}=this;if(!e)throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a});const{popupEnabled:n}=a,l=c(a,o);if(!n||s(l))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:n,popupTemplate:l});const p=[],{value:u,magdirValue:f}=await a.identify(e,{timeExtent:this.timeExtent});let m=\"\";if(u&&u.length){m=\"imagery-tile\"===a.type&&a.hasStandardTime()&&null!=u[0]?u.map((e=>a.getStandardTimeValue(e))).join(\", \"):u.join(\", \");const e={ObjectId:0};e[\"Raster.ServicePixelValue\"]=m;const r=a.rasterInfo.attributeTable;if(i(r)){const{fields:t,features:o}=r,s=t.find((({name:e})=>\"value\"===e.toLowerCase())),i=s?o.find((e=>String(e.attributes[s.name])===m)):null;if(i)for(const r in i.attributes)if(i.attributes.hasOwnProperty(r)){e[this._rasterFieldPrefix+r]=i.attributes[r]}}const o=a.rasterInfo.dataType;\"vector-magdir\"!==o&&\"vector-uv\"!==o||(e[\"Raster.Magnitude\"]=f?.[0],e[\"Raster.Direction\"]=f?.[1]);const s=new t(this.fullExtent.clone(),null,e);s.layer=a,s.sourceLayer=s.layer,p.push(s)}return p}};return e([a()],m.prototype,\"layer\",void 0),e([a(l)],m.prototype,\"timeExtent\",void 0),e([a()],m.prototype,\"view\",void 0),e([a()],m.prototype,\"fullExtent\",null),e([a()],m.prototype,\"tileInfo\",void 0),e([a({readOnly:!0})],m.prototype,\"hasTilingEffects\",null),m=e([n(\"esri.views.layers.ImageryTileLayerView\")],m),m};export{f as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}