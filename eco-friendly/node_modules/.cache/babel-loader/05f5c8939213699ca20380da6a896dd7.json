{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../../../core/maybe.js\";\nimport { pt2px as t } from \"../../../../../../core/screenUtils.js\";\nimport { generateGradient as r } from \"../../../../../../renderers/support/heatmapUtils.js\";\nimport { Technique as a } from \"../Technique.js\";\nimport { DataType as i } from \"../../../../../webgl/enums.js\";\n\nclass n extends a {\n  static getStorageSpec({\n    field: e,\n    valueExpression: t\n  }) {\n    return {\n      visualVariables: !1,\n      attributes: e || t ? [{\n        field: e,\n        valueExpression: t\n      }] : null\n    };\n  }\n\n  static _createRendererSchema() {\n    return {\n      type: \"heatmap\",\n      radius: -1,\n      referenceScale: -1,\n      isFieldActive: 0,\n      minDensity: -1,\n      densityRange: -1,\n      kernel: null,\n      gradient: null,\n      gradientHash: \"invalid\"\n    };\n  }\n\n  static createOrUpdateRendererSchema(a, i) {\n    const {\n      radius: n,\n      minDensity: s,\n      maxDensity: o,\n      referenceScale: c,\n      field: l,\n      valueExpression: m,\n      colorStops: p\n    } = i,\n          d = o - s,\n          u = l || m ? 1 : 0,\n          y = p.map(({\n      color: e,\n      ratio: t\n    }) => `${t}:${e.toString()}`).join();\n    let h,\n        S = !0;\n    return e(a) && \"heatmap\" === a.type ? (h = a, S = y !== a.gradientHash) : h = this._createRendererSchema(), h.radius = t(n), h.minDensity = s, h.densityRange = d, h.referenceScale = c, h.isFieldActive = u, S && (h.gradient = r(p), h.gradientHash = y), h;\n  }\n\n}\n\nn.type = \"heatmap\", n.programSpec = {\n  shader: \"materials/icon/heatmapAccumulate\",\n  vertexLayout: {\n    geometry: [{\n      location: 0,\n      name: \"a_pos\",\n      count: 2,\n      type: i.SHORT\n    }, {\n      location: 1,\n      name: \"a_vertexOffset\",\n      count: 2,\n      type: i.SHORT\n    }, {\n      location: 4,\n      name: \"a_id\",\n      count: 4,\n      type: i.UNSIGNED_BYTE\n    }]\n  }\n};\nexport { n as HeatmapTechnique };","map":{"version":3,"names":["isSome","e","pt2px","t","generateGradient","r","Technique","a","DataType","i","n","getStorageSpec","field","valueExpression","visualVariables","attributes","_createRendererSchema","type","radius","referenceScale","isFieldActive","minDensity","densityRange","kernel","gradient","gradientHash","createOrUpdateRendererSchema","s","maxDensity","o","c","l","m","colorStops","p","d","u","y","map","color","ratio","toString","join","h","S","programSpec","shader","vertexLayout","geometry","location","name","count","SHORT","UNSIGNED_BYTE","HeatmapTechnique"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../../../core/maybe.js\";import{pt2px as t}from\"../../../../../../core/screenUtils.js\";import{generateGradient as r}from\"../../../../../../renderers/support/heatmapUtils.js\";import{Technique as a}from\"../Technique.js\";import{DataType as i}from\"../../../../../webgl/enums.js\";class n extends a{static getStorageSpec({field:e,valueExpression:t}){return{visualVariables:!1,attributes:e||t?[{field:e,valueExpression:t}]:null}}static _createRendererSchema(){return{type:\"heatmap\",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:\"invalid\"}}static createOrUpdateRendererSchema(a,i){const{radius:n,minDensity:s,maxDensity:o,referenceScale:c,field:l,valueExpression:m,colorStops:p}=i,d=o-s,u=l||m?1:0,y=p.map((({color:e,ratio:t})=>`${t}:${e.toString()}`)).join();let h,S=!0;return e(a)&&\"heatmap\"===a.type?(h=a,S=y!==a.gradientHash):h=this._createRendererSchema(),h.radius=t(n),h.minDensity=s,h.densityRange=d,h.referenceScale=c,h.isFieldActive=u,S&&(h.gradient=r(p),h.gradientHash=y),h}}n.type=\"heatmap\",n.programSpec={shader:\"materials/icon/heatmapAccumulate\",vertexLayout:{geometry:[{location:0,name:\"a_pos\",count:2,type:i.SHORT},{location:1,name:\"a_vertexOffset\",count:2,type:i.SHORT},{location:4,name:\"a_id\",count:4,type:i.UNSIGNED_BYTE}]}};export{n as HeatmapTechnique};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}