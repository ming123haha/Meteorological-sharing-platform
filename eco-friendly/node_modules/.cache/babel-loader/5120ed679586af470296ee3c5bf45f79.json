{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport r from \"../../../../core/Accessor.js\";\nimport { isNone as t, isSome as s } from \"../../../../core/maybe.js\";\nimport { screenPointObjectToArray as o } from \"../../../../core/screenUtils.js\";\nimport { property as i } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as n } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { c, n as a, g as p, a as l } from \"../../../../chunks/vec3.js\";\nimport { d as m, a as d, c as u } from \"../../../../chunks/vec3f64.js\";\nimport { create as h, copy as f, fromPoints as y } from \"../../../../geometry/support/ray.js\";\nimport { sv2d as g } from \"../../../../geometry/support/vectorStacks.js\";\nimport { getObjectId as I } from \"../../../../layers/graphics/dehydratedFeatures.js\";\nimport { LineOfSightIntersectionResult as j } from \"./LineOfSightIntersectionResult.js\";\nimport { isI3sIntersectorResult as w } from \"../../layers/i3s/Intersector.js\";\nimport { fromScreen as v } from \"../../support/geometryUtils/ray.js\";\nimport { isTerrainIntersectorResult as b } from \"../../terrain/Intersector.js\";\nimport { newIntersector as R } from \"../../webgl-engine/lib/Intersector.js\";\nimport { StoreResults as C, IntersectorType as S } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nimport { toGraphic as U } from \"../../webgl-engine/lib/intersectorUtilsConversions.js\";\nlet O = class extends r {\n  constructor(e) {\n    super(e), this._terrainIntersectionOptionsLayerUids = new Set([\"terrain\"]);\n  }\n\n  initialize() {\n    this.intersector = R(this.view.state.viewingMode), this.intersector.options.hud = !1, this.intersector.options.store = C.MIN;\n  }\n\n  getScreenPointIntersection(e) {\n    const r = o(e, g.get()),\n          t = v(this.view.state.camera, r, M);\n    return this._getRayIntersection(t);\n  }\n\n  _getRayIntersection(e, r) {\n    if (t(e) || t(this.view.sceneIntersectionHelper)) return null;\n    this.intersector.options.store = C.MIN, this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e, this.intersector, r);\n    const o = this.intersector.results.min;\n    if (!o.getIntersectionPoint(H)) return null;\n    const i = this.view.renderCoordsHelper.fromRenderCoords(H, this.view.spatialReference),\n          n = m(o.normal);\n    if (w(o)) return new j({\n      type: S.OBJECT,\n      id: `${o.target.layerUid}/${o.target.nodeIndex}/${o.target.componentIndex}`,\n      point: i,\n      normal: n,\n      ray: f(e),\n      graphic: null\n    });\n    if (b(o)) return new j({\n      type: S.TERRAIN,\n      id: o.target.lij.slice(),\n      point: i,\n      normal: n,\n      ray: f(e),\n      graphic: null\n    });\n    const c = U(o, this.view);\n\n    if (s(c)) {\n      const r = c.layer,\n            t = c.sourceLayer;\n      let s;\n      if (t) {\n        if (\"scene\" === t.type) s = I(c, t.objectIdField);else s = c.uid;\n      } else s = c.uid;\n      return new j({\n        type: S.OBJECT,\n        id: `${r.uid}/${s}`,\n        point: i,\n        normal: n,\n        ray: f(e),\n        graphic: c\n      });\n    }\n\n    return null;\n  }\n\n  updateFromGroundIntersection(e, r, t) {\n    const o = H,\n          i = L,\n          n = T,\n          m = _,\n          u = x;\n    c(i, e), this.view.renderCoordsHelper.worldUpAtPosition(i, n), a(n, n);\n    const h = this.view.basemapTerrain.elevationBounds,\n          f = this.view.renderCoordsHelper.getAltitude(i),\n          g = h ? Math.abs(h.max - h.min) : 100,\n          I = f > 0 ? 1 : -1;\n    p(m, n, I * (g + Math.abs(r))), l(o, i, m), y(o, i, M);\n\n    const j = this._getRayIntersection(M, {\n      include: this._terrainIntersectionOptionsLayerUids\n    });\n\n    return s(j) && s(j.point) ? (this.view.renderCoordsHelper.toRenderCoords(j.point, u), p(m, n, I * r), l(t, u, m), d(j.normal)) : (c(t, e), null);\n  }\n\n};\ne([i()], O.prototype, \"view\", void 0), e([i()], O.prototype, \"intersector\", void 0), O = e([n(\"esri.views.3d.analysis.LineOfSight.LineOfSightRayIntersector\")], O);\n\nconst H = u(),\n      L = u(),\n      T = u(),\n      _ = u(),\n      x = u(),\n      M = h();\n\nexport { O as LineOfSightRayIntersector };","map":{"version":3,"names":["_","e","r","isNone","t","isSome","s","screenPointObjectToArray","o","property","i","subclass","n","c","a","g","p","l","d","m","u","create","h","copy","f","fromPoints","y","sv2d","getObjectId","I","LineOfSightIntersectionResult","j","isI3sIntersectorResult","w","fromScreen","v","isTerrainIntersectorResult","b","newIntersector","R","StoreResults","C","IntersectorType","S","toGraphic","U","O","constructor","_terrainIntersectionOptionsLayerUids","Set","initialize","intersector","view","state","viewingMode","options","hud","store","MIN","getScreenPointIntersection","get","camera","M","_getRayIntersection","sceneIntersectionHelper","intersectToolIntersectorRay","results","min","getIntersectionPoint","H","renderCoordsHelper","fromRenderCoords","spatialReference","normal","type","OBJECT","id","target","layerUid","nodeIndex","componentIndex","point","ray","graphic","TERRAIN","lij","slice","layer","sourceLayer","objectIdField","uid","updateFromGroundIntersection","L","T","x","worldUpAtPosition","basemapTerrain","elevationBounds","getAltitude","Math","abs","max","include","toRenderCoords","prototype","LineOfSightRayIntersector"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/analysis/LineOfSight/LineOfSightRayIntersector.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import{isNone as t,isSome as s}from\"../../../../core/maybe.js\";import{screenPointObjectToArray as o}from\"../../../../core/screenUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{c,n as a,g as p,a as l}from\"../../../../chunks/vec3.js\";import{d as m,a as d,c as u}from\"../../../../chunks/vec3f64.js\";import{create as h,copy as f,fromPoints as y}from\"../../../../geometry/support/ray.js\";import{sv2d as g}from\"../../../../geometry/support/vectorStacks.js\";import{getObjectId as I}from\"../../../../layers/graphics/dehydratedFeatures.js\";import{LineOfSightIntersectionResult as j}from\"./LineOfSightIntersectionResult.js\";import{isI3sIntersectorResult as w}from\"../../layers/i3s/Intersector.js\";import{fromScreen as v}from\"../../support/geometryUtils/ray.js\";import{isTerrainIntersectorResult as b}from\"../../terrain/Intersector.js\";import{newIntersector as R}from\"../../webgl-engine/lib/Intersector.js\";import{StoreResults as C,IntersectorType as S}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";import{toGraphic as U}from\"../../webgl-engine/lib/intersectorUtilsConversions.js\";let O=class extends r{constructor(e){super(e),this._terrainIntersectionOptionsLayerUids=new Set([\"terrain\"])}initialize(){this.intersector=R(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=C.MIN}getScreenPointIntersection(e){const r=o(e,g.get()),t=v(this.view.state.camera,r,M);return this._getRayIntersection(t)}_getRayIntersection(e,r){if(t(e)||t(this.view.sceneIntersectionHelper))return null;this.intersector.options.store=C.MIN,this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this.intersector,r);const o=this.intersector.results.min;if(!o.getIntersectionPoint(H))return null;const i=this.view.renderCoordsHelper.fromRenderCoords(H,this.view.spatialReference),n=m(o.normal);if(w(o))return new j({type:S.OBJECT,id:`${o.target.layerUid}/${o.target.nodeIndex}/${o.target.componentIndex}`,point:i,normal:n,ray:f(e),graphic:null});if(b(o))return new j({type:S.TERRAIN,id:o.target.lij.slice(),point:i,normal:n,ray:f(e),graphic:null});const c=U(o,this.view);if(s(c)){const r=c.layer,t=c.sourceLayer;let s;if(t)if(\"scene\"===t.type)s=I(c,t.objectIdField);else s=c.uid;else s=c.uid;return new j({type:S.OBJECT,id:`${r.uid}/${s}`,point:i,normal:n,ray:f(e),graphic:c})}return null}updateFromGroundIntersection(e,r,t){const o=H,i=L,n=T,m=_,u=x;c(i,e),this.view.renderCoordsHelper.worldUpAtPosition(i,n),a(n,n);const h=this.view.basemapTerrain.elevationBounds,f=this.view.renderCoordsHelper.getAltitude(i),g=h?Math.abs(h.max-h.min):100,I=f>0?1:-1;p(m,n,I*(g+Math.abs(r))),l(o,i,m),y(o,i,M);const j=this._getRayIntersection(M,{include:this._terrainIntersectionOptionsLayerUids});return s(j)&&s(j.point)?(this.view.renderCoordsHelper.toRenderCoords(j.point,u),p(m,n,I*r),l(t,u,m),d(j.normal)):(c(t,e),null)}};e([i()],O.prototype,\"view\",void 0),e([i()],O.prototype,\"intersector\",void 0),O=e([n(\"esri.views.3d.analysis.LineOfSight.LineOfSightRayIntersector\")],O);const H=u(),L=u(),T=u(),_=u(),x=u(),M=h();export{O as LineOfSightRayIntersector};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}