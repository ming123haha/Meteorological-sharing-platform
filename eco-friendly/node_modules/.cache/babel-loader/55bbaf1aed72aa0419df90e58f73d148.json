{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../AggregateGraphic.js\";\nimport \"../../../geometry.js\";\nimport i from \"../../../Graphic.js\";\nimport r from \"../../../core/Collection.js\";\nimport s from \"../../../core/Error.js\";\nimport a from \"../../../core/has.js\";\nimport { clone as n } from \"../../../core/lang.js\";\nimport o from \"../../../core/Logger.js\";\nimport { applySome as l, isSome as h, unwrap as u, isNone as d } from \"../../../core/maybe.js\";\nimport { debounce as p, isAbortError as y } from \"../../../core/promiseUtils.js\";\nimport { watch as c, whenOnce as f, initial as g } from \"../../../core/reactiveUtils.js\";\nimport { property as m } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as _ } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport v from \"../../../layers/effects/FeatureEffectView.js\";\nimport b from \"../../../layers/support/FeatureFilter.js\";\nimport R from \"../../../rest/support/FeatureSet.js\";\nimport S from \"../../../rest/support/Query.js\";\nimport { MAX_FILTERS as w } from \"../engine/webgl/definitions.js\";\nimport { LayerView2DMixin as x } from \"./LayerView2D.js\";\nimport { createSchema as U } from \"./features/schemaUtils.js\";\nimport { createOrReuseTileRenderer as F } from \"./features/tileRenderers.js\";\nimport { isRendererSupported as C } from \"./features/support/rendererUtils.js\";\nimport { findSizeVV as I, createClusterCountSizeVariable as O, convertAggregateFieldFromPublic as E, isClusterCompatibleRenderer as q, createClusterRenderer as T } from \"./support/clusterUtils.js\";\nimport V from \"./support/FeatureCommandQueue.js\";\nimport j from \"./support/FeatureLayerProxy.js\";\nimport { toJSONGeometryType as N } from \"./support/util.js\";\nimport { TileManager as P } from \"../tiling/TileManager.js\";\nimport k from \"../../layers/FeatureLayerView.js\";\nimport L from \"../../layers/LayerView.js\";\nimport z from \"../../layers/RefreshableLayerView.js\";\nimport { getWebGLCapabilities as H } from \"../../webgl/capabilities.js\";\nimport J from \"../../../geometry/Extent.js\";\n\nfunction Q(e) {\n  return e && \"openPorts\" in e;\n}\n\nconst A = o.getLogger(\"esri.views.2d.layers.FeatureLayerView2D\");\nlet M = class extends k(z(x(L))) {\n  constructor() {\n    super(...arguments), this._pipelineIsUpdating = !0, this._commandsQueue = new V({\n      process: e => {\n        switch (e.type) {\n          case \"processed-edit\":\n            return this._doEdit(e);\n\n          case \"refresh\":\n            return this._doRefresh(e.dataChanged);\n\n          case \"update\":\n            return this._doUpdate();\n        }\n      }\n    }), this._visibilityOverrides = new Set(), this._highlightIds = new Map(), this._updateHighlight = p(async () => this._proxy.setHighlight(Array.from(this._highlightIds.keys()))), this._uploadsLocked = !1, this._needsClusterSizeUpdate = !1, this.featureEffectView = new v(), this._lastDefinitionExpression = null;\n  }\n\n  destroy() {\n    l(this._updateClusterSizeTask, e => e.remove()), this._proxy?.destroy(), this._commandsQueue.destroy();\n  }\n\n  initialize() {\n    this.addResolvingPromise(Promise.all([this._initProxy(), this._initServiceOptions()])), this.handles.add([this.on(\"valueRangesChanged\", e => {\n      this._set(\"_aggregateValueRanges\", e.valueRanges);\n    }), c(() => this.featureEffect, e => {\n      this.featureEffectView.featureEffect = e;\n    }, {\n      initial: !0,\n      sync: !0\n    })]);\n  }\n\n  async _initProxy() {\n    const e = this.layer;\n    if (\"isTable\" in e && e.isTable) throw new s(\"featurelayerview:table-not-supported\", \"table feature layer can't be displayed\", {\n      layer: this.layer\n    });\n    const t = \"feature\" === e.type || \"subtype-group\" === e.type,\n          i = \"capabilities\" in e && e.capabilities.operations.supportsQuery;\n    if (t && !i) throw new s(\"featurelayerview:query-not-supported\", \"layer view requires a layer with query capability\", {\n      layer: e\n    });\n    this._proxy && this._proxy.destroy();\n\n    const r = this._createClientOptions();\n\n    return this._set(\"_proxy\", new j({\n      client: r\n    })), this._proxy.when();\n  }\n\n  async _initServiceOptions() {\n    return this._set(\"_serviceOptions\", await this._createServiceOptions()), this._serviceOptions;\n  }\n\n  get orderByFields() {\n    return \"stream\" !== this._serviceOptions.type && this._serviceOptions.orderByFields;\n  }\n\n  get labelsVisible() {\n    const e = \"subtype-group\" === this.layer.type ? this.layer.sublayers.items : [this.layer];\n    return !this.suspended && e.some(e => e.labelingInfo && e.labelsVisible);\n  }\n\n  get queryMode() {\n    return this._serviceOptions.type;\n  }\n\n  get renderingConfigHash() {\n    if (!this.layer) return null;\n    const e = this.availableFields,\n          t = this.layer,\n          i = this.view.floors,\n          {\n      definitionExpression: r\n    } = t,\n          s = \"subtype-group\" !== this.layer.type && this.layer.labelsVisible && this.layer.labelingInfo,\n          a = \"renderer\" in t && t.renderer,\n          n = \"feature\" === t.type ? t.gdbVersion : void 0,\n          o = \"feature\" === t.type && t.historicMoment ? t.historicMoment.getTime() : void 0,\n          {\n      timeExtent: l\n    } = this,\n          u = \"customParameters\" in t ? JSON.stringify(t.customParameters) : void 0,\n          d = \"apiKey\" in t ? t.apiKey : void 0,\n          p = \"stream\" === t.type ? `${JSON.stringify(t.geometryDefinition)}${t.definitionExpression}` : null,\n          y = JSON.stringify(this.clips),\n          c = t.featureReduction && t.featureReduction.toJSON(),\n          f = \"orderBy\" in this.layer && JSON.stringify(this.layer.orderBy),\n          g = \"sublayers\" in this.layer && this.layer.sublayers.items.reduce((e, t) => e + `${t.visible ? 1 : 0}.${JSON.stringify(t.renderer)}.${t.labelsVisible}\\n.${JSON.stringify(t.labelingInfo)}`, \"\"),\n          m = \"subtypeCode\" in this.layer && this.layer.subtypeCode;\n    return JSON.stringify({\n      orderBy: f,\n      sublayerHash: g,\n      subtypeCode: m,\n      filterHash: h(this.filter) && this.filter.toJSON(),\n      effectHash: h(this.featureEffect) && this.featureEffect.toJSON(),\n      streamFilter: p,\n      gdbVersion: n,\n      definitionExpression: r,\n      historicMoment: o,\n      availableFields: e,\n      renderer: a,\n      labelingInfo: s,\n      timeExtent: l,\n      floors: i,\n      clipsHash: y,\n      featureReduction: c,\n      customParameters: u,\n      apiKey: d\n    });\n  }\n\n  highlight(e) {\n    let t;\n    return e instanceof i ? t = [e.getObjectId()] : \"number\" == typeof e || \"string\" == typeof e ? t = [e] : Array.isArray(e) && e.length > 0 ? t = \"number\" == typeof e[0] || \"string\" == typeof e[0] ? e : e.map(e => e?.getObjectId()) : r.isCollection(e) && e.length > 0 && (t = e.map(e => e?.getObjectId()).toArray()), t = t?.filter(e => null != e), t && t.length ? (this._addHighlight(t), {\n      remove: () => this._removeHighlight(t)\n    }) : {\n      remove: () => {}\n    };\n  }\n\n  hasHighlight() {\n    return !!this._highlightIds.size;\n  }\n\n  async hitTest(e, r) {\n    if (!this.tileRenderer) return null;\n    const s = await this.tileRenderer.hitTest(r);\n    if (0 === s.length) return null;\n    const {\n      features: a,\n      aggregates: n\n    } = await this._proxy.getFeatures(s);\n    return [...n.map(i => this._createGraphicHit(e, t.fromJSON(i))), ...a.map(t => this._createGraphicHit(e, i.fromJSON(t)))];\n  }\n\n  async queryAggregates() {\n    return (await this._proxy.getAggregates()).map(e => t.fromJSON(e));\n  }\n\n  queryStatistics() {\n    return this._proxy.queryStatistics();\n  }\n\n  async querySummaryStatistics(e, t, i) {\n    const r = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.querySummaryStatistics(this._cleanUpQuery(e), r, i);\n  }\n\n  async queryUniqueValues(e, t, i) {\n    const r = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryUniqueValues(this._cleanUpQuery(e), r, i);\n  }\n\n  async queryClassBreaks(e, t, i) {\n    const r = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryClassBreaks(this._cleanUpQuery(e), r, i);\n  }\n\n  async queryHistogram(e, t, i) {\n    const r = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryHistogram(this._cleanUpQuery(e), r, i);\n  }\n\n  queryFeatures(e, t) {\n    return this.queryFeaturesJSON(e, t).then(e => {\n      const t = R.fromJSON(e);\n      return t.features.forEach(e => this._setLayersForFeature(e)), t;\n    });\n  }\n\n  queryVisibleFeatures(e, t) {\n    return this._proxy.queryVisibleFeatures(this._cleanUpQuery(e), t).then(e => {\n      const t = R.fromJSON(e);\n      return t.features.forEach(e => this._setLayersForFeature(e)), t;\n    });\n  }\n\n  queryFeaturesJSON(e, t) {\n    return this._proxy.queryFeatures(this._cleanUpQuery(e), t);\n  }\n\n  queryObjectIds(e, t) {\n    return this._proxy.queryObjectIds(this._cleanUpQuery(e), t);\n  }\n\n  queryFeatureCount(e, t) {\n    return this._proxy.queryFeatureCount(this._cleanUpQuery(e), t);\n  }\n\n  queryExtent(e, t) {\n    return this._proxy.queryExtent(this._cleanUpQuery(e), t).then(e => ({\n      count: e.count,\n      extent: J.fromJSON(e.extent)\n    }));\n  }\n\n  setVisibility(e, t) {\n    t ? this._visibilityOverrides.delete(e) : this._visibilityOverrides.add(e), this._update();\n  }\n\n  update(e) {\n    if (!this._tileStrategy || !this.tileRenderer) return;\n\n    const {\n      hasMissingTiles: t,\n      added: i,\n      removed: r\n    } = this._tileStrategy.update(e);\n\n    (i.length || r.length) && this._proxy.updateTiles({\n      added: i,\n      removed: r\n    }), t && this.requestUpdate(), this.notifyChange(\"updating\");\n  }\n\n  attach() {\n    this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`), this._tileStrategy = new P({\n      acquireTile: e => this._acquireTile(e),\n      releaseTile: e => this._releaseTile(e),\n      tileInfoView: this.view.featuresTilingScheme,\n      buffer: 0\n    }), this.handles.add(c(() => this.renderingConfigHash, () => this._update(), g), \"attach\"), \"stream\" !== this.layer.type && this.handles.add(this.layer.on(\"edits\", e => this._edit(e)), \"attach\");\n  }\n\n  detach() {\n    this._commandsQueue.clear(), this._proxy?.stop(), this.container.removeAllChildren(), this.handles.remove(\"attach\"), this.tileRenderer && (this.tileRenderer.uninstall(this.container), this.tileRenderer = null), this._tileStrategy && (this._tileStrategy.destroy(), this._tileStrategy = null), this._tileRendererHash = null;\n  }\n\n  moveStart() {\n    this.requestUpdate();\n  }\n\n  viewChange() {\n    this.requestUpdate();\n  }\n\n  moveEnd() {\n    this.requestUpdate();\n  }\n\n  isUpdating() {\n    const e = \"renderer\" in this.layer && null != this.layer.renderer,\n          t = this._commandsQueue.updating,\n          i = null != this._updatingRequiredFieldsPromise,\n          r = !this._proxy || !this._proxy.isReady,\n          s = this._pipelineIsUpdating,\n          n = null == this.tileRenderer || this.tileRenderer?.updating,\n          o = e && (t || i || r || s || n);\n    return a(\"esri-2d-log-updating\") && console.log(`Updating FLV2D: ${o}\\n  -> hasRenderer ${e}\\n  -> hasPendingCommand ${t}\\n  -> updatingRequiredFields ${i}\\n  -> updatingProxy ${r}\\n  -> updatingPipeline ${s}\\n  -> updatingTileRenderer ${n}\\n`), o;\n  }\n\n  _createClientOptions() {\n    return {\n      setUpdating: e => {\n        this._set(\"_pipelineIsUpdating\", e);\n      },\n      emitEvent: e => {\n        this.emit(e.name, e.event);\n      }\n    };\n  }\n\n  async _detectQueryMode(e) {\n    const t = (\"path\" in e),\n          i = \"editingInfo\" in this.layer && this.layer.editingInfo?.lastEditDate,\n          r = !!this.layer.refreshInterval,\n          s = !i && r;\n    if (t && (\"feature\" === this.layer.type || \"subtype-group\" === this.layer.type) && \"point\" === this.layer.geometryType && this.layer.capabilities.query.supportsPagination && !this.layer.capabilities.operations.supportsEditing && !s && a(\"featurelayer-snapshot-enabled\")) try {\n      const e = await this.layer.queryFeatureCount();\n      if (e <= a(\"featurelayer-snapshot-point-min-threshold\")) return {\n        mode: \"snapshot\",\n        featureCount: e\n      };\n      const t = a(\"featurelayer-snapshot-point-max-threshold\"),\n            i = a(\"featurelayer-snapshot-point-coverage\"),\n            r = this.view.extent,\n            s = u(this.layer.fullExtent),\n            n = s?.clone().intersection(r),\n            o = h(n) ? n.width * n.height : 0,\n            l = s?.width * s?.height,\n            d = 0 === l ? 0 : o / l;\n      if (e <= t && d >= i) return {\n        mode: \"snapshot\",\n        featureCount: e\n      };\n    } catch (n) {\n      A.warn(\"mapview-feature-layer\", \"Encountered an error when querying for featureCount\", {\n        error: n\n      });\n    }\n    return {\n      mode: \"on-demand\"\n    };\n  }\n\n  async _createServiceOptions() {\n    const e = this.layer;\n    if (\"stream\" === e.type) return null;\n    const {\n      capabilities: t,\n      objectIdField: i\n    } = e,\n          r = e.fields.map(e => e.toJSON()),\n          s = h(e.fullExtent) && e.fullExtent.toJSON(),\n          a = N(e.geometryType),\n          o = e.timeInfo && e.timeInfo.toJSON() || null,\n          l = e.spatialReference ? e.spatialReference.toJSON() : null,\n          u = \"feature\" === e.type ? e.globalIdField : null;\n    let d;\n    \"ogc-feature\" === e.type ? d = e.source.getFeatureDefinition() : Q(e.source) ? d = await e.source.openPorts() : e.parsedUrl && (d = n(e.parsedUrl), \"dynamicDataSource\" in e && e.dynamicDataSource && (d.query = {\n      layer: JSON.stringify({\n        source: e.dynamicDataSource\n      })\n    }));\n    const p = \"datesInUnknownTimezone\" in this.layer && this.layer.datesInUnknownTimezone,\n          y = (\"subtypeField\" in this.layer && this.layer.subtypeField) ?? null,\n          {\n      mode: c,\n      featureCount: f\n    } = await this._detectQueryMode(d);\n    let g = this.layer.objectIdField;\n\n    if (\"feature\" === this.layer.type && h(this.layer.orderBy) && this.layer.orderBy.length) {\n      const e = !this.layer.orderBy[0].valueExpression && this.layer.orderBy[0].field;\n      e && (g = e);\n    }\n\n    return {\n      type: c,\n      timeReferenceUnknownClient: p,\n      subtypeField: y,\n      featureCount: f,\n      globalIdField: u,\n      maxRecordCount: t.query.maxRecordCount,\n      tileMaxRecordCount: t.query.tileMaxRecordCount,\n      capabilities: t,\n      fields: r,\n      fullExtent: s,\n      geometryType: a,\n      objectIdField: i,\n      source: d,\n      timeInfo: o,\n      spatialReference: l,\n      orderByFields: g\n    };\n  }\n\n  async _createMemoryServiceOptions(e) {\n    const t = await e.openPorts();\n    return { ...this._createServiceOptions(),\n      type: \"memory\",\n      source: t\n    };\n  }\n\n  _cleanUpQuery(e) {\n    const t = S.from(e) || this.createQuery();\n    return t.outSpatialReference || (t.outSpatialReference = this.view.spatialReference), t;\n  }\n\n  async _update() {\n    return this._commandsQueue.push({\n      type: \"update\"\n    });\n  }\n\n  async _edit(e) {\n    if (this.suspended) return void this._clearTiles();\n    return this._validateEdit(e) ? this._commandsQueue.push({\n      type: \"edit\",\n      edits: e\n    }) : void 0;\n  }\n\n  async doRefresh(e) {\n    if (this._tileStrategy.tileKeys().length) return this.suspended && e ? void this._clearTiles() : this._commandsQueue.push({\n      type: \"refresh\",\n      dataChanged: e\n    });\n  }\n\n  _clearTiles() {\n    this._tileStrategy.tileKeys().length && (this._proxy.updateTiles({\n      added: [],\n      removed: this._tileStrategy.tileKeys()\n    }), this._tileStrategy.clear(), this.requestUpdate(), this._commandsQueue.clear(), this._update());\n  }\n\n  _validateEdit(e) {\n    const t = \"globalIdField\" in this.layer && this.layer.globalIdField,\n          i = e.deletedFeatures.some(e => -1 === e.objectId || !e.objectId),\n          r = t && this.availableFields.includes(t);\n    return i && !r ? (A.error(new s(\"mapview-apply-edits\", `Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected on the map`)), null) : e;\n  }\n\n  async _doUpdate() {\n    try {\n      if (this.destroyed || !this._hasRequiredSupport(this.layer) || !this._tileStrategy) return;\n      const {\n        featureEffectView: t,\n        filter: i\n      } = this;\n      await this._updateRequiredFields();\n\n      const {\n        renderer: r\n      } = this._getEffectiveRenderer();\n\n      this._set(\"_effectiveRenderer\", r);\n\n      const s = this._createSchemaConfig(),\n            a = this._createConfiguration(s, i, t.filter),\n            n = this._lastDefinitionExpression !== a.schema.source.definitionExpression;\n\n      this._lastDefinitionExpression = a.schema.source.definitionExpression;\n\n      const o = a.schema.tileRenderer,\n            l = this._createTileRendererHash(o);\n\n      if (\"snapshot\" === this._serviceOptions.type && (a.schema.source.featureCount = this._serviceOptions.featureCount), l !== this._tileRendererHash) {\n        await this._initTileRenderer(o, r);\n        const e = this.layer,\n              t = \"stream\" === e.type ? await this._initServiceOptions() : this._serviceOptions;\n        this.tileRenderer.onConfigUpdate(r), \"stream\" !== e.type && Q(e.source) && (t.source = await e.source.openPorts());\n        const i = {\n          added: this._tileStrategy.tileKeys(),\n          removed: []\n        };\n        await this._proxy.startup(this.view.featuresTilingScheme, a, t, i), this.hasHighlight() && (await this._proxy.setHighlight(Array.from(this._highlightIds.keys()))), await this._onceTilesUpdated(), this.tileRenderer.onConfigUpdate(r);\n      } else {\n        \"snapshot\" === this._serviceOptions.type && n && (a.schema.source.featureCount = await this.layer.queryFeatureCount());\n        const t = await this._proxy.update(a);\n        (t.mesh || t.targets.aggregate) && this._lockGPUUploads();\n\n        try {\n          await this._proxy.applyUpdate(t);\n        } catch (e) {\n          y(e) || A.error(e);\n        }\n\n        (t.mesh || t.targets.aggregate) && this._unlockGPUUploads(), this.tileRenderer.onConfigUpdate(r), this._updateClusterSizeVariable(), this._forceAttributeTextureUpload();\n      }\n\n      this._tileRendererHash = l, this.tileRenderer.invalidateLabels(), this.requestUpdate();\n    } catch (e) {}\n  }\n\n  async _doEdit(e) {\n    try {\n      await this._proxy.onEdits(e);\n    } catch (t) {\n      y(t), 0;\n    }\n  }\n\n  async _doRefresh(e) {\n    this._lockGPUUploads();\n\n    try {\n      await this._proxy.refresh(e);\n    } catch (t) {\n      y(t), 0;\n    }\n\n    this._unlockGPUUploads(), this.layer?.featureReduction && this._updateClusterSizeVariable();\n  }\n\n  _updateClusterSizeVariable() {\n    this._needsClusterSizeUpdate && (this.tileRenderer.onConfigUpdate(this._effectiveRenderer), this._needsClusterSizeUpdate = !1);\n  }\n\n  _createUpdateClusterSizeTask(e, t) {\n    return c(() => this._aggregateValueRanges, i => {\n      this._updateClusterEffectiveRendererSizeVariable(e, t, i), this._needsClusterSizeUpdate = !0, this._uploadsLocked || this._updateClusterSizeVariable();\n    });\n  }\n\n  async _updateClusterEffectiveRendererSizeVariable(e, t, i) {\n    if (e.dynamicClusterSize && \"visualVariables\" in e && e.visualVariables) {\n      const r = I(e.visualVariables);\n\n      if (h(r) && \"cluster_count\" === r.field) {\n        const s = e.visualVariables.indexOf(r);\n        e.visualVariables[s] = O(t, i);\n        const a = e.clone();\n        a.dynamicClusterSize = !0, this._set(\"_effectiveRenderer\", a);\n      }\n    }\n  }\n\n  _getEffectiveRenderer() {\n    const e = \"renderer\" in this.layer && this.layer.renderer,\n          t = this.layer.featureReduction;\n\n    if (h(this._updateClusterSizeTask) && (this._updateClusterSizeTask.remove(), this._updateClusterSizeTask = null), t && \"renderer\" in t && t.renderer) {\n      const e = [];\n\n      for (const i of t.fields ?? []) E(e, i);\n\n      return {\n        renderer: t.renderer,\n        aggregateFields: e,\n        featureReduction: t\n      };\n    }\n\n    if (t && \"cluster\" === t.type && q(e)) {\n      const i = t,\n            r = [],\n            s = T(r, e, i, this._aggregateValueRanges);\n      return l(this._updateClusterSizeTask, e => e.remove()), this._updateClusterSizeTask = this._createUpdateClusterSizeTask(s, i), {\n        renderer: s,\n        aggregateFields: r,\n        featureReduction: t\n      };\n    }\n\n    return {\n      renderer: e,\n      aggregateFields: [],\n      featureReduction: null\n    };\n  }\n\n  _acquireTile(e) {\n    const t = this.tileRenderer.acquireTile(e);\n    return t.once(\"attach\", () => {\n      this.requestUpdate();\n    }), t;\n  }\n\n  _releaseTile(e) {\n    this.tileRenderer.releaseTile(e);\n  }\n\n  async _initTileRenderer(e, t) {\n    const i = await F(e, {\n      layerView: this,\n      tileInfoView: this.view.featuresTilingScheme,\n      layer: this.layer\n    });\n    return this.tileRenderer && (this._tileStrategy.clear(), this.tileRenderer.uninstall(this.container), this.tileRenderer.destroy(), this.tileRenderer = null), this.destroyed ? null : (this._proxy.tileRenderer = i, this._set(\"tileRenderer\", i), this.tileRenderer.install(this.container), this.tileRenderer.onConfigUpdate(t), this.requestUpdate(), this.tileRenderer);\n  }\n\n  _createTileRendererHash(e) {\n    return `${e.type}`;\n  }\n\n  get hasFilter() {\n    const e = !!(\"floorInfo\" in this.layer && this.layer.floorInfo && this.view.floors && this.view.floors.length);\n    return !!this.filter || e || !!this._visibilityOverrides.size || !!this.timeExtent;\n  }\n\n  _injectOverrides(e) {\n    const t = h(e) ? e.timeExtent : null,\n          i = h(this.timeExtent) && h(t) ? this.timeExtent.intersection(t) : this.timeExtent || t;\n    let r = null;\n    const s = \"floorInfo\" in this.layer && this.layer.floorInfo;\n\n    if (s) {\n      const t = h(e) && e.where;\n      r = this._addFloorFilterClause(t);\n    }\n\n    if (!this._visibilityOverrides.size && !i && !s) return h(e) ? e.toJSON() : null;\n    (e = h(e) && e.clone() || new b()).timeExtent = i, r && (e.where = r);\n    const a = e.toJSON();\n    return a.hiddenIds = Array.from(this._visibilityOverrides), a;\n  }\n\n  _addFloorFilterClause(e) {\n    const t = this.layer;\n    let i = e || \"\";\n\n    if (\"floorInfo\" in t && t.floorInfo) {\n      let e = this.view.floors;\n      if (!e || !e.length) return i;\n      t.floorInfo.viewAllLevelIds?.length && (e = t.floorInfo.viewAllLevelIds);\n      const r = e.filter(e => \"\" !== e).map(e => \"'\" + e + \"'\");\n      r.push(\"''\");\n      const s = t.floorInfo.floorField;\n      let a = \"(\" + s + \" IN ({ids}) OR \" + s + \" IS NULL)\";\n\n      if (a = a.replace(\"{ids}\", r.join(\", \")), h(i) && i.includes(s)) {\n        let e = new RegExp(\"AND \\\\(\" + s + \".*NULL\\\\)\", \"g\");\n        i = i.replace(e, \"\"), e = new RegExp(\"\\\\(\" + s + \".*NULL\\\\)\", \"g\"), i = i.replace(e, \"\"), i = i.replace(/\\s+/g, \" \").trim();\n      }\n\n      i = \"\" !== i ? \"(\" + i + \") AND \" + a : a;\n    }\n\n    return \"\" !== i ? i : null;\n  }\n\n  _createConfiguration(e, t, i) {\n    const r = \"feature\" === this.layer.type && this.layer.historicMoment ? this.layer.historicMoment.getTime() : void 0,\n          s = \"feature\" === this.layer.type ? this.layer.gdbVersion : void 0,\n          a = new Array(w),\n          n = this._injectOverrides(t);\n\n    a[0] = n, a[1] = h(i) ? i.toJSON() : null;\n    const o = U(e);\n    if (d(o)) return null;\n    const l = H(\"2d\");\n    return {\n      availableFields: this.availableFields,\n      gdbVersion: s,\n      historicMoment: r,\n      devicePixelRatio: window.devicePixelRatio || 1,\n      filters: a,\n      schema: o,\n      supportsTextureFloat: l.supportsTextureFloat,\n      maxTextureSize: l.maxTextureSize\n    };\n  }\n\n  _hasRequiredSupport(e) {\n    return !(\"renderer\" in e) || C(e.renderer);\n  }\n\n  _onceTilesUpdated() {\n    return this.requestUpdate(), f(() => !this._pipelineIsUpdating);\n  }\n\n  _lockGPUUploads() {\n    this.tileRenderer && (this._uploadsLocked = !0, this.tileRenderer.lockGPUUploads());\n  }\n\n  _unlockGPUUploads() {\n    this.tileRenderer && (this._uploadsLocked = !1, this.tileRenderer.unlockGPUUploads());\n  }\n\n  _forceAttributeTextureUpload() {\n    this.tileRenderer && this.tileRenderer.forceAttributeTextureUpload();\n  }\n\n  _createSchemaConfig() {\n    const e = \"feature\" === this.layer.type ? this.layer.historicMoment : null,\n          t = \"feature\" === this.layer.type ? this.layer.gdbVersion : null;\n    return {\n      renderer: \"renderer\" in this.layer && this.layer.renderer,\n      spatialReference: this.layer.spatialReference,\n      timeExtent: this.layer.timeExtent,\n      definitionExpression: this.layer.definitionExpression,\n      featureReduction: this.layer.featureReduction,\n      fields: this.layer.fields,\n      geometryType: this.layer.geometryType,\n      historicMoment: e,\n      labelsVisible: \"labelsVisible\" in this.layer && this.layer.labelsVisible,\n      labelingInfo: \"labelingInfo\" in this.layer && this.layer.labelingInfo,\n      availableFields: this.availableFields,\n      featureEffect: this.featureEffect,\n      filter: this.filter,\n      gdbVersion: t,\n      pixelBuffer: 0,\n      orderBy: \"orderBy\" in this.layer && this.layer.orderBy ? this.layer.orderBy : null,\n      customParameters: { ...(\"customParameters\" in this.layer ? this.layer.customParameters : void 0),\n        token: \"apiKey\" in this.layer ? this.layer.apiKey : void 0\n      },\n      subtypeCode: \"subtypeCode\" in this.layer ? this.layer.subtypeCode : void 0,\n      subtypeField: \"subtypeField\" in this.layer ? this.layer.subtypeField : void 0\n    };\n  }\n\n  _addHighlight(e) {\n    for (const t of e) if (this._highlightIds.has(t)) {\n      const e = this._highlightIds.get(t);\n\n      this._highlightIds.set(t, e + 1);\n    } else this._highlightIds.set(t, 1);\n\n    this._updateHighlight().catch(e => {\n      y(e) || A.error(e);\n    });\n  }\n\n  _removeHighlight(e) {\n    for (const t of e) if (this._highlightIds.has(t)) {\n      const e = this._highlightIds.get(t) - 1;\n      0 === e ? this._highlightIds.delete(t) : this._highlightIds.set(t, e);\n    }\n\n    this._updateHighlight().catch(e => {\n      y(e) || A.error(e);\n    });\n  }\n\n  _setLayersForFeature(e) {\n    const t = this.layer;\n    e.layer = t, e.sourceLayer = t;\n  }\n\n  _createGraphicHit(e, t) {\n    return this._setLayersForFeature(t), h(t.geometry) && (t.geometry.spatialReference = this.view.spatialReference), {\n      type: \"graphic\",\n      graphic: t,\n      layer: this.layer,\n      mapPoint: e\n    };\n  }\n\n};\ne([m()], M.prototype, \"_serviceOptions\", void 0), e([m()], M.prototype, \"_proxy\", void 0), e([m()], M.prototype, \"_pipelineIsUpdating\", void 0), e([m()], M.prototype, \"_effectiveRenderer\", void 0), e([m()], M.prototype, \"_aggregateValueRanges\", void 0), e([m()], M.prototype, \"_commandsQueue\", void 0), e([m()], M.prototype, \"featureEffectView\", void 0), e([m()], M.prototype, \"labelsVisible\", null), e([m({\n  readOnly: !0\n})], M.prototype, \"queryMode\", null), e([m()], M.prototype, \"renderingConfigHash\", null), e([m()], M.prototype, \"tileRenderer\", void 0), e([m()], M.prototype, \"updating\", void 0), M = e([_(\"esri.views.2d.layers.FeatureLayerView2D\")], M);\nconst B = M;\nexport { B as default };","map":{"version":3,"names":["_","e","t","i","r","s","a","clone","n","o","applySome","l","isSome","h","unwrap","u","isNone","d","debounce","p","isAbortError","y","watch","c","whenOnce","f","initial","g","property","m","subclass","v","b","R","S","MAX_FILTERS","w","LayerView2DMixin","x","createSchema","U","createOrReuseTileRenderer","F","isRendererSupported","C","findSizeVV","I","createClusterCountSizeVariable","O","convertAggregateFieldFromPublic","E","isClusterCompatibleRenderer","q","createClusterRenderer","T","V","j","toJSONGeometryType","N","TileManager","P","k","L","z","getWebGLCapabilities","H","J","Q","A","getLogger","M","constructor","arguments","_pipelineIsUpdating","_commandsQueue","process","type","_doEdit","_doRefresh","dataChanged","_doUpdate","_visibilityOverrides","Set","_highlightIds","Map","_updateHighlight","_proxy","setHighlight","Array","from","keys","_uploadsLocked","_needsClusterSizeUpdate","featureEffectView","_lastDefinitionExpression","destroy","_updateClusterSizeTask","remove","initialize","addResolvingPromise","Promise","all","_initProxy","_initServiceOptions","handles","add","on","_set","valueRanges","featureEffect","sync","layer","isTable","capabilities","operations","supportsQuery","_createClientOptions","client","when","_createServiceOptions","_serviceOptions","orderByFields","labelsVisible","sublayers","items","suspended","some","labelingInfo","queryMode","renderingConfigHash","availableFields","view","floors","definitionExpression","renderer","gdbVersion","historicMoment","getTime","timeExtent","JSON","stringify","customParameters","apiKey","geometryDefinition","clips","featureReduction","toJSON","orderBy","reduce","visible","subtypeCode","sublayerHash","filterHash","filter","effectHash","streamFilter","clipsHash","highlight","getObjectId","isArray","length","map","isCollection","toArray","_addHighlight","_removeHighlight","hasHighlight","size","hitTest","tileRenderer","features","aggregates","getFeatures","_createGraphicHit","fromJSON","queryAggregates","getAggregates","queryStatistics","querySummaryStatistics","scale","_cleanUpQuery","queryUniqueValues","queryClassBreaks","queryHistogram","queryFeatures","queryFeaturesJSON","then","forEach","_setLayersForFeature","queryVisibleFeatures","queryObjectIds","queryFeatureCount","queryExtent","count","extent","setVisibility","delete","_update","update","_tileStrategy","hasMissingTiles","added","removed","updateTiles","requestUpdate","notifyChange","attach","timeline","record","title","acquireTile","_acquireTile","releaseTile","_releaseTile","tileInfoView","featuresTilingScheme","buffer","_edit","detach","clear","stop","container","removeAllChildren","uninstall","_tileRendererHash","moveStart","viewChange","moveEnd","isUpdating","updating","_updatingRequiredFieldsPromise","isReady","console","log","setUpdating","emitEvent","emit","name","event","_detectQueryMode","editingInfo","lastEditDate","refreshInterval","geometryType","query","supportsPagination","supportsEditing","mode","featureCount","fullExtent","intersection","width","height","warn","error","objectIdField","fields","timeInfo","spatialReference","globalIdField","source","getFeatureDefinition","openPorts","parsedUrl","dynamicDataSource","datesInUnknownTimezone","subtypeField","valueExpression","field","timeReferenceUnknownClient","maxRecordCount","tileMaxRecordCount","_createMemoryServiceOptions","createQuery","outSpatialReference","push","_clearTiles","_validateEdit","edits","doRefresh","tileKeys","deletedFeatures","objectId","includes","destroyed","_hasRequiredSupport","_updateRequiredFields","_getEffectiveRenderer","_createSchemaConfig","_createConfiguration","schema","_createTileRendererHash","_initTileRenderer","onConfigUpdate","startup","_onceTilesUpdated","mesh","targets","aggregate","_lockGPUUploads","applyUpdate","_unlockGPUUploads","_updateClusterSizeVariable","_forceAttributeTextureUpload","invalidateLabels","onEdits","refresh","_effectiveRenderer","_createUpdateClusterSizeTask","_aggregateValueRanges","_updateClusterEffectiveRendererSizeVariable","dynamicClusterSize","visualVariables","indexOf","aggregateFields","once","layerView","install","hasFilter","floorInfo","_injectOverrides","where","_addFloorFilterClause","hiddenIds","viewAllLevelIds","floorField","replace","join","RegExp","trim","devicePixelRatio","window","filters","supportsTextureFloat","maxTextureSize","lockGPUUploads","unlockGPUUploads","forceAttributeTextureUpload","pixelBuffer","token","has","get","set","catch","sourceLayer","geometry","graphic","mapPoint","prototype","readOnly","B","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/FeatureLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../AggregateGraphic.js\";import\"../../../geometry.js\";import i from\"../../../Graphic.js\";import r from\"../../../core/Collection.js\";import s from\"../../../core/Error.js\";import a from\"../../../core/has.js\";import{clone as n}from\"../../../core/lang.js\";import o from\"../../../core/Logger.js\";import{applySome as l,isSome as h,unwrap as u,isNone as d}from\"../../../core/maybe.js\";import{debounce as p,isAbortError as y}from\"../../../core/promiseUtils.js\";import{watch as c,whenOnce as f,initial as g}from\"../../../core/reactiveUtils.js\";import{property as m}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as _}from\"../../../core/accessorSupport/decorators/subclass.js\";import v from\"../../../layers/effects/FeatureEffectView.js\";import b from\"../../../layers/support/FeatureFilter.js\";import R from\"../../../rest/support/FeatureSet.js\";import S from\"../../../rest/support/Query.js\";import{MAX_FILTERS as w}from\"../engine/webgl/definitions.js\";import{LayerView2DMixin as x}from\"./LayerView2D.js\";import{createSchema as U}from\"./features/schemaUtils.js\";import{createOrReuseTileRenderer as F}from\"./features/tileRenderers.js\";import{isRendererSupported as C}from\"./features/support/rendererUtils.js\";import{findSizeVV as I,createClusterCountSizeVariable as O,convertAggregateFieldFromPublic as E,isClusterCompatibleRenderer as q,createClusterRenderer as T}from\"./support/clusterUtils.js\";import V from\"./support/FeatureCommandQueue.js\";import j from\"./support/FeatureLayerProxy.js\";import{toJSONGeometryType as N}from\"./support/util.js\";import{TileManager as P}from\"../tiling/TileManager.js\";import k from\"../../layers/FeatureLayerView.js\";import L from\"../../layers/LayerView.js\";import z from\"../../layers/RefreshableLayerView.js\";import{getWebGLCapabilities as H}from\"../../webgl/capabilities.js\";import J from\"../../../geometry/Extent.js\";function Q(e){return e&&\"openPorts\"in e}const A=o.getLogger(\"esri.views.2d.layers.FeatureLayerView2D\");let M=class extends(k(z(x(L)))){constructor(){super(...arguments),this._pipelineIsUpdating=!0,this._commandsQueue=new V({process:e=>{switch(e.type){case\"processed-edit\":return this._doEdit(e);case\"refresh\":return this._doRefresh(e.dataChanged);case\"update\":return this._doUpdate()}}}),this._visibilityOverrides=new Set,this._highlightIds=new Map,this._updateHighlight=p((async()=>this._proxy.setHighlight(Array.from(this._highlightIds.keys())))),this._uploadsLocked=!1,this._needsClusterSizeUpdate=!1,this.featureEffectView=new v,this._lastDefinitionExpression=null}destroy(){l(this._updateClusterSizeTask,(e=>e.remove())),this._proxy?.destroy(),this._commandsQueue.destroy()}initialize(){this.addResolvingPromise(Promise.all([this._initProxy(),this._initServiceOptions()])),this.handles.add([this.on(\"valueRangesChanged\",(e=>{this._set(\"_aggregateValueRanges\",e.valueRanges)})),c((()=>this.featureEffect),(e=>{this.featureEffectView.featureEffect=e}),{initial:!0,sync:!0})])}async _initProxy(){const e=this.layer;if(\"isTable\"in e&&e.isTable)throw new s(\"featurelayerview:table-not-supported\",\"table feature layer can't be displayed\",{layer:this.layer});const t=\"feature\"===e.type||\"subtype-group\"===e.type,i=\"capabilities\"in e&&e.capabilities.operations.supportsQuery;if(t&&!i)throw new s(\"featurelayerview:query-not-supported\",\"layer view requires a layer with query capability\",{layer:e});this._proxy&&this._proxy.destroy();const r=this._createClientOptions();return this._set(\"_proxy\",new j({client:r})),this._proxy.when()}async _initServiceOptions(){return this._set(\"_serviceOptions\",await this._createServiceOptions()),this._serviceOptions}get orderByFields(){return\"stream\"!==this._serviceOptions.type&&this._serviceOptions.orderByFields}get labelsVisible(){const e=\"subtype-group\"===this.layer.type?this.layer.sublayers.items:[this.layer];return!this.suspended&&e.some((e=>e.labelingInfo&&e.labelsVisible))}get queryMode(){return this._serviceOptions.type}get renderingConfigHash(){if(!this.layer)return null;const e=this.availableFields,t=this.layer,i=this.view.floors,{definitionExpression:r}=t,s=\"subtype-group\"!==this.layer.type&&this.layer.labelsVisible&&this.layer.labelingInfo,a=\"renderer\"in t&&t.renderer,n=\"feature\"===t.type?t.gdbVersion:void 0,o=\"feature\"===t.type&&t.historicMoment?t.historicMoment.getTime():void 0,{timeExtent:l}=this,u=\"customParameters\"in t?JSON.stringify(t.customParameters):void 0,d=\"apiKey\"in t?t.apiKey:void 0,p=\"stream\"===t.type?`${JSON.stringify(t.geometryDefinition)}${t.definitionExpression}`:null,y=JSON.stringify(this.clips),c=t.featureReduction&&t.featureReduction.toJSON(),f=\"orderBy\"in this.layer&&JSON.stringify(this.layer.orderBy),g=\"sublayers\"in this.layer&&this.layer.sublayers.items.reduce(((e,t)=>e+`${t.visible?1:0}.${JSON.stringify(t.renderer)}.${t.labelsVisible}\\n.${JSON.stringify(t.labelingInfo)}`),\"\"),m=\"subtypeCode\"in this.layer&&this.layer.subtypeCode;return JSON.stringify({orderBy:f,sublayerHash:g,subtypeCode:m,filterHash:h(this.filter)&&this.filter.toJSON(),effectHash:h(this.featureEffect)&&this.featureEffect.toJSON(),streamFilter:p,gdbVersion:n,definitionExpression:r,historicMoment:o,availableFields:e,renderer:a,labelingInfo:s,timeExtent:l,floors:i,clipsHash:y,featureReduction:c,customParameters:u,apiKey:d})}highlight(e){let t;return e instanceof i?t=[e.getObjectId()]:\"number\"==typeof e||\"string\"==typeof e?t=[e]:Array.isArray(e)&&e.length>0?t=\"number\"==typeof e[0]||\"string\"==typeof e[0]?e:e.map((e=>e?.getObjectId())):r.isCollection(e)&&e.length>0&&(t=e.map((e=>e?.getObjectId())).toArray()),t=t?.filter((e=>null!=e)),t&&t.length?(this._addHighlight(t),{remove:()=>this._removeHighlight(t)}):{remove:()=>{}}}hasHighlight(){return!!this._highlightIds.size}async hitTest(e,r){if(!this.tileRenderer)return null;const s=await this.tileRenderer.hitTest(r);if(0===s.length)return null;const{features:a,aggregates:n}=await this._proxy.getFeatures(s);return[...n.map((i=>this._createGraphicHit(e,t.fromJSON(i)))),...a.map((t=>this._createGraphicHit(e,i.fromJSON(t))))]}async queryAggregates(){return(await this._proxy.getAggregates()).map((e=>t.fromJSON(e)))}queryStatistics(){return this._proxy.queryStatistics()}async querySummaryStatistics(e,t,i){const r={...t,scale:this.view.scale};return this._proxy.querySummaryStatistics(this._cleanUpQuery(e),r,i)}async queryUniqueValues(e,t,i){const r={...t,scale:this.view.scale};return this._proxy.queryUniqueValues(this._cleanUpQuery(e),r,i)}async queryClassBreaks(e,t,i){const r={...t,scale:this.view.scale};return this._proxy.queryClassBreaks(this._cleanUpQuery(e),r,i)}async queryHistogram(e,t,i){const r={...t,scale:this.view.scale};return this._proxy.queryHistogram(this._cleanUpQuery(e),r,i)}queryFeatures(e,t){return this.queryFeaturesJSON(e,t).then((e=>{const t=R.fromJSON(e);return t.features.forEach((e=>this._setLayersForFeature(e))),t}))}queryVisibleFeatures(e,t){return this._proxy.queryVisibleFeatures(this._cleanUpQuery(e),t).then((e=>{const t=R.fromJSON(e);return t.features.forEach((e=>this._setLayersForFeature(e))),t}))}queryFeaturesJSON(e,t){return this._proxy.queryFeatures(this._cleanUpQuery(e),t)}queryObjectIds(e,t){return this._proxy.queryObjectIds(this._cleanUpQuery(e),t)}queryFeatureCount(e,t){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),t)}queryExtent(e,t){return this._proxy.queryExtent(this._cleanUpQuery(e),t).then((e=>({count:e.count,extent:J.fromJSON(e.extent)})))}setVisibility(e,t){t?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._update()}update(e){if(!this._tileStrategy||!this.tileRenderer)return;const{hasMissingTiles:t,added:i,removed:r}=this._tileStrategy.update(e);(i.length||r.length)&&this._proxy.updateTiles({added:i,removed:r}),t&&this.requestUpdate(),this.notifyChange(\"updating\")}attach(){this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`),this._tileStrategy=new P({acquireTile:e=>this._acquireTile(e),releaseTile:e=>this._releaseTile(e),tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add(c((()=>this.renderingConfigHash),(()=>this._update()),g),\"attach\"),\"stream\"!==this.layer.type&&this.handles.add(this.layer.on(\"edits\",(e=>this._edit(e))),\"attach\")}detach(){this._commandsQueue.clear(),this._proxy?.stop(),this.container.removeAllChildren(),this.handles.remove(\"attach\"),this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null),this._tileRendererHash=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}isUpdating(){const e=\"renderer\"in this.layer&&null!=this.layer.renderer,t=this._commandsQueue.updating,i=null!=this._updatingRequiredFieldsPromise,r=!this._proxy||!this._proxy.isReady,s=this._pipelineIsUpdating,n=null==this.tileRenderer||this.tileRenderer?.updating,o=e&&(t||i||r||s||n);return a(\"esri-2d-log-updating\")&&console.log(`Updating FLV2D: ${o}\\n  -> hasRenderer ${e}\\n  -> hasPendingCommand ${t}\\n  -> updatingRequiredFields ${i}\\n  -> updatingProxy ${r}\\n  -> updatingPipeline ${s}\\n  -> updatingTileRenderer ${n}\\n`),o}_createClientOptions(){return{setUpdating:e=>{this._set(\"_pipelineIsUpdating\",e)},emitEvent:e=>{this.emit(e.name,e.event)}}}async _detectQueryMode(e){const t=\"path\"in e,i=\"editingInfo\"in this.layer&&this.layer.editingInfo?.lastEditDate,r=!!this.layer.refreshInterval,s=!i&&r;if(t&&(\"feature\"===this.layer.type||\"subtype-group\"===this.layer.type)&&\"point\"===this.layer.geometryType&&this.layer.capabilities.query.supportsPagination&&!this.layer.capabilities.operations.supportsEditing&&!s&&a(\"featurelayer-snapshot-enabled\"))try{const e=await this.layer.queryFeatureCount();if(e<=a(\"featurelayer-snapshot-point-min-threshold\"))return{mode:\"snapshot\",featureCount:e};const t=a(\"featurelayer-snapshot-point-max-threshold\"),i=a(\"featurelayer-snapshot-point-coverage\"),r=this.view.extent,s=u(this.layer.fullExtent),n=s?.clone().intersection(r),o=h(n)?n.width*n.height:0,l=s?.width*s?.height,d=0===l?0:o/l;if(e<=t&&d>=i)return{mode:\"snapshot\",featureCount:e}}catch(n){A.warn(\"mapview-feature-layer\",\"Encountered an error when querying for featureCount\",{error:n})}return{mode:\"on-demand\"}}async _createServiceOptions(){const e=this.layer;if(\"stream\"===e.type)return null;const{capabilities:t,objectIdField:i}=e,r=e.fields.map((e=>e.toJSON())),s=h(e.fullExtent)&&e.fullExtent.toJSON(),a=N(e.geometryType),o=e.timeInfo&&e.timeInfo.toJSON()||null,l=e.spatialReference?e.spatialReference.toJSON():null,u=\"feature\"===e.type?e.globalIdField:null;let d;\"ogc-feature\"===e.type?d=e.source.getFeatureDefinition():Q(e.source)?d=await e.source.openPorts():e.parsedUrl&&(d=n(e.parsedUrl),\"dynamicDataSource\"in e&&e.dynamicDataSource&&(d.query={layer:JSON.stringify({source:e.dynamicDataSource})}));const p=\"datesInUnknownTimezone\"in this.layer&&this.layer.datesInUnknownTimezone,y=(\"subtypeField\"in this.layer&&this.layer.subtypeField)??null,{mode:c,featureCount:f}=await this._detectQueryMode(d);let g=this.layer.objectIdField;if(\"feature\"===this.layer.type&&h(this.layer.orderBy)&&this.layer.orderBy.length){const e=!this.layer.orderBy[0].valueExpression&&this.layer.orderBy[0].field;e&&(g=e)}return{type:c,timeReferenceUnknownClient:p,subtypeField:y,featureCount:f,globalIdField:u,maxRecordCount:t.query.maxRecordCount,tileMaxRecordCount:t.query.tileMaxRecordCount,capabilities:t,fields:r,fullExtent:s,geometryType:a,objectIdField:i,source:d,timeInfo:o,spatialReference:l,orderByFields:g}}async _createMemoryServiceOptions(e){const t=await e.openPorts();return{...this._createServiceOptions(),type:\"memory\",source:t}}_cleanUpQuery(e){const t=S.from(e)||this.createQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t}async _update(){return this._commandsQueue.push({type:\"update\"})}async _edit(e){if(this.suspended)return void this._clearTiles();return this._validateEdit(e)?this._commandsQueue.push({type:\"edit\",edits:e}):void 0}async doRefresh(e){if(this._tileStrategy.tileKeys().length)return this.suspended&&e?void this._clearTiles():this._commandsQueue.push({type:\"refresh\",dataChanged:e})}_clearTiles(){this._tileStrategy.tileKeys().length&&(this._proxy.updateTiles({added:[],removed:this._tileStrategy.tileKeys()}),this._tileStrategy.clear(),this.requestUpdate(),this._commandsQueue.clear(),this._update())}_validateEdit(e){const t=\"globalIdField\"in this.layer&&this.layer.globalIdField,i=e.deletedFeatures.some((e=>-1===e.objectId||!e.objectId)),r=t&&this.availableFields.includes(t);return i&&!r?(A.error(new s(\"mapview-apply-edits\",`Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected on the map`)),null):e}async _doUpdate(){try{if(this.destroyed||!this._hasRequiredSupport(this.layer)||!this._tileStrategy)return;const{featureEffectView:t,filter:i}=this;await this._updateRequiredFields();const{renderer:r}=this._getEffectiveRenderer();this._set(\"_effectiveRenderer\",r);const s=this._createSchemaConfig(),a=this._createConfiguration(s,i,t.filter),n=this._lastDefinitionExpression!==a.schema.source.definitionExpression;this._lastDefinitionExpression=a.schema.source.definitionExpression;const o=a.schema.tileRenderer,l=this._createTileRendererHash(o);if(\"snapshot\"===this._serviceOptions.type&&(a.schema.source.featureCount=this._serviceOptions.featureCount),l!==this._tileRendererHash){await this._initTileRenderer(o,r);const e=this.layer,t=\"stream\"===e.type?await this._initServiceOptions():this._serviceOptions;this.tileRenderer.onConfigUpdate(r),\"stream\"!==e.type&&Q(e.source)&&(t.source=await e.source.openPorts());const i={added:this._tileStrategy.tileKeys(),removed:[]};await this._proxy.startup(this.view.featuresTilingScheme,a,t,i),this.hasHighlight()&&await this._proxy.setHighlight(Array.from(this._highlightIds.keys())),await this._onceTilesUpdated(),this.tileRenderer.onConfigUpdate(r)}else{\"snapshot\"===this._serviceOptions.type&&n&&(a.schema.source.featureCount=await this.layer.queryFeatureCount());const t=await this._proxy.update(a);(t.mesh||t.targets.aggregate)&&this._lockGPUUploads();try{await this._proxy.applyUpdate(t)}catch(e){y(e)||A.error(e)}(t.mesh||t.targets.aggregate)&&this._unlockGPUUploads(),this.tileRenderer.onConfigUpdate(r),this._updateClusterSizeVariable(),this._forceAttributeTextureUpload()}this._tileRendererHash=l,this.tileRenderer.invalidateLabels(),this.requestUpdate()}catch(e){}}async _doEdit(e){try{await this._proxy.onEdits(e)}catch(t){y(t),0}}async _doRefresh(e){this._lockGPUUploads();try{await this._proxy.refresh(e)}catch(t){y(t),0}this._unlockGPUUploads(),this.layer?.featureReduction&&this._updateClusterSizeVariable()}_updateClusterSizeVariable(){this._needsClusterSizeUpdate&&(this.tileRenderer.onConfigUpdate(this._effectiveRenderer),this._needsClusterSizeUpdate=!1)}_createUpdateClusterSizeTask(e,t){return c((()=>this._aggregateValueRanges),(i=>{this._updateClusterEffectiveRendererSizeVariable(e,t,i),this._needsClusterSizeUpdate=!0,this._uploadsLocked||this._updateClusterSizeVariable()}))}async _updateClusterEffectiveRendererSizeVariable(e,t,i){if(e.dynamicClusterSize&&\"visualVariables\"in e&&e.visualVariables){const r=I(e.visualVariables);if(h(r)&&\"cluster_count\"===r.field){const s=e.visualVariables.indexOf(r);e.visualVariables[s]=O(t,i);const a=e.clone();a.dynamicClusterSize=!0,this._set(\"_effectiveRenderer\",a)}}}_getEffectiveRenderer(){const e=\"renderer\"in this.layer&&this.layer.renderer,t=this.layer.featureReduction;if(h(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null),t&&\"renderer\"in t&&t.renderer){const e=[];for(const i of t.fields??[])E(e,i);return{renderer:t.renderer,aggregateFields:e,featureReduction:t}}if(t&&\"cluster\"===t.type&&q(e)){const i=t,r=[],s=T(r,e,i,this._aggregateValueRanges);return l(this._updateClusterSizeTask,(e=>e.remove())),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(s,i),{renderer:s,aggregateFields:r,featureReduction:t}}return{renderer:e,aggregateFields:[],featureReduction:null}}_acquireTile(e){const t=this.tileRenderer.acquireTile(e);return t.once(\"attach\",(()=>{this.requestUpdate()})),t}_releaseTile(e){this.tileRenderer.releaseTile(e)}async _initTileRenderer(e,t){const i=await F(e,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer});return this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this.destroyed?null:(this._proxy.tileRenderer=i,this._set(\"tileRenderer\",i),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(t),this.requestUpdate(),this.tileRenderer)}_createTileRendererHash(e){return`${e.type}`}get hasFilter(){const e=!!(\"floorInfo\"in this.layer&&this.layer.floorInfo&&this.view.floors&&this.view.floors.length);return!!this.filter||e||!!this._visibilityOverrides.size||!!this.timeExtent}_injectOverrides(e){const t=h(e)?e.timeExtent:null,i=h(this.timeExtent)&&h(t)?this.timeExtent.intersection(t):this.timeExtent||t;let r=null;const s=\"floorInfo\"in this.layer&&this.layer.floorInfo;if(s){const t=h(e)&&e.where;r=this._addFloorFilterClause(t)}if(!this._visibilityOverrides.size&&!i&&!s)return h(e)?e.toJSON():null;(e=h(e)&&e.clone()||new b).timeExtent=i,r&&(e.where=r);const a=e.toJSON();return a.hiddenIds=Array.from(this._visibilityOverrides),a}_addFloorFilterClause(e){const t=this.layer;let i=e||\"\";if(\"floorInfo\"in t&&t.floorInfo){let e=this.view.floors;if(!e||!e.length)return i;t.floorInfo.viewAllLevelIds?.length&&(e=t.floorInfo.viewAllLevelIds);const r=e.filter((e=>\"\"!==e)).map((e=>\"'\"+e+\"'\"));r.push(\"''\");const s=t.floorInfo.floorField;let a=\"(\"+s+\" IN ({ids}) OR \"+s+\" IS NULL)\";if(a=a.replace(\"{ids}\",r.join(\", \")),h(i)&&i.includes(s)){let e=new RegExp(\"AND \\\\(\"+s+\".*NULL\\\\)\",\"g\");i=i.replace(e,\"\"),e=new RegExp(\"\\\\(\"+s+\".*NULL\\\\)\",\"g\"),i=i.replace(e,\"\"),i=i.replace(/\\s+/g,\" \").trim()}i=\"\"!==i?\"(\"+i+\") AND \"+a:a}return\"\"!==i?i:null}_createConfiguration(e,t,i){const r=\"feature\"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,s=\"feature\"===this.layer.type?this.layer.gdbVersion:void 0,a=new Array(w),n=this._injectOverrides(t);a[0]=n,a[1]=h(i)?i.toJSON():null;const o=U(e);if(d(o))return null;const l=H(\"2d\");return{availableFields:this.availableFields,gdbVersion:s,historicMoment:r,devicePixelRatio:window.devicePixelRatio||1,filters:a,schema:o,supportsTextureFloat:l.supportsTextureFloat,maxTextureSize:l.maxTextureSize}}_hasRequiredSupport(e){return!(\"renderer\"in e)||C(e.renderer)}_onceTilesUpdated(){return this.requestUpdate(),f((()=>!this._pipelineIsUpdating))}_lockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!0,this.tileRenderer.lockGPUUploads())}_unlockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!1,this.tileRenderer.unlockGPUUploads())}_forceAttributeTextureUpload(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()}_createSchemaConfig(){const e=\"feature\"===this.layer.type?this.layer.historicMoment:null,t=\"feature\"===this.layer.type?this.layer.gdbVersion:null;return{renderer:\"renderer\"in this.layer&&this.layer.renderer,spatialReference:this.layer.spatialReference,timeExtent:this.layer.timeExtent,definitionExpression:this.layer.definitionExpression,featureReduction:this.layer.featureReduction,fields:this.layer.fields,geometryType:this.layer.geometryType,historicMoment:e,labelsVisible:\"labelsVisible\"in this.layer&&this.layer.labelsVisible,labelingInfo:\"labelingInfo\"in this.layer&&this.layer.labelingInfo,availableFields:this.availableFields,featureEffect:this.featureEffect,filter:this.filter,gdbVersion:t,pixelBuffer:0,orderBy:\"orderBy\"in this.layer&&this.layer.orderBy?this.layer.orderBy:null,customParameters:{...\"customParameters\"in this.layer?this.layer.customParameters:void 0,token:\"apiKey\"in this.layer?this.layer.apiKey:void 0},subtypeCode:\"subtypeCode\"in this.layer?this.layer.subtypeCode:void 0,subtypeField:\"subtypeField\"in this.layer?this.layer.subtypeField:void 0}}_addHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t);this._highlightIds.set(t,e+1)}else this._highlightIds.set(t,1);this._updateHighlight().catch((e=>{y(e)||A.error(e)}))}_removeHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t)-1;0===e?this._highlightIds.delete(t):this._highlightIds.set(t,e)}this._updateHighlight().catch((e=>{y(e)||A.error(e)}))}_setLayersForFeature(e){const t=this.layer;e.layer=t,e.sourceLayer=t}_createGraphicHit(e,t){return this._setLayersForFeature(t),h(t.geometry)&&(t.geometry.spatialReference=this.view.spatialReference),{type:\"graphic\",graphic:t,layer:this.layer,mapPoint:e}}};e([m()],M.prototype,\"_serviceOptions\",void 0),e([m()],M.prototype,\"_proxy\",void 0),e([m()],M.prototype,\"_pipelineIsUpdating\",void 0),e([m()],M.prototype,\"_effectiveRenderer\",void 0),e([m()],M.prototype,\"_aggregateValueRanges\",void 0),e([m()],M.prototype,\"_commandsQueue\",void 0),e([m()],M.prototype,\"featureEffectView\",void 0),e([m()],M.prototype,\"labelsVisible\",null),e([m({readOnly:!0})],M.prototype,\"queryMode\",null),e([m()],M.prototype,\"renderingConfigHash\",null),e([m()],M.prototype,\"tileRenderer\",void 0),e([m()],M.prototype,\"updating\",void 0),M=e([_(\"esri.views.2d.layers.FeatureLayerView2D\")],M);const B=M;export{B as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}