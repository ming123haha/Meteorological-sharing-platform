{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Logger.js\";\nimport { disposeMaybe as r, abortMaybe as t } from \"../../../core/maybe.js\";\nimport { createResolver as o, isAbortError as s } from \"../../../core/promiseUtils.js\";\nimport { c as i } from \"../../../chunks/mat4.js\";\nimport { c as a } from \"../../../chunks/mat4f64.js\";\nimport { requestImage as n } from \"../../../support/requestImageUtils.js\";\nimport { S as m } from \"../../../chunks/SimpleAtmosphere.glsl.js\";\nimport { SimpleAtmosphereTechnique as l } from \"./SimpleAtmosphereTechnique.js\";\nimport { SimpleAtmosphereTechniqueConfiguration as h, SimpleAtmosphereGeometry as p } from \"./SimpleAtmosphereTechniqueConfiguration.js\";\nimport c from \"./resources/SimpleAtmosphereTexture.js\";\nimport { glLayout as u } from \"../support/buffer/glUtil.js\";\nimport { newLayout as f } from \"../support/buffer/InterleavedLayout.js\";\nimport { Default3D as g } from \"../webgl-engine/lib/DefaultVertexAttributeLocations.js\";\nimport _ from \"../webgl-engine/lib/GeometryUtil.js\";\nimport { VertexAttribute as d } from \"../webgl-engine/lib/VertexAttribute.js\";\nimport { BufferObject as b } from \"../../webgl/BufferObject.js\";\nimport { PixelFormat as y, PixelType as j, TextureWrapMode as v, TextureSamplingMode as x, PrimitiveType as A, Usage as w } from \"../../webgl/enums.js\";\nimport { Texture as C } from \"../../webgl/Texture.js\";\nimport { vertexCount as T } from \"../../webgl/Util.js\";\nimport { VertexArrayObject as P } from \"../../webgl/VertexArrayObject.js\";\nconst q = e.getLogger(\"esri.views.3d.environment.PanoramicAtmosphere\");\n\nclass R {\n  constructor() {\n    this.type = \"panoramic\", this._techniqueConfig = new h(), this._passParameters = new m(), this._readyResolver = o(), this._readyController = new AbortController();\n  }\n\n  destroy() {\n    this._readyResolver.reject(), this._passParameters.texture = r(this._passParameters.texture), this._vao = r(this._vao), this._readyController = t(this._readyController);\n  }\n\n  when() {\n    return this._readyResolver.promise;\n  }\n\n  initializeRenderContext(e) {\n    this._techniqueConfig.geometry = p.Cylinder, this._technique = e.shaderTechniqueRepository.acquire(l, this._techniqueConfig);\n    const r = e.renderContext.rctx;\n    this._vao = this._createVertexArrayObject(r), this._vaoCount = T(this._vao, \"geometry\"), n(c, {\n      signal: this._readyController.signal\n    }).then(t => {\n      this._passParameters.texture = new C(r, {\n        pixelFormat: y.RGBA,\n        dataType: j.UNSIGNED_BYTE,\n        wrapMode: v.CLAMP_TO_EDGE,\n        samplingMode: x.LINEAR,\n        flipped: !0\n      }, t), e.requestRender(), this._readyController = null, this._readyResolver.resolve();\n    }).catch(e => {\n      s(e) || q.error(\"Unable to initialize atmosphere: image request failed\", e), this._readyResolver.reject();\n    });\n  }\n\n  get canRender() {\n    return null != this._passParameters.texture;\n  }\n\n  render(e) {\n    const r = e.rctx,\n          t = r.bindTechnique(this._technique, this._passParameters, e.bindParameters);\n    I(O, e.bindParameters.camera.viewMatrix), t.setUniformMatrix4fv(\"view\", O), r.bindVAO(this._vao), t.assertCompatibleVertexAttributeLocations(this._vao), r.drawArrays(A.TRIANGLES, 0, this._vaoCount);\n  }\n\n  renderHaze() {\n    return !1;\n  }\n\n  _createVertexArrayObject(e) {\n    const r = _.createPolySphereGeometry(1, 2, !1),\n          t = r.indices.get(d.POSITION);\n\n    for (let a = 0; a < t.length; a += 3) {\n      const e = t[a];\n      t[a] = t[a + 2], t[a + 2] = e;\n    }\n\n    const o = r.vertexAttributes.get(d.POSITION).data,\n          s = S.createBuffer(t.length),\n          i = s.position;\n\n    for (let a = 0; a < t.length; ++a) {\n      const e = 3 * t[a];\n      i.set(a, 0, o[e]), i.set(a, 1, o[e + 1]), i.set(a, 2, o[e + 2]);\n    }\n\n    return new P(e, g, {\n      geometry: u(S)\n    }, {\n      geometry: b.createVertex(e, w.STATIC_DRAW, s.buffer)\n    });\n  }\n\n}\n\nfunction I(e, r) {\n  i(e, r), e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1;\n}\n\nconst O = a(),\n      S = f().vec3f(d.POSITION);\nexport { R as PanoramicAtmosphere };","map":{"version":3,"names":["e","disposeMaybe","r","abortMaybe","t","createResolver","o","isAbortError","s","c","i","a","requestImage","n","S","m","SimpleAtmosphereTechnique","l","SimpleAtmosphereTechniqueConfiguration","h","SimpleAtmosphereGeometry","p","glLayout","u","newLayout","f","Default3D","g","_","VertexAttribute","d","BufferObject","b","PixelFormat","y","PixelType","j","TextureWrapMode","v","TextureSamplingMode","x","PrimitiveType","A","Usage","w","Texture","C","vertexCount","T","VertexArrayObject","P","q","getLogger","R","constructor","type","_techniqueConfig","_passParameters","_readyResolver","_readyController","AbortController","destroy","reject","texture","_vao","when","promise","initializeRenderContext","geometry","Cylinder","_technique","shaderTechniqueRepository","acquire","renderContext","rctx","_createVertexArrayObject","_vaoCount","signal","then","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","wrapMode","CLAMP_TO_EDGE","samplingMode","LINEAR","flipped","requestRender","resolve","catch","error","canRender","render","bindTechnique","bindParameters","I","O","camera","viewMatrix","setUniformMatrix4fv","bindVAO","assertCompatibleVertexAttributeLocations","drawArrays","TRIANGLES","renderHaze","createPolySphereGeometry","indices","get","POSITION","length","vertexAttributes","data","createBuffer","position","set","createVertex","STATIC_DRAW","buffer","vec3f","PanoramicAtmosphere"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/environment/PanoramicAtmosphere.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Logger.js\";import{disposeMaybe as r,abortMaybe as t}from\"../../../core/maybe.js\";import{createResolver as o,isAbortError as s}from\"../../../core/promiseUtils.js\";import{c as i}from\"../../../chunks/mat4.js\";import{c as a}from\"../../../chunks/mat4f64.js\";import{requestImage as n}from\"../../../support/requestImageUtils.js\";import{S as m}from\"../../../chunks/SimpleAtmosphere.glsl.js\";import{SimpleAtmosphereTechnique as l}from\"./SimpleAtmosphereTechnique.js\";import{SimpleAtmosphereTechniqueConfiguration as h,SimpleAtmosphereGeometry as p}from\"./SimpleAtmosphereTechniqueConfiguration.js\";import c from\"./resources/SimpleAtmosphereTexture.js\";import{glLayout as u}from\"../support/buffer/glUtil.js\";import{newLayout as f}from\"../support/buffer/InterleavedLayout.js\";import{Default3D as g}from\"../webgl-engine/lib/DefaultVertexAttributeLocations.js\";import _ from\"../webgl-engine/lib/GeometryUtil.js\";import{VertexAttribute as d}from\"../webgl-engine/lib/VertexAttribute.js\";import{BufferObject as b}from\"../../webgl/BufferObject.js\";import{PixelFormat as y,PixelType as j,TextureWrapMode as v,TextureSamplingMode as x,PrimitiveType as A,Usage as w}from\"../../webgl/enums.js\";import{Texture as C}from\"../../webgl/Texture.js\";import{vertexCount as T}from\"../../webgl/Util.js\";import{VertexArrayObject as P}from\"../../webgl/VertexArrayObject.js\";const q=e.getLogger(\"esri.views.3d.environment.PanoramicAtmosphere\");class R{constructor(){this.type=\"panoramic\",this._techniqueConfig=new h,this._passParameters=new m,this._readyResolver=o(),this._readyController=new AbortController}destroy(){this._readyResolver.reject(),this._passParameters.texture=r(this._passParameters.texture),this._vao=r(this._vao),this._readyController=t(this._readyController)}when(){return this._readyResolver.promise}initializeRenderContext(e){this._techniqueConfig.geometry=p.Cylinder,this._technique=e.shaderTechniqueRepository.acquire(l,this._techniqueConfig);const r=e.renderContext.rctx;this._vao=this._createVertexArrayObject(r),this._vaoCount=T(this._vao,\"geometry\"),n(c,{signal:this._readyController.signal}).then((t=>{this._passParameters.texture=new C(r,{pixelFormat:y.RGBA,dataType:j.UNSIGNED_BYTE,wrapMode:v.CLAMP_TO_EDGE,samplingMode:x.LINEAR,flipped:!0},t),e.requestRender(),this._readyController=null,this._readyResolver.resolve()})).catch((e=>{s(e)||q.error(\"Unable to initialize atmosphere: image request failed\",e),this._readyResolver.reject()}))}get canRender(){return null!=this._passParameters.texture}render(e){const r=e.rctx,t=r.bindTechnique(this._technique,this._passParameters,e.bindParameters);I(O,e.bindParameters.camera.viewMatrix),t.setUniformMatrix4fv(\"view\",O),r.bindVAO(this._vao),t.assertCompatibleVertexAttributeLocations(this._vao),r.drawArrays(A.TRIANGLES,0,this._vaoCount)}renderHaze(){return!1}_createVertexArrayObject(e){const r=_.createPolySphereGeometry(1,2,!1),t=r.indices.get(d.POSITION);for(let a=0;a<t.length;a+=3){const e=t[a];t[a]=t[a+2],t[a+2]=e}const o=r.vertexAttributes.get(d.POSITION).data,s=S.createBuffer(t.length),i=s.position;for(let a=0;a<t.length;++a){const e=3*t[a];i.set(a,0,o[e]),i.set(a,1,o[e+1]),i.set(a,2,o[e+2])}return new P(e,g,{geometry:u(S)},{geometry:b.createVertex(e,w.STATIC_DRAW,s.buffer)})}}function I(e,r){i(e,r),e[12]=0,e[13]=0,e[14]=0,e[15]=1}const O=a(),S=f().vec3f(d.POSITION);export{R as PanoramicAtmosphere};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}