{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { clamp as t } from \"../../../../core/mathUtils.js\";\nimport { watch as r } from \"../../../../core/reactiveUtils.js\";\nimport { createRenderScreenPointArray3 as o } from \"../../../../core/screenUtils.js\";\nimport { property as s } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as i } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { e as n, z as a, c, h as d, b as p, n as l } from \"../../../../chunks/vec3.js\";\nimport { c as h } from \"../../../../chunks/vec3f64.js\";\nimport u from \"../../../../geometry/Point.js\";\nimport { wrap as m } from \"../../../../geometry/support/ray.js\";\nimport { PropertiesPool as f } from \"../PropertiesPool.js\";\nimport { PointOfInterest as y } from \"./PointOfInterest.js\";\nimport { PaddingSide as g } from \"../../webgl-engine/lib/Camera.js\";\nimport { TaskPriority as _ } from \"../../../support/Scheduler.js\";\nconst O = Array;\nlet j = class extends y {\n  constructor(e) {\n    super(e), this._propertiesPool = new f({\n      location: u,\n      renderLocation: O\n    }, this), this._dirty = !0, this.renderLocation = this._propertiesPool.get(\"renderLocation\");\n  }\n\n  initialize() {\n    this.handles.add([r(() => this.centerOnSurface.renderLocation, () => this.updateRenderLocation()), r(() => this.state.contentCamera, () => this.updateRenderLocation())]), this.scheduler && this.handles.add(this.scheduler.registerTask(_.POINT_OF_INTEREST_FREQUENT, this));\n  }\n\n  destroy() {\n    this._propertiesPool.destroy(), this._propertiesPool = null;\n  }\n\n  get updating() {\n    return this._dirty || this.centerOnSurface.updating;\n  }\n\n  get location() {\n    const e = this._propertiesPool.get(\"location\");\n\n    return this.renderCoordsHelper.fromRenderCoords(this.renderLocation, e, this.state.spatialReference), e;\n  }\n\n  get running() {\n    return this._dirty;\n  }\n\n  runTask() {\n    const e = this._get(\"renderLocation\"),\n          r = this.centerOnSurface.renderLocation,\n          o = this.renderCoordsHelper,\n          s = this.state.contentCamera;\n\n    this._dirty = !1, o.worldUpAtPosition(r, P);\n    const i = Math.max(0, (Math.acos(n(P, s.viewForward)) - .5 * Math.PI) * (s.aboveGround ? 1 : -1));\n\n    if (Number.isNaN(i)) {\n      if (!e || !a(e, r)) {\n        const e = this._propertiesPool.get(\"renderLocation\");\n\n        c(e, r), this._set(\"renderLocation\", e);\n      }\n\n      return;\n    }\n\n    const p = 1 - t(i / (.5 * Math.PI), 0, 1),\n          l = p * p * p;\n\n    this._calculateScreenHorizontalEdgeOnSurface(L);\n\n    const h = this._propertiesPool.get(\"renderLocation\");\n\n    d(h, r, L, l), e && a(e, h) || this._set(\"renderLocation\", h);\n  }\n\n  _calculateScreenHorizontalEdgeOnSurface(e) {\n    const t = this.state.contentCamera,\n          r = t.getRenderCenter(o());\n    if (r[1] = t.aboveGround ? t.padding[g.BOTTOM] : t.fullHeight - t.padding[g.TOP], this.estimateSurfaceIntersectionAtRenderPoint(r, e)) return e;\n    const s = this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);\n\n    if (t.unprojectFromRenderScreen(r, S)) {\n      p(S, S, t.eye);\n      const r = l(S, S);\n      if (this.renderCoordsHelper.intersectManifold(m(t.eye, r), s, e)) return e;\n    }\n\n    return this.renderCoordsHelper.setAltitude(e, s, t.eye);\n  }\n\n  updateRenderLocation() {\n    this._dirty = !0;\n  }\n\n};\ne([s()], j.prototype, \"_dirty\", void 0), e([s({\n  constructOnly: !0\n})], j.prototype, \"scheduler\", void 0), e([s({\n  constructOnly: !0\n})], j.prototype, \"centerOnSurface\", void 0), e([s({\n  constructOnly: !0\n})], j.prototype, \"estimateSurfaceIntersectionAtRenderPoint\", void 0), e([s({\n  readOnly: !0\n})], j.prototype, \"updating\", null), e([s({\n  readOnly: !0\n})], j.prototype, \"location\", null), e([s({\n  readOnly: !0\n})], j.prototype, \"renderLocation\", void 0), j = e([i(\"esri.views.3d.support.CenterOnSurface\")], j);\nconst P = h(),\n      S = h(),\n      L = h();\nexport { j as Focus };","map":{"version":3,"names":["_","e","clamp","t","watch","r","createRenderScreenPointArray3","o","property","s","subclass","i","n","z","a","c","h","d","b","p","l","u","wrap","m","PropertiesPool","f","PointOfInterest","y","PaddingSide","g","TaskPriority","O","Array","j","constructor","_propertiesPool","location","renderLocation","_dirty","get","initialize","handles","add","centerOnSurface","updateRenderLocation","state","contentCamera","scheduler","registerTask","POINT_OF_INTEREST_FREQUENT","destroy","updating","renderCoordsHelper","fromRenderCoords","spatialReference","running","runTask","_get","worldUpAtPosition","P","Math","max","acos","viewForward","PI","aboveGround","Number","isNaN","_set","_calculateScreenHorizontalEdgeOnSurface","L","getRenderCenter","padding","BOTTOM","fullHeight","TOP","estimateSurfaceIntersectionAtRenderPoint","getAltitude","unprojectFromRenderScreen","S","eye","intersectManifold","setAltitude","prototype","constructOnly","readOnly","Focus"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/support/pointsOfInterest/Focus.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{clamp as t}from\"../../../../core/mathUtils.js\";import{watch as r}from\"../../../../core/reactiveUtils.js\";import{createRenderScreenPointArray3 as o}from\"../../../../core/screenUtils.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{e as n,z as a,c,h as d,b as p,n as l}from\"../../../../chunks/vec3.js\";import{c as h}from\"../../../../chunks/vec3f64.js\";import u from\"../../../../geometry/Point.js\";import{wrap as m}from\"../../../../geometry/support/ray.js\";import{PropertiesPool as f}from\"../PropertiesPool.js\";import{PointOfInterest as y}from\"./PointOfInterest.js\";import{PaddingSide as g}from\"../../webgl-engine/lib/Camera.js\";import{TaskPriority as _}from\"../../../support/Scheduler.js\";const O=Array;let j=class extends y{constructor(e){super(e),this._propertiesPool=new f({location:u,renderLocation:O},this),this._dirty=!0,this.renderLocation=this._propertiesPool.get(\"renderLocation\")}initialize(){this.handles.add([r((()=>this.centerOnSurface.renderLocation),(()=>this.updateRenderLocation())),r((()=>this.state.contentCamera),(()=>this.updateRenderLocation()))]),this.scheduler&&this.handles.add(this.scheduler.registerTask(_.POINT_OF_INTEREST_FREQUENT,this))}destroy(){this._propertiesPool.destroy(),this._propertiesPool=null}get updating(){return this._dirty||this.centerOnSurface.updating}get location(){const e=this._propertiesPool.get(\"location\");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get running(){return this._dirty}runTask(){const e=this._get(\"renderLocation\"),r=this.centerOnSurface.renderLocation,o=this.renderCoordsHelper,s=this.state.contentCamera;this._dirty=!1,o.worldUpAtPosition(r,P);const i=Math.max(0,(Math.acos(n(P,s.viewForward))-.5*Math.PI)*(s.aboveGround?1:-1));if(Number.isNaN(i)){if(!e||!a(e,r)){const e=this._propertiesPool.get(\"renderLocation\");c(e,r),this._set(\"renderLocation\",e)}return}const p=1-t(i/(.5*Math.PI),0,1),l=p*p*p;this._calculateScreenHorizontalEdgeOnSurface(L);const h=this._propertiesPool.get(\"renderLocation\");d(h,r,L,l),e&&a(e,h)||this._set(\"renderLocation\",h)}_calculateScreenHorizontalEdgeOnSurface(e){const t=this.state.contentCamera,r=t.getRenderCenter(o());if(r[1]=t.aboveGround?t.padding[g.BOTTOM]:t.fullHeight-t.padding[g.TOP],this.estimateSurfaceIntersectionAtRenderPoint(r,e))return e;const s=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);if(t.unprojectFromRenderScreen(r,S)){p(S,S,t.eye);const r=l(S,S);if(this.renderCoordsHelper.intersectManifold(m(t.eye,r),s,e))return e}return this.renderCoordsHelper.setAltitude(e,s,t.eye)}updateRenderLocation(){this._dirty=!0}};e([s()],j.prototype,\"_dirty\",void 0),e([s({constructOnly:!0})],j.prototype,\"scheduler\",void 0),e([s({constructOnly:!0})],j.prototype,\"centerOnSurface\",void 0),e([s({constructOnly:!0})],j.prototype,\"estimateSurfaceIntersectionAtRenderPoint\",void 0),e([s({readOnly:!0})],j.prototype,\"updating\",null),e([s({readOnly:!0})],j.prototype,\"location\",null),e([s({readOnly:!0})],j.prototype,\"renderLocation\",void 0),j=e([i(\"esri.views.3d.support.CenterOnSurface\")],j);const P=h(),S=h(),L=h();export{j as Focus};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}