{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport \"../../../../geometry.js\";\nimport { remove as e } from \"../../../../core/arrayUtils.js\";\nimport { isSome as t } from \"../../../../core/maybe.js\";\nimport { onAbort as r, createAbortError as s } from \"../../../../core/promiseUtils.js\";\nimport { TaskPriority as i } from \"../../../support/Scheduler.js\";\nimport o from \"../../../../geometry/Multipoint.js\";\n\nclass n {\n  constructor(e, t) {\n    this.spatialReference = e, this.view = t;\n  }\n\n  getElevation(e, t, r) {\n    return this.view.elevationProvider.getElevation(e, t, 0, this.spatialReference, r);\n  }\n\n  async queryElevation(e, t, r, s, i) {\n    return this.view.elevationProvider.queryElevation(e, t, 0, this.spatialReference, i, r, s);\n  }\n\n}\n\nclass a {\n  constructor(e, t, r, s) {\n    this.spatialReference = t, this._getElevationQueryProvider = r, this._queries = new Array(), this._queryOptions = { ...s,\n      ignoreInvisibleLayers: !0\n    }, this._frameTask = e.registerTask(i.ELEVATION_QUERY, this);\n  }\n\n  destroy() {\n    this._frameTask.remove();\n  }\n\n  queryElevation(t, i, o, n = 0) {\n    return new Promise((a, l) => {\n      const u = {\n        x: t,\n        y: i,\n        minDemResolution: n,\n        result: {\n          resolve: a,\n          reject: l\n        },\n        signal: o\n      };\n      this._queries.push(u), r(o, () => {\n        e(this._queries, u), l(s());\n      });\n    });\n  }\n\n  get running() {\n    return this._queries.length > 0;\n  }\n\n  runTask() {\n    const e = this._queries;\n    this._queries = [];\n\n    const i = this._getElevationQueryProvider();\n\n    if (!i) return void e.forEach(e => e.result.reject());\n    const n = e.map(e => [e.x, e.y]),\n          a = e.reduce((e, t) => Math.min(e, t.minDemResolution), 1 / 0),\n          l = new o({\n      points: n,\n      spatialReference: this.spatialReference\n    }),\n          u = e.length > 1 && e.some(e => !!e.signal) ? new AbortController() : null,\n          c = t(u) ? u.signal : e[0].signal;\n\n    if (t(u)) {\n      let t = 0;\n      e.forEach(i => r(i.signal, () => {\n        t++, i.result.reject(s()), t === e.length && u.abort();\n      }));\n    }\n\n    const h = { ...this._queryOptions,\n      minDemResolution: a,\n      signal: c\n    };\n    i.queryElevation(l, h).then(r => {\n      e.forEach((e, i) => {\n        t(e.signal) && e.signal.aborted ? e.result.reject(s()) : e.result.resolve(r.geometry.points[i][2]);\n      });\n    }).catch(t => {\n      e.forEach(e => e.result.reject(t));\n    });\n  }\n\n  get test() {\n    const e = this;\n    return {\n      update: () => e._queries.length > 0 && e.runTask()\n    };\n  }\n\n}\n\nexport { a as ElevationQuery, n as ViewElevationProvider };","map":{"version":3,"names":["remove","e","isSome","t","onAbort","r","createAbortError","s","TaskPriority","i","o","n","constructor","spatialReference","view","getElevation","elevationProvider","queryElevation","a","_getElevationQueryProvider","_queries","Array","_queryOptions","ignoreInvisibleLayers","_frameTask","registerTask","ELEVATION_QUERY","destroy","Promise","l","u","x","y","minDemResolution","result","resolve","reject","signal","push","running","length","runTask","forEach","map","reduce","Math","min","points","some","AbortController","c","abort","h","then","aborted","geometry","catch","test","update","ElevationQuery","ViewElevationProvider"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/graphics/ElevationQuery.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import{remove as e}from\"../../../../core/arrayUtils.js\";import{isSome as t}from\"../../../../core/maybe.js\";import{onAbort as r,createAbortError as s}from\"../../../../core/promiseUtils.js\";import{TaskPriority as i}from\"../../../support/Scheduler.js\";import o from\"../../../../geometry/Multipoint.js\";class n{constructor(e,t){this.spatialReference=e,this.view=t}getElevation(e,t,r){return this.view.elevationProvider.getElevation(e,t,0,this.spatialReference,r)}async queryElevation(e,t,r,s,i){return this.view.elevationProvider.queryElevation(e,t,0,this.spatialReference,i,r,s)}}class a{constructor(e,t,r,s){this.spatialReference=t,this._getElevationQueryProvider=r,this._queries=new Array,this._queryOptions={...s,ignoreInvisibleLayers:!0},this._frameTask=e.registerTask(i.ELEVATION_QUERY,this)}destroy(){this._frameTask.remove()}queryElevation(t,i,o,n=0){return new Promise(((a,l)=>{const u={x:t,y:i,minDemResolution:n,result:{resolve:a,reject:l},signal:o};this._queries.push(u),r(o,(()=>{e(this._queries,u),l(s())}))}))}get running(){return this._queries.length>0}runTask(){const e=this._queries;this._queries=[];const i=this._getElevationQueryProvider();if(!i)return void e.forEach((e=>e.result.reject()));const n=e.map((e=>[e.x,e.y])),a=e.reduce(((e,t)=>Math.min(e,t.minDemResolution)),1/0),l=new o({points:n,spatialReference:this.spatialReference}),u=e.length>1&&e.some((e=>!!e.signal))?new AbortController:null,c=t(u)?u.signal:e[0].signal;if(t(u)){let t=0;e.forEach((i=>r(i.signal,(()=>{t++,i.result.reject(s()),t===e.length&&u.abort()}))))}const h={...this._queryOptions,minDemResolution:a,signal:c};i.queryElevation(l,h).then((r=>{e.forEach(((e,i)=>{t(e.signal)&&e.signal.aborted?e.result.reject(s()):e.result.resolve(r.geometry.points[i][2])}))})).catch((t=>{e.forEach((e=>e.result.reject(t)))}))}get test(){const e=this;return{update:()=>e._queries.length>0&&e.runTask()}}}export{a as ElevationQuery,n as ViewElevationProvider};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}