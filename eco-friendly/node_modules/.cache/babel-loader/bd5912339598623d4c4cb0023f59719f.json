{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../core/Evented.js\";\nimport { clone as s } from \"../../core/lang.js\";\nimport \"../../core/Logger.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Error.js\";\nimport \"../../core/has.js\";\nimport { subclass as r } from \"../../core/accessorSupport/decorators/subclass.js\";\nconst d = new t.EventEmitter(),\n      i = \"esri.layers.mixins.EditBusLayer\",\n      l = Symbol(i);\n\nfunction o(e) {\n  return null != e && \"object\" == typeof e && l in e;\n}\n\nconst a = t => {\n  var o;\n  let a = class extends t {\n    constructor(...e) {\n      super(...e), this[o] = !0, this.when().then(() => {\n        this.own([d.on(\"edits\", e => {\n          const t = \"layer\" in e ? e.layer : null,\n                r = \"layer\" in e ? e.layer?.url : e.serviceUrl,\n                d = \"layer\" in e ? e.layer?.layerId : e.layerId,\n                i = e.event;\n          if (t === this || r !== this.url) return;\n          if (null != d && null != this.layerId && d === this.layerId) return void this.emit(\"edits\", s(i));\n          const l = i.editedFeatures?.find(({\n            layerId: e\n          }) => e === this.layerId);\n\n          if (l) {\n            const {\n              adds: e,\n              updates: t,\n              deletes: r\n            } = l.editedFeatures,\n                  d = {\n              edits: null,\n              addedAttachments: [],\n              deletedAttachments: [],\n              updatedAttachments: [],\n              addedFeatures: e ? e.map(({\n                attributes: e\n              }) => ({\n                objectId: this.objectIdField && e[this.objectIdField],\n                globalId: this.globalIdField && e[this.globalIdField]\n              })) : [],\n              deletedFeatures: r ? r.map(({\n                attributes: e\n              }) => ({\n                objectId: this.objectIdField && e[this.objectIdField],\n                globalId: this.globalIdField && e[this.globalIdField]\n              })) : [],\n              updatedFeatures: t ? t.map(({\n                current: {\n                  attributes: e\n                }\n              }) => ({\n                objectId: this.objectIdField && e[this.objectIdField],\n                globalId: this.globalIdField && e[this.globalIdField]\n              })) : [],\n              editedFeatures: s(i.editedFeatures)\n            };\n            this.emit(\"edits\", d);\n          }\n        })]);\n      }, () => {});\n    }\n\n  };\n  return o = l, a = e([r(i)], a), a;\n};\n\nexport { a as EditBusLayer, d as editEventBus, o as isEditBusLayer };","map":{"version":3,"names":["_","e","t","clone","s","subclass","r","d","EventEmitter","i","l","Symbol","o","a","constructor","when","then","own","on","layer","url","serviceUrl","layerId","event","emit","editedFeatures","find","adds","updates","deletes","edits","addedAttachments","deletedAttachments","updatedAttachments","addedFeatures","map","attributes","objectId","objectIdField","globalId","globalIdField","deletedFeatures","updatedFeatures","current","EditBusLayer","editEventBus","isEditBusLayer"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/mixins/EditBusLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Evented.js\";import{clone as s}from\"../../core/lang.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Error.js\";import\"../../core/has.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";const d=new t.EventEmitter,i=\"esri.layers.mixins.EditBusLayer\",l=Symbol(i);function o(e){return null!=e&&\"object\"==typeof e&&l in e}const a=t=>{var o;let a=class extends t{constructor(...e){super(...e),this[o]=!0,this.when().then((()=>{this.own([d.on(\"edits\",(e=>{const t=\"layer\"in e?e.layer:null,r=\"layer\"in e?e.layer?.url:e.serviceUrl,d=\"layer\"in e?e.layer?.layerId:e.layerId,i=e.event;if(t===this||r!==this.url)return;if(null!=d&&null!=this.layerId&&d===this.layerId)return void this.emit(\"edits\",s(i));const l=i.editedFeatures?.find((({layerId:e})=>e===this.layerId));if(l){const{adds:e,updates:t,deletes:r}=l.editedFeatures,d={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:e?e.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],deletedFeatures:r?r.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],updatedFeatures:t?t.map((({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],editedFeatures:s(i.editedFeatures)};this.emit(\"edits\",d)}}))])}),(()=>{}))}};return o=l,a=e([r(i)],a),a};export{a as EditBusLayer,d as editEventBus,o as isEditBusLayer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}