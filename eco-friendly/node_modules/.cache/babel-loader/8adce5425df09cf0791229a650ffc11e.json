{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../AggregateGraphic.js\";\nimport \"../../../geometry.js\";\nimport r from \"../../../Graphic.js\";\nimport i from \"../../../core/Collection.js\";\nimport s from \"../../../core/Error.js\";\nimport has from \"../../../core/has.js\";\nimport { clone as a } from \"../../../core/lang.js\";\nimport n from \"../../../core/Logger.js\";\nimport { applySome as o, isSome as l, unwrap as u, isNone as h } from \"../../../core/maybe.js\";\nimport { debounce as d, isAbortError as p } from \"../../../core/promiseUtils.js\";\nimport { watch as c, whenOnce as y, syncAndInitial as g, initial as f } from \"../../../core/reactiveUtils.js\";\nimport { property as m } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as _ } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport v from \"../../../layers/effects/FeatureEffectView.js\";\nimport b from \"../../../layers/support/FeatureFilter.js\";\nimport R from \"../../../rest/support/AggregateFeatureSet.js\";\nimport S from \"../../../rest/support/FeatureSet.js\";\nimport w from \"../../../rest/support/Query.js\";\nimport { MAX_FILTERS as x } from \"../engine/webgl/definitions.js\";\nimport { LayerView2DMixin as U } from \"./LayerView2D.js\";\nimport { createSchema as C } from \"./features/schemaUtils.js\";\nimport { createOrReuseTileRenderer as F } from \"./features/tileRenderers.js\";\nimport { isRendererSupported as q } from \"./features/support/rendererUtils.js\";\nimport { findSizeVV as I, createClusterCountSizeVariable as O, injectDynamicLevelDependentSizeVisualVariable as E, isClusterCompatibleRenderer as T, createClusterRenderer as V } from \"./support/clusterUtils.js\";\nimport j from \"./support/FeatureCommandQueue.js\";\nimport A from \"./support/FeatureLayerProxy.js\";\nimport { toJSONGeometryType as Q } from \"./support/util.js\";\nimport { TileManager as k } from \"../tiling/TileManager.js\";\nimport L from \"../../layers/FeatureLayerView.js\";\nimport N from \"../../layers/LayerView.js\";\nimport z from \"../../layers/RefreshableLayerView.js\";\nimport { getWebGLCapabilities as P } from \"../../webgl/capabilities.js\";\nimport H from \"../../../geometry/Extent.js\";\n\nfunction J(e) {\n  return e && \"openPorts\" in e;\n}\n\nlet M = class extends L(z(U(N))) {\n  constructor() {\n    super(...arguments), this._pipelineIsUpdating = !0, this._commandsQueue = new j({\n      process: e => {\n        switch (e.type) {\n          case \"processed-edit\":\n            return this._doEdit(e);\n\n          case \"refresh\":\n            return this._doRefresh(e.dataChanged);\n\n          case \"update\":\n            return this._doUpdate();\n        }\n      }\n    }), this._visibilityOverrides = new Set(), this._highlightIds = new Map(), this._updateHighlight = d(async () => this._proxy.setHighlight(Array.from(this._highlightIds.keys()))), this._uploadsLocked = !1, this._needsClusterSizeUpdate = !1, this.featureEffectView = new v(), this._lastDefinitionExpression = null;\n  }\n\n  destroy() {\n    o(this._updateClusterSizeTask, e => e.remove()), this._proxy?.destroy(), this._commandsQueue.destroy();\n  }\n\n  initialize() {\n    this.addResolvingPromise(Promise.all([this._initProxy(), this._initServiceOptions()])), this.handles.add([this.on(\"valueRangesChanged\", e => {\n      this._set(\"_aggregateValueRanges\", e.valueRanges);\n    }), c(() => this.featureEffect, e => {\n      this.featureEffectView.featureEffect = e;\n    }, g)]), this.featureEffectView.endTransitions();\n  }\n\n  async _initProxy() {\n    const e = this.layer;\n    if (\"isTable\" in e && e.isTable) throw new s(\"featurelayerview:table-not-supported\", \"table feature layer can't be displayed\", {\n      layer: this.layer\n    });\n    const t = \"feature\" === e.type || \"subtype-group\" === e.type,\n          r = \"capabilities\" in e && e.capabilities.operations.supportsQuery;\n    if (t && !r) throw new s(\"featurelayerview:query-not-supported\", \"layer view requires a layer with query capability\", {\n      layer: e\n    });\n    this._proxy && this._proxy.destroy();\n\n    const i = this._createClientOptions();\n\n    return this._set(\"_proxy\", new A({\n      client: i\n    })), this._proxy.when();\n  }\n\n  async _initServiceOptions() {\n    return this._set(\"_serviceOptions\", await this._createServiceOptions()), this._serviceOptions;\n  }\n\n  get orderByFields() {\n    return \"stream\" !== this._serviceOptions.type && this._serviceOptions.orderByFields;\n  }\n\n  get labelsVisible() {\n    const e = \"subtype-group\" === this.layer.type ? this.layer.sublayers.items : [this.layer];\n    return !this.suspended && e.some(e => e.labelingInfo && e.labelsVisible);\n  }\n\n  get queryMode() {\n    return this._serviceOptions.type;\n  }\n\n  get renderingConfigHash() {\n    if (!this.layer) return null;\n    const e = this.availableFields,\n          t = this.layer,\n          r = this.view.floors,\n          {\n      definitionExpression: i\n    } = t,\n          s = \"subtype-group\" !== this.layer.type && this.layer.labelsVisible && this.layer.labelingInfo,\n          a = \"renderer\" in t && t.renderer,\n          n = \"gdbVersion\" in t ? t.gdbVersion : void 0,\n          o = \"historicMoment\" in t ? t.historicMoment?.getTime() : void 0,\n          {\n      timeExtent: u\n    } = this,\n          h = \"customParameters\" in t ? JSON.stringify(t.customParameters) : void 0,\n          d = \"apiKey\" in t ? t.apiKey : void 0,\n          p = \"stream\" === t.type ? `${JSON.stringify(t.geometryDefinition)}${t.definitionExpression}` : null,\n          c = JSON.stringify(this.clips),\n          y = \"featureReduction\" in t ? t.featureReduction?.toJSON() : null,\n          g = \"orderBy\" in this.layer && JSON.stringify(this.layer.orderBy),\n          f = \"sublayers\" in this.layer && this.layer.sublayers.items.reduce((e, t) => e + `${t.visible ? 1 : 0}.${JSON.stringify(t.renderer)}.${t.labelsVisible}\\n.${JSON.stringify(t.labelingInfo)}`, \"\"),\n          m = \"subtypeCode\" in this.layer && this.layer.subtypeCode;\n    return JSON.stringify({\n      orderBy: g,\n      sublayerHash: f,\n      subtypeCode: m,\n      filterHash: l(this.filter) && this.filter.toJSON(),\n      effectHash: l(this.featureEffect) && this.featureEffect.toJSON(),\n      streamFilter: p,\n      gdbVersion: n,\n      definitionExpression: i,\n      historicMoment: o,\n      availableFields: e,\n      renderer: a,\n      labelingInfo: s,\n      timeExtent: u,\n      floors: r,\n      clipsHash: c,\n      featureReduction: y,\n      customParameters: h,\n      apiKey: d\n    });\n  }\n\n  highlight(e) {\n    let t;\n    return e instanceof r ? t = [e.getObjectId()] : \"number\" == typeof e || \"string\" == typeof e ? t = [e] : i.isCollection(e) && e.length > 0 ? t = e.map(e => e?.getObjectId()).toArray() : Array.isArray(e) && e.length > 0 && (t = \"number\" == typeof e[0] || \"string\" == typeof e[0] ? e : e.map(e => e?.getObjectId())), t = t?.filter(e => null != e), t && t.length ? (this._addHighlight(t), {\n      remove: () => this._removeHighlight(t)\n    }) : {\n      remove: () => {}\n    };\n  }\n\n  hasHighlight() {\n    return !!this._highlightIds.size;\n  }\n\n  async hitTest(e, i) {\n    if (!this.tileRenderer) return null;\n    const s = await this.tileRenderer.hitTest(i);\n    if (0 === s.length) return null;\n    const {\n      features: a,\n      aggregates: n\n    } = await this._proxy.getFeatures(s);\n    return [...n.map(r => this._createGraphicHit(e, t.fromJSON(r))), ...a.map(t => this._createGraphicHit(e, r.fromJSON(t)))];\n  }\n\n  queryStatistics() {\n    return this._proxy.queryStatistics();\n  }\n\n  async querySummaryStatistics(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.querySummaryStatistics(this._cleanUpQuery(e), i, r);\n  }\n\n  async queryAggregateSummaryStatistics(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryAggregateSummaryStatistics(this._cleanUpAggregateQuery(e), i, r);\n  }\n\n  async queryUniqueValues(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryUniqueValues(this._cleanUpQuery(e), i, r);\n  }\n\n  async queryAggregateUniqueValues(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryAggregateUniqueValues(this._cleanUpAggregateQuery(e), i, r);\n  }\n\n  async queryClassBreaks(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryClassBreaks(this._cleanUpQuery(e), i, r);\n  }\n\n  async queryAggregateClassBreaks(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryAggregateClassBreaks(this._cleanUpAggregateQuery(e), i, r);\n  }\n\n  async queryHistogram(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryHistogram(this._cleanUpQuery(e), i, r);\n  }\n\n  async queryAggregateHistogram(e, t, r) {\n    const i = { ...t,\n      scale: this.view.scale\n    };\n    return this._proxy.queryAggregateHistogram(this._cleanUpAggregateQuery(e), i, r);\n  }\n\n  queryFeatures(e, t) {\n    return this.queryFeaturesJSON(e, t).then(e => {\n      const t = S.fromJSON(e);\n      return t.features.forEach(e => this._setLayersForFeature(e)), t;\n    });\n  }\n\n  queryVisibleFeatures(e, t) {\n    return this._proxy.queryVisibleFeatures(this._cleanUpQuery(e), t).then(e => {\n      const t = S.fromJSON(e);\n      return t.features.forEach(e => this._setLayersForFeature(e)), t;\n    });\n  }\n\n  async queryAggregates(e, t) {\n    const r = await this._proxy.queryAggregates(this._cleanUpAggregateQuery(e), t),\n          i = R.fromJSON(r);\n    return i.features.forEach(e => this._setLayersForFeature(e)), i;\n  }\n\n  queryAggregateIds(e, t) {\n    return this._proxy.queryAggregateIds(this._cleanUpAggregateQuery(e), t);\n  }\n\n  queryAggregateCount(e, t) {\n    return this._proxy.queryAggregateCount(this._cleanUpAggregateQuery(e), t);\n  }\n\n  queryAggregateJSON(e, t) {\n    return this._proxy.queryAggregates(this._cleanUpAggregateQuery(e), t);\n  }\n\n  queryFeaturesJSON(e, t) {\n    return this._proxy.queryFeatures(this._cleanUpQuery(e), t);\n  }\n\n  queryObjectIds(e, t) {\n    return this._proxy.queryObjectIds(this._cleanUpQuery(e), t);\n  }\n\n  queryFeatureCount(e, t) {\n    return this._proxy.queryFeatureCount(this._cleanUpQuery(e), t);\n  }\n\n  queryExtent(e, t) {\n    return this._proxy.queryExtent(this._cleanUpQuery(e), t).then(e => ({\n      count: e.count,\n      extent: H.fromJSON(e.extent)\n    }));\n  }\n\n  setVisibility(e, t) {\n    t ? this._visibilityOverrides.delete(e) : this._visibilityOverrides.add(e), this._update();\n  }\n\n  update(e) {\n    if (!this._tileStrategy || !this.tileRenderer) return;\n\n    const {\n      hasMissingTiles: t,\n      added: r,\n      removed: i\n    } = this._tileStrategy.update(e);\n\n    (r.length || i.length) && this._proxy.updateTiles({\n      added: r,\n      removed: i\n    }), t && this.requestUpdate(), this.notifyChange(\"updating\");\n  }\n\n  attach() {\n    this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`), this._tileStrategy = new k({\n      acquireTile: e => this._acquireTile(e),\n      releaseTile: e => this._releaseTile(e),\n      tileInfoView: this.view.featuresTilingScheme,\n      buffer: 0\n    }), this.handles.add(c(() => this.renderingConfigHash, () => this._update(), f), \"attach\"), \"stream\" !== this.layer.type && this.handles.add(this.layer.on(\"edits\", e => this._edit(e)), \"attach\");\n  }\n\n  detach() {\n    this._commandsQueue.clear(), this._proxy?.stop(), this.container.removeAllChildren(), this.handles.remove(\"attach\"), this.tileRenderer && (this.tileRenderer.uninstall(this.container), this.tileRenderer = null), this._tileStrategy && (this._tileStrategy.destroy(), this._tileStrategy = null), this._tileRendererHash = null;\n  }\n\n  moveStart() {\n    this.requestUpdate();\n  }\n\n  viewChange() {\n    this.requestUpdate();\n  }\n\n  moveEnd() {\n    this.requestUpdate();\n  }\n\n  isUpdating() {\n    const e = \"renderer\" in this.layer && null != this.layer.renderer,\n          t = this._commandsQueue.updating,\n          r = null != this._updatingRequiredFieldsPromise,\n          i = !this._proxy || !this._proxy.isReady,\n          s = this._pipelineIsUpdating,\n          a = null == this.tileRenderer || this.tileRenderer?.updating,\n          n = e && (t || r || i || s || a);\n    return has(\"esri-2d-log-updating\") && console.log(`Updating FLV2D: ${n}\\n  -> hasRenderer ${e}\\n  -> hasPendingCommand ${t}\\n  -> updatingRequiredFields ${r}\\n  -> updatingProxy ${i}\\n  -> updatingPipeline ${s}\\n  -> updatingTileRenderer ${a}\\n`), n;\n  }\n\n  _createClientOptions() {\n    return {\n      setUpdating: e => {\n        this._set(\"_pipelineIsUpdating\", e);\n      },\n      emitEvent: e => {\n        this.emit(e.name, e.event);\n      }\n    };\n  }\n\n  async _detectQueryMode(e) {\n    const t = (\"path\" in e),\n          r = \"editingInfo\" in this.layer && this.layer.editingInfo?.lastEditDate,\n          i = !!this.layer.refreshInterval,\n          s = !r && i;\n    if (t && (\"feature\" === this.layer.type || \"subtype-group\" === this.layer.type) && \"point\" === this.layer.geometryType && this.layer.capabilities.query.supportsPagination && !this.layer.capabilities.operations.supportsEditing && !s && has(\"featurelayer-snapshot-enabled\")) try {\n      const e = await this.layer.queryFeatureCount();\n      if (e <= has(\"featurelayer-snapshot-point-min-threshold\")) return {\n        mode: \"snapshot\",\n        featureCount: e\n      };\n      const t = has(\"featurelayer-snapshot-point-max-threshold\"),\n            r = has(\"featurelayer-snapshot-point-coverage\"),\n            i = this.view.extent,\n            s = u(this.layer.fullExtent),\n            a = s?.clone().intersection(i),\n            n = l(a) ? a.width * a.height : 0,\n            o = s?.width * s?.height,\n            h = 0 === o ? 0 : n / o;\n      if (e <= t && h >= r) return {\n        mode: \"snapshot\",\n        featureCount: e\n      };\n    } catch (a) {\n      n.getLogger(this.declaredClass).warn(\"mapview-feature-layer\", \"Encountered an error when querying for featureCount\", {\n        error: a\n      });\n    }\n    return {\n      mode: \"on-demand\"\n    };\n  }\n\n  async _createServiceOptions() {\n    const e = this.layer;\n    if (\"stream\" === e.type) return null;\n    const {\n      capabilities: t,\n      objectIdField: r\n    } = e,\n          i = e.fields.map(e => e.toJSON()),\n          s = l(e.fullExtent) && e.fullExtent.toJSON(),\n          n = Q(e.geometryType),\n          o = e.timeInfo && e.timeInfo.toJSON() || null,\n          u = e.spatialReference ? e.spatialReference.toJSON() : null,\n          h = \"feature\" === e.type ? e.globalIdField : null;\n    let d;\n    \"ogc-feature\" === e.type ? d = e.source.getSource() : J(e.source) ? d = await e.source.openPorts() : e.parsedUrl && (d = a(e.parsedUrl), \"dynamicDataSource\" in e && e.dynamicDataSource && (d.query = {\n      layer: JSON.stringify({\n        source: e.dynamicDataSource\n      })\n    }));\n    const p = \"datesInUnknownTimezone\" in this.layer && this.layer.datesInUnknownTimezone,\n          c = (\"subtypeField\" in this.layer && this.layer.subtypeField) ?? null,\n          {\n      mode: y,\n      featureCount: g\n    } = await this._detectQueryMode(d);\n    let f = this.layer.objectIdField;\n\n    if (\"feature\" === this.layer.type && l(this.layer.orderBy) && this.layer.orderBy.length) {\n      const e = !this.layer.orderBy[0].valueExpression && this.layer.orderBy[0].field;\n      e && (f = e);\n    }\n\n    return {\n      type: y,\n      timeReferenceUnknownClient: p,\n      subtypeField: c,\n      featureCount: g,\n      globalIdField: h,\n      maxRecordCount: t.query.maxRecordCount,\n      tileMaxRecordCount: t.query.tileMaxRecordCount,\n      capabilities: t,\n      fields: i,\n      fullExtent: s,\n      geometryType: n,\n      objectIdField: r,\n      source: d,\n      timeInfo: o,\n      spatialReference: u,\n      orderByFields: f\n    };\n  }\n\n  async _createMemoryServiceOptions(e) {\n    const t = await e.openPorts();\n    return { ...this._createServiceOptions(),\n      type: \"memory\",\n      source: t\n    };\n  }\n\n  _cleanUpQuery(e) {\n    const t = w.from(e) || this.createQuery();\n    return t.outSpatialReference || (t.outSpatialReference = this.view.spatialReference), t;\n  }\n\n  _cleanUpAggregateQuery(e) {\n    const t = w.from(e) || this.createAggregateQuery();\n    return t.outSpatialReference || (t.outSpatialReference = this.view.spatialReference), t;\n  }\n\n  async _update() {\n    return this._commandsQueue.push({\n      type: \"update\"\n    });\n  }\n\n  async _edit(e) {\n    if (this.suspended) return void this._clearTiles();\n    return this._validateEdit(e) ? this._commandsQueue.push({\n      type: \"edit\",\n      edits: e\n    }) : void 0;\n  }\n\n  async doRefresh(e) {\n    if (this.attached && this._tileStrategy.tileKeys().length) return this.suspended && e ? void this._clearTiles() : this._commandsQueue.push({\n      type: \"refresh\",\n      dataChanged: e\n    });\n  }\n\n  _clearTiles() {\n    this._tileStrategy.tileKeys().length && (this._proxy.updateTiles({\n      added: [],\n      removed: this._tileStrategy.tileKeys()\n    }), this._tileStrategy.clear(), this.requestUpdate(), this._commandsQueue.clear(), this._update());\n  }\n\n  _validateEdit(e) {\n    const t = \"globalIdField\" in this.layer && this.layer.globalIdField,\n          r = e.deletedFeatures.some(e => -1 === e.objectId || !e.objectId),\n          i = t && this.availableFields.includes(t);\n    return r && !i ? (n.getLogger(this.declaredClass).error(new s(\"mapview-apply-edits\", `Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected on the map`)), null) : e;\n  }\n\n  async _doUpdate() {\n    try {\n      if (this.destroyed || !this._hasRequiredSupport(this.layer) || !this._tileStrategy) return;\n      const {\n        featureEffectView: t,\n        filter: r\n      } = this;\n      await this._updateRequiredFields();\n\n      const {\n        renderer: i\n      } = this._getEffectiveRenderer();\n\n      this._set(\"_effectiveRenderer\", i);\n\n      const s = this._createSchemaConfig(),\n            a = this._createConfiguration(s, r, t.filter),\n            o = this._lastDefinitionExpression !== a.schema.source.definitionExpression;\n\n      this._lastDefinitionExpression = a.schema.source.definitionExpression;\n\n      const l = a.schema.tileRenderer,\n            u = this._createTileRendererHash(l);\n\n      if (\"snapshot\" === this._serviceOptions.type && (a.schema.source.initialFeatureCount = this._serviceOptions.featureCount), u !== this._tileRendererHash) {\n        await this._initTileRenderer(l, i);\n        const e = this.layer,\n              t = \"stream\" === e.type ? await this._initServiceOptions() : this._serviceOptions;\n        this.tileRenderer.onConfigUpdate(i), \"stream\" !== e.type && J(e.source) && (t.source = await e.source.openPorts());\n        const r = {\n          added: this._tileStrategy.tileKeys(),\n          removed: []\n        };\n        await this._proxy.startup(this.view.featuresTilingScheme, a, t, r), this.hasHighlight() && (await this._proxy.setHighlight(Array.from(this._highlightIds.keys()))), await this._onceTilesUpdated(), this.tileRenderer.onConfigUpdate(i);\n      } else {\n        \"snapshot\" === this._serviceOptions.type && o && (a.schema.source.changedFeatureCount = await this.layer.queryFeatureCount());\n        const t = await this._proxy.update(a);\n        (t.mesh || t.targets.aggregate) && this._lockGPUUploads();\n\n        try {\n          await this._proxy.applyUpdate(t);\n        } catch (e) {\n          p(e) || n.getLogger(this.declaredClass).error(e);\n        }\n\n        (t.mesh || t.targets.aggregate) && this._unlockGPUUploads(), this.tileRenderer.onConfigUpdate(i), this._updateClusterSizeVariable(), this._forceAttributeTextureUpload();\n      }\n\n      this._tileRendererHash = u, this.tileRenderer.invalidateLabels(), this.requestUpdate();\n    } catch (e) {}\n  }\n\n  async _doEdit(e) {\n    try {\n      await this._proxy.onEdits(e);\n    } catch (t) {\n      p(t), 0;\n    }\n  }\n\n  async _doRefresh(e) {\n    this._lockGPUUploads();\n\n    try {\n      let t;\n      e && \"snapshot\" === this.queryMode && \"queryFeatureCount\" in this.layer && (t = await this.layer.queryFeatureCount()), await this._proxy.refresh({\n        dataChanged: e,\n        featureCount: t\n      });\n    } catch (r) {\n      p(r), 0;\n    }\n\n    this._unlockGPUUploads();\n\n    const t = this.layer;\n    t && \"featureReduction\" in t && t.featureReduction && this._updateClusterSizeVariable();\n  }\n\n  _updateClusterSizeVariable() {\n    this._needsClusterSizeUpdate && (this.tileRenderer.onConfigUpdate(this._effectiveRenderer), this._needsClusterSizeUpdate = !1);\n  }\n\n  _createUpdateClusterSizeTask(e, t) {\n    return c(() => this._aggregateValueRanges, r => {\n      this._updateClusterEffectiveRendererSizeVariable(e, t, r), this._needsClusterSizeUpdate = !0, this._uploadsLocked || this._updateClusterSizeVariable();\n    });\n  }\n\n  async _updateClusterEffectiveRendererSizeVariable(e, t, r) {\n    if (e.dynamicClusterSize && \"visualVariables\" in e && e.visualVariables) {\n      const i = I(e.visualVariables);\n\n      if (l(i) && \"cluster_count\" === i.field) {\n        const s = e.visualVariables.indexOf(i);\n        e.visualVariables[s] = O(t, r);\n        const a = e.clone();\n        a.dynamicClusterSize = !0, this._set(\"_effectiveRenderer\", a);\n      }\n    }\n  }\n\n  _getEffectiveRenderer() {\n    const e = this.layer,\n          t = \"renderer\" in e ? e.renderer : null,\n          r = \"featureReduction\" in e ? e.featureReduction : null;\n\n    if (l(this._updateClusterSizeTask) && (this._updateClusterSizeTask.remove(), this._updateClusterSizeTask = null), r && \"renderer\" in r && r.renderer && !r.renderer.authoringInfo?.isAutoGenerated) {\n      const e = r.fields;\n\n      if (\"cluster\" === r.type) {\n        const {\n          renderer: t,\n          didInject: i\n        } = E(r.renderer, r, this._aggregateValueRanges);\n        return i && (o(this._updateClusterSizeTask, e => e.remove()), this._updateClusterSizeTask = this._createUpdateClusterSizeTask(t, r)), {\n          renderer: t,\n          aggregateFields: e,\n          featureReduction: r\n        };\n      }\n\n      return {\n        renderer: r.renderer,\n        aggregateFields: e,\n        featureReduction: r\n      };\n    }\n\n    if (r && \"cluster\" === r.type && T(t)) {\n      const e = r,\n            i = [],\n            s = V(i, t, e, this._aggregateValueRanges, !0);\n      return o(this._updateClusterSizeTask, e => e.remove()), this._updateClusterSizeTask = this._createUpdateClusterSizeTask(s, e), {\n        renderer: s,\n        aggregateFields: i,\n        featureReduction: r\n      };\n    }\n\n    return {\n      renderer: t,\n      aggregateFields: [],\n      featureReduction: null\n    };\n  }\n\n  _acquireTile(e) {\n    const t = this.tileRenderer.acquireTile(e);\n    return t.once(\"attach\", () => {\n      this.requestUpdate();\n    }), t;\n  }\n\n  _releaseTile(e) {\n    this.tileRenderer.releaseTile(e);\n  }\n\n  async _initTileRenderer(e, t) {\n    const r = await F(e, {\n      layerView: this,\n      tileInfoView: this.view.featuresTilingScheme,\n      layer: this.layer\n    });\n    return this.tileRenderer && (this._tileStrategy.clear(), this.tileRenderer.uninstall(this.container), this.tileRenderer.destroy(), this.tileRenderer = null), this.destroyed ? null : (this._proxy.tileRenderer = r, this._set(\"tileRenderer\", r), this.tileRenderer.install(this.container), this.tileRenderer.onConfigUpdate(t), this.requestUpdate(), this.tileRenderer);\n  }\n\n  _createTileRendererHash(e) {\n    return `${e.type}`;\n  }\n\n  get hasFilter() {\n    const e = !!(\"floorInfo\" in this.layer && this.layer.floorInfo && this.view.floors && this.view.floors.length);\n    return !!this.filter || e || !!this._visibilityOverrides.size || !!this.timeExtent;\n  }\n\n  _injectOverrides(e) {\n    const t = l(e) ? e.timeExtent : null,\n          r = l(this.timeExtent) && l(t) ? this.timeExtent.intersection(t) : this.timeExtent || t;\n    let i = null;\n    const s = \"floorInfo\" in this.layer && this.layer.floorInfo;\n\n    if (s) {\n      const t = l(e) && e.where;\n      i = this._addFloorFilterClause(t);\n    }\n\n    if (!this._visibilityOverrides.size && !r && !s) return l(e) ? e.toJSON() : null;\n    (e = l(e) && e.clone() || new b()).timeExtent = r, i && (e.where = i);\n    const a = e.toJSON();\n    return a.hiddenIds = Array.from(this._visibilityOverrides), a;\n  }\n\n  _addFloorFilterClause(e) {\n    const t = this.layer;\n    let r = e || \"\";\n\n    if (\"floorInfo\" in t && t.floorInfo) {\n      let e = this.view.floors;\n      if (!e || !e.length) return r;\n      t.floorInfo.viewAllLevelIds?.length && (e = t.floorInfo.viewAllLevelIds);\n      const i = e.filter(e => \"\" !== e).map(e => \"'\" + e + \"'\");\n      i.push(\"''\");\n      const s = t.floorInfo.floorField;\n      let a = \"(\" + s + \" IN ({ids}) OR \" + s + \" IS NULL)\";\n\n      if (a = a.replace(\"{ids}\", i.join(\", \")), l(r) && r.includes(s)) {\n        let e = new RegExp(\"AND \\\\(\" + s + \".*NULL\\\\)\", \"g\");\n        r = r.replace(e, \"\"), e = new RegExp(\"\\\\(\" + s + \".*NULL\\\\)\", \"g\"), r = r.replace(e, \"\"), r = r.replace(/\\s+/g, \" \").trim();\n      }\n\n      r = \"\" !== r ? \"(\" + r + \") AND \" + a : a;\n    }\n\n    return \"\" !== r ? r : null;\n  }\n\n  _createConfiguration(e, t, r) {\n    const i = \"feature\" === this.layer.type && this.layer.historicMoment ? this.layer.historicMoment.getTime() : void 0,\n          s = \"feature\" === this.layer.type ? this.layer.gdbVersion : void 0,\n          a = new Array(x),\n          n = this._injectOverrides(t);\n\n    a[0] = n, a[1] = l(r) ? r.toJSON() : null;\n    const o = C(e);\n    if (h(o)) return null;\n    const u = P(\"2d\");\n    return {\n      availableFields: this.availableFields,\n      gdbVersion: s,\n      historicMoment: i,\n      devicePixelRatio: window.devicePixelRatio || 1,\n      filters: a,\n      schema: o,\n      supportsTextureFloat: u.supportsTextureFloat,\n      maxTextureSize: u.maxTextureSize\n    };\n  }\n\n  _hasRequiredSupport(e) {\n    return !(\"renderer\" in e) || q(e.renderer);\n  }\n\n  _onceTilesUpdated() {\n    return this.requestUpdate(), y(() => !this._pipelineIsUpdating);\n  }\n\n  _lockGPUUploads() {\n    this.tileRenderer && (this._uploadsLocked = !0, this.tileRenderer.lockGPUUploads());\n  }\n\n  _unlockGPUUploads() {\n    this.tileRenderer && (this._uploadsLocked = !1, this.tileRenderer.unlockGPUUploads());\n  }\n\n  _forceAttributeTextureUpload() {\n    this.tileRenderer && this.tileRenderer.forceAttributeTextureUpload();\n  }\n\n  _createSchemaConfig() {\n    const e = this.layer;\n    return {\n      renderer: \"renderer\" in e ? e.renderer : null,\n      spatialReference: e.spatialReference,\n      timeExtent: e.timeExtent,\n      definitionExpression: e.definitionExpression,\n      featureReduction: \"featureReduction\" in e ? e.featureReduction : null,\n      fields: e.fields,\n      geometryType: e.geometryType,\n      historicMoment: \"historicMoment\" in e ? e.historicMoment : null,\n      labelsVisible: \"labelsVisible\" in e && e.labelsVisible,\n      labelingInfo: \"labelingInfo\" in e && e.labelingInfo,\n      availableFields: this.availableFields,\n      featureEffect: this.featureEffect,\n      filter: this.filter,\n      gdbVersion: \"gdbVersion\" in e ? e.gdbVersion : null,\n      pixelBuffer: 0,\n      orderBy: \"orderBy\" in e && e.orderBy ? e.orderBy : null,\n      customParameters: { ...(\"customParameters\" in e ? e.customParameters : void 0),\n        token: \"apiKey\" in e ? e.apiKey : void 0\n      },\n      subtypeCode: \"subtypeCode\" in e ? e.subtypeCode : void 0,\n      subtypeField: \"subtypeField\" in e ? e.subtypeField : void 0\n    };\n  }\n\n  _addHighlight(e) {\n    for (const t of e) if (this._highlightIds.has(t)) {\n      const e = this._highlightIds.get(t);\n\n      this._highlightIds.set(t, e + 1);\n    } else this._highlightIds.set(t, 1);\n\n    this._updateHighlight().catch(e => {\n      p(e) || n.getLogger(this.declaredClass).error(e);\n    });\n  }\n\n  _removeHighlight(e) {\n    for (const t of e) if (this._highlightIds.has(t)) {\n      const e = this._highlightIds.get(t) - 1;\n      0 === e ? this._highlightIds.delete(t) : this._highlightIds.set(t, e);\n    }\n\n    this._updateHighlight().catch(e => {\n      p(e) || n.getLogger(this.declaredClass).error(e);\n    });\n  }\n\n  _setLayersForFeature(e) {\n    const t = this.layer;\n    e.layer = t, e.sourceLayer = t;\n  }\n\n  _createGraphicHit(e, t) {\n    return this._setLayersForFeature(t), l(t.geometry) && (t.geometry.spatialReference = this.view.spatialReference), {\n      type: \"graphic\",\n      graphic: t,\n      layer: this.layer,\n      mapPoint: e\n    };\n  }\n\n};\ne([m()], M.prototype, \"_serviceOptions\", void 0), e([m()], M.prototype, \"_proxy\", void 0), e([m()], M.prototype, \"_pipelineIsUpdating\", void 0), e([m()], M.prototype, \"_effectiveRenderer\", void 0), e([m()], M.prototype, \"_aggregateValueRanges\", void 0), e([m()], M.prototype, \"_commandsQueue\", void 0), e([m()], M.prototype, \"featureEffectView\", void 0), e([m()], M.prototype, \"labelsVisible\", null), e([m({\n  readOnly: !0\n})], M.prototype, \"queryMode\", null), e([m()], M.prototype, \"renderingConfigHash\", null), e([m()], M.prototype, \"tileRenderer\", void 0), e([m()], M.prototype, \"updating\", void 0), M = e([_(\"esri.views.2d.layers.FeatureLayerView2D\")], M);\nconst B = M;\nexport { B as default };","map":{"version":3,"names":["_","e","t","r","i","s","has","clone","a","n","applySome","o","isSome","l","unwrap","u","isNone","h","debounce","d","isAbortError","p","watch","c","whenOnce","y","syncAndInitial","g","initial","f","property","m","subclass","v","b","R","S","w","MAX_FILTERS","x","LayerView2DMixin","U","createSchema","C","createOrReuseTileRenderer","F","isRendererSupported","q","findSizeVV","I","createClusterCountSizeVariable","O","injectDynamicLevelDependentSizeVisualVariable","E","isClusterCompatibleRenderer","T","createClusterRenderer","V","j","A","toJSONGeometryType","Q","TileManager","k","L","N","z","getWebGLCapabilities","P","H","J","M","constructor","arguments","_pipelineIsUpdating","_commandsQueue","process","type","_doEdit","_doRefresh","dataChanged","_doUpdate","_visibilityOverrides","Set","_highlightIds","Map","_updateHighlight","_proxy","setHighlight","Array","from","keys","_uploadsLocked","_needsClusterSizeUpdate","featureEffectView","_lastDefinitionExpression","destroy","_updateClusterSizeTask","remove","initialize","addResolvingPromise","Promise","all","_initProxy","_initServiceOptions","handles","add","on","_set","valueRanges","featureEffect","endTransitions","layer","isTable","capabilities","operations","supportsQuery","_createClientOptions","client","when","_createServiceOptions","_serviceOptions","orderByFields","labelsVisible","sublayers","items","suspended","some","labelingInfo","queryMode","renderingConfigHash","availableFields","view","floors","definitionExpression","renderer","gdbVersion","historicMoment","getTime","timeExtent","JSON","stringify","customParameters","apiKey","geometryDefinition","clips","featureReduction","toJSON","orderBy","reduce","visible","subtypeCode","sublayerHash","filterHash","filter","effectHash","streamFilter","clipsHash","highlight","getObjectId","isCollection","length","map","toArray","isArray","_addHighlight","_removeHighlight","hasHighlight","size","hitTest","tileRenderer","features","aggregates","getFeatures","_createGraphicHit","fromJSON","queryStatistics","querySummaryStatistics","scale","_cleanUpQuery","queryAggregateSummaryStatistics","_cleanUpAggregateQuery","queryUniqueValues","queryAggregateUniqueValues","queryClassBreaks","queryAggregateClassBreaks","queryHistogram","queryAggregateHistogram","queryFeatures","queryFeaturesJSON","then","forEach","_setLayersForFeature","queryVisibleFeatures","queryAggregates","queryAggregateIds","queryAggregateCount","queryAggregateJSON","queryObjectIds","queryFeatureCount","queryExtent","count","extent","setVisibility","delete","_update","update","_tileStrategy","hasMissingTiles","added","removed","updateTiles","requestUpdate","notifyChange","attach","timeline","record","title","acquireTile","_acquireTile","releaseTile","_releaseTile","tileInfoView","featuresTilingScheme","buffer","_edit","detach","clear","stop","container","removeAllChildren","uninstall","_tileRendererHash","moveStart","viewChange","moveEnd","isUpdating","updating","_updatingRequiredFieldsPromise","isReady","console","log","setUpdating","emitEvent","emit","name","event","_detectQueryMode","editingInfo","lastEditDate","refreshInterval","geometryType","query","supportsPagination","supportsEditing","mode","featureCount","fullExtent","intersection","width","height","getLogger","declaredClass","warn","error","objectIdField","fields","timeInfo","spatialReference","globalIdField","source","getSource","openPorts","parsedUrl","dynamicDataSource","datesInUnknownTimezone","subtypeField","valueExpression","field","timeReferenceUnknownClient","maxRecordCount","tileMaxRecordCount","_createMemoryServiceOptions","createQuery","outSpatialReference","createAggregateQuery","push","_clearTiles","_validateEdit","edits","doRefresh","attached","tileKeys","deletedFeatures","objectId","includes","destroyed","_hasRequiredSupport","_updateRequiredFields","_getEffectiveRenderer","_createSchemaConfig","_createConfiguration","schema","_createTileRendererHash","initialFeatureCount","_initTileRenderer","onConfigUpdate","startup","_onceTilesUpdated","changedFeatureCount","mesh","targets","aggregate","_lockGPUUploads","applyUpdate","_unlockGPUUploads","_updateClusterSizeVariable","_forceAttributeTextureUpload","invalidateLabels","onEdits","refresh","_effectiveRenderer","_createUpdateClusterSizeTask","_aggregateValueRanges","_updateClusterEffectiveRendererSizeVariable","dynamicClusterSize","visualVariables","indexOf","authoringInfo","isAutoGenerated","didInject","aggregateFields","once","layerView","install","hasFilter","floorInfo","_injectOverrides","where","_addFloorFilterClause","hiddenIds","viewAllLevelIds","floorField","replace","join","RegExp","trim","devicePixelRatio","window","filters","supportsTextureFloat","maxTextureSize","lockGPUUploads","unlockGPUUploads","forceAttributeTextureUpload","pixelBuffer","token","get","set","catch","sourceLayer","geometry","graphic","mapPoint","prototype","readOnly","B","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/FeatureLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../AggregateGraphic.js\";import\"../../../geometry.js\";import r from\"../../../Graphic.js\";import i from\"../../../core/Collection.js\";import s from\"../../../core/Error.js\";import has from\"../../../core/has.js\";import{clone as a}from\"../../../core/lang.js\";import n from\"../../../core/Logger.js\";import{applySome as o,isSome as l,unwrap as u,isNone as h}from\"../../../core/maybe.js\";import{debounce as d,isAbortError as p}from\"../../../core/promiseUtils.js\";import{watch as c,whenOnce as y,syncAndInitial as g,initial as f}from\"../../../core/reactiveUtils.js\";import{property as m}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as _}from\"../../../core/accessorSupport/decorators/subclass.js\";import v from\"../../../layers/effects/FeatureEffectView.js\";import b from\"../../../layers/support/FeatureFilter.js\";import R from\"../../../rest/support/AggregateFeatureSet.js\";import S from\"../../../rest/support/FeatureSet.js\";import w from\"../../../rest/support/Query.js\";import{MAX_FILTERS as x}from\"../engine/webgl/definitions.js\";import{LayerView2DMixin as U}from\"./LayerView2D.js\";import{createSchema as C}from\"./features/schemaUtils.js\";import{createOrReuseTileRenderer as F}from\"./features/tileRenderers.js\";import{isRendererSupported as q}from\"./features/support/rendererUtils.js\";import{findSizeVV as I,createClusterCountSizeVariable as O,injectDynamicLevelDependentSizeVisualVariable as E,isClusterCompatibleRenderer as T,createClusterRenderer as V}from\"./support/clusterUtils.js\";import j from\"./support/FeatureCommandQueue.js\";import A from\"./support/FeatureLayerProxy.js\";import{toJSONGeometryType as Q}from\"./support/util.js\";import{TileManager as k}from\"../tiling/TileManager.js\";import L from\"../../layers/FeatureLayerView.js\";import N from\"../../layers/LayerView.js\";import z from\"../../layers/RefreshableLayerView.js\";import{getWebGLCapabilities as P}from\"../../webgl/capabilities.js\";import H from\"../../../geometry/Extent.js\";function J(e){return e&&\"openPorts\"in e}let M=class extends(L(z(U(N)))){constructor(){super(...arguments),this._pipelineIsUpdating=!0,this._commandsQueue=new j({process:e=>{switch(e.type){case\"processed-edit\":return this._doEdit(e);case\"refresh\":return this._doRefresh(e.dataChanged);case\"update\":return this._doUpdate()}}}),this._visibilityOverrides=new Set,this._highlightIds=new Map,this._updateHighlight=d((async()=>this._proxy.setHighlight(Array.from(this._highlightIds.keys())))),this._uploadsLocked=!1,this._needsClusterSizeUpdate=!1,this.featureEffectView=new v,this._lastDefinitionExpression=null}destroy(){o(this._updateClusterSizeTask,(e=>e.remove())),this._proxy?.destroy(),this._commandsQueue.destroy()}initialize(){this.addResolvingPromise(Promise.all([this._initProxy(),this._initServiceOptions()])),this.handles.add([this.on(\"valueRangesChanged\",(e=>{this._set(\"_aggregateValueRanges\",e.valueRanges)})),c((()=>this.featureEffect),(e=>{this.featureEffectView.featureEffect=e}),g)]),this.featureEffectView.endTransitions()}async _initProxy(){const e=this.layer;if(\"isTable\"in e&&e.isTable)throw new s(\"featurelayerview:table-not-supported\",\"table feature layer can't be displayed\",{layer:this.layer});const t=\"feature\"===e.type||\"subtype-group\"===e.type,r=\"capabilities\"in e&&e.capabilities.operations.supportsQuery;if(t&&!r)throw new s(\"featurelayerview:query-not-supported\",\"layer view requires a layer with query capability\",{layer:e});this._proxy&&this._proxy.destroy();const i=this._createClientOptions();return this._set(\"_proxy\",new A({client:i})),this._proxy.when()}async _initServiceOptions(){return this._set(\"_serviceOptions\",await this._createServiceOptions()),this._serviceOptions}get orderByFields(){return\"stream\"!==this._serviceOptions.type&&this._serviceOptions.orderByFields}get labelsVisible(){const e=\"subtype-group\"===this.layer.type?this.layer.sublayers.items:[this.layer];return!this.suspended&&e.some((e=>e.labelingInfo&&e.labelsVisible))}get queryMode(){return this._serviceOptions.type}get renderingConfigHash(){if(!this.layer)return null;const e=this.availableFields,t=this.layer,r=this.view.floors,{definitionExpression:i}=t,s=\"subtype-group\"!==this.layer.type&&this.layer.labelsVisible&&this.layer.labelingInfo,a=\"renderer\"in t&&t.renderer,n=\"gdbVersion\"in t?t.gdbVersion:void 0,o=\"historicMoment\"in t?t.historicMoment?.getTime():void 0,{timeExtent:u}=this,h=\"customParameters\"in t?JSON.stringify(t.customParameters):void 0,d=\"apiKey\"in t?t.apiKey:void 0,p=\"stream\"===t.type?`${JSON.stringify(t.geometryDefinition)}${t.definitionExpression}`:null,c=JSON.stringify(this.clips),y=\"featureReduction\"in t?t.featureReduction?.toJSON():null,g=\"orderBy\"in this.layer&&JSON.stringify(this.layer.orderBy),f=\"sublayers\"in this.layer&&this.layer.sublayers.items.reduce(((e,t)=>e+`${t.visible?1:0}.${JSON.stringify(t.renderer)}.${t.labelsVisible}\\n.${JSON.stringify(t.labelingInfo)}`),\"\"),m=\"subtypeCode\"in this.layer&&this.layer.subtypeCode;return JSON.stringify({orderBy:g,sublayerHash:f,subtypeCode:m,filterHash:l(this.filter)&&this.filter.toJSON(),effectHash:l(this.featureEffect)&&this.featureEffect.toJSON(),streamFilter:p,gdbVersion:n,definitionExpression:i,historicMoment:o,availableFields:e,renderer:a,labelingInfo:s,timeExtent:u,floors:r,clipsHash:c,featureReduction:y,customParameters:h,apiKey:d})}highlight(e){let t;return e instanceof r?t=[e.getObjectId()]:\"number\"==typeof e||\"string\"==typeof e?t=[e]:i.isCollection(e)&&e.length>0?t=e.map((e=>e?.getObjectId())).toArray():Array.isArray(e)&&e.length>0&&(t=\"number\"==typeof e[0]||\"string\"==typeof e[0]?e:e.map((e=>e?.getObjectId()))),t=t?.filter((e=>null!=e)),t&&t.length?(this._addHighlight(t),{remove:()=>this._removeHighlight(t)}):{remove:()=>{}}}hasHighlight(){return!!this._highlightIds.size}async hitTest(e,i){if(!this.tileRenderer)return null;const s=await this.tileRenderer.hitTest(i);if(0===s.length)return null;const{features:a,aggregates:n}=await this._proxy.getFeatures(s);return[...n.map((r=>this._createGraphicHit(e,t.fromJSON(r)))),...a.map((t=>this._createGraphicHit(e,r.fromJSON(t))))]}queryStatistics(){return this._proxy.queryStatistics()}async querySummaryStatistics(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.querySummaryStatistics(this._cleanUpQuery(e),i,r)}async queryAggregateSummaryStatistics(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryAggregateSummaryStatistics(this._cleanUpAggregateQuery(e),i,r)}async queryUniqueValues(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryUniqueValues(this._cleanUpQuery(e),i,r)}async queryAggregateUniqueValues(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryAggregateUniqueValues(this._cleanUpAggregateQuery(e),i,r)}async queryClassBreaks(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryClassBreaks(this._cleanUpQuery(e),i,r)}async queryAggregateClassBreaks(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryAggregateClassBreaks(this._cleanUpAggregateQuery(e),i,r)}async queryHistogram(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryHistogram(this._cleanUpQuery(e),i,r)}async queryAggregateHistogram(e,t,r){const i={...t,scale:this.view.scale};return this._proxy.queryAggregateHistogram(this._cleanUpAggregateQuery(e),i,r)}queryFeatures(e,t){return this.queryFeaturesJSON(e,t).then((e=>{const t=S.fromJSON(e);return t.features.forEach((e=>this._setLayersForFeature(e))),t}))}queryVisibleFeatures(e,t){return this._proxy.queryVisibleFeatures(this._cleanUpQuery(e),t).then((e=>{const t=S.fromJSON(e);return t.features.forEach((e=>this._setLayersForFeature(e))),t}))}async queryAggregates(e,t){const r=await this._proxy.queryAggregates(this._cleanUpAggregateQuery(e),t),i=R.fromJSON(r);return i.features.forEach((e=>this._setLayersForFeature(e))),i}queryAggregateIds(e,t){return this._proxy.queryAggregateIds(this._cleanUpAggregateQuery(e),t)}queryAggregateCount(e,t){return this._proxy.queryAggregateCount(this._cleanUpAggregateQuery(e),t)}queryAggregateJSON(e,t){return this._proxy.queryAggregates(this._cleanUpAggregateQuery(e),t)}queryFeaturesJSON(e,t){return this._proxy.queryFeatures(this._cleanUpQuery(e),t)}queryObjectIds(e,t){return this._proxy.queryObjectIds(this._cleanUpQuery(e),t)}queryFeatureCount(e,t){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),t)}queryExtent(e,t){return this._proxy.queryExtent(this._cleanUpQuery(e),t).then((e=>({count:e.count,extent:H.fromJSON(e.extent)})))}setVisibility(e,t){t?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._update()}update(e){if(!this._tileStrategy||!this.tileRenderer)return;const{hasMissingTiles:t,added:r,removed:i}=this._tileStrategy.update(e);(r.length||i.length)&&this._proxy.updateTiles({added:r,removed:i}),t&&this.requestUpdate(),this.notifyChange(\"updating\")}attach(){this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`),this._tileStrategy=new k({acquireTile:e=>this._acquireTile(e),releaseTile:e=>this._releaseTile(e),tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add(c((()=>this.renderingConfigHash),(()=>this._update()),f),\"attach\"),\"stream\"!==this.layer.type&&this.handles.add(this.layer.on(\"edits\",(e=>this._edit(e))),\"attach\")}detach(){this._commandsQueue.clear(),this._proxy?.stop(),this.container.removeAllChildren(),this.handles.remove(\"attach\"),this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null),this._tileRendererHash=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}isUpdating(){const e=\"renderer\"in this.layer&&null!=this.layer.renderer,t=this._commandsQueue.updating,r=null!=this._updatingRequiredFieldsPromise,i=!this._proxy||!this._proxy.isReady,s=this._pipelineIsUpdating,a=null==this.tileRenderer||this.tileRenderer?.updating,n=e&&(t||r||i||s||a);return has(\"esri-2d-log-updating\")&&console.log(`Updating FLV2D: ${n}\\n  -> hasRenderer ${e}\\n  -> hasPendingCommand ${t}\\n  -> updatingRequiredFields ${r}\\n  -> updatingProxy ${i}\\n  -> updatingPipeline ${s}\\n  -> updatingTileRenderer ${a}\\n`),n}_createClientOptions(){return{setUpdating:e=>{this._set(\"_pipelineIsUpdating\",e)},emitEvent:e=>{this.emit(e.name,e.event)}}}async _detectQueryMode(e){const t=\"path\"in e,r=\"editingInfo\"in this.layer&&this.layer.editingInfo?.lastEditDate,i=!!this.layer.refreshInterval,s=!r&&i;if(t&&(\"feature\"===this.layer.type||\"subtype-group\"===this.layer.type)&&\"point\"===this.layer.geometryType&&this.layer.capabilities.query.supportsPagination&&!this.layer.capabilities.operations.supportsEditing&&!s&&has(\"featurelayer-snapshot-enabled\"))try{const e=await this.layer.queryFeatureCount();if(e<=has(\"featurelayer-snapshot-point-min-threshold\"))return{mode:\"snapshot\",featureCount:e};const t=has(\"featurelayer-snapshot-point-max-threshold\"),r=has(\"featurelayer-snapshot-point-coverage\"),i=this.view.extent,s=u(this.layer.fullExtent),a=s?.clone().intersection(i),n=l(a)?a.width*a.height:0,o=s?.width*s?.height,h=0===o?0:n/o;if(e<=t&&h>=r)return{mode:\"snapshot\",featureCount:e}}catch(a){n.getLogger(this.declaredClass).warn(\"mapview-feature-layer\",\"Encountered an error when querying for featureCount\",{error:a})}return{mode:\"on-demand\"}}async _createServiceOptions(){const e=this.layer;if(\"stream\"===e.type)return null;const{capabilities:t,objectIdField:r}=e,i=e.fields.map((e=>e.toJSON())),s=l(e.fullExtent)&&e.fullExtent.toJSON(),n=Q(e.geometryType),o=e.timeInfo&&e.timeInfo.toJSON()||null,u=e.spatialReference?e.spatialReference.toJSON():null,h=\"feature\"===e.type?e.globalIdField:null;let d;\"ogc-feature\"===e.type?d=e.source.getSource():J(e.source)?d=await e.source.openPorts():e.parsedUrl&&(d=a(e.parsedUrl),\"dynamicDataSource\"in e&&e.dynamicDataSource&&(d.query={layer:JSON.stringify({source:e.dynamicDataSource})}));const p=\"datesInUnknownTimezone\"in this.layer&&this.layer.datesInUnknownTimezone,c=(\"subtypeField\"in this.layer&&this.layer.subtypeField)??null,{mode:y,featureCount:g}=await this._detectQueryMode(d);let f=this.layer.objectIdField;if(\"feature\"===this.layer.type&&l(this.layer.orderBy)&&this.layer.orderBy.length){const e=!this.layer.orderBy[0].valueExpression&&this.layer.orderBy[0].field;e&&(f=e)}return{type:y,timeReferenceUnknownClient:p,subtypeField:c,featureCount:g,globalIdField:h,maxRecordCount:t.query.maxRecordCount,tileMaxRecordCount:t.query.tileMaxRecordCount,capabilities:t,fields:i,fullExtent:s,geometryType:n,objectIdField:r,source:d,timeInfo:o,spatialReference:u,orderByFields:f}}async _createMemoryServiceOptions(e){const t=await e.openPorts();return{...this._createServiceOptions(),type:\"memory\",source:t}}_cleanUpQuery(e){const t=w.from(e)||this.createQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t}_cleanUpAggregateQuery(e){const t=w.from(e)||this.createAggregateQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t}async _update(){return this._commandsQueue.push({type:\"update\"})}async _edit(e){if(this.suspended)return void this._clearTiles();return this._validateEdit(e)?this._commandsQueue.push({type:\"edit\",edits:e}):void 0}async doRefresh(e){if(this.attached&&this._tileStrategy.tileKeys().length)return this.suspended&&e?void this._clearTiles():this._commandsQueue.push({type:\"refresh\",dataChanged:e})}_clearTiles(){this._tileStrategy.tileKeys().length&&(this._proxy.updateTiles({added:[],removed:this._tileStrategy.tileKeys()}),this._tileStrategy.clear(),this.requestUpdate(),this._commandsQueue.clear(),this._update())}_validateEdit(e){const t=\"globalIdField\"in this.layer&&this.layer.globalIdField,r=e.deletedFeatures.some((e=>-1===e.objectId||!e.objectId)),i=t&&this.availableFields.includes(t);return r&&!i?(n.getLogger(this.declaredClass).error(new s(\"mapview-apply-edits\",`Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected on the map`)),null):e}async _doUpdate(){try{if(this.destroyed||!this._hasRequiredSupport(this.layer)||!this._tileStrategy)return;const{featureEffectView:t,filter:r}=this;await this._updateRequiredFields();const{renderer:i}=this._getEffectiveRenderer();this._set(\"_effectiveRenderer\",i);const s=this._createSchemaConfig(),a=this._createConfiguration(s,r,t.filter),o=this._lastDefinitionExpression!==a.schema.source.definitionExpression;this._lastDefinitionExpression=a.schema.source.definitionExpression;const l=a.schema.tileRenderer,u=this._createTileRendererHash(l);if(\"snapshot\"===this._serviceOptions.type&&(a.schema.source.initialFeatureCount=this._serviceOptions.featureCount),u!==this._tileRendererHash){await this._initTileRenderer(l,i);const e=this.layer,t=\"stream\"===e.type?await this._initServiceOptions():this._serviceOptions;this.tileRenderer.onConfigUpdate(i),\"stream\"!==e.type&&J(e.source)&&(t.source=await e.source.openPorts());const r={added:this._tileStrategy.tileKeys(),removed:[]};await this._proxy.startup(this.view.featuresTilingScheme,a,t,r),this.hasHighlight()&&await this._proxy.setHighlight(Array.from(this._highlightIds.keys())),await this._onceTilesUpdated(),this.tileRenderer.onConfigUpdate(i)}else{\"snapshot\"===this._serviceOptions.type&&o&&(a.schema.source.changedFeatureCount=await this.layer.queryFeatureCount());const t=await this._proxy.update(a);(t.mesh||t.targets.aggregate)&&this._lockGPUUploads();try{await this._proxy.applyUpdate(t)}catch(e){p(e)||n.getLogger(this.declaredClass).error(e)}(t.mesh||t.targets.aggregate)&&this._unlockGPUUploads(),this.tileRenderer.onConfigUpdate(i),this._updateClusterSizeVariable(),this._forceAttributeTextureUpload()}this._tileRendererHash=u,this.tileRenderer.invalidateLabels(),this.requestUpdate()}catch(e){}}async _doEdit(e){try{await this._proxy.onEdits(e)}catch(t){p(t),0}}async _doRefresh(e){this._lockGPUUploads();try{let t;e&&\"snapshot\"===this.queryMode&&\"queryFeatureCount\"in this.layer&&(t=await this.layer.queryFeatureCount()),await this._proxy.refresh({dataChanged:e,featureCount:t})}catch(r){p(r),0}this._unlockGPUUploads();const t=this.layer;t&&\"featureReduction\"in t&&t.featureReduction&&this._updateClusterSizeVariable()}_updateClusterSizeVariable(){this._needsClusterSizeUpdate&&(this.tileRenderer.onConfigUpdate(this._effectiveRenderer),this._needsClusterSizeUpdate=!1)}_createUpdateClusterSizeTask(e,t){return c((()=>this._aggregateValueRanges),(r=>{this._updateClusterEffectiveRendererSizeVariable(e,t,r),this._needsClusterSizeUpdate=!0,this._uploadsLocked||this._updateClusterSizeVariable()}))}async _updateClusterEffectiveRendererSizeVariable(e,t,r){if(e.dynamicClusterSize&&\"visualVariables\"in e&&e.visualVariables){const i=I(e.visualVariables);if(l(i)&&\"cluster_count\"===i.field){const s=e.visualVariables.indexOf(i);e.visualVariables[s]=O(t,r);const a=e.clone();a.dynamicClusterSize=!0,this._set(\"_effectiveRenderer\",a)}}}_getEffectiveRenderer(){const e=this.layer,t=\"renderer\"in e?e.renderer:null,r=\"featureReduction\"in e?e.featureReduction:null;if(l(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null),r&&\"renderer\"in r&&r.renderer&&!r.renderer.authoringInfo?.isAutoGenerated){const e=r.fields;if(\"cluster\"===r.type){const{renderer:t,didInject:i}=E(r.renderer,r,this._aggregateValueRanges);return i&&(o(this._updateClusterSizeTask,(e=>e.remove())),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(t,r)),{renderer:t,aggregateFields:e,featureReduction:r}}return{renderer:r.renderer,aggregateFields:e,featureReduction:r}}if(r&&\"cluster\"===r.type&&T(t)){const e=r,i=[],s=V(i,t,e,this._aggregateValueRanges,!0);return o(this._updateClusterSizeTask,(e=>e.remove())),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(s,e),{renderer:s,aggregateFields:i,featureReduction:r}}return{renderer:t,aggregateFields:[],featureReduction:null}}_acquireTile(e){const t=this.tileRenderer.acquireTile(e);return t.once(\"attach\",(()=>{this.requestUpdate()})),t}_releaseTile(e){this.tileRenderer.releaseTile(e)}async _initTileRenderer(e,t){const r=await F(e,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer});return this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this.destroyed?null:(this._proxy.tileRenderer=r,this._set(\"tileRenderer\",r),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(t),this.requestUpdate(),this.tileRenderer)}_createTileRendererHash(e){return`${e.type}`}get hasFilter(){const e=!!(\"floorInfo\"in this.layer&&this.layer.floorInfo&&this.view.floors&&this.view.floors.length);return!!this.filter||e||!!this._visibilityOverrides.size||!!this.timeExtent}_injectOverrides(e){const t=l(e)?e.timeExtent:null,r=l(this.timeExtent)&&l(t)?this.timeExtent.intersection(t):this.timeExtent||t;let i=null;const s=\"floorInfo\"in this.layer&&this.layer.floorInfo;if(s){const t=l(e)&&e.where;i=this._addFloorFilterClause(t)}if(!this._visibilityOverrides.size&&!r&&!s)return l(e)?e.toJSON():null;(e=l(e)&&e.clone()||new b).timeExtent=r,i&&(e.where=i);const a=e.toJSON();return a.hiddenIds=Array.from(this._visibilityOverrides),a}_addFloorFilterClause(e){const t=this.layer;let r=e||\"\";if(\"floorInfo\"in t&&t.floorInfo){let e=this.view.floors;if(!e||!e.length)return r;t.floorInfo.viewAllLevelIds?.length&&(e=t.floorInfo.viewAllLevelIds);const i=e.filter((e=>\"\"!==e)).map((e=>\"'\"+e+\"'\"));i.push(\"''\");const s=t.floorInfo.floorField;let a=\"(\"+s+\" IN ({ids}) OR \"+s+\" IS NULL)\";if(a=a.replace(\"{ids}\",i.join(\", \")),l(r)&&r.includes(s)){let e=new RegExp(\"AND \\\\(\"+s+\".*NULL\\\\)\",\"g\");r=r.replace(e,\"\"),e=new RegExp(\"\\\\(\"+s+\".*NULL\\\\)\",\"g\"),r=r.replace(e,\"\"),r=r.replace(/\\s+/g,\" \").trim()}r=\"\"!==r?\"(\"+r+\") AND \"+a:a}return\"\"!==r?r:null}_createConfiguration(e,t,r){const i=\"feature\"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,s=\"feature\"===this.layer.type?this.layer.gdbVersion:void 0,a=new Array(x),n=this._injectOverrides(t);a[0]=n,a[1]=l(r)?r.toJSON():null;const o=C(e);if(h(o))return null;const u=P(\"2d\");return{availableFields:this.availableFields,gdbVersion:s,historicMoment:i,devicePixelRatio:window.devicePixelRatio||1,filters:a,schema:o,supportsTextureFloat:u.supportsTextureFloat,maxTextureSize:u.maxTextureSize}}_hasRequiredSupport(e){return!(\"renderer\"in e)||q(e.renderer)}_onceTilesUpdated(){return this.requestUpdate(),y((()=>!this._pipelineIsUpdating))}_lockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!0,this.tileRenderer.lockGPUUploads())}_unlockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!1,this.tileRenderer.unlockGPUUploads())}_forceAttributeTextureUpload(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()}_createSchemaConfig(){const e=this.layer;return{renderer:\"renderer\"in e?e.renderer:null,spatialReference:e.spatialReference,timeExtent:e.timeExtent,definitionExpression:e.definitionExpression,featureReduction:\"featureReduction\"in e?e.featureReduction:null,fields:e.fields,geometryType:e.geometryType,historicMoment:\"historicMoment\"in e?e.historicMoment:null,labelsVisible:\"labelsVisible\"in e&&e.labelsVisible,labelingInfo:\"labelingInfo\"in e&&e.labelingInfo,availableFields:this.availableFields,featureEffect:this.featureEffect,filter:this.filter,gdbVersion:\"gdbVersion\"in e?e.gdbVersion:null,pixelBuffer:0,orderBy:\"orderBy\"in e&&e.orderBy?e.orderBy:null,customParameters:{...\"customParameters\"in e?e.customParameters:void 0,token:\"apiKey\"in e?e.apiKey:void 0},subtypeCode:\"subtypeCode\"in e?e.subtypeCode:void 0,subtypeField:\"subtypeField\"in e?e.subtypeField:void 0}}_addHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t);this._highlightIds.set(t,e+1)}else this._highlightIds.set(t,1);this._updateHighlight().catch((e=>{p(e)||n.getLogger(this.declaredClass).error(e)}))}_removeHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t)-1;0===e?this._highlightIds.delete(t):this._highlightIds.set(t,e)}this._updateHighlight().catch((e=>{p(e)||n.getLogger(this.declaredClass).error(e)}))}_setLayersForFeature(e){const t=this.layer;e.layer=t,e.sourceLayer=t}_createGraphicHit(e,t){return this._setLayersForFeature(t),l(t.geometry)&&(t.geometry.spatialReference=this.view.spatialReference),{type:\"graphic\",graphic:t,layer:this.layer,mapPoint:e}}};e([m()],M.prototype,\"_serviceOptions\",void 0),e([m()],M.prototype,\"_proxy\",void 0),e([m()],M.prototype,\"_pipelineIsUpdating\",void 0),e([m()],M.prototype,\"_effectiveRenderer\",void 0),e([m()],M.prototype,\"_aggregateValueRanges\",void 0),e([m()],M.prototype,\"_commandsQueue\",void 0),e([m()],M.prototype,\"featureEffectView\",void 0),e([m()],M.prototype,\"labelsVisible\",null),e([m({readOnly:!0})],M.prototype,\"queryMode\",null),e([m()],M.prototype,\"renderingConfigHash\",null),e([m()],M.prototype,\"tileRenderer\",void 0),e([m()],M.prototype,\"updating\",void 0),M=e([_(\"esri.views.2d.layers.FeatureLayerView2D\")],M);const B=M;export{B as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}