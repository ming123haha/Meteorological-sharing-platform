{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../Graphic.js\";\nimport { X as t } from \"../../../chunks/languageUtils.js\";\nimport { SqlExpressionAdapted as i, OriginalField as s, AdaptedFeatureSet as n } from \"./Adapted.js\";\nimport r from \"./AttributeFilter.js\";\nimport a from \"./OrderBy.js\";\nimport l from \"../support/FeatureSet.js\";\nimport o from \"../support/IdSet.js\";\nimport d from \"../support/OrderbyClause.js\";\nimport { IdState as u, layerGeometryEsriConstants as f, FeatureServiceDatabaseType as c } from \"../support/shared.js\";\nimport { isSingleField as h, toWhereClause as p, predictType as g, scanForField as _, reformulateWithoutField as m } from \"../support/sqlUtils.js\";\nimport { calculateStat as y } from \"../support/stats.js\";\nimport b from \"../support/StatsField.js\";\nimport { createMD5Hash as w, outputTypes as F } from \"../../../core/MD5.js\";\nimport { WhereClause as I } from \"../../../core/sql/WhereClause.js\";\nimport S from \"../../../geometry/SpatialReference.js\";\nimport x from \"../../../layers/support/Field.js\";\nimport k from \"../../../layers/support/FieldsIndex.js\";\n\nfunction D(e) {\n  if (!e) return \"COUNT\";\n\n  switch (e.toLowerCase()) {\n    case \"max\":\n      return \"MAX\";\n\n    case \"var\":\n    case \"variance\":\n      return \"VAR\";\n\n    case \"avg\":\n    case \"average\":\n    case \"mean\":\n      return \"AVG\";\n\n    case \"min\":\n      return \"MIN\";\n\n    case \"sum\":\n      return \"SUM\";\n\n    case \"stdev\":\n    case \"stddev\":\n      return \"STDDEV\";\n\n    case \"count\":\n      return \"COUNT\";\n  }\n\n  return \"COUNT\";\n}\n\nclass A extends l {\n  constructor(e) {\n    super(e), this._decodedStatsfield = [], this._decodedGroupbyfield = [], this._candosimplegroupby = !0, this.phsyicalgroupbyfields = [], this.objectIdField = \"ROW__ID\", this._internalObjectIdField = \"ROW__ID\", this._adaptedFields = [], this.declaredClass = \"esri.arcade.featureset.actions.Aggregate\", this._uniqueIds = 1, this._maxQuery = 10, this._maxProcessing = 10, this._parent = e.parentfeatureset, this._config = e;\n  }\n\n  isTable() {\n    return !0;\n  }\n\n  async _getSet(e) {\n    if (null === this._wset) {\n      const t = await this._getFilteredSet(\"\", null, null, null, e);\n      return this._wset = t, this._wset;\n    }\n\n    return this._wset;\n  }\n\n  _isInFeatureSet() {\n    return u.InFeatureSet;\n  }\n\n  _nextUniqueName(e) {\n    for (; 1 === e[\"T\" + this._uniqueIds.toString()];) this._uniqueIds++;\n\n    const t = \"T\" + this._uniqueIds.toString();\n\n    return e[t] = 1, t;\n  }\n\n  _convertToEsriFieldType(e) {\n    return e;\n  }\n\n  _initialiseFeatureSet() {\n    const e = {};\n    let t = !1,\n        n = 1;\n    const r = this._parent ? this._parent.getFieldsIndex() : new k([]);\n\n    for (this.objectIdField = \"ROW__ID\", this.globalIdField = \"\"; !1 === t;) {\n      let e = !1;\n\n      for (let t = 0; t < this._config.groupbyfields.length; t++) if (this._config.groupbyfields[t].name.toLowerCase() === this.objectIdField.toLowerCase()) {\n        e = !0;\n        break;\n      }\n\n      if (!1 === e) for (let t = 0; t < this._config.statsfields.length; t++) if (this._config.statsfields[t].name.toLowerCase() === this.objectIdField.toLowerCase()) {\n        e = !0;\n        break;\n      }\n      !1 === e ? t = !0 : (this.objectIdField = \"ROW__ID\" + n.toString(), n++);\n    }\n\n    for (const i of this._config.statsfields) {\n      const e = new b();\n      e.field = i.name, e.tofieldname = i.name, e.workingexpr = i.expression instanceof I ? i.expression : I.create(i.expression, r), e.typeofstat = D(i.statistic), this._decodedStatsfield.push(e);\n    }\n\n    this._decodedGroupbyfield = [];\n\n    for (const i of this._config.groupbyfields) {\n      const e = {\n        name: i.name,\n        singlefield: null,\n        tofieldname: i.name,\n        expression: i.expression instanceof I ? i.expression : I.create(i.expression, r)\n      };\n\n      this._decodedGroupbyfield.push(e);\n    }\n\n    if (null !== this._parent) {\n      this.geometryType = this._parent.geometryType, this.spatialReference = this._parent.spatialReference, this.hasM = this._parent.hasM, this.hasZ = this._parent.hasZ, this.typeIdField = \"\";\n\n      for (const t of this._parent.fields) e[t.name.toUpperCase()] = 1;\n\n      this.types = null;\n    } else this.geometryType = f.point, this.typeIdField = \"\", this.types = null, this.spatialReference = new S({\n      wkid: 4326\n    });\n\n    this.fields = [];\n    const a = new b();\n    a.field = this._nextUniqueName(e), a.tofieldname = this.objectIdField, a.workingexpr = I.create(this._parent.objectIdField, this._parent.getFieldsIndex()), a.typeofstat = \"MIN\", this._decodedStatsfield.push(a);\n\n    for (const s of this._decodedGroupbyfield) {\n      const t = new x();\n\n      if (s.name = this._nextUniqueName(e), t.name = s.tofieldname, t.alias = t.name, h(s.expression)) {\n        const e = this._parent.getField(p(s.expression, c.Standardised));\n\n        if (!e) throw new Error(\"Field is not present for Aggregation\");\n        s.name = e.name, s.singlefield = e.name, this.phsyicalgroupbyfields.push(e.name), t.type = e.type;\n      } else {\n        t.type = this._convertToEsriFieldType(g(s.expression, this._parent.fields));\n        const e = new x();\n        e.name = s.name, e.alias = e.name, this.phsyicalgroupbyfields.push(s.name), this._adaptedFields.push(new i(e, s.expression)), this._candosimplegroupby = !1;\n      }\n\n      this.fields.push(t);\n    }\n\n    if (this._adaptedFields.length > 0) for (const i of this._parent.fields) this._adaptedFields.push(new s(i));\n\n    for (let i = 0; i < this._decodedStatsfield.length; i++) {\n      const t = new x();\n      let s = null;\n      const n = this._decodedStatsfield[i];\n      n.field = this._nextUniqueName(e), n.tofieldname === this.objectIdField && (this._internalObjectIdField = n.field), t.name = n.tofieldname, t.alias = t.name;\n      const r = null !== n.workingexpr && h(n.workingexpr) ? p(n.workingexpr, c.Standardised) : \"\";\n\n      switch (this._decodedStatsfield[i].typeofstat) {\n        case \"SUM\":\n          if (\"\" !== r) {\n            if (s = this._parent.getField(r), !s) throw new Error(\"Field is not present for Aggregation\");\n            t.type = s.type;\n          } else t.type = \"double\";\n\n          break;\n\n        case \"MIN\":\n        case \"MAX\":\n          if (\"\" !== r) {\n            if (s = this._parent.getField(r), !s) throw new Error(\"Field is not present for Aggregation\");\n            t.type = s.type;\n          } else t.type = \"double\";\n\n          break;\n\n        case \"COUNT\":\n          t.type = \"integer\";\n          break;\n\n        case \"STDDEV\":\n        case \"VAR\":\n        case \"AVG\":\n          if (\"\" !== r && (s = this._parent.getField(r), !s)) throw new Error(\"Field is not present for Aggregation\");\n          t.type = \"double\";\n      }\n\n      this.fields.push(t);\n    }\n  }\n\n  async _canDoAggregates() {\n    return !1;\n  }\n\n  async _getFeatures(e, t, i, s) {\n    -1 !== t && this._featureCache[t];\n    const n = this._maxQuery;\n    return !0 === this._checkIfNeedToExpandKnownPage(e, n) ? (await this._expandPagedSet(e, n, 0, 0, s), this._getFeatures(e, t, i, s)) : \"success\";\n  }\n\n  async _getFilteredSet(e, t, i, s, l) {\n    if (\"\" !== e) return new o([], [], !0, null);\n    let u = null;\n    const f = {\n      ordered: !1,\n      nowhereclause: !1\n    };\n    if (await this._ensureLoaded(), null !== i) for (let n = 0; n < this._decodedStatsfield.length; n++) if (!0 === _(i, this._decodedStatsfield[n].tofieldname)) {\n      f.nowhereclause = !0, i = null;\n      break;\n    }\n\n    if (null !== s) {\n      f.ordered = !0;\n\n      for (let e = 0; e < this._decodedStatsfield.length; e++) if (!0 === s.scanForField(this._decodedStatsfield[e].tofieldname)) {\n        s = null, f.ordered = !1;\n        break;\n      }\n\n      if (null !== s) for (const e of this._decodedGroupbyfield) if (null === e.singlefield && !0 === s.scanForField(e.tofieldname)) {\n        s = null, f.ordered = !1;\n        break;\n      }\n    }\n\n    if (!1 !== this._candosimplegroupby && (await this._parent._canDoAggregates(this.phsyicalgroupbyfields, this._decodedStatsfield, \"\", null, null))) {\n      let e = null;\n      i && (e = this._reformulateWhereClauseWithoutGroupByFields(i));\n      let t = null;\n      s && (t = this._reformulateOrderClauseWithoutGroupByFields(s));\n      const n = await this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields, this._decodedStatsfield, \"\", null, e, t, this._internalObjectIdField);\n      return this._checkCancelled(l), u = !0 === f.nowhereclause ? new o(n._candidates.slice(0).concat(n._known.slice(0)), [], !0 === f.ordered && n._ordered, this._clonePageDefinition(n.pagesDefinition)) : new o(n._candidates.slice(0), n._known.slice(0), !0 === f.ordered && n._ordered, this._clonePageDefinition(n.pagesDefinition)), u;\n    }\n\n    let c = this._parent;\n    if (this._adaptedFields.length > 0 && (c = new n({\n      parentfeatureset: this._parent,\n      adaptedFields: this._adaptedFields,\n      extraFilter: null\n    })), !0 === f.nowhereclause) u = new o([\"GETPAGES\"], [], !1, {\n      aggregatefeaturesetpagedefinition: !0,\n      resultOffset: 0,\n      resultRecordCount: this._maxQuery,\n      internal: {\n        fullyResolved: !1,\n        workingItem: null,\n        type: \"manual\",\n        iterator: null,\n        set: [],\n        subfeatureset: new a({\n          parentfeatureset: c,\n          orderbyclause: new d(this.phsyicalgroupbyfields.join(\",\") + \",\" + this._parent.objectIdField + \" ASC\")\n        })\n      }\n    });else {\n      let e = c;\n\n      if (null !== i) {\n        let t = null;\n        i && (t = this._reformulateWhereClauseWithoutGroupByFields(i)), e = new r({\n          parentfeatureset: e,\n          whereclause: t\n        });\n      }\n\n      u = new o([\"GETPAGES\"], [], !1, {\n        aggregatefeaturesetpagedefinition: !0,\n        resultOffset: 0,\n        resultRecordCount: this._maxQuery,\n        internal: {\n          fullyResolved: !1,\n          workingItem: null,\n          type: \"manual\",\n          iterator: null,\n          set: [],\n          subfeatureset: new a({\n            parentfeatureset: e,\n            orderbyclause: new d(this.phsyicalgroupbyfields.join(\",\") + \",\" + this._parent.objectIdField + \" ASC\")\n          })\n        }\n      });\n    }\n    return u;\n  }\n\n  _reformulateWhereClauseWithoutStatsFields(e) {\n    for (const t of this._decodedStatsfield) e = m(e, t.tofieldname, p(t.workingexpr, c.Standardised), this._parent.getFieldsIndex());\n\n    return e;\n  }\n\n  _reformulateWhereClauseWithoutGroupByFields(e) {\n    for (const t of this._decodedGroupbyfield) t.tofieldname !== t.name && (e = m(e, t.tofieldname, p(t.expression, c.Standardised), this._parent.getFieldsIndex()));\n\n    return e;\n  }\n\n  _reformulateOrderClauseWithoutGroupByFields(e) {\n    const t = [];\n\n    for (const i of this._decodedGroupbyfield) i.tofieldname !== i.name && t.push({\n      field: i.tofieldname,\n      newfield: i.name\n    });\n\n    return t.length > 0 ? e.replaceFields(t) : e;\n  }\n\n  _clonePageDefinition(e) {\n    return null === e ? null : !0 === e.aggregatefeaturesetpagedefinition ? {\n      aggregatefeaturesetpagedefinition: !0,\n      resultRecordCount: e.resultRecordCount,\n      resultOffset: e.resultOffset,\n      internal: e.internal\n    } : this._parent._clonePageDefinition(e);\n  }\n\n  async _refineSetBlock(e, t, i) {\n    if (!0 === this._checkIfNeedToExpandCandidatePage(e, this._maxQuery)) return await this._expandPagedSet(e, this._maxQuery, 0, 0, i), this._refineSetBlock(e, t, i);\n\n    this._checkCancelled(i);\n\n    const s = e._candidates.length;\n\n    this._refineKnowns(e, t);\n\n    e._candidates.length;\n    return e._candidates.length, e;\n  }\n\n  _expandPagedSet(e, t, i, s, n) {\n    return this._expandPagedSetFeatureSet(e, t, i, s, n);\n  }\n\n  async _getPhysicalPage(t, i, s) {\n    if (!0 === t.pagesDefinition.aggregatefeaturesetpagedefinition) return this._sequentialGetPhysicalItem(t, t.pagesDefinition.resultRecordCount, s, []);\n    const n = await this._getAgregagtePhysicalPage(t, i, s);\n\n    for (const r of n) {\n      const t = {\n        geometry: r.geometry,\n        attributes: {}\n      };\n\n      for (const e of this._decodedGroupbyfield) t.attributes[e.tofieldname] = r.attributes[e.name];\n\n      for (const e of this._decodedStatsfield) t.attributes[e.tofieldname] = r.attributes[e.field];\n\n      this._featureCache[t.attributes[this.objectIdField]] = new e(t);\n    }\n\n    return n.length;\n  }\n\n  _sequentialGetPhysicalItem(e, t, i, s) {\n    return new Promise((n, r) => {\n      null === e.pagesDefinition.internal.iterator && (e.pagesDefinition.internal.iterator = e.pagesDefinition.internal.subfeatureset.iterator(i)), !0 === e.pagesDefinition.internal.fullyResolved || 0 === t ? n(s.length) : this._nextAggregateItem(e, t, i, s, r => {\n        null === r ? n(s.length) : (t -= 1, n(this._sequentialGetPhysicalItem(e, t, i, s)));\n      }, r);\n    });\n  }\n\n  _nextAggregateItem(e, i, s, n, r, a) {\n    try {\n      t(e.pagesDefinition.internal.iterator.next()).then(t => {\n        if (null === t) {\n          if (null !== e.pagesDefinition.internal.workingItem) {\n            const t = this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);\n\n            n.push(t), e.pagesDefinition.internal.workingItem = null, e.pagesDefinition.internal.set.push(t.attributes[this.objectIdField]), e.pagesDefinition.internal.fullyResolved = !0, r(null);\n          } else e.pagesDefinition.internal.fullyResolved = !0, r(null);\n        } else {\n          const l = this._generateAggregateHash(t);\n\n          if (null === e.pagesDefinition.internal.workingItem) e.pagesDefinition.internal.workingItem = {\n            features: [t],\n            id: l\n          };else {\n            if (l !== e.pagesDefinition.internal.workingItem.id) {\n              const s = this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);\n\n              return n.push(s), e.pagesDefinition.internal.workingItem = null, e.pagesDefinition.internal.set.push(s.attributes[this.objectIdField]), i -= 1, e.pagesDefinition.internal.workingItem = {\n                features: [t],\n                id: l\n              }, void r(s);\n            }\n\n            e.pagesDefinition.internal.workingItem.features.push(t);\n          }\n\n          this._nextAggregateItem(e, i, s, n, r, a);\n        }\n      }, a);\n    } catch (l) {\n      a(l);\n    }\n  }\n\n  _calculateFieldStat(e, t, i) {\n    const s = [];\n\n    for (let n = 0; n < e.features.length; n++) if (null !== t.workingexpr) {\n      const i = t.workingexpr.calculateValue(e.features[n]);\n      null !== i && s.push(i);\n    } else s.push(null);\n\n    switch (t.typeofstat) {\n      case \"MIN\":\n        i.attributes[t.tofieldname] = y(\"min\", s, -1);\n        break;\n\n      case \"MAX\":\n        i.attributes[t.tofieldname] = y(\"max\", s, -1);\n        break;\n\n      case \"SUM\":\n        i.attributes[t.tofieldname] = y(\"sum\", s, -1);\n        break;\n\n      case \"COUNT\":\n        i.attributes[t.tofieldname] = s.length;\n        break;\n\n      case \"VAR\":\n        i.attributes[t.tofieldname] = y(\"var\", s, -1);\n        break;\n\n      case \"STDDEV\":\n        i.attributes[t.tofieldname] = y(\"stddev\", s, -1);\n        break;\n\n      case \"AVG\":\n        i.attributes[t.tofieldname] = y(\"avg\", s, -1);\n    }\n\n    return !0;\n  }\n\n  _calculateAndAppendAggregateItem(t) {\n    const i = {\n      attributes: {},\n      geometry: null\n    };\n\n    for (const e of this._decodedGroupbyfield) {\n      const s = e.singlefield ? t.features[0].attributes[e.singlefield] : e.expression.calculateValue(t.features[0]);\n      i.attributes[e.tofieldname] = s;\n    }\n\n    for (const e of this._decodedStatsfield) this._calculateFieldStat(t, e, i);\n\n    const s = [];\n\n    for (let e = 0; e < this._decodedStatsfield.length; e++) s.push(this._calculateFieldStat(t, this._decodedStatsfield[e], i));\n\n    return this._featureCache[i.attributes[this.objectIdField]] = new e({\n      attributes: i.attributes,\n      geometry: i.geometry\n    }), i;\n  }\n\n  _generateAggregateHash(e) {\n    let t = \"\";\n\n    for (const i of this._decodedGroupbyfield) {\n      const s = i.singlefield ? e.attributes[i.singlefield] : i.expression.calculateValue(e);\n      t += null == s ? \":\" : \":\" + s.toString();\n    }\n\n    return w(t, F.String);\n  }\n\n  async _stat() {\n    return {\n      calculated: !1\n    };\n  }\n\n  async getFeatureByObjectId() {\n    return null;\n  }\n\n  static registerAction() {\n    l._featuresetFunctions.groupby = function (e, t) {\n      return new A({\n        parentfeatureset: this,\n        groupbyfields: e,\n        statsfields: t\n      });\n    };\n  }\n\n}\n\nexport { A as default };","map":{"version":3,"names":["e","X","t","SqlExpressionAdapted","i","OriginalField","s","AdaptedFeatureSet","n","r","a","l","o","d","IdState","u","layerGeometryEsriConstants","f","FeatureServiceDatabaseType","c","isSingleField","h","toWhereClause","p","predictType","g","scanForField","_","reformulateWithoutField","m","calculateStat","y","b","createMD5Hash","w","outputTypes","F","WhereClause","I","S","x","k","D","toLowerCase","A","constructor","_decodedStatsfield","_decodedGroupbyfield","_candosimplegroupby","phsyicalgroupbyfields","objectIdField","_internalObjectIdField","_adaptedFields","declaredClass","_uniqueIds","_maxQuery","_maxProcessing","_parent","parentfeatureset","_config","isTable","_getSet","_wset","_getFilteredSet","_isInFeatureSet","InFeatureSet","_nextUniqueName","toString","_convertToEsriFieldType","_initialiseFeatureSet","getFieldsIndex","globalIdField","groupbyfields","length","name","statsfields","field","tofieldname","workingexpr","expression","create","typeofstat","statistic","push","singlefield","geometryType","spatialReference","hasM","hasZ","typeIdField","fields","toUpperCase","types","point","wkid","alias","getField","Standardised","Error","type","_canDoAggregates","_getFeatures","_featureCache","_checkIfNeedToExpandKnownPage","_expandPagedSet","ordered","nowhereclause","_ensureLoaded","_reformulateWhereClauseWithoutGroupByFields","_reformulateOrderClauseWithoutGroupByFields","_getAggregatePagesDataSourceDefinition","_checkCancelled","_candidates","slice","concat","_known","_ordered","_clonePageDefinition","pagesDefinition","adaptedFields","extraFilter","aggregatefeaturesetpagedefinition","resultOffset","resultRecordCount","internal","fullyResolved","workingItem","iterator","set","subfeatureset","orderbyclause","join","whereclause","_reformulateWhereClauseWithoutStatsFields","newfield","replaceFields","_refineSetBlock","_checkIfNeedToExpandCandidatePage","_refineKnowns","_expandPagedSetFeatureSet","_getPhysicalPage","_sequentialGetPhysicalItem","_getAgregagtePhysicalPage","geometry","attributes","Promise","_nextAggregateItem","next","then","_calculateAndAppendAggregateItem","_generateAggregateHash","features","id","_calculateFieldStat","calculateValue","String","_stat","calculated","getFeatureByObjectId","registerAction","_featuresetFunctions","groupby","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/arcade/featureset/actions/GroupBy.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../Graphic.js\";import{X as t}from\"../../../chunks/languageUtils.js\";import{SqlExpressionAdapted as i,OriginalField as s,AdaptedFeatureSet as n}from\"./Adapted.js\";import r from\"./AttributeFilter.js\";import a from\"./OrderBy.js\";import l from\"../support/FeatureSet.js\";import o from\"../support/IdSet.js\";import d from\"../support/OrderbyClause.js\";import{IdState as u,layerGeometryEsriConstants as f,FeatureServiceDatabaseType as c}from\"../support/shared.js\";import{isSingleField as h,toWhereClause as p,predictType as g,scanForField as _,reformulateWithoutField as m}from\"../support/sqlUtils.js\";import{calculateStat as y}from\"../support/stats.js\";import b from\"../support/StatsField.js\";import{createMD5Hash as w,outputTypes as F}from\"../../../core/MD5.js\";import{WhereClause as I}from\"../../../core/sql/WhereClause.js\";import S from\"../../../geometry/SpatialReference.js\";import x from\"../../../layers/support/Field.js\";import k from\"../../../layers/support/FieldsIndex.js\";function D(e){if(!e)return\"COUNT\";switch(e.toLowerCase()){case\"max\":return\"MAX\";case\"var\":case\"variance\":return\"VAR\";case\"avg\":case\"average\":case\"mean\":return\"AVG\";case\"min\":return\"MIN\";case\"sum\":return\"SUM\";case\"stdev\":case\"stddev\":return\"STDDEV\";case\"count\":return\"COUNT\"}return\"COUNT\"}class A extends l{constructor(e){super(e),this._decodedStatsfield=[],this._decodedGroupbyfield=[],this._candosimplegroupby=!0,this.phsyicalgroupbyfields=[],this.objectIdField=\"ROW__ID\",this._internalObjectIdField=\"ROW__ID\",this._adaptedFields=[],this.declaredClass=\"esri.arcade.featureset.actions.Aggregate\",this._uniqueIds=1,this._maxQuery=10,this._maxProcessing=10,this._parent=e.parentfeatureset,this._config=e}isTable(){return!0}async _getSet(e){if(null===this._wset){const t=await this._getFilteredSet(\"\",null,null,null,e);return this._wset=t,this._wset}return this._wset}_isInFeatureSet(){return u.InFeatureSet}_nextUniqueName(e){for(;1===e[\"T\"+this._uniqueIds.toString()];)this._uniqueIds++;const t=\"T\"+this._uniqueIds.toString();return e[t]=1,t}_convertToEsriFieldType(e){return e}_initialiseFeatureSet(){const e={};let t=!1,n=1;const r=this._parent?this._parent.getFieldsIndex():new k([]);for(this.objectIdField=\"ROW__ID\",this.globalIdField=\"\";!1===t;){let e=!1;for(let t=0;t<this._config.groupbyfields.length;t++)if(this._config.groupbyfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}if(!1===e)for(let t=0;t<this._config.statsfields.length;t++)if(this._config.statsfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}!1===e?t=!0:(this.objectIdField=\"ROW__ID\"+n.toString(),n++)}for(const i of this._config.statsfields){const e=new b;e.field=i.name,e.tofieldname=i.name,e.workingexpr=i.expression instanceof I?i.expression:I.create(i.expression,r),e.typeofstat=D(i.statistic),this._decodedStatsfield.push(e)}this._decodedGroupbyfield=[];for(const i of this._config.groupbyfields){const e={name:i.name,singlefield:null,tofieldname:i.name,expression:i.expression instanceof I?i.expression:I.create(i.expression,r)};this._decodedGroupbyfield.push(e)}if(null!==this._parent){this.geometryType=this._parent.geometryType,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=\"\";for(const t of this._parent.fields)e[t.name.toUpperCase()]=1;this.types=null}else this.geometryType=f.point,this.typeIdField=\"\",this.types=null,this.spatialReference=new S({wkid:4326});this.fields=[];const a=new b;a.field=this._nextUniqueName(e),a.tofieldname=this.objectIdField,a.workingexpr=I.create(this._parent.objectIdField,this._parent.getFieldsIndex()),a.typeofstat=\"MIN\",this._decodedStatsfield.push(a);for(const s of this._decodedGroupbyfield){const t=new x;if(s.name=this._nextUniqueName(e),t.name=s.tofieldname,t.alias=t.name,h(s.expression)){const e=this._parent.getField(p(s.expression,c.Standardised));if(!e)throw new Error(\"Field is not present for Aggregation\");s.name=e.name,s.singlefield=e.name,this.phsyicalgroupbyfields.push(e.name),t.type=e.type}else{t.type=this._convertToEsriFieldType(g(s.expression,this._parent.fields));const e=new x;e.name=s.name,e.alias=e.name,this.phsyicalgroupbyfields.push(s.name),this._adaptedFields.push(new i(e,s.expression)),this._candosimplegroupby=!1}this.fields.push(t)}if(this._adaptedFields.length>0)for(const i of this._parent.fields)this._adaptedFields.push(new s(i));for(let i=0;i<this._decodedStatsfield.length;i++){const t=new x;let s=null;const n=this._decodedStatsfield[i];n.field=this._nextUniqueName(e),n.tofieldname===this.objectIdField&&(this._internalObjectIdField=n.field),t.name=n.tofieldname,t.alias=t.name;const r=null!==n.workingexpr&&h(n.workingexpr)?p(n.workingexpr,c.Standardised):\"\";switch(this._decodedStatsfield[i].typeofstat){case\"SUM\":if(\"\"!==r){if(s=this._parent.getField(r),!s)throw new Error(\"Field is not present for Aggregation\");t.type=s.type}else t.type=\"double\";break;case\"MIN\":case\"MAX\":if(\"\"!==r){if(s=this._parent.getField(r),!s)throw new Error(\"Field is not present for Aggregation\");t.type=s.type}else t.type=\"double\";break;case\"COUNT\":t.type=\"integer\";break;case\"STDDEV\":case\"VAR\":case\"AVG\":if(\"\"!==r&&(s=this._parent.getField(r),!s))throw new Error(\"Field is not present for Aggregation\");t.type=\"double\"}this.fields.push(t)}}async _canDoAggregates(){return!1}async _getFeatures(e,t,i,s){-1!==t&&this._featureCache[t];const n=this._maxQuery;return!0===this._checkIfNeedToExpandKnownPage(e,n)?(await this._expandPagedSet(e,n,0,0,s),this._getFeatures(e,t,i,s)):\"success\"}async _getFilteredSet(e,t,i,s,l){if(\"\"!==e)return new o([],[],!0,null);let u=null;const f={ordered:!1,nowhereclause:!1};if(await this._ensureLoaded(),null!==i)for(let n=0;n<this._decodedStatsfield.length;n++)if(!0===_(i,this._decodedStatsfield[n].tofieldname)){f.nowhereclause=!0,i=null;break}if(null!==s){f.ordered=!0;for(let e=0;e<this._decodedStatsfield.length;e++)if(!0===s.scanForField(this._decodedStatsfield[e].tofieldname)){s=null,f.ordered=!1;break}if(null!==s)for(const e of this._decodedGroupbyfield)if(null===e.singlefield&&!0===s.scanForField(e.tofieldname)){s=null,f.ordered=!1;break}}if(!1!==this._candosimplegroupby&&await this._parent._canDoAggregates(this.phsyicalgroupbyfields,this._decodedStatsfield,\"\",null,null)){let e=null;i&&(e=this._reformulateWhereClauseWithoutGroupByFields(i));let t=null;s&&(t=this._reformulateOrderClauseWithoutGroupByFields(s));const n=await this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields,this._decodedStatsfield,\"\",null,e,t,this._internalObjectIdField);return this._checkCancelled(l),u=!0===f.nowhereclause?new o(n._candidates.slice(0).concat(n._known.slice(0)),[],!0===f.ordered&&n._ordered,this._clonePageDefinition(n.pagesDefinition)):new o(n._candidates.slice(0),n._known.slice(0),!0===f.ordered&&n._ordered,this._clonePageDefinition(n.pagesDefinition)),u}let c=this._parent;if(this._adaptedFields.length>0&&(c=new n({parentfeatureset:this._parent,adaptedFields:this._adaptedFields,extraFilter:null})),!0===f.nowhereclause)u=new o([\"GETPAGES\"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:\"manual\",iterator:null,set:[],subfeatureset:new a({parentfeatureset:c,orderbyclause:new d(this.phsyicalgroupbyfields.join(\",\")+\",\"+this._parent.objectIdField+\" ASC\")})}});else{let e=c;if(null!==i){let t=null;i&&(t=this._reformulateWhereClauseWithoutGroupByFields(i)),e=new r({parentfeatureset:e,whereclause:t})}u=new o([\"GETPAGES\"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:\"manual\",iterator:null,set:[],subfeatureset:new a({parentfeatureset:e,orderbyclause:new d(this.phsyicalgroupbyfields.join(\",\")+\",\"+this._parent.objectIdField+\" ASC\")})}})}return u}_reformulateWhereClauseWithoutStatsFields(e){for(const t of this._decodedStatsfield)e=m(e,t.tofieldname,p(t.workingexpr,c.Standardised),this._parent.getFieldsIndex());return e}_reformulateWhereClauseWithoutGroupByFields(e){for(const t of this._decodedGroupbyfield)t.tofieldname!==t.name&&(e=m(e,t.tofieldname,p(t.expression,c.Standardised),this._parent.getFieldsIndex()));return e}_reformulateOrderClauseWithoutGroupByFields(e){const t=[];for(const i of this._decodedGroupbyfield)i.tofieldname!==i.name&&t.push({field:i.tofieldname,newfield:i.name});return t.length>0?e.replaceFields(t):e}_clonePageDefinition(e){return null===e?null:!0===e.aggregatefeaturesetpagedefinition?{aggregatefeaturesetpagedefinition:!0,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,internal:e.internal}:this._parent._clonePageDefinition(e)}async _refineSetBlock(e,t,i){if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQuery))return await this._expandPagedSet(e,this._maxQuery,0,0,i),this._refineSetBlock(e,t,i);this._checkCancelled(i);const s=e._candidates.length;this._refineKnowns(e,t);e._candidates.length;return e._candidates.length,e}_expandPagedSet(e,t,i,s,n){return this._expandPagedSetFeatureSet(e,t,i,s,n)}async _getPhysicalPage(t,i,s){if(!0===t.pagesDefinition.aggregatefeaturesetpagedefinition)return this._sequentialGetPhysicalItem(t,t.pagesDefinition.resultRecordCount,s,[]);const n=await this._getAgregagtePhysicalPage(t,i,s);for(const r of n){const t={geometry:r.geometry,attributes:{}};for(const e of this._decodedGroupbyfield)t.attributes[e.tofieldname]=r.attributes[e.name];for(const e of this._decodedStatsfield)t.attributes[e.tofieldname]=r.attributes[e.field];this._featureCache[t.attributes[this.objectIdField]]=new e(t)}return n.length}_sequentialGetPhysicalItem(e,t,i,s){return new Promise(((n,r)=>{null===e.pagesDefinition.internal.iterator&&(e.pagesDefinition.internal.iterator=e.pagesDefinition.internal.subfeatureset.iterator(i)),!0===e.pagesDefinition.internal.fullyResolved||0===t?n(s.length):this._nextAggregateItem(e,t,i,s,(r=>{null===r?n(s.length):(t-=1,n(this._sequentialGetPhysicalItem(e,t,i,s)))}),r)}))}_nextAggregateItem(e,i,s,n,r,a){try{t(e.pagesDefinition.internal.iterator.next()).then((t=>{if(null===t)if(null!==e.pagesDefinition.internal.workingItem){const t=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);n.push(t),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(t.attributes[this.objectIdField]),e.pagesDefinition.internal.fullyResolved=!0,r(null)}else e.pagesDefinition.internal.fullyResolved=!0,r(null);else{const l=this._generateAggregateHash(t);if(null===e.pagesDefinition.internal.workingItem)e.pagesDefinition.internal.workingItem={features:[t],id:l};else{if(l!==e.pagesDefinition.internal.workingItem.id){const s=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);return n.push(s),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(s.attributes[this.objectIdField]),i-=1,e.pagesDefinition.internal.workingItem={features:[t],id:l},void r(s)}e.pagesDefinition.internal.workingItem.features.push(t)}this._nextAggregateItem(e,i,s,n,r,a)}}),a)}catch(l){a(l)}}_calculateFieldStat(e,t,i){const s=[];for(let n=0;n<e.features.length;n++)if(null!==t.workingexpr){const i=t.workingexpr.calculateValue(e.features[n]);null!==i&&s.push(i)}else s.push(null);switch(t.typeofstat){case\"MIN\":i.attributes[t.tofieldname]=y(\"min\",s,-1);break;case\"MAX\":i.attributes[t.tofieldname]=y(\"max\",s,-1);break;case\"SUM\":i.attributes[t.tofieldname]=y(\"sum\",s,-1);break;case\"COUNT\":i.attributes[t.tofieldname]=s.length;break;case\"VAR\":i.attributes[t.tofieldname]=y(\"var\",s,-1);break;case\"STDDEV\":i.attributes[t.tofieldname]=y(\"stddev\",s,-1);break;case\"AVG\":i.attributes[t.tofieldname]=y(\"avg\",s,-1)}return!0}_calculateAndAppendAggregateItem(t){const i={attributes:{},geometry:null};for(const e of this._decodedGroupbyfield){const s=e.singlefield?t.features[0].attributes[e.singlefield]:e.expression.calculateValue(t.features[0]);i.attributes[e.tofieldname]=s}for(const e of this._decodedStatsfield)this._calculateFieldStat(t,e,i);const s=[];for(let e=0;e<this._decodedStatsfield.length;e++)s.push(this._calculateFieldStat(t,this._decodedStatsfield[e],i));return this._featureCache[i.attributes[this.objectIdField]]=new e({attributes:i.attributes,geometry:i.geometry}),i}_generateAggregateHash(e){let t=\"\";for(const i of this._decodedGroupbyfield){const s=i.singlefield?e.attributes[i.singlefield]:i.expression.calculateValue(e);t+=null==s?\":\":\":\"+s.toString()}return w(t,F.String)}async _stat(){return{calculated:!1}}async getFeatureByObjectId(){return null}static registerAction(){l._featuresetFunctions.groupby=function(e,t){return new A({parentfeatureset:this,groupbyfields:e,statsfields:t})}}}export{A as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}