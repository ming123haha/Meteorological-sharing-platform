{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isSome as e, get as t, isNone as s } from \"../../../core/maybe.js\";\nimport { TextureUpdate as i } from \"./interfaces.js\";\nimport { PROGRESSIVE_LOADING_MODULO as l } from \"./TerrainConst.js\";\nimport { getLayerWithExtentRange as a } from \"./terrainUtils.js\";\nimport { fallsWithinLayer as r } from \"./tileUtils.js\";\n\nclass n {\n  get updating() {\n    return !!this._tileRequested;\n  }\n\n  init(e, t, s, i) {\n    this.tile = e, this._layerIdx = t, this._layerClass = s, this._suspended = i, this._tileLayerInfo = e.getLayerInfo(t, s), this._tileRequested = null;\n\n    const l = this._findAncestorWithData();\n\n    this._setUpsampleTile(l);\n  }\n\n  startLoading() {\n    return this._requestNext();\n  }\n\n  dispose() {\n    this._tileRequested && (this._tileRequested.unrequestLayerData(this._layerIdx, this._layerClass, this), this._tileRequested = null), this.tile = null, this._tileLayerInfo = null;\n  }\n\n  setSuspension(e) {\n    e !== this._suspended && (this._suspended = e, e ? this._tileRequested && (this._tileRequested.unrequestLayerData(this._layerIdx, this._layerClass, this), this._tileRequested = null) : this._tileLayerInfo.data || this.update());\n  }\n\n  update() {\n    const e = this._findAncestorWithData();\n\n    return this._setUpsampleTile(e), this._requestNext();\n  }\n\n  dataArrived(e) {\n    this._setUpsampleTile(e), this._tileRequested = null, e === this.tile ? this.tile.updateRenderData(this._layerClass, i.FADING) : this._requestNext();\n  }\n\n  dataMissing() {\n    this._tileRequested = null, this._tileLayerInfo.data = null, this._requestNext();\n  }\n\n  _agentDone() {\n    this.tile.agentDone(this._layerIdx, this._layerClass), this.dispose();\n  }\n\n  _requestNext() {\n    if (this._suspended) return !0;\n\n    const t = this._findNextDownload();\n\n    if (this._tileRequested) {\n      if (t === this._tileRequested) return !0;\n      this._tileRequested.unrequestLayerData(this._layerIdx, this._layerClass, this), this._tileRequested = null;\n    }\n\n    return e(t) ? t.requestLayerData(this._layerIdx, this._layerClass, this) && (this._tileRequested = t) : this._agentDone(), !!this._tileRequested;\n  }\n\n  _findNextDownload() {\n    const i = this._layerIdx,\n          n = this._layerClass,\n          h = this.tile.surface.layerViewByIndex(i, n),\n          d = a(h),\n          {\n      minLevel: _,\n      maxLevel: o\n    } = h.dataLevelRange,\n          u = this._desiredMinLevelDelta,\n          p = this._progressiveLevelModulo + u,\n          y = this._scaleRangeEnabled ? r : () => !0;\n    let f = this.tile;\n    const I = f.level;\n    let q;\n    const v = this._tileLayerInfo.upsampleInfo,\n          L = e(v) ? v.tile.level : -1,\n          m = !!e(v) && L - I >= u,\n          D = t(d, \"tilemapCache\");\n\n    for (; f && y(f, d, !1) && f.level >= _;) {\n      const e = f.level,\n            t = I - e,\n            a = f.layerInfo[n][i];\n\n      if (a.data && t >= u) {\n        (!m || e > L) && this._setUpsampleTile(f), a.dataInvalidated && (q = f);\n        break;\n      }\n\n      if ((s(D) || \"unavailable\" !== D.getAvailability(f.lij[0], f.lij[1], f.lij[2])) && e <= o && !a.data && !a.dataMissing && ((s(q) || f.level === _ || e % l == 0 || I - q.level < u) && (q = f), t >= p)) break;\n      f = f.parent;\n    }\n\n    return e(q) && I - q.level < u && this._tileLayerInfo.upsampleInfo && (q = null), q;\n  }\n\n  _findAncestorWithData() {\n    const e = this.tile.vlevel,\n          t = this._desiredMinLevelDelta;\n    let s;\n\n    for (let i = this.tile; i; i = i.parent) if (i.hasLayerData(this._layerIdx, this._layerClass)) {\n      if (e - i.level >= t) return i;\n      s = i;\n    }\n\n    return s;\n  }\n\n  _setUpsampleTile(e) {\n    this._tileLayerInfo.setUpsampleInfo(this.tile, e), this.tile.updateRenderData(this._layerClass, i.FADING);\n  }\n\n  get test() {\n    return {\n      findNextDownload: () => this._findNextDownload(),\n      tileLayerInfo: this._tileLayerInfo\n    };\n  }\n\n}\n\nclass h extends n {\n  get _desiredMinLevelDelta() {\n    throw d;\n  }\n\n  get _progressiveLevelModulo() {\n    throw d;\n  }\n\n  dispose() {}\n\n}\n\nconst d = new Error(\"Abstract method called on TileAgent\"),\n      _ = new h();\n\nexport { _ as TILE_AGENT_DONE, n as TileAgent };","map":{"version":3,"names":["isSome","e","get","t","isNone","s","TextureUpdate","i","PROGRESSIVE_LOADING_MODULO","l","getLayerWithExtentRange","a","fallsWithinLayer","r","n","updating","_tileRequested","init","tile","_layerIdx","_layerClass","_suspended","_tileLayerInfo","getLayerInfo","_findAncestorWithData","_setUpsampleTile","startLoading","_requestNext","dispose","unrequestLayerData","setSuspension","data","update","dataArrived","updateRenderData","FADING","dataMissing","_agentDone","agentDone","_findNextDownload","requestLayerData","h","surface","layerViewByIndex","d","minLevel","_","maxLevel","o","dataLevelRange","u","_desiredMinLevelDelta","p","_progressiveLevelModulo","y","_scaleRangeEnabled","f","I","level","q","v","upsampleInfo","L","m","D","layerInfo","dataInvalidated","getAvailability","lij","parent","vlevel","hasLayerData","setUpsampleInfo","test","findNextDownload","tileLayerInfo","Error","TILE_AGENT_DONE","TileAgent"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/terrain/TileAgent.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as e,get as t,isNone as s}from\"../../../core/maybe.js\";import{TextureUpdate as i}from\"./interfaces.js\";import{PROGRESSIVE_LOADING_MODULO as l}from\"./TerrainConst.js\";import{getLayerWithExtentRange as a}from\"./terrainUtils.js\";import{fallsWithinLayer as r}from\"./tileUtils.js\";class n{get updating(){return!!this._tileRequested}init(e,t,s,i){this.tile=e,this._layerIdx=t,this._layerClass=s,this._suspended=i,this._tileLayerInfo=e.getLayerInfo(t,s),this._tileRequested=null;const l=this._findAncestorWithData();this._setUpsampleTile(l)}startLoading(){return this._requestNext()}dispose(){this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null),this.tile=null,this._tileLayerInfo=null}setSuspension(e){e!==this._suspended&&(this._suspended=e,e?this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null):this._tileLayerInfo.data||this.update())}update(){const e=this._findAncestorWithData();return this._setUpsampleTile(e),this._requestNext()}dataArrived(e){this._setUpsampleTile(e),this._tileRequested=null,e===this.tile?this.tile.updateRenderData(this._layerClass,i.FADING):this._requestNext()}dataMissing(){this._tileRequested=null,this._tileLayerInfo.data=null,this._requestNext()}_agentDone(){this.tile.agentDone(this._layerIdx,this._layerClass),this.dispose()}_requestNext(){if(this._suspended)return!0;const t=this._findNextDownload();if(this._tileRequested){if(t===this._tileRequested)return!0;this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null}return e(t)?t.requestLayerData(this._layerIdx,this._layerClass,this)&&(this._tileRequested=t):this._agentDone(),!!this._tileRequested}_findNextDownload(){const i=this._layerIdx,n=this._layerClass,h=this.tile.surface.layerViewByIndex(i,n),d=a(h),{minLevel:_,maxLevel:o}=h.dataLevelRange,u=this._desiredMinLevelDelta,p=this._progressiveLevelModulo+u,y=this._scaleRangeEnabled?r:()=>!0;let f=this.tile;const I=f.level;let q;const v=this._tileLayerInfo.upsampleInfo,L=e(v)?v.tile.level:-1,m=!!e(v)&&L-I>=u,D=t(d,\"tilemapCache\");for(;f&&y(f,d,!1)&&f.level>=_;){const e=f.level,t=I-e,a=f.layerInfo[n][i];if(a.data&&t>=u){(!m||e>L)&&this._setUpsampleTile(f),a.dataInvalidated&&(q=f);break}if((s(D)||\"unavailable\"!==D.getAvailability(f.lij[0],f.lij[1],f.lij[2]))&&e<=o&&!a.data&&!a.dataMissing&&((s(q)||f.level===_||e%l==0||I-q.level<u)&&(q=f),t>=p))break;f=f.parent}return e(q)&&I-q.level<u&&this._tileLayerInfo.upsampleInfo&&(q=null),q}_findAncestorWithData(){const e=this.tile.vlevel,t=this._desiredMinLevelDelta;let s;for(let i=this.tile;i;i=i.parent)if(i.hasLayerData(this._layerIdx,this._layerClass)){if(e-i.level>=t)return i;s=i}return s}_setUpsampleTile(e){this._tileLayerInfo.setUpsampleInfo(this.tile,e),this.tile.updateRenderData(this._layerClass,i.FADING)}get test(){return{findNextDownload:()=>this._findNextDownload(),tileLayerInfo:this._tileLayerInfo}}}class h extends n{get _desiredMinLevelDelta(){throw d}get _progressiveLevelModulo(){throw d}dispose(){}}const d=new Error(\"Abstract method called on TileAgent\"),_=new h;export{_ as TILE_AGENT_DONE,n as TileAgent};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}