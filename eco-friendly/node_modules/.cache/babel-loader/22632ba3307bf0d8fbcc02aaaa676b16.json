{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../request.js\";\nimport r from \"../../core/Error.js\";\nimport \"../../core/has.js\";\nimport o from \"../../core/Logger.js\";\nimport { isSome as i } from \"../../core/maybe.js\";\nimport { debounce as s } from \"../../core/promiseUtils.js\";\nimport { urlToObject as a } from \"../../core/urlUtils.js\";\nimport { property as n } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { reader as l } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as p } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { writer as d } from \"../../core/accessorSupport/decorators/writer.js\";\nimport { updateOrigins as c } from \"../../core/accessorSupport/originUtils.js\";\nimport u from \"../../geometry/Extent.js\";\nimport m from \"../../geometry/HeightModelInfo.js\";\nimport y from \"../../geometry/SpatialReference.js\";\nimport { titleFromUrlAndName as h, parse as f, cleanTitle as v, sanitizeUrlWithLayerId as S, writeUrlWithLayerId as g } from \"../support/arcgisLayerUrl.js\";\nimport { id as w, url as I } from \"../support/commonProperties.js\";\nimport { fetchIndexInfo as x } from \"../support/I3SIndexInfo.js\";\nimport b from \"../../portal/Portal.js\";\nimport j from \"../../portal/PortalItem.js\";\nimport { saveResources as _ } from \"../../webdoc/support/saveUtils.js\";\n\nconst R = \"esri.layers.mixins.SceneService\",\n      A = o.getLogger(R),\n      N = o => {\n  let N = class extends o {\n    constructor() {\n      super(...arguments), this.spatialReference = null, this.fullExtent = null, this.heightModelInfo = null, this.minScale = 0, this.maxScale = 0, this.version = {\n        major: Number.NaN,\n        minor: Number.NaN,\n        versionString: \"\"\n      }, this.copyright = null, this.sublayerTitleMode = \"item-title\", this.title = null, this.layerId = null, this.indexInfo = null, this._debouncedSaveOperations = s(async (e, t, r) => {\n        switch (e) {\n          case L.SAVE:\n            return this._save(t);\n\n          case L.SAVE_AS:\n            return this._saveAs(r, t);\n        }\n      });\n    }\n\n    readSpatialReference(e, t) {\n      return this._readSpatialReference(t);\n    }\n\n    _readSpatialReference(e) {\n      if (null != e.spatialReference) return y.fromJSON(e.spatialReference);\n      {\n        const t = e.store,\n              r = t.indexCRS || t.geographicCRS,\n              o = r && parseInt(r.substring(r.lastIndexOf(\"/\") + 1, r.length), 10);\n        return null != o ? new y(o) : null;\n      }\n    }\n\n    readFullExtent(e, t, r) {\n      if (null != e && \"object\" == typeof e) {\n        const o = null == e.spatialReference ? { ...e,\n          spatialReference: this._readSpatialReference(t)\n        } : e;\n        return u.fromJSON(o, r);\n      }\n\n      const o = t.store,\n            i = this._readSpatialReference(t);\n\n      return null == i || null == o || null == o.extent || !Array.isArray(o.extent) || o.extent.some(e => e < U) ? null : new u({\n        xmin: o.extent[0],\n        ymin: o.extent[1],\n        xmax: o.extent[2],\n        ymax: o.extent[3],\n        spatialReference: i\n      });\n    }\n\n    parseVersionString(e) {\n      const t = {\n        major: Number.NaN,\n        minor: Number.NaN,\n        versionString: e\n      },\n            r = e.split(\".\");\n      return r.length >= 2 && (t.major = parseInt(r[0], 10), t.minor = parseInt(r[1], 10)), t;\n    }\n\n    readVersion(e, t) {\n      const r = t.store,\n            o = null != r.version ? r.version.toString() : \"\";\n      return this.parseVersionString(o);\n    }\n\n    readTitlePortalItem(e) {\n      return \"item-title\" !== this.sublayerTitleMode ? void 0 : e;\n    }\n\n    readTitleService(e, t) {\n      const r = this.portalItem && this.portalItem.title;\n      if (\"item-title\" === this.sublayerTitleMode) return h(this.url, t.name);\n      let o = t.name;\n\n      if (!o && this.url) {\n        const e = f(this.url);\n        i(e) && (o = e.title);\n      }\n\n      return \"item-title-and-service-name\" === this.sublayerTitleMode && r && (o = r + \" - \" + o), v(o);\n    }\n\n    set url(e) {\n      const t = S({\n        layer: this,\n        url: e,\n        nonStandardUrlAllowed: !1,\n        logger: A\n      });\n      this._set(\"url\", t.url), null != t.layerId && this._set(\"layerId\", t.layerId);\n    }\n\n    writeUrl(e, t, r, o) {\n      g(this, e, \"layers\", t, o);\n    }\n\n    get parsedUrl() {\n      const e = this._get(\"url\"),\n            t = a(e);\n\n      return null != this.layerId && (t.path = `${t.path}/layers/${this.layerId}`), t;\n    }\n\n    async _fetchIndexAndUpdateExtent(e, t) {\n      this.indexInfo = x(this.parsedUrl.path, this.rootNode, e, this.apiKey, A, t), null == this.fullExtent || this.fullExtent.hasZ || this._updateExtent(await this.indexInfo);\n    }\n\n    _updateExtent(e) {\n      if (\"page\" === e?.type) {\n        const t = e.rootIndex % e.pageSize,\n              o = e.rootPage?.nodes?.[t];\n        if (null == o || null == o.obb || null == o.obb.center || null == o.obb.halfSize) throw new r(\"sceneservice:invalid-node-page\", \"Invalid node page.\");\n        if (o.obb.center[0] < U || null == this.fullExtent || this.fullExtent.hasZ) return;\n        const i = o.obb.halfSize,\n              s = o.obb.center[2],\n              a = Math.sqrt(i[0] * i[0] + i[1] * i[1] + i[2] * i[2]);\n        this.fullExtent.zmin = s - a, this.fullExtent.zmax = s + a;\n      } else if (\"node\" === e?.type) {\n        const t = e.rootNode?.mbs;\n        if (!Array.isArray(t) || 4 !== t.length || t[0] < U) return;\n        const r = t[2],\n              o = t[3],\n              {\n          fullExtent: i\n        } = this;\n        i && (i.zmin = r - o, i.zmax = r + o);\n      }\n    }\n\n    async _fetchService(e) {\n      if (null == this.url) throw new r(\"sceneservice:url-not-set\", \"Scene service can not be loaded without valid portal item or url\");\n\n      if (null == this.layerId && /SceneServer\\/*$/i.test(this.url)) {\n        const t = await this._fetchFirstLayerId(e);\n        null != t && (this.layerId = t);\n      }\n\n      return this._fetchServiceLayer(e);\n    }\n\n    async _fetchFirstLayerId(e) {\n      const r = await t(this.url, {\n        query: {\n          f: \"json\",\n          token: this.apiKey\n        },\n        responseType: \"json\",\n        signal: e\n      });\n      if (r.data && Array.isArray(r.data.layers) && r.data.layers.length > 0) return r.data.layers[0].id;\n    }\n\n    async _fetchServiceLayer(e) {\n      const r = await t(this.parsedUrl?.path ?? \"\", {\n        query: {\n          f: \"json\",\n          token: this.apiKey\n        },\n        responseType: \"json\",\n        signal: e\n      });\n      r.ssl && (this.url = this.url.replace(/^http:/i, \"https:\"));\n      let o = !1;\n      if (r.data.layerType && \"Voxel\" === r.data.layerType && (o = !0), o) return this._fetchVoxelServiceLayer();\n      const i = r.data;\n      this.read(i, {\n        origin: \"service\",\n        url: this.parsedUrl\n      }), this.validateLayer(i);\n    }\n\n    async _fetchVoxelServiceLayer(e) {\n      const r = (await t(this.parsedUrl?.path + \"/layer\", {\n        query: {\n          f: \"json\",\n          token: this.apiKey\n        },\n        responseType: \"json\",\n        signal: e\n      })).data;\n      this.read(r, {\n        origin: \"service\",\n        url: this.parsedUrl\n      }), this.validateLayer(r);\n    }\n\n    async _ensureLoadBeforeSave() {\n      await this.load(), \"beforeSave\" in this && \"function\" == typeof this.beforeSave && (await this.beforeSave());\n    }\n\n    validateLayer(e) {}\n\n    _updateTypeKeywords(e, t, r) {\n      e.typeKeywords || (e.typeKeywords = []);\n      const o = t.getTypeKeywords();\n\n      for (const i of o) e.typeKeywords.push(i);\n\n      e.typeKeywords && (e.typeKeywords = e.typeKeywords.filter((e, t, r) => r.indexOf(e) === t), r === T.newItem && (e.typeKeywords = e.typeKeywords.filter(e => \"Hosted Service\" !== e)));\n    }\n\n    async _saveAs(e, t) {\n      const o = { ...K,\n        ...t\n      };\n      let i = j.from(e);\n      i || (A.error(\"_saveAs(): requires a portal item parameter\"), await Promise.reject(new r(\"sceneservice:portal-item-required\", \"_saveAs() requires a portal item to save to\"))), i.id && (i = i.clone(), i.id = null);\n      const s = i.portal || b.getDefault();\n      await this._ensureLoadBeforeSave(), i.type = O, i.portal = s;\n      const a = {\n        origin: \"portal-item\",\n        url: null,\n        messages: [],\n        portal: s,\n        portalItem: i,\n        writtenProperties: [],\n        blockedRelativeUrls: [],\n        resources: {\n          toAdd: [],\n          toUpdate: [],\n          toKeep: [],\n          pendingOperations: []\n        }\n      },\n            n = {\n        layers: [this.write({}, a)]\n      };\n      return await Promise.all(a.resources?.pendingOperations ?? []), await this._validateAgainstJSONSchema(n, a, o), i.url = this.url, i.title || (i.title = this.title), this._updateTypeKeywords(i, o, T.newItem), await s._signIn(), await s.user?.addItem({\n        item: i,\n        folder: o && o.folder,\n        data: n\n      }), await _(this.resourceReferences, a, null), this.portalItem = i, c(a), a.portalItem = i, i;\n    }\n\n    async _save(e) {\n      const t = { ...K,\n        ...e\n      };\n      if (!this.portalItem) throw A.error(\"_save(): requires the .portalItem property to be set\"), new r(\"sceneservice:portal-item-not-set\", \"Portal item to save to has not been set on this SceneService\");\n      if (this.portalItem.type !== O) throw A.error(\"_save(): Non-matching portal item type. Got \" + this.portalItem.type + \", expected \" + O), new r(\"sceneservice:portal-item-wrong-type\", `Portal item needs to have type \"${O}\"`);\n      await this._ensureLoadBeforeSave();\n      const o = {\n        origin: \"portal-item\",\n        url: this.portalItem.itemUrl && a(this.portalItem.itemUrl),\n        messages: [],\n        portal: this.portalItem.portal || b.getDefault(),\n        portalItem: this.portalItem,\n        writtenProperties: [],\n        blockedRelativeUrls: [],\n        resources: {\n          toAdd: [],\n          toUpdate: [],\n          toKeep: [],\n          pendingOperations: []\n        }\n      },\n            i = {\n        layers: [this.write({}, o)]\n      };\n      return await Promise.all(o.resources?.pendingOperations ?? []), await this._validateAgainstJSONSchema(i, o, t), this.portalItem.url = this.url, this.portalItem.title || (this.portalItem.title = this.title), this._updateTypeKeywords(this.portalItem, t, T.existingItem), await this.portalItem.update({\n        data: i\n      }), await _(this.resourceReferences, o, null), c(o), this.portalItem;\n    }\n\n    async _validateAgainstJSONSchema(e, t, o) {\n      let i = t.messages?.filter(e => \"error\" === e.type).map(e => new r(e.name, e.message, e.details)) ?? [];\n\n      if (o && o.validationOptions?.ignoreUnsupported && (i = i.filter(e => \"layer:unsupported\" !== e.name && \"symbol:unsupported\" !== e.name && \"symbol-layer:unsupported\" !== e.name && \"property:unsupported\" !== e.name && \"url:unsupported\" !== e.name && \"scenemodification:unsupported\" !== e.name)), o.validationOptions?.enabled || E) {\n        const t = (await import(\"../support/schemaValidator.js\")).validate(e, o.portalItemLayerType);\n\n        if (t.length > 0) {\n          const e = `Layer item did not validate:\\n${t.join(\"\\n\")}`;\n\n          if (A.error(`_validateAgainstJSONSchema(): ${e}`), \"throw\" === o.validationOptions?.failPolicy) {\n            const e = t.map(e => new r(\"sceneservice:schema-validation\", e)).concat(i);\n            throw new r(\"sceneservice-validate:error\", \"Failed to save layer item due to schema validation, see `details.errors`.\", {\n              combined: e\n            });\n          }\n        }\n      }\n\n      if (i.length > 0) throw new r(\"sceneservice:save\", \"Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information\", {\n        errors: i\n      });\n    }\n\n  };\n  return e([n(w)], N.prototype, \"id\", void 0), e([n({\n    type: y\n  })], N.prototype, \"spatialReference\", void 0), e([l(\"spatialReference\", [\"spatialReference\", \"store.indexCRS\", \"store.geographicCRS\"])], N.prototype, \"readSpatialReference\", null), e([n({\n    type: u\n  })], N.prototype, \"fullExtent\", void 0), e([l(\"fullExtent\", [\"fullExtent\", \"store.extent\", \"spatialReference\", \"store.indexCRS\", \"store.geographicCRS\"])], N.prototype, \"readFullExtent\", null), e([n({\n    readOnly: !0,\n    type: m\n  })], N.prototype, \"heightModelInfo\", void 0), e([n({\n    type: Number,\n    json: {\n      name: \"layerDefinition.minScale\",\n      write: !0,\n      origins: {\n        service: {\n          read: {\n            source: \"minScale\"\n          },\n          write: !1\n        }\n      }\n    }\n  })], N.prototype, \"minScale\", void 0), e([n({\n    type: Number,\n    json: {\n      name: \"layerDefinition.maxScale\",\n      write: !0,\n      origins: {\n        service: {\n          read: {\n            source: \"maxScale\"\n          },\n          write: !1\n        }\n      }\n    }\n  })], N.prototype, \"maxScale\", void 0), e([n({\n    readOnly: !0\n  })], N.prototype, \"version\", void 0), e([l(\"version\", [\"store.version\"])], N.prototype, \"readVersion\", null), e([n({\n    type: String,\n    json: {\n      read: {\n        source: \"copyrightText\"\n      }\n    }\n  })], N.prototype, \"copyright\", void 0), e([n({\n    type: String,\n    json: {\n      read: !1\n    }\n  })], N.prototype, \"sublayerTitleMode\", void 0), e([n({\n    type: String\n  })], N.prototype, \"title\", void 0), e([l(\"portal-item\", \"title\")], N.prototype, \"readTitlePortalItem\", null), e([l(\"service\", \"title\", [\"name\"])], N.prototype, \"readTitleService\", null), e([n({\n    type: Number,\n    json: {\n      origins: {\n        service: {\n          read: {\n            source: \"id\"\n          }\n        },\n        \"portal-item\": {\n          write: {\n            target: \"id\",\n            isRequired: !0,\n            ignoreOrigin: !0\n          },\n          read: !1\n        }\n      }\n    }\n  })], N.prototype, \"layerId\", void 0), e([n(I)], N.prototype, \"url\", null), e([d(\"url\")], N.prototype, \"writeUrl\", null), e([n()], N.prototype, \"parsedUrl\", null), e([n({\n    readOnly: !0\n  })], N.prototype, \"store\", void 0), e([n({\n    type: String,\n    readOnly: !0,\n    json: {\n      read: {\n        source: \"store.rootNode\"\n      }\n    }\n  })], N.prototype, \"rootNode\", void 0), N = e([p(R)], N), N;\n},\n      U = -1e38,\n      E = !1;\n\nvar T;\n!function (e) {\n  e[e.existingItem = 0] = \"existingItem\", e[e.newItem = 1] = \"newItem\";\n}(T || (T = {}));\nconst O = \"Scene Service\",\n      K = {\n  getTypeKeywords: () => [],\n  portalItemLayerType: \"unknown\",\n  validationOptions: {\n    enabled: !0,\n    ignoreUnsupported: !1,\n    failPolicy: \"throw\"\n  }\n};\nvar L;\n!function (e) {\n  e[e.SAVE = 0] = \"SAVE\", e[e.SAVE_AS = 1] = \"SAVE_AS\";\n}(L || (L = {}));\nexport { O as SCENE_SERVICE_ITEM_TYPE, L as SaveOperationType, N as SceneService };","map":{"version":3,"names":["_","e","t","r","o","isSome","i","debounce","s","urlToObject","a","property","n","reader","l","subclass","p","writer","d","updateOrigins","c","u","m","y","titleFromUrlAndName","h","parse","f","cleanTitle","v","sanitizeUrlWithLayerId","S","writeUrlWithLayerId","g","id","w","url","I","fetchIndexInfo","x","b","j","saveResources","R","A","getLogger","N","constructor","arguments","spatialReference","fullExtent","heightModelInfo","minScale","maxScale","version","major","Number","NaN","minor","versionString","copyright","sublayerTitleMode","title","layerId","indexInfo","_debouncedSaveOperations","L","SAVE","_save","SAVE_AS","_saveAs","readSpatialReference","_readSpatialReference","fromJSON","store","indexCRS","geographicCRS","parseInt","substring","lastIndexOf","length","readFullExtent","extent","Array","isArray","some","U","xmin","ymin","xmax","ymax","parseVersionString","split","readVersion","toString","readTitlePortalItem","readTitleService","portalItem","name","layer","nonStandardUrlAllowed","logger","_set","writeUrl","parsedUrl","_get","path","_fetchIndexAndUpdateExtent","rootNode","apiKey","hasZ","_updateExtent","type","rootIndex","pageSize","rootPage","nodes","obb","center","halfSize","Math","sqrt","zmin","zmax","mbs","_fetchService","test","_fetchFirstLayerId","_fetchServiceLayer","query","token","responseType","signal","data","layers","ssl","replace","layerType","_fetchVoxelServiceLayer","read","origin","validateLayer","_ensureLoadBeforeSave","load","beforeSave","_updateTypeKeywords","typeKeywords","getTypeKeywords","push","filter","indexOf","T","newItem","K","from","error","Promise","reject","clone","portal","getDefault","O","messages","writtenProperties","blockedRelativeUrls","resources","toAdd","toUpdate","toKeep","pendingOperations","write","all","_validateAgainstJSONSchema","_signIn","user","addItem","item","folder","resourceReferences","itemUrl","existingItem","update","map","message","details","validationOptions","ignoreUnsupported","enabled","E","validate","portalItemLayerType","join","failPolicy","concat","combined","errors","prototype","readOnly","json","origins","service","source","String","target","isRequired","ignoreOrigin","SCENE_SERVICE_ITEM_TYPE","SaveOperationType","SceneService"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/mixins/SceneService.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import r from\"../../core/Error.js\";import\"../../core/has.js\";import o from\"../../core/Logger.js\";import{isSome as i}from\"../../core/maybe.js\";import{debounce as s}from\"../../core/promiseUtils.js\";import{urlToObject as a}from\"../../core/urlUtils.js\";import{property as n}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{reader as l}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as d}from\"../../core/accessorSupport/decorators/writer.js\";import{updateOrigins as c}from\"../../core/accessorSupport/originUtils.js\";import u from\"../../geometry/Extent.js\";import m from\"../../geometry/HeightModelInfo.js\";import y from\"../../geometry/SpatialReference.js\";import{titleFromUrlAndName as h,parse as f,cleanTitle as v,sanitizeUrlWithLayerId as S,writeUrlWithLayerId as g}from\"../support/arcgisLayerUrl.js\";import{id as w,url as I}from\"../support/commonProperties.js\";import{fetchIndexInfo as x}from\"../support/I3SIndexInfo.js\";import b from\"../../portal/Portal.js\";import j from\"../../portal/PortalItem.js\";import{saveResources as _}from\"../../webdoc/support/saveUtils.js\";const R=\"esri.layers.mixins.SceneService\",A=o.getLogger(R),N=o=>{let N=class extends o{constructor(){super(...arguments),this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:\"\"},this.copyright=null,this.sublayerTitleMode=\"item-title\",this.title=null,this.layerId=null,this.indexInfo=null,this._debouncedSaveOperations=s((async(e,t,r)=>{switch(e){case L.SAVE:return this._save(t);case L.SAVE_AS:return this._saveAs(r,t)}}))}readSpatialReference(e,t){return this._readSpatialReference(t)}_readSpatialReference(e){if(null!=e.spatialReference)return y.fromJSON(e.spatialReference);{const t=e.store,r=t.indexCRS||t.geographicCRS,o=r&&parseInt(r.substring(r.lastIndexOf(\"/\")+1,r.length),10);return null!=o?new y(o):null}}readFullExtent(e,t,r){if(null!=e&&\"object\"==typeof e){const o=null==e.spatialReference?{...e,spatialReference:this._readSpatialReference(t)}:e;return u.fromJSON(o,r)}const o=t.store,i=this._readSpatialReference(t);return null==i||null==o||null==o.extent||!Array.isArray(o.extent)||o.extent.some((e=>e<U))?null:new u({xmin:o.extent[0],ymin:o.extent[1],xmax:o.extent[2],ymax:o.extent[3],spatialReference:i})}parseVersionString(e){const t={major:Number.NaN,minor:Number.NaN,versionString:e},r=e.split(\".\");return r.length>=2&&(t.major=parseInt(r[0],10),t.minor=parseInt(r[1],10)),t}readVersion(e,t){const r=t.store,o=null!=r.version?r.version.toString():\"\";return this.parseVersionString(o)}readTitlePortalItem(e){return\"item-title\"!==this.sublayerTitleMode?void 0:e}readTitleService(e,t){const r=this.portalItem&&this.portalItem.title;if(\"item-title\"===this.sublayerTitleMode)return h(this.url,t.name);let o=t.name;if(!o&&this.url){const e=f(this.url);i(e)&&(o=e.title)}return\"item-title-and-service-name\"===this.sublayerTitleMode&&r&&(o=r+\" - \"+o),v(o)}set url(e){const t=S({layer:this,url:e,nonStandardUrlAllowed:!1,logger:A});this._set(\"url\",t.url),null!=t.layerId&&this._set(\"layerId\",t.layerId)}writeUrl(e,t,r,o){g(this,e,\"layers\",t,o)}get parsedUrl(){const e=this._get(\"url\"),t=a(e);return null!=this.layerId&&(t.path=`${t.path}/layers/${this.layerId}`),t}async _fetchIndexAndUpdateExtent(e,t){this.indexInfo=x(this.parsedUrl.path,this.rootNode,e,this.apiKey,A,t),null==this.fullExtent||this.fullExtent.hasZ||this._updateExtent(await this.indexInfo)}_updateExtent(e){if(\"page\"===e?.type){const t=e.rootIndex%e.pageSize,o=e.rootPage?.nodes?.[t];if(null==o||null==o.obb||null==o.obb.center||null==o.obb.halfSize)throw new r(\"sceneservice:invalid-node-page\",\"Invalid node page.\");if(o.obb.center[0]<U||null==this.fullExtent||this.fullExtent.hasZ)return;const i=o.obb.halfSize,s=o.obb.center[2],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);this.fullExtent.zmin=s-a,this.fullExtent.zmax=s+a}else if(\"node\"===e?.type){const t=e.rootNode?.mbs;if(!Array.isArray(t)||4!==t.length||t[0]<U)return;const r=t[2],o=t[3],{fullExtent:i}=this;i&&(i.zmin=r-o,i.zmax=r+o)}}async _fetchService(e){if(null==this.url)throw new r(\"sceneservice:url-not-set\",\"Scene service can not be loaded without valid portal item or url\");if(null==this.layerId&&/SceneServer\\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}return this._fetchServiceLayer(e)}async _fetchFirstLayerId(e){const r=await t(this.url,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e});if(r.data&&Array.isArray(r.data.layers)&&r.data.layers.length>0)return r.data.layers[0].id}async _fetchServiceLayer(e){const r=await t(this.parsedUrl?.path??\"\",{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e});r.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\"));let o=!1;if(r.data.layerType&&\"Voxel\"===r.data.layerType&&(o=!0),o)return this._fetchVoxelServiceLayer();const i=r.data;this.read(i,{origin:\"service\",url:this.parsedUrl}),this.validateLayer(i)}async _fetchVoxelServiceLayer(e){const r=(await t(this.parsedUrl?.path+\"/layer\",{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e})).data;this.read(r,{origin:\"service\",url:this.parsedUrl}),this.validateLayer(r)}async _ensureLoadBeforeSave(){await this.load(),\"beforeSave\"in this&&\"function\"==typeof this.beforeSave&&await this.beforeSave()}validateLayer(e){}_updateTypeKeywords(e,t,r){e.typeKeywords||(e.typeKeywords=[]);const o=t.getTypeKeywords();for(const i of o)e.typeKeywords.push(i);e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)),r===T.newItem&&(e.typeKeywords=e.typeKeywords.filter((e=>\"Hosted Service\"!==e))))}async _saveAs(e,t){const o={...K,...t};let i=j.from(e);i||(A.error(\"_saveAs(): requires a portal item parameter\"),await Promise.reject(new r(\"sceneservice:portal-item-required\",\"_saveAs() requires a portal item to save to\"))),i.id&&(i=i.clone(),i.id=null);const s=i.portal||b.getDefault();await this._ensureLoadBeforeSave(),i.type=O,i.portal=s;const a={origin:\"portal-item\",url:null,messages:[],portal:s,portalItem:i,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},n={layers:[this.write({},a)]};return await Promise.all(a.resources?.pendingOperations??[]),await this._validateAgainstJSONSchema(n,a,o),i.url=this.url,i.title||(i.title=this.title),this._updateTypeKeywords(i,o,T.newItem),await s._signIn(),await(s.user?.addItem({item:i,folder:o&&o.folder,data:n})),await _(this.resourceReferences,a,null),this.portalItem=i,c(a),a.portalItem=i,i}async _save(e){const t={...K,...e};if(!this.portalItem)throw A.error(\"_save(): requires the .portalItem property to be set\"),new r(\"sceneservice:portal-item-not-set\",\"Portal item to save to has not been set on this SceneService\");if(this.portalItem.type!==O)throw A.error(\"_save(): Non-matching portal item type. Got \"+this.portalItem.type+\", expected \"+O),new r(\"sceneservice:portal-item-wrong-type\",`Portal item needs to have type \"${O}\"`);await this._ensureLoadBeforeSave();const o={origin:\"portal-item\",url:this.portalItem.itemUrl&&a(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||b.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},i={layers:[this.write({},o)]};return await Promise.all(o.resources?.pendingOperations??[]),await this._validateAgainstJSONSchema(i,o,t),this.portalItem.url=this.url,this.portalItem.title||(this.portalItem.title=this.title),this._updateTypeKeywords(this.portalItem,t,T.existingItem),await this.portalItem.update({data:i}),await _(this.resourceReferences,o,null),c(o),this.portalItem}async _validateAgainstJSONSchema(e,t,o){let i=t.messages?.filter((e=>\"error\"===e.type)).map((e=>new r(e.name,e.message,e.details)))??[];if(o&&o.validationOptions?.ignoreUnsupported&&(i=i.filter((e=>\"layer:unsupported\"!==e.name&&\"symbol:unsupported\"!==e.name&&\"symbol-layer:unsupported\"!==e.name&&\"property:unsupported\"!==e.name&&\"url:unsupported\"!==e.name&&\"scenemodification:unsupported\"!==e.name))),o.validationOptions?.enabled||E){const t=(await import(\"../support/schemaValidator.js\")).validate(e,o.portalItemLayerType);if(t.length>0){const e=`Layer item did not validate:\\n${t.join(\"\\n\")}`;if(A.error(`_validateAgainstJSONSchema(): ${e}`),\"throw\"===o.validationOptions?.failPolicy){const e=t.map((e=>new r(\"sceneservice:schema-validation\",e))).concat(i);throw new r(\"sceneservice-validate:error\",\"Failed to save layer item due to schema validation, see `details.errors`.\",{combined:e})}}}if(i.length>0)throw new r(\"sceneservice:save\",\"Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:i})}};return e([n(w)],N.prototype,\"id\",void 0),e([n({type:y})],N.prototype,\"spatialReference\",void 0),e([l(\"spatialReference\",[\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],N.prototype,\"readSpatialReference\",null),e([n({type:u})],N.prototype,\"fullExtent\",void 0),e([l(\"fullExtent\",[\"fullExtent\",\"store.extent\",\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],N.prototype,\"readFullExtent\",null),e([n({readOnly:!0,type:m})],N.prototype,\"heightModelInfo\",void 0),e([n({type:Number,json:{name:\"layerDefinition.minScale\",write:!0,origins:{service:{read:{source:\"minScale\"},write:!1}}}})],N.prototype,\"minScale\",void 0),e([n({type:Number,json:{name:\"layerDefinition.maxScale\",write:!0,origins:{service:{read:{source:\"maxScale\"},write:!1}}}})],N.prototype,\"maxScale\",void 0),e([n({readOnly:!0})],N.prototype,\"version\",void 0),e([l(\"version\",[\"store.version\"])],N.prototype,\"readVersion\",null),e([n({type:String,json:{read:{source:\"copyrightText\"}}})],N.prototype,\"copyright\",void 0),e([n({type:String,json:{read:!1}})],N.prototype,\"sublayerTitleMode\",void 0),e([n({type:String})],N.prototype,\"title\",void 0),e([l(\"portal-item\",\"title\")],N.prototype,\"readTitlePortalItem\",null),e([l(\"service\",\"title\",[\"name\"])],N.prototype,\"readTitleService\",null),e([n({type:Number,json:{origins:{service:{read:{source:\"id\"}},\"portal-item\":{write:{target:\"id\",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],N.prototype,\"layerId\",void 0),e([n(I)],N.prototype,\"url\",null),e([d(\"url\")],N.prototype,\"writeUrl\",null),e([n()],N.prototype,\"parsedUrl\",null),e([n({readOnly:!0})],N.prototype,\"store\",void 0),e([n({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],N.prototype,\"rootNode\",void 0),N=e([p(R)],N),N},U=-1e38,E=!1;var T;!function(e){e[e.existingItem=0]=\"existingItem\",e[e.newItem=1]=\"newItem\"}(T||(T={}));const O=\"Scene Service\",K={getTypeKeywords:()=>[],portalItemLayerType:\"unknown\",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:\"throw\"}};var L;!function(e){e[e.SAVE=0]=\"SAVE\",e[e.SAVE_AS=1]=\"SAVE_AS\"}(L||(L={}));export{O as SCENE_SERVICE_ITEM_TYPE,L as SaveOperationType,N as SceneService};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}