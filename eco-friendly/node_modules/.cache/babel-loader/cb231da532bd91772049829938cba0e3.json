{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../Color.js\";\nimport i from \"../../../core/Accessor.js\";\nimport { difference as r } from \"../../../core/arrayUtils.js\";\nimport s from \"../../../core/CollectionFlattener.js\";\nimport a from \"../../../core/Evented.js\";\nimport n from \"../../../core/Handles.js\";\nimport o from \"../../../core/Logger.js\";\nimport { clamp as l } from \"../../../core/mathUtils.js\";\nimport { releaseMaybe as h, destroyMaybe as d, isNone as p, isSome as u } from \"../../../core/maybe.js\";\nimport c from \"../../../core/ObjectPool.js\";\nimport _ from \"../../../core/PooledArray.js\";\nimport { isAbortError as g, isAborted as m, createAbortError as f } from \"../../../core/promiseUtils.js\";\nimport { watch as T, syncAndInitial as y, sync as v, initial as w } from \"../../../core/reactiveUtils.js\";\nimport { aliasOf as L } from \"../../../core/accessorSupport/decorators/aliasOf.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { property as S } from \"../../../core/accessorSupport/decorators/property.js\";\nimport { subclass as b } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { m as E } from \"../../../chunks/mat4.js\";\nimport { c as D } from \"../../../chunks/mat4f64.js\";\nimport { c as x } from \"../../../chunks/vec3.js\";\nimport { c as U } from \"../../../chunks/vec3f64.js\";\nimport { c as C } from \"../../../chunks/vec4f64.js\";\nimport { WatchUpdatingTracking as P } from \"../../../core/support/WatchUpdatingTracking.js\";\nimport { projectVectorToVector as R, projectPointToVector as j } from \"../../../geometry/projection.js\";\nimport { getReferenceEllipsoid as M } from \"../../../geometry/projectionEllipsoid.js\";\nimport { create as A, equals as I, intersection as V, intersectsSphere as O } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { create as N, copy as k } from \"../../../geometry/support/frustum.js\";\nimport { isPlateCarree as B } from \"../../../geometry/support/spatialReferenceUtils.js\";\nimport { isRefreshableLayer as q } from \"../../../layers/mixins/RefreshableLayer.js\";\nimport { ElevationQueryTileCache as G } from \"../../../layers/support/ElevationQueryTileCache.js\";\nimport { isBaseLayer as W } from \"../../../layers/support/layerUtils.js\";\nimport { acquireDecoder as F } from \"../../../layers/support/LercDecoder.js\";\nimport { printAllocations as H } from \"../../2d/engine/vectorTiles/VectorTile.js\";\nimport { directionToHeadingTilt as Q, scaleToZoom as X } from \"../support/cameraUtils.js\";\nimport z from \"../support/debugFlags.js\";\nimport { toBoundingRect as Y } from \"../support/extentUtils.js\";\nimport { ClientType as $ } from \"../support/index.js\";\nimport { updatingProgress as K } from \"../support/updatingProperties.js\";\nimport { ElevationBounds as J } from \"./ElevationBounds.js\";\nimport { sampleElevation as Z, ElevationData as ee } from \"./ElevationData.js\";\nimport { create as te } from \"./ExtentHelper.js\";\nimport { LODSnapping as ie, TextureUpdate as re } from \"./interfaces.js\";\nimport { LayerClass as se, LayerClasses as ae } from \"./LayerClass.js\";\nimport { OverlayManager as ne } from \"./OverlayManager.js\";\nimport { PlanarPatch as oe } from \"./PlanarPatch.js\";\nimport { RenderOrder as le } from \"./RenderOrder.js\";\nimport { SphericalPatch as he } from \"./SphericalPatch.js\";\nimport { MAX_ROOT_TILES as de, TOO_MANY_ROOT_TILES_AFTER_CHANGE_ERROR as pe, TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR as ue, MAX_MEMORY_LOD_BIAS as ce, ELEVATION_NODATA_VALUE as _e } from \"./TerrainConst.js\";\nimport ge from \"./TerrainRenderer.js\";\nimport me from \"./TerrainSurfacePerformanceInfo.js\";\nimport { weakAssert as fe, internalAssert as Te, isSurfaceLayerView as ye, isMapTileLayerView as ve, isBlendableLayerView as we, isGroupLayer as Le, isElevationLayerView as Se, isVectorTileLayerView as be, useFetchTileForLayer as Ee, isImageryTileLayerView as De, isTileLayerView as xe, releaseTileData as Ue, ENABLE_WATERPROOFNESS_TESTS as Ce } from \"./terrainUtils.js\";\nimport { SplitLimits as Pe, Tile as Re } from \"./Tile.js\";\nimport { printAllocations as je } from \"./TilePerLayerInfo.js\";\nimport { TileUpdate as Me } from \"./TileUpdate.js\";\nimport { IteratorPreorder as Ae, IteratorPostorder as Ie, hasLoadableSiblings as Ve, sortTilesByPOI as Oe, sortTiles as Ne } from \"./tileUtils.js\";\nimport { TilingSchemeLogic as ke } from \"./TilingSchemeLogic.js\";\nimport { UpsampleInfo as Be } from \"./UpsampleInfo.js\";\nimport { isCompositeBlendMode as qe, blendModeFromString as Ge } from \"../webgl-engine/core/shaderLibrary/output/BlendOptions.js\";\nimport { RenderRequestType as We } from \"../webgl-engine/lib/basicInterfaces.js\";\nimport { ImmediateTask as Fe, TaskPriority as He, noBudget as Qe } from \"../../support/Scheduler.js\";\nconst Xe = o.getLogger(\"esri.views.3d.terrain.TerrainSurface\"),\n      ze = .25;\nlet Ye = class extends a.EventedMixin(i) {\n  constructor(e) {\n    super(e), this._elevationBounds = new J(), this._iteratorPool = new c(Ae, e => e.remove = () => this._iteratorPool.release(e)), this._postorderIterator = new Ie(), this._hasPendingUpdates = !1, this._pendingUpdates = 0, this._asyncWorkItems = 0, this._allTilesDirty = !0, this._allTilesSorted = !0, this._visible = !1, this._usedMemory = null, this._performanceInfo = new me(), this._viewChanged = !1, this._inFrameTask = !1, this._viewChangeUpdateDirty = !1, this._eyePosRenderSR = U(), this._eyePosSurfaceSR = U(), this._splitLimits = new Pe(), this._snapLevel = 1 / 0, this._frustum = N(), this._viewProjectionMatrix = D(), this._layerViews = [new Array(), new Array()], this._layerIndexByUid = [new Map(), new Map()], this._basemapLayerViewHandles = new Map(), this._handles = new n(), this._watchUpdatingTracking = new P(), this._frameTask = Fe, this._allTiles = new _(), this._upsampleInfoPool = new c(Be), this._rootTilesExtent = A(), this._maxNumUpdating = 1, this.maxTextureScale = 1.2, this.backgroundColor = null, this._updatingRootTiles = !1, this.deferTileNeighborUpdate = !1, this.neighborTilesToUpdate = new Set(), this.totalGeometryUpdates = 0, this.totalTileUpdates = 0, this._layerViewsDirty = !1, this._isGlobal = !e.view?.state?.isLocal;\n  }\n\n  initialize() {\n    this._lercDecoder = F(this.view.resourceController), this._tilePool = this.view.state.isLocal ? new c(oe) : new c(he);\n    const e = this.view.resourceController.memoryController;\n    this._upsampleMapCache = e.newCache(\"esri.views.3d.terrain.upsample\", e => e.unloadMapData()), this._elevationQueryCache = new G(e.newCache(\"elevation-query\")), this._set(\"overlayManager\", new ne({\n      surface: this\n    })), this._handles.add([T(() => this.overlayManager.hasHighlights, e => this._renderer.setNeedsHighlight(e)), T(() => this.overlayManager.rendersOccluded, e => this._renderer.setRenderOccludedOverlay(e))], \"overlayManager\"), this._renderer = new ge({\n      overlayRenderer: this.overlayManager.renderer,\n      ellipsoidRadius: M(this.view.spatialReference).radius,\n      stage: this.view._stage,\n      allTiles: this._allTiles\n    }), this._handles.add([T(() => this.baseOpacity, e => {\n      this._handleLayerViewChanges(), this._updateBaseOpacity(e);\n    }, y), T(() => this.hasCompositeBlendMode, () => {\n      this._updateBaseOpacity(this.baseOpacity);\n    }, y), T(() => this.renderingDisabled, () => this._updateTransparentTerrain(), v), T(() => this.backgroundColor, e => {\n      this._handleLayerViewChanges(), this._renderer.updateTileBackground(e);\n    }, y), T(() => this.view.pointsOfInterest, e => {\n      this._renderer.pointsOfInterest = e, this._watchUpdatingTracking.removeAll(), e && this._watchUpdatingTracking.add(() => e.focus.renderLocation, () => () => this._allTilesSorted = !1);\n    }), T(() => z.TERRAIN_TILE_TREE_SHOW_TILES, e => {\n      e && !this._treeDebugger ? import(\"../layers/support/TerrainTileTree3DDebugger.js\").then(({\n        TerrainTileTree3DDebugger: e\n      }) => {\n        !this._treeDebugger && z.TERRAIN_TILE_TREE_SHOW_TILES && (this._treeDebugger = new e({\n          view: this.view\n        }));\n      }) : e || (this._treeDebugger = d(this._treeDebugger));\n    }, w)]), this._extentHelper = te(this.viewingMode, {\n      layers: this.view.map.allLayers,\n      layerViews: this.view.allLayerViews,\n      viewSpatialReference: this.view.spatialReference\n    });\n    const t = this.view.defaultsFromMap ? new s({\n      getCollections: () => this.view?.defaultsFromMap?.mapCollections?.map(({\n        layers: e\n      }) => e),\n      getChildrenFunction: e => e && \"layers\" in e ? e.layers : null\n    }) : this.view.map.allLayers,\n          i = new ke({\n      layers: t,\n      extentHelper: this._extentHelper,\n      viewingMode: this.viewingMode,\n      viewSpatialReference: this.view.spatialReference\n    });\n    this._set(\"tilingSchemeLogic\", i), this._updateTilingScheme(), this._elevationDataRequester = this.view.resourceController.createStreamDataRequester($.ELEVATION), this._mapDataRequester = this.view.resourceController.createStreamDataRequester($.BASEMAP);\n    const r = this.view.resourceController.scheduler;\n    this._frameTask = r.registerTask(He.TERRAIN_SURFACE, this), this._handles.add([T(() => this._extentHelper.stencilEnabledExtents, e => this._renderer.setStencilEnabledLayerExtents(e), w), T(() => this.tilingSchemeLogic.tilingScheme, () => this._updateTilingScheme(), v), T(() => this.extent, () => this._updateRootTiles(), w), this.view.on(\"resize\", () => this._viewChangeUpdate()), T(() => {\n      const e = this.view,\n            t = e.state;\n      return [this.lodBias, this.lodSnapping, e.resourceController?.memoryController?.memoryFactor, t.camera, t.contentCamera, t.fixedContentCamera];\n    }, () => this._viewChangeUpdate(), y), T(() => this.view.qualitySettings?.tiledSurface?.textureFadeDuration, e => this._renderer.textureFadingEnabled = e > 0, w), T(() => this._userClippingExtent, () => this._updateClippingExtent(), v)]), this._handles.add(this.view.allLayerViews.on(\"after-changes\", () => this._layerViewsDirty = !0)), this._layerViewsDirty = !0, this._handleLayerViewChanges();\n  }\n\n  destroy() {\n    this._frameTask.remove(), this._handles.destroy(), this._watchUpdatingTracking.destroy(), this._lercDecoder = h(this._lercDecoder), this._removeAllTiles(), this._upsampleMapCache = d(this._upsampleMapCache), this._elevationQueryCache = d(this._elevationQueryCache), this._set(\"tilingSchemeLogic\", d(this.tilingSchemeLogic)), this._extentHelper = d(this._extentHelper), this._basemapLayerViewHandles.forEach((e, t) => this._unregisterTiledLayerView(t)), this._elevationDataRequester = null, this._mapDataRequester = null, this._set(\"overlayManager\", d(this.overlayManager)), this._tilePool = d(this._tilePool), Re.prune(), this._treeDebugger && (this._treeDebugger.destroy(), this._treeDebugger = null), this._renderer = d(this._renderer), this._iteratorPool = d(this._iteratorPool), this._set(\"view\", null), this._upsampleInfoPool = d(this._upsampleInfoPool), H(), je();\n  }\n\n  get renderer() {\n    return this._renderer;\n  }\n\n  get frustum() {\n    return this._frustum;\n  }\n\n  get snapLevel() {\n    const e = this.view.pointsOfInterest?.contentCameraOnSurface?.scale;\n\n    if (e) {\n      const t = this.view.state.contentCamera;\n      let i = Q(this.view, t.eye, t.viewForward, t.up).tilt;\n      i > 90 && (i = 180 - i);\n      const r = 2 * (i / 90) ** 2,\n            s = X(this.view, e) - r;\n      Math.abs(this._snapLevel - s) > ze && (Math.round(s) !== Math.round(this._snapLevel) && (this._viewChanged = !0), this._snapLevel = s);\n    }\n\n    return Math.round(this._snapLevel);\n  }\n\n  get lodSnapping() {\n    return this.view.qualitySettings.tiledSurface.reduceTileLevelDifferences ? ie.ON : ie.OFF;\n  }\n\n  get upsampleInfoPool() {\n    return this._upsampleInfoPool;\n  }\n\n  get upsampleMapCache() {\n    return this._upsampleMapCache;\n  }\n\n  get elevationQueryCache() {\n    return this._elevationQueryCache;\n  }\n\n  get mapTileRequester() {\n    return this._mapDataRequester;\n  }\n\n  get _userClippingExtent() {\n    const {\n      spatialReference: e\n    } = this,\n          {\n      clippingArea: t\n    } = this.view;\n    if (p(t) || p(e)) return null;\n\n    const i = A(),\n          r = Y(t, i, e) ? i : null,\n          s = this._get(\"extent\");\n\n    return I(r, s) ? s : r;\n  }\n\n  get rootTilesExtent() {\n    return this._rootTilesExtent;\n  }\n\n  get extent() {\n    const e = V(this.groundExtent, this._userClippingExtent, A()),\n          t = this._get(\"extent\");\n\n    return I(e, t) ? t : e;\n  }\n\n  get groundExtent() {\n    return u(this._tilingSchemeExtent) ? this._tilingSchemeExtent : this._rootTilesExtent;\n  }\n\n  get _tilingSchemeExtent() {\n    return this.tilingSchemeLogic?.extent;\n  }\n\n  get updating() {\n    return this._hasPendingUpdates || (this._maxNumUpdating = 1), !!((this._watchUpdatingTracking.updating || this._hasPendingUpdates || this._viewChanged || this._allTilesDirty || this._asyncWorkItems > 0 || !this._allTilesSorted || this._layerViewsDirty) && this.ready && !this.suspended || this.overlayManager.updating || this._frameTask.updating);\n  }\n\n  get updatingProgressValue() {\n    return this._maxNumUpdating = Math.max(this._pendingUpdates, this._maxNumUpdating), 1 - this._pendingUpdates / this._maxNumUpdating;\n  }\n\n  get viewingMode() {\n    return this.view.state.viewingMode;\n  }\n\n  get ready() {\n    return u(this.rootTiles);\n  }\n\n  set renderOrder(e) {\n    this._renderer.renderOrder = e, this._set(\"renderOrder\", e);\n  }\n\n  get spatialReference() {\n    return this.tilingScheme?.spatialReference ?? null;\n  }\n\n  set slicePlaneEnabled(e) {\n    this._renderer.slicePlaneEnabled = e, this._set(\"slicePlaneEnabled\", e), this._updateTransparentTerrain();\n  }\n\n  _updateTransparentTerrain() {\n    const e = !this.renderingDisabled && !this.opaque;\n    this.view?._stage?.renderView.setRenderParameters({\n      transparentTerrain: e\n    });\n  }\n\n  set velvetOverground(e) {\n    e !== this.velvetOverground && (this._renderer.velvetOverground = e), this._set(\"velvetOverground\", e);\n  }\n\n  set visible(e) {\n    e !== this._visible && (this._visible = e, this._renderer.setVisibility(e), this.suspended = !e);\n  }\n\n  get opaque() {\n    return this._renderer.opaque;\n  }\n\n  set suspended(e) {\n    this._set(\"suspended\", e), this._viewChangeUpdate();\n  }\n\n  intersect(e, t, i, r) {\n    this._renderer.intersect(e, t, i, r);\n  }\n\n  getElevation(e, t, i, r) {\n    const s = this.getTileWithElevation(e, t, i, r, et);\n    return p(s) ? null : Z(et[0], et[1], s.renderData.geometryState.samplerData);\n  }\n\n  getTileWithElevation(e, t, i, r, s = et) {\n    const a = this.rootTiles;\n    if (p(a) || !a.length) return null;\n    if (0 === a[0].layerInfo[se.ELEVATION].length) return null;\n    if (s[0] = e, s[1] = t, s[2] = i, !R(s, r, s, this.tilingScheme?.spatialReference)) return Xe.error(\"TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system\"), null;\n\n    for (let n of a) {\n      if (!n.containsPoint(s)) continue;\n\n      for (; n && !n.rendered && !n.isLeaf;) {\n        let e = 0;\n        s[0] > .5 * (n.extent[0] + n.extent[2]) && (e += 1), s[1] < .5 * (n.extent[1] + n.extent[3]) && (e += 2), n = n.children[e];\n      }\n\n      const e = n.renderData;\n      return (e ? e.geometryState.samplerData : null) ? n : null;\n    }\n\n    return null;\n  }\n\n  get elevationBounds() {\n    return this._elevationBounds;\n  }\n\n  getScale(e) {\n    if (this.tilingScheme) {\n      if (!j(e, et, this.spatialReference)) return Xe.error(\"TerrainSurface.getScale(): could not project given point to tiling scheme coordinate system\"), null;\n      const t = this.rootTiles;\n      if (u(t)) for (let e of t) if (e?.containsPoint(et)) {\n        for (; !e.isLeaf && !e.rendered;) {\n          let t = 0;\n          et[0] > e.children[0].extent[2] && (t += 1), et[1] < e.children[0].extent[1] && (t += 2), e = e.children[t];\n        }\n\n        return this._getLodBiasCorrectedScale(e.level);\n      }\n    }\n\n    return 1e100;\n  }\n\n  getSphereElevationBounds(e, t, i, r, s) {\n    if (et[0] = e, et[1] = t, et[2] = i, et[3] = r, !R(et, s, et, this.tilingScheme?.spatialReference)) return Xe.error(\"TerrainSurface.getSphereElevationBounds(): could not project given point to tiling scheme coordinate system\"), null;\n    let a = 1 / 0,\n        n = -1 / 0;\n\n    const o = e => {\n      if (e && O(e.extent, et)) if (e.isLeaf || e.rendered) a = Math.min(a, e.elevationBounds[0]), n = Math.max(n, e.elevationBounds[1]);else for (const t of e.children) o(t);\n    },\n          l = this.rootTiles;\n\n    if (u(l)) for (const h of l) o(h);\n    return {\n      min: a,\n      max: n\n    };\n  }\n\n  getSphereScale(e, t) {\n    if (!this.tilingScheme) return null;\n    if (!j(e, et, this.spatialReference)) return Xe.error(\"TerrainSurface.getSphereScale(): could not project given point to tiling scheme coordinate system\"), null;\n    et[3] = t;\n    let i = null;\n\n    const r = e => {\n      if (e && O(e.extent, et)) if (e.isLeaf || e.rendered) {\n        const t = this._getLodBiasCorrectedScale(e.level);\n\n        i = null == i ? t : Math.min(i, t);\n      } else for (const t of e.children) r(t);\n    },\n          s = this.rootTiles;\n\n    if (u(s)) for (const a of s) r(a);\n    return i;\n  }\n\n  queryVisibleScaleRange(e, t, i, r) {\n    const s = t ? this.tilingScheme.levelAtScale(t) : 0,\n          a = i ? this.tilingScheme.levelAtScale(i) : 1 / 0,\n          n = this.lodBias;\n\n    this._renderer.queryVisibleLevelRange(e, s + n, a + n, r);\n  }\n\n  _updateBaseOpacity(e) {\n    const t = this._renderer.opaque;\n    this._renderer.opaque = e >= 1 && !this.hasCompositeBlendMode, this._renderer.isTransparent = this._allSurfaceLayersTransparent();\n    const i = t !== this._renderer.opaque;\n    i && this._updateTransparentTerrain(), this._updateTileTextures(i ? re.UNFADED : re.IMMEDIATE);\n  }\n\n  _updateTilingScheme() {\n    const e = this.tilingSchemeLogic.tilingScheme;\n    e !== this.tilingScheme && (fe(!!e, \"tiling scheme cannot be reset to undefined\"), this._isGlobal = !this.view?.state?.isLocal, this.tilingScheme && this._removeAllTiles(), this._set(\"tilingScheme\", e), this._updateClippingExtent(), e && (this._updateTiledLayers(), this._renderer.setTileSize(e.pixelSize), this.overlayManager.setSpatialReference(e.spatialReference), this._updateRootTiles()));\n  }\n\n  _acquireTile(e, t, i, r) {\n    const s = this._tilePool.acquire();\n\n    return it[0] = e, it[1] = t, it[2] = i, s.init(it, r, this), s;\n  }\n\n  get updatingRootTiles() {\n    return this._updatingRootTiles;\n  }\n\n  _updateRootTiles() {\n    const {\n      extent: e,\n      tilingScheme: t\n    } = this;\n    if (!t) return;\n    const i = tt;\n    let s = t.rootTilesInExtent(e, i, 5 * de);\n\n    if (u(this.rootTiles)) {\n      if (s.length > de) return void Xe.warn(pe);\n      const e = this.rootTiles.map(e => e.lij),\n            t = r(e, s, Ke);\n\n      if (this._updatingRootTiles = !0, t.removed.length > 0 || t.added.length > 0) {\n        const e = this.rootTiles.filter(e => !(t.removed.findIndex(t => Ke(t, e.lij)) > -1) || (this._purgeTile(e, !0), !1));\n        t.added.forEach(t => e.push(this._newRootTile(t))), this._setRootTiles(e);\n      }\n    } else this._updatingRootTiles = !0, s.length > de && (Xe.warn(ue), s = t.rootTilesInExtent(e, i, de)), this._setRootTiles(s.map(e => this._newRootTile(e)));\n\n    I(i, this._rootTilesExtent) || (this._rootTilesExtent = A(i)), this.visible = !0, this._viewChangeUpdate(), this.overlayManager.setPlacementDirty(), this.notifyChange(\"ready\"), this._allTiles.forEach(e => {\n      e.isLoaded && this._prepareToLoadTile(e);\n    }), this._allTiles.forAll(e => {\n      e.isLoaded && (this._updateTileGeometry(e), this._updateTileNeighborsAfterGeometryChange(e));\n    }), this._updatingRootTiles = !1, this.checkAllTileWaterproofness();\n  }\n\n  _newRootTile(e) {\n    const t = this._acquireTile(0, e[1], e[2], null);\n\n    return t.shouldSplit(this._splitLimits, this._eyePosRenderSR, this.lodSnapping) === Me.SPLIT && t.setPendingUpdate(Me.SPLIT), this._loadTile(t), this.deferTileNeighborUpdate || t.checkGeometryWaterproofness(), t;\n  }\n\n  _setRootTiles(e) {\n    if (this._set(\"rootTiles\", e), this._allTiles.clear(), u(e)) {\n      const t = this._iteratorPool.acquire();\n\n      for (t.reset(e); !t.done;) this._allTiles.push(t.next());\n\n      t.remove();\n    }\n\n    this._renderer.setRootTiles(this.rootTiles), this._updateTilesVisibility(e);\n  }\n\n  _runViewChangeUpdateIfDirty() {\n    this._viewChangeUpdateDirty && (this._viewChangeUpdateDirty = !1, this._viewChangeUpdate());\n  }\n\n  _viewChangeUpdate() {\n    this.view && !this.suspended && this.tilingScheme && this._visible && (this._inFrameTask ? this._viewChangeUpdateDirty = !0 : (this._viewChangeUpdateDirty = !1, this._updateViewDependentParameters(), this._updateTilesVisibility(this.rootTiles)));\n  }\n\n  _updateClippingStatus(e) {\n    e.updateClippingStatus(this.extent) && e.resetPendingUpdate(Me.GEOMETRY) && this._updateTileGeometry(e);\n  }\n\n  _updateTilesVisibility(e) {\n    if (p(e)) return;\n    const t = Ve(e);\n    let i = t ? this._elevationBounds.min : 1 / 0,\n        r = t ? this._elevationBounds.max : -1 / 0;\n    const s = this.view.state.fixedContentCamera,\n          a = this.extent,\n          n = this._viewProjectionMatrix;\n    this.setTileTreeDirty();\n\n    const o = this._iteratorPool.acquire();\n\n    for (o.reset(e); !o.done;) {\n      const e = o.next();\n      e.updateClippingStatus(a) && e.resetPendingUpdate(Me.GEOMETRY) && this._updateTileGeometry(e), e.setPendingUpdate(Me.RENDERDATA);\n      const t = e.computeVisibility();\n      s || t ? (e.updateScreenDepth(n), e.renderData && (i = Math.min(e.elevationBounds[0], i), r = Math.max(e.elevationBounds[1], r))) : o.skipSubtree();\n    }\n\n    o.remove(), this._viewChanged = !0, this._allTilesDirty = !0, isFinite(i) && isFinite(r) && (this._elevationBounds.min === i && this._elevationBounds.max === r || (this._elevationBounds.min = i, this._elevationBounds.max = r, this.emit(\"elevation-bounds-change\", null)));\n  }\n\n  _updateViewDependentParameters() {\n    const e = this.view.state.camera,\n          t = this.view.state.contentCamera,\n          i = Math.tan(.5 * t.fovX),\n          r = Math.tan(.5 * t.fovY),\n          s = this.tilingScheme.pixelSize,\n          a = 2 ** -this.lodBias * e.pixelRatio;\n    this._splitLimits.aboveGround = e.aboveGround, this._splitLimits.fovX = i, this._splitLimits.fovY = r, this._splitLimits.relativeWidthLimit = s / e.width * this.maxTextureScale * a, this._splitLimits.relativeHeightLimit = s / e.height * this.maxTextureScale * a, this._splitLimits.maxLod = this.tilingScheme.getMaxLod(), this._splitLimits.angledSplitBias = this.view.qualitySettings.tiledSurface.angledSplitBias, this.view.state.fixedContentCamera ? (p(this._splitLimits.frustum) && (this._splitLimits.frustum = N()), k(this._splitLimits.frustum, t.frustum)) : this._splitLimits.frustum = null, k(this._frustum, e.frustum), E(this._viewProjectionMatrix, t.projectionMatrix, t.viewMatrix), x(this._eyePosRenderSR, t.eye), R(e.eye, this.view.renderSpatialReference, this._eyePosSurfaceSR, this.spatialReference);\n  }\n\n  _updateRenderData(e) {\n    e.rendered && !e.shouldLoad && (Je(e) ? (this._loadChildren(e), this.deferTileNeighborUpdate || (this._checkTileNeighborsWaterproofness(e), e.children.forEach(e => e.checkGeometryWaterproofness()))) : Ze(e) && this._loadParent(e));\n  }\n\n  _updateTileGeometry(e) {\n    e.updateVisibility(), this._renderer.updateTileGeometry(e), this._updateTileNeighborsAfterGeometryChange(e), this._elevationUpdate(e), this._usedMemory = null, this.deferTileNeighborUpdate && this.neighborTilesToUpdate.delete(e);\n  }\n\n  _updateTileNeighborsAfterGeometryChange(e, t) {\n    if (this.deferTileNeighborUpdate) {\n      const t = this.neighborTilesToUpdate;\n      e.forEachLoadedNeighbor(e => {\n        t.add(e);\n      });\n    } else e.updateNeighborsAfterGeometryChange(t);\n  }\n\n  _updateTileTexture(e, t) {\n    const i = e.resetPendingUpdate(Me.TEXTURE_FADING) ? Me.TEXTURE_FADING : !!e.resetPendingUpdate(Me.TEXTURE_NOFADING) && Me.TEXTURE_NOFADING;\n    i && (this._renderer.updateTileTexture(e, i), this._usedMemory = null, t.madeProgress());\n  }\n\n  _elevationUpdate(e) {\n    st.spatialReference = this.spatialReference, st.tile = e, st.extent = e.extent, this.emit(\"elevation-change\", st);\n  }\n\n  get running() {\n    return this.updating && this.ready && !this.suspended;\n  }\n\n  runTask(e) {\n    this._handleLayerViewChanges(e), this._frameTask.processQueue(e), this._inFrameTask = !0, this._pendingUpdates = 0, this._hasPendingUpdates = !1, this._updateTileStatus(e), this._sortTiles(e);\n    const t = !this.view.state.fixedContentCamera;\n    this._mergeAndSplit(e, t), e.run(() => this._updateElevation(e)), e.run(() => this._updateTextures(e)), t || this._mergeAndSplit(e, !0), this._inFrameTask = !1, this._runViewChangeUpdateIfDirty(), e.done ? this.requestUpdate() : this._usedMemory = this._recalculateUsedMemory(), this.notifyChange(\"updatingProgressValue\");\n  }\n\n  _updateTileStatus(e) {\n    if (!this._viewChanged || !this.rootTiles || e.done) return;\n    this._viewChanged = !1;\n\n    const t = this._iteratorPool.acquire();\n\n    for (t.reset(this.rootTiles); !t.done;) {\n      const e = t.next();\n\n      if (e.loadable) {\n        const i = e.shouldSplit(this._splitLimits, this._eyePosRenderSR, this.lodSnapping);\n\n        if (i === Me.SPLIT) {\n          e.resetPendingUpdate(Me.MERGE), e.isLeaf && (e.setPendingUpdate(Me.SPLIT), t.skipSubtree());\n          continue;\n        }\n\n        e.resetPendingUpdate(Me.SPLIT) && e.updateAgentSuspension(), i === Me.VSPLITMERGE && e.updateAgents(se.ELEVATION);\n      }\n\n      if (t.skipSubtree(), !e.isLeaf) {\n        e.setPendingUpdate(Me.MERGE), e.resetPendingUpdate(Me.SPLIT);\n\n        const t = this._iteratorPool.acquire();\n\n        t.resetOne(e);\n\n        for (let e = t.next(); !t.done; e = t.next()) this._updateClippingStatus(e), e.updateVisibility(), e.loadable && e.updateScreenDepth(this._viewProjectionMatrix);\n\n        t.remove();\n      }\n    }\n\n    t.remove(), this.requestUpdate(), e.madeProgress();\n  }\n\n  _sortTiles(e) {\n    e.done || this._allTilesSorted || (Oe(this._allTiles, this.view.pointsOfInterest.focus.renderLocation), this._allTilesSorted = !0, this._treeDebugger && this._treeDebugger.update(), e.madeProgress());\n  }\n\n  _prepareBatchTileGeometryUpdate() {\n    Te(0 === this.neighborTilesToUpdate.size), this.deferTileNeighborUpdate = !0;\n  }\n\n  _batchUpdateUpdatedTileNeighbors() {\n    this.deferTileNeighborUpdate = !1;\n    const e = this.neighborTilesToUpdate;\n\n    (() => {\n      const t = () => {\n        for (const t of e) t.updateNeighborsWithChangedEdgeResolution();\n      };\n\n      (() => {\n        for (const t of e) t.updateNeighborDataAndGeometryIfNeeded();\n      })(), t(), e.clear();\n    })();\n  }\n\n  _mergeAndSplit(e, t) {\n    if (this.suspended || e.done || !this._allTilesDirty) return;\n    this._allTilesDirty = !1, this.requestUpdate(), this._prepareBatchTileGeometryUpdate();\n    let i = !1;\n\n    for (; !e.done;) {\n      i = !0;\n      let r = !1;\n      const s = !this._allTiles.some(i => {\n        if (i.resetPendingUpdate(Me.MERGE)) {\n          if (!t) return i.setPendingUpdate(Me.MERGE), e.done;\n          this._mergeTile(i), r = !0, e.madeProgress();\n        } else i.resetPendingUpdate(Me.SPLIT) && (this._splitTile(i), r = !0, e.madeProgress());\n\n        return !e.done && i.resetPendingUpdate(Me.RENDERDATA) && (this._updateRenderData(i), e.madeProgress()), e.done;\n      });\n\n      if (r && (this._allTilesSorted = !1, this._allTilesDirty = !0), s) {\n        if (!r) break;\n\n        this._updateTilesVisibility(this.rootTiles);\n      } else this._allTilesDirty = !0;\n    }\n\n    i || (this._allTilesDirty = !0), this._batchUpdateUpdatedTileNeighbors(), this._sortTiles(e);\n  }\n\n  _updateElevation(e) {\n    return this._prepareBatchTileGeometryUpdate(), this._allTiles.some(t => (t.resetPendingUpdate(Me.GEOMETRY) && (this._updateTileGeometry(t), this._updateTileTexture(t, e), e.madeProgress()), e.done)), this._batchUpdateUpdatedTileNeighbors(), e.hasProgressed;\n  }\n\n  _updateTextures(e) {\n    return this._allTiles.some(t => (this._updateTileTexture(t, e), e.done)), e.hasProgressed;\n  }\n\n  _updateClippingExtent() {\n    this.spatialReference && (this.updateTileOverlayParams(We.UPDATE), this.overlayManager.setPlacementDirty(), this._updateRootTiles());\n  }\n\n  get lodBias() {\n    const e = this.view.resourceController.memoryController.memoryFactor;\n    return this.view.qualitySettings.tiledSurface.lodBias - (1 - e) * ce;\n  }\n\n  _getLodBiasCorrectedScale(e) {\n    const t = this.tilingScheme.levels,\n          i = l(e - this.lodBias, 0, t.length - 1),\n          r = i - Math.floor(i);\n    return t[Math.floor(i)].scale * (1 - r) + t[Math.ceil(i)].scale * r;\n  }\n\n  _removeAllTiles() {\n    u(this.rootTiles) && (this.rootTiles.forEach(e => this._purgeTile(e, !1)), this._setRootTiles(null), this.notifyChange(\"ready\")), this._allTiles.clear(), this.visible = !1;\n  }\n\n  _purgeDescendantTiles(e) {\n    if (e.isLeaf) return !1;\n    let t = !1;\n\n    for (let i = 0; i < 4; ++i) t = this._purgeTile(e.children[i], !1) || t;\n\n    return e.unsetChildren(), t;\n  }\n\n  _purgeTile(e, t) {\n    const i = this._purgeDescendantTiles(e) || e.rendered;\n    return this._allTiles.removeUnordered(e), this._unloadTile(e), t && this._updateTileNeighborsAfterGeometryChange(e), this._tilePool.release(e), i;\n  }\n\n  _unloadTile(e) {\n    this.deferTileNeighborUpdate && this.neighborTilesToUpdate.delete(e), e.unload(this._renderer);\n  }\n\n  _splitTile(e) {\n    fe(e.isLeaf, \"tile that is already split should not be split again!\");\n    const t = e.level + 1,\n          i = 2 * e.lij[1],\n          r = 2 * e.lij[2];\n    e.setChildren(this._createTile(t, i, r, e), this._createTile(t, i, r + 1, e), this._createTile(t, i + 1, r, e), this._createTile(t, i + 1, r + 1, e)), e.setPendingUpdate(Me.RENDERDATA), e.updateAgentSuspension(), this._allTiles.pushArray(e.children), this._allTilesDirty = !0, this._emitTileScaleChange(e, t), ++this._performanceInfo.numSplit;\n  }\n\n  _emitTileScaleChange(e, t = e.level) {\n    at.spatialReference = this.spatialReference, at.extent = e.extent, at.scale = this._getLodBiasCorrectedScale(t), this.emit(\"scale-change\", at);\n  }\n\n  _createTile(e, t, i, r) {\n    fe(!!r, \"_createTile sanity check\");\n\n    const s = this._acquireTile(e, t, i, r);\n\n    return s.updateClippingStatus(this.extent), s.loadable && (s.updateScreenDepth(this._viewProjectionMatrix), s.shouldSplit(this._splitLimits, this._eyePosRenderSR, this.lodSnapping) === Me.SPLIT && s.setPendingUpdate(Me.SPLIT)), s;\n  }\n\n  _mergeTile(e) {\n    fe(!e.hasPendingUpdate(Me.SPLIT), \"_mergeTile sanity check\"), this._purgeDescendantTiles(e) && (fe(!e.renderData, \"_mergeTile sanity check\"), this._loadTile(e), this._updateTileNeighborsAfterGeometryChange(e), this.deferTileNeighborUpdate || this._checkTileAndNeighborsWaterproofness(e)), this._allTilesDirty = !0, ++this._performanceInfo.numMerged, this._emitTileScaleChange(e);\n  }\n\n  _checkTileAndNeighborsWaterproofness(e) {\n    e.checkGeometryWaterproofness(), this._checkTileNeighborsWaterproofness(e);\n  }\n\n  _checkTileNeighborsWaterproofness(e) {\n    Ce && e.forallNeighbors(e => !!e.isLoaded && (e.checkGeometryWaterproofness(), !0));\n  }\n\n  _loadChildren(e) {\n    this.deferTileNeighborUpdate || this._checkTileAndNeighborsWaterproofness(e), fe(e.rendered, \"parent should be rendered\"), this._unloadTile(e);\n    const t = e.children;\n    t.forEach(e => this._prepareToLoadTile(e)), t.forEach(e => this._loadTilePrepared(e)), this._updateTileNeighborsAfterGeometryChange(e, e.level + 1), this.deferTileNeighborUpdate || (t.forEach(e => e.updateNeighborsWithChangedEdgeResolution()), t.forEach(e => e.checkGeometryWaterproofness()), this._checkTileNeighborsWaterproofness(e));\n  }\n\n  _loadParent(e) {\n    this.deferTileNeighborUpdate || this._checkTileAndNeighborsWaterproofness(e);\n    const t = e.parent;\n    this._unloadChildren(t), this._loadTile(t), this._updateTileNeighborsAfterGeometryChange(t), this.deferTileNeighborUpdate || this._checkTileAndNeighborsWaterproofness(t);\n  }\n\n  _unloadChildren(e) {\n    if (!e.isLeaf) for (let t = 0; t < 4; ++t) {\n      const i = e.children[t];\n      this._unloadChildren(i), this._unloadTile(i);\n    }\n  }\n\n  _postLoadTile(e) {\n    e.setPendingUpdate(Me.RENDERDATA), this.requestUpdate(), this._allTilesDirty = !0, this.overlayManager && this.overlayManager.hasOverlays && this.overlayManager.setTileParameters(e), this._elevationUpdate(e);\n  }\n\n  _loadTile(e) {\n    e.load(this._renderer), this._postLoadTile(e);\n  }\n\n  _loadTilePrepared(e) {\n    e.loadPrepared(this._renderer), this._postLoadTile(e);\n  }\n\n  _prepareToLoadTile(e) {\n    e.prepareToLoad(this._renderer);\n  }\n\n  _elevationDataArrived(e, t, i) {\n    const r = new ee(e.lij, e.extent, i);\n    e.dataArrived(t, se.ELEVATION, r);\n\n    const s = [e],\n          a = e.level,\n          n = this._iteratorPool.acquire();\n\n    for (n.reset(s); !n.done;) {\n      const e = n.next();\n      e.findElevationBoundsForLayer(t, a), e.computeElevationBounds();\n    }\n\n    n.remove(), this._updateTilesVisibility(s);\n  }\n\n  _handleLayerViewChanges(e = Qe) {\n    if (!this._layerViewsDirty) return;\n    this._layerViewsDirty = !1;\n    let t = !1;\n    const i = new Set();\n    let r = -1;\n\n    for (const s of this.view.allLayerViews.items) if (i.add(s.uid), ye(s)) if (this._basemapLayerViewHandles.has(s.uid)) {\n      const e = this._layerClassFromLayerView(s),\n            i = this._getLayerIdxByUID(e, s.uid);\n\n      u(i) && ((i < r || p(r)) && (t = !0), r = i);\n    } else this._registerTiledLayerView(s), s.layer.loaded && (t = !0);\n\n    this._basemapLayerViewHandles.forEach((e, r) => {\n      i.has(r) || (this._unregisterTiledLayerView(r), t = !0);\n    }), t && this._updateTiledLayers(), this._renderer.isTransparent = this._allSurfaceLayersTransparent(), this.hasCompositeBlendMode = this._hasCompositeBlendMode(), e.madeProgress();\n  }\n\n  _allSurfaceLayersTransparent() {\n    let e = 0 === this.view.map?.ground?.opacity;\n\n    for (const t of this.view.allLayerViews.items) if (ve(t) && !W(t.layer) && 0 !== t.fullOpacity) return e = !1, e;\n\n    return e;\n  }\n\n  _hasCompositeBlendMode() {\n    for (const e of this.view.allLayerViews.items) if (we(e)) {\n      const t = Le(e.layer.parent) ? \"normal\" : e.layer.blendMode;\n      if (qe(Ge[t])) return !0;\n    }\n\n    return !1;\n  }\n\n  _layerClassFromLayerView(e) {\n    return Se(e) ? se.ELEVATION : se.MAP;\n  }\n\n  _registerTiledLayerView(e) {\n    const t = [],\n          i = this._layerClassFromLayerView(e);\n\n    t.push(T(() => e.suspended, () => this._updateTiledLayers())), t.push(T(() => e.fullOpacity, () => this._updateTileTextures(re.UNFADED))), t.push(T(() => \"effectiveScaleRange\" in e.layer ? e.layer.effectiveScaleRange : null, () => this._restartAllAgents(i))), we(e) && t.push(T(() => e.layer.blendMode, () => {\n      this.hasCompositeBlendMode = this._hasCompositeBlendMode(), this._updateTileTextures(re.UNFADED);\n    })), e.on(\"data-changed\", () => {\n      const t = this._getLayerIdxByUID(i, e.uid);\n\n      u(t) && this._invalidateLayerData(t, i);\n    }), this._basemapLayerViewHandles.set(e.uid, t);\n  }\n\n  _unregisterTiledLayerView(e) {\n    const t = this._basemapLayerViewHandles.get(e);\n\n    if (t) {\n      for (let e = 0; e < t.length; e++) t[e].remove();\n\n      this._basemapLayerViewHandles.delete(e);\n    }\n  }\n\n  _updateTiledLayers() {\n    if (!this.tilingScheme || this.view.suspended) return;\n    const e = this.view.allLayerViews,\n          t = [[], []];\n    let i = null;\n    e.forEach(e => {\n      if (!e.layer || e.suspended || !ye(e) || !e.fullExtent) return;\n\n      const r = this._layerClassFromLayerView(e);\n\n      if (r === se.MAP) {\n        const t = e.displayLevelRange.maxLevel;\n        t !== 1 / 0 && (null === i || t > i) && (i = t);\n      }\n\n      t[r].push(e);\n    });\n\n    for (const r of ae) {\n      const e = this._layerViews[r],\n            i = t[r];\n      i.reverse();\n      const s = i.length;\n      let a = e.length !== s;\n      const n = new Array(s),\n            o = new Array(e.length);\n\n      this._layerIndexByUid[r].clear();\n\n      for (let t = 0; t < s; t++) {\n        const s = i[t].uid;\n\n        this._layerIndexByUid[r].set(s, t);\n\n        const l = e.indexOf(i[t]);\n        n[t] = l, t !== l && (a = !0), l > -1 && (o[l] = t);\n      }\n\n      if (a) {\n        const e = this._postorderIterator;\n\n        for (e.reset(this.rootTiles); !e.done;) e.next().modifyLayers(o, n, r);\n\n        this._layerViews[r] = i, this._restartAllAgents(r), this._updateTilesVisibility(this.rootTiles);\n      }\n    }\n\n    this.tilingScheme.ensureMaxLod(i) && this._viewChangeUpdate();\n  }\n\n  _restartAllAgents(e) {\n    const t = this._postorderIterator;\n\n    for (t.reset(this.rootTiles); !t.done;) {\n      const i = t.next();\n      i.restartAgents(e), e === se.ELEVATION && i.computeElevationBounds();\n    }\n  }\n\n  layerViewByIndex(e, t) {\n    return this._layerViews[t][e];\n  }\n\n  numLayers(e) {\n    return this._layerViews[e].length;\n  }\n\n  _updateTileTextures(e) {\n    this._allTiles.forAll(t => {\n      t.updateAgents(se.MAP), e === re.IMMEDIATE ? this.renderer.updateTileTexture(t, Me.TEXTURE_NOFADING) : t.updateRenderData(se.MAP, e);\n    }), this._renderer.isTransparent = this._allSurfaceLayersTransparent();\n  }\n\n  _invalidateLayerData(e, t) {\n    this._allTiles.forAll(i => i.removeLayerAgent(e, t)), this._allTiles.forAll(i => i.invalidateLayerData(e, t));\n  }\n\n  setTileTreeDirty() {\n    this._allTilesDirty = !0;\n  }\n\n  requestRender(e = We.UPDATE) {\n    this.renderer.setNeedsRender(e);\n  }\n\n  requestUpdate() {\n    1 == ++this._pendingUpdates && (this._hasPendingUpdates = !0);\n  }\n\n  requestTileData(e, t, i, r) {\n    const s = this.layerViewByIndex(t, i),\n          a = s.layer;\n    return !a.tilemapCache || be(s) ? this._requestTileData(e, i, s, r) : (++this._asyncWorkItems, a.tilemapCache.fetchAvailability(e.lij[0], e.lij[1], e.lij[2], { ...r,\n      timeout: 6e3\n    }).then(() => --this._asyncWorkItems).catch(t => {\n      throw --this._asyncWorkItems, g(t) || this._dataMissing(e, i, s, {\n        notInTilemap: !0\n      }), t;\n    }).then(() => this._frameTask.schedule(() => this._requestTileData(e, i, s, r), r.signal)));\n  }\n\n  _requestTileData(e, t, i, r) {\n    return t === se.ELEVATION ? Se(i) ? this._requestElevationTileData(e, i, r) : Promise.reject() : ve(i) ? this._requestMapTileData(e, i, r) : Promise.reject();\n  }\n\n  _requestElevationTileData(e, t, i) {\n    ++this._asyncWorkItems;\n\n    const r = r => {\n      if (m(i)) return;\n\n      const s = this._layerIndexByUid[se.ELEVATION].get(t.uid);\n\n      null != s ? (this._usedMemory = null, this.requestUpdate(), this._elevationDataArrived(e, s, r)) : Xe.warn(\"TerrainSurface: received data from unknown layer %d %s\", se.ELEVATION, e.lij.toString());\n    },\n          s = i => {\n      g(i) || (this._dataMissing(e, se.ELEVATION, t, i), this.requestUpdate());\n    };\n\n    if (Ee(t.layer)) return t.layer.fetchTile(e.lij[0], e.lij[1], e.lij[2], {\n      noDataValue: _e,\n      signal: i.signal\n    }).then(e => {\n      if (!m(i)) return this._frameTask.schedule(() => r(e), i.signal, s);\n      Xe.warnOnce(\"A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.\");\n    }, s).finally(() => {\n      --this._asyncWorkItems;\n    });\n    const a = t.getTileUrl(e.lij[0], e.lij[1], e.lij[2]);\n    return this._elevationDataRequester.request(a, \"binary\", i).then(e => this._lercDecoder.decode(e, {\n      noDataValue: _e\n    }, i.signal)).then(e => {\n      e ? r({\n        values: e.pixelData,\n        width: e.width,\n        height: e.height,\n        noDataValue: e.noDataValue,\n        minValue: e.minValue,\n        maxValue: e.maxValue\n      }) : s(new Error(\"LERC decoding failed\"));\n    }, s).finally(() => {\n      --this._asyncWorkItems;\n    });\n  }\n\n  _requestMapTileData(e, t, i) {\n    ++this._asyncWorkItems;\n\n    const r = (r, s) => {\n      --this._asyncWorkItems, Ue(s), m(i) || (this._dataMissing(e, se.MAP, t, r), this.requestUpdate());\n    },\n          s = e => t => r(t, e),\n          a = r => this._frameTask.schedule(() => {\n      --this._asyncWorkItems, this.requestUpdate(), m(i) ? Ue(r) : this._mapTileDataArrived(e, t, r);\n    }, i.signal, s(r)).catch(s(r)),\n          n = (e, t = null) => this._frameTask.schedule(() => r(e, t));\n\n    if (be(t)) {\n      const r = t.schemaHelper.getLevelRowColumn(e.lij);\n      return t.fetchTile(r[0], r[1], r[2], i).then(a, n);\n    }\n\n    if (De(t)) return t.fetchTile(e.lij[0], e.lij[1], e.lij[2], i).then(a, n);\n    if (xe(t) && Ee(t.layer)) return t.layer.fetchTile(e.lij[0], e.lij[1], e.lij[2], i).then(e => {\n      if (m(i)) return Xe.warnOnce(\"A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.\"), void n(f());\n      a(e);\n    }, n);\n    let o = t.getTileUrl(e.lij[0], e.lij[1], e.lij[2]);\n    q(t.layer) && t.layer.refreshTimestamp && (o += `${o.includes(\"?\") ? \"&\" : \"?\"}_ts=${t.layer.refreshTimestamp}`);\n    const l = t.hasMixedImageFormats ? \"image+type\" : \"image\";\n    return this._mapDataRequester.request(o, l, i).then(a, n);\n  }\n\n  _mapTileDataArrived(e, t, i) {\n    const r = this._getLayerIdxByUID(se.MAP, t.uid);\n\n    u(r) ? e.dataArrived(r, se.MAP, i) : (Ue(i), Xe.warn(\"TerrainSurface: received data from unknown layer\"));\n  }\n\n  _getLayerIdxByUID(e, t) {\n    return this._layerIndexByUid[e].get(t);\n  }\n\n  _dataMissing(e, t, i, r) {\n    const s = this._getLayerIdxByUID(t, i.uid);\n\n    u(s) ? e.dataMissing(s, t, r) : Xe.warn(\"TerrainSurface: received data from unknown layer\");\n  }\n\n  updateTileOverlayParams(e) {\n    this.rootTiles && this.overlayManager && (this._allTiles.forAll(e => {\n      e.renderData && this.overlayManager.setTileParameters(e);\n    }), this._renderer.setNeedsRender(e));\n  }\n\n  get performanceInfo() {\n    const e = this._performanceInfo;\n    return e.numNodes = this._allTiles.length, e.numLeaves = e.numVisible = e.numRendered = e.numLoadedPerLevel.length = e.numRenderedPerLevel.length = 0, this._allTiles.forAll(t => {\n      t.isLeaf && e.numLeaves++;\n      const i = t.level;\n      t.renderData && (e.numLoadedPerLevel[i] = (e.numLoadedPerLevel[i] || 0) + 1), t.visible && (e.numVisible++, t.rendered && (e.numRenderedPerLevel[i] = (e.numRenderedPerLevel[i] || 0) + 1, e.numRendered++));\n    }), e;\n  }\n\n  getUsedMemory() {\n    return this.tilingScheme ? (p(this._usedMemory) && (this._usedMemory = this._recalculateUsedMemory()), u(this._usedMemory) ? this._usedMemory : 0) : 0;\n  }\n\n  _recalculateUsedMemory() {\n    return this.tilingScheme ? this._allTiles.reduce((e, t) => e + t.usedMemory, 0) : null;\n  }\n\n  getUsedMemoryForLayerView(e) {\n    let t = 0;\n\n    const i = this._layerClassFromLayerView(e),\n          r = this._getLayerIdxByUID(i, e.uid);\n\n    return u(r) && this._allTiles.forAll(e => t += e.getUsedMemoryForLayer(i, r)), t;\n  }\n\n  getTile(e) {\n    if (p(e) || p(this.rootTiles)) return null;\n    const t = e.split(\"/\").map(e => +e);\n    if (0 === t[0]) return this.rootTiles.find(e => e.lij[1] === t[1] && e.lij[2] === t[2]);\n    const i = 2 ** t[0],\n          r = Math.floor(t[1] / i),\n          s = Math.floor(t[2] / i);\n    let a;\n\n    if (this.rootTiles.some(e => e.lij[1] === r && e.lij[2] === s && (a = e, !0)), a) {\n      let e = 1 << t[0] - 1;\n\n      for (; a.lij[0] < t[0];) {\n        let i = t[1] & e ? 2 : 0;\n        if ((t[2] & e) > 0 && i++, !a.children[i]) return null;\n        a = a.children[i], e >>= 1;\n      }\n\n      return fe(a.lij[0] === t[0] && a.lij[1] === t[1] && a.lij[2] === t[2], \"not the right tile?\"), a;\n    }\n\n    return null;\n  }\n\n  get test() {\n    const e = this;\n    return {\n      renderer: e._renderer,\n      lercDecoder: e._lercDecoder,\n      forceReload: () => {\n        u(e.rootTiles) && (e._mergeTile(e.rootTiles[0]), e._viewChangeUpdate());\n      },\n      getTiles: () => e._allTiles.toArray(),\n\n      getRenderedTiles() {\n        rt.clear(), e._allTiles.forAll(e => {\n          e.visible && e.rendered && rt.push(e);\n        });\n        const t = rt.toArray();\n        return Ne(e.renderOrder, t), t;\n      },\n\n      lockTilingScheme(t, i) {\n        e._extentHelper.defaultTiledLayersExtent = i, e.tilingSchemeLogic.test.lockTilingScheme(t);\n      }\n\n    };\n  }\n\n  checkAllTileWaterproofness() {\n    if (!Ce) return;\n    const e = this.rootTiles;\n    if (p(e)) return;\n\n    const t = e => e?.renderData?.geometryInfo?.indices?.length > 0 ?? !1,\n          i = (e, i) => {\n      t(e) && console.error(\"Tile[\", e.lij, \"] has geometry although parent[\", i.lij, \"] has geom\");\n    },\n          r = e => {\n      if (e.renderData && !e.renderData.geometryState && console.error(\"Tile[\", e.lij, \"] has renderData but not geometryState\"), e.renderData && !e.renderData.geometryInfo && console.error(\"Tile[\", e.lij, \"] has renderData but not geometryInfo\"), !e.renderData?.geometryInfo || (e.renderData.geometryInfo.indices?.length ?? 0) > 0 || console.error(\"Tile[\", e.lij, \"] has renderData but no indices - geometryInfo: \", e.renderData.geometryInfo), t(e)) {\n        e.checkGeometryWaterproofness();\n\n        for (const t of e.children) i(t, e);\n      } else if (e.isLeaf) console.error(\"Tile[\", e.lij, \"] has no geometry and no children, from root to leaf\");else for (const t of e.children) r(t);\n    },\n          s = e => {\n      const t = e.parent?.visible ?? !0,\n            i = e.visible;\n      e.computeVisibility();\n      const r = e.visible;\n      if (i !== r && t && console.error(\" Tile[\", e.lij, \"] has out of date visibility: \", i, \" instead of \", r), !e.isLeaf) for (const a of e.children) s(a);\n    };\n\n    for (const a of e) r(a), s(a);\n  }\n\n  get isGlobal() {\n    return this._isGlobal;\n  }\n\n  get shadingEnabled() {\n    return this._renderer.shadingEnabled;\n  }\n\n  get isWebMercator() {\n    return !!this.tilingScheme?.spatialReference.isWebMercator;\n  }\n\n  get isWebMercatorOnPlateeCarree() {\n    return this.isWebMercator && B(this.view?.renderSpatialReference);\n  }\n\n  isEastEndWrap(e) {\n    return this.isGlobal && e[2] === this.lijEastEnd(e[0]) - 1;\n  }\n\n  isWestEndWrap(e) {\n    return this.isGlobal && 0 === e[2];\n  }\n\n  lijEastEnd(e) {\n    return 2 ** (e + (this.spatialReference.isGeographic ? 1 : 0));\n  }\n\n  wrapEastWest(e) {\n    const t = this.lijEastEnd(e[0]),\n          i = e[2];\n    if (0 <= i && i < t) return e;\n    if (!this.isGlobal) return null;\n    const r = (i + (i < 0 ? t : 0)) % t;\n    return [e[0], e[1], r];\n  }\n\n};\ne([S()], Ye.prototype, \"_renderer\", void 0), e([S()], Ye.prototype, \"_hasPendingUpdates\", void 0), e([S()], Ye.prototype, \"_asyncWorkItems\", void 0), e([S()], Ye.prototype, \"_allTilesDirty\", void 0), e([S()], Ye.prototype, \"_allTilesSorted\", void 0), e([S()], Ye.prototype, \"_viewChanged\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"_watchUpdatingTracking\", void 0), e([S()], Ye.prototype, \"_frameTask\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"snapLevel\", null), e([S({\n  readOnly: !0\n})], Ye.prototype, \"lodSnapping\", null), e([S({\n  constructOnly: !0\n})], Ye.prototype, \"view\", void 0), e([S()], Ye.prototype, \"_userClippingExtent\", null), e([S()], Ye.prototype, \"_rootTilesExtent\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"extent\", null), e([S({\n  readOnly: !0\n})], Ye.prototype, \"groundExtent\", null), e([S({\n  readOnly: !0\n})], Ye.prototype, \"_tilingSchemeExtent\", null), e([S({\n  readOnly: !0\n})], Ye.prototype, \"updating\", null), e([S(K)], Ye.prototype, \"updatingProgress\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"updatingProgressValue\", null), e([S()], Ye.prototype, \"_maxNumUpdating\", void 0), e([S({\n  aliasOf: \"view.map.ground.opacity\"\n})], Ye.prototype, \"baseOpacity\", void 0), e([S()], Ye.prototype, \"hasCompositeBlendMode\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"overlayManager\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"viewingMode\", null), e([S()], Ye.prototype, \"maxTextureScale\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"ready\", null), e([S({\n  value: le.FRONT_TO_BACK\n})], Ye.prototype, \"renderOrder\", null), e([S({\n  readOnly: !0\n})], Ye.prototype, \"rootTiles\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"spatialReference\", null), e([S({\n  type: t,\n  aliasOf: \"view.map.ground.surfaceColor\"\n})], Ye.prototype, \"backgroundColor\", void 0), e([S({\n  value: !1\n})], Ye.prototype, \"slicePlaneEnabled\", null), e([S({\n  readOnly: !0\n})], Ye.prototype, \"tilingScheme\", void 0), e([S({\n  readOnly: !0,\n  aliasOf: \"tilingSchemeLogic.tilingSchemeLocked\"\n})], Ye.prototype, \"tilingSchemeLocked\", void 0), e([S({\n  readOnly: !0\n})], Ye.prototype, \"tilingSchemeLogic\", void 0), e([S({\n  value: !0\n})], Ye.prototype, \"velvetOverground\", null), e([L(\"_renderer.wireframe\")], Ye.prototype, \"wireframe\", void 0), e([S({\n  value: !1\n})], Ye.prototype, \"suspended\", null), e([S({\n  readOnly: !0,\n  aliasOf: \"view.qualitySettings.tiledSurface.textureFadeDuration\"\n})], Ye.prototype, \"textureFadeDuration\", void 0), e([S()], Ye.prototype, \"_layerViewsDirty\", void 0), e([L(\"_renderer.renderPatchBorders\")], Ye.prototype, \"renderPatchBorders\", void 0), e([L(\"_renderer.renderingDisabled\")], Ye.prototype, \"renderingDisabled\", void 0), Ye = e([b(\"esri.views.3d.terrain.TerrainSurface\")], Ye);\nconst $e = Ye;\n\nfunction Ke(e, t) {\n  return e[0] === t[0] && e[1] === t[1] && e[2] === t[2];\n}\n\nfunction Je(e) {\n  return !e.isLeaf && (e.children.some(e => e.shouldLoad) || e.children.some(e => Je(e)));\n}\n\nfunction Ze(e) {\n  return e.isLeaf && e.parent && e.parent.shouldLoad;\n}\n\nconst et = C(),\n      tt = A(),\n      it = [0, 0, 0],\n      rt = new _(),\n      st = {\n  spatialReference: null,\n  tile: null,\n  extent: null,\n  context: \"ground\"\n},\n      at = {\n  spatialReference: null,\n  extent: null,\n  scale: 0\n};\nexport { $e as default };","map":{"version":3,"names":["_","e","t","i","difference","r","s","a","n","o","clamp","l","releaseMaybe","h","destroyMaybe","d","isNone","p","isSome","u","c","isAbortError","g","isAborted","m","createAbortError","f","watch","T","syncAndInitial","y","sync","v","initial","w","aliasOf","L","property","S","subclass","b","E","D","x","U","C","WatchUpdatingTracking","P","projectVectorToVector","R","projectPointToVector","j","getReferenceEllipsoid","M","create","A","equals","I","intersection","V","intersectsSphere","O","N","copy","k","isPlateCarree","B","isRefreshableLayer","q","ElevationQueryTileCache","G","isBaseLayer","W","acquireDecoder","F","printAllocations","H","directionToHeadingTilt","Q","scaleToZoom","X","z","toBoundingRect","Y","ClientType","$","updatingProgress","K","ElevationBounds","J","sampleElevation","Z","ElevationData","ee","te","LODSnapping","ie","TextureUpdate","re","LayerClass","se","LayerClasses","ae","OverlayManager","ne","PlanarPatch","oe","RenderOrder","le","SphericalPatch","he","MAX_ROOT_TILES","de","TOO_MANY_ROOT_TILES_AFTER_CHANGE_ERROR","pe","TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR","ue","MAX_MEMORY_LOD_BIAS","ce","ELEVATION_NODATA_VALUE","_e","ge","me","weakAssert","fe","internalAssert","Te","isSurfaceLayerView","ye","isMapTileLayerView","ve","isBlendableLayerView","we","isGroupLayer","Le","isElevationLayerView","Se","isVectorTileLayerView","be","useFetchTileForLayer","Ee","isImageryTileLayerView","De","isTileLayerView","xe","releaseTileData","Ue","ENABLE_WATERPROOFNESS_TESTS","Ce","SplitLimits","Pe","Tile","Re","je","TileUpdate","Me","IteratorPreorder","Ae","IteratorPostorder","Ie","hasLoadableSiblings","Ve","sortTilesByPOI","Oe","sortTiles","Ne","TilingSchemeLogic","ke","UpsampleInfo","Be","isCompositeBlendMode","qe","blendModeFromString","Ge","RenderRequestType","We","ImmediateTask","Fe","TaskPriority","He","noBudget","Qe","Xe","getLogger","ze","Ye","EventedMixin","constructor","_elevationBounds","_iteratorPool","remove","release","_postorderIterator","_hasPendingUpdates","_pendingUpdates","_asyncWorkItems","_allTilesDirty","_allTilesSorted","_visible","_usedMemory","_performanceInfo","_viewChanged","_inFrameTask","_viewChangeUpdateDirty","_eyePosRenderSR","_eyePosSurfaceSR","_splitLimits","_snapLevel","_frustum","_viewProjectionMatrix","_layerViews","Array","_layerIndexByUid","Map","_basemapLayerViewHandles","_handles","_watchUpdatingTracking","_frameTask","_allTiles","_upsampleInfoPool","_rootTilesExtent","_maxNumUpdating","maxTextureScale","backgroundColor","_updatingRootTiles","deferTileNeighborUpdate","neighborTilesToUpdate","Set","totalGeometryUpdates","totalTileUpdates","_layerViewsDirty","_isGlobal","view","state","isLocal","initialize","_lercDecoder","resourceController","_tilePool","memoryController","_upsampleMapCache","newCache","unloadMapData","_elevationQueryCache","_set","surface","add","overlayManager","hasHighlights","_renderer","setNeedsHighlight","rendersOccluded","setRenderOccludedOverlay","overlayRenderer","renderer","ellipsoidRadius","spatialReference","radius","stage","_stage","allTiles","baseOpacity","_handleLayerViewChanges","_updateBaseOpacity","hasCompositeBlendMode","renderingDisabled","_updateTransparentTerrain","updateTileBackground","pointsOfInterest","removeAll","focus","renderLocation","TERRAIN_TILE_TREE_SHOW_TILES","_treeDebugger","then","TerrainTileTree3DDebugger","_extentHelper","viewingMode","layers","map","allLayers","layerViews","allLayerViews","viewSpatialReference","defaultsFromMap","getCollections","mapCollections","getChildrenFunction","extentHelper","_updateTilingScheme","_elevationDataRequester","createStreamDataRequester","ELEVATION","_mapDataRequester","BASEMAP","scheduler","registerTask","TERRAIN_SURFACE","stencilEnabledExtents","setStencilEnabledLayerExtents","tilingSchemeLogic","tilingScheme","extent","_updateRootTiles","on","_viewChangeUpdate","lodBias","lodSnapping","memoryFactor","camera","contentCamera","fixedContentCamera","qualitySettings","tiledSurface","textureFadeDuration","textureFadingEnabled","_userClippingExtent","_updateClippingExtent","destroy","_removeAllTiles","forEach","_unregisterTiledLayerView","prune","frustum","snapLevel","contentCameraOnSurface","scale","eye","viewForward","up","tilt","Math","abs","round","reduceTileLevelDifferences","ON","OFF","upsampleInfoPool","upsampleMapCache","elevationQueryCache","mapTileRequester","clippingArea","_get","rootTilesExtent","groundExtent","_tilingSchemeExtent","updating","ready","suspended","updatingProgressValue","max","rootTiles","renderOrder","slicePlaneEnabled","opaque","renderView","setRenderParameters","transparentTerrain","velvetOverground","visible","setVisibility","intersect","getElevation","getTileWithElevation","et","renderData","geometryState","samplerData","length","layerInfo","error","containsPoint","rendered","isLeaf","children","elevationBounds","getScale","_getLodBiasCorrectedScale","level","getSphereElevationBounds","min","getSphereScale","queryVisibleScaleRange","levelAtScale","queryVisibleLevelRange","isTransparent","_allSurfaceLayersTransparent","_updateTileTextures","UNFADED","IMMEDIATE","_updateTiledLayers","setTileSize","pixelSize","setSpatialReference","_acquireTile","acquire","it","init","updatingRootTiles","tt","rootTilesInExtent","warn","lij","Ke","removed","added","filter","findIndex","_purgeTile","push","_newRootTile","_setRootTiles","setPlacementDirty","notifyChange","isLoaded","_prepareToLoadTile","forAll","_updateTileGeometry","_updateTileNeighborsAfterGeometryChange","checkAllTileWaterproofness","shouldSplit","SPLIT","setPendingUpdate","_loadTile","checkGeometryWaterproofness","clear","reset","done","next","setRootTiles","_updateTilesVisibility","_runViewChangeUpdateIfDirty","_updateViewDependentParameters","_updateClippingStatus","updateClippingStatus","resetPendingUpdate","GEOMETRY","setTileTreeDirty","RENDERDATA","computeVisibility","updateScreenDepth","skipSubtree","isFinite","emit","tan","fovX","fovY","pixelRatio","aboveGround","relativeWidthLimit","width","relativeHeightLimit","height","maxLod","getMaxLod","angledSplitBias","projectionMatrix","viewMatrix","renderSpatialReference","_updateRenderData","shouldLoad","Je","_loadChildren","_checkTileNeighborsWaterproofness","Ze","_loadParent","updateVisibility","updateTileGeometry","_elevationUpdate","delete","forEachLoadedNeighbor","updateNeighborsAfterGeometryChange","_updateTileTexture","TEXTURE_FADING","TEXTURE_NOFADING","updateTileTexture","madeProgress","st","tile","running","runTask","processQueue","_updateTileStatus","_sortTiles","_mergeAndSplit","run","_updateElevation","_updateTextures","requestUpdate","_recalculateUsedMemory","loadable","MERGE","updateAgentSuspension","VSPLITMERGE","updateAgents","resetOne","update","_prepareBatchTileGeometryUpdate","size","_batchUpdateUpdatedTileNeighbors","updateNeighborsWithChangedEdgeResolution","updateNeighborDataAndGeometryIfNeeded","some","_mergeTile","_splitTile","hasProgressed","updateTileOverlayParams","UPDATE","levels","floor","ceil","_purgeDescendantTiles","unsetChildren","removeUnordered","_unloadTile","unload","setChildren","_createTile","pushArray","_emitTileScaleChange","numSplit","at","hasPendingUpdate","_checkTileAndNeighborsWaterproofness","numMerged","forallNeighbors","_loadTilePrepared","parent","_unloadChildren","_postLoadTile","hasOverlays","setTileParameters","load","loadPrepared","prepareToLoad","_elevationDataArrived","dataArrived","findElevationBoundsForLayer","computeElevationBounds","items","uid","has","_layerClassFromLayerView","_getLayerIdxByUID","_registerTiledLayerView","layer","loaded","_hasCompositeBlendMode","ground","opacity","fullOpacity","blendMode","MAP","effectiveScaleRange","_restartAllAgents","_invalidateLayerData","set","get","fullExtent","displayLevelRange","maxLevel","reverse","indexOf","modifyLayers","ensureMaxLod","restartAgents","layerViewByIndex","numLayers","updateRenderData","removeLayerAgent","invalidateLayerData","requestRender","setNeedsRender","requestTileData","tilemapCache","_requestTileData","fetchAvailability","timeout","catch","_dataMissing","notInTilemap","schedule","signal","_requestElevationTileData","Promise","reject","_requestMapTileData","toString","fetchTile","noDataValue","warnOnce","finally","getTileUrl","request","decode","values","pixelData","minValue","maxValue","Error","_mapTileDataArrived","schemaHelper","getLevelRowColumn","refreshTimestamp","includes","hasMixedImageFormats","dataMissing","performanceInfo","numNodes","numLeaves","numVisible","numRendered","numLoadedPerLevel","numRenderedPerLevel","getUsedMemory","reduce","usedMemory","getUsedMemoryForLayerView","getUsedMemoryForLayer","getTile","split","find","test","lercDecoder","forceReload","getTiles","toArray","getRenderedTiles","rt","lockTilingScheme","defaultTiledLayersExtent","geometryInfo","indices","console","isGlobal","shadingEnabled","isWebMercator","isWebMercatorOnPlateeCarree","isEastEndWrap","lijEastEnd","isWestEndWrap","isGeographic","wrapEastWest","prototype","readOnly","constructOnly","value","FRONT_TO_BACK","type","$e","context","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/terrain/TerrainSurface.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Color.js\";import i from\"../../../core/Accessor.js\";import{difference as r}from\"../../../core/arrayUtils.js\";import s from\"../../../core/CollectionFlattener.js\";import a from\"../../../core/Evented.js\";import n from\"../../../core/Handles.js\";import o from\"../../../core/Logger.js\";import{clamp as l}from\"../../../core/mathUtils.js\";import{releaseMaybe as h,destroyMaybe as d,isNone as p,isSome as u}from\"../../../core/maybe.js\";import c from\"../../../core/ObjectPool.js\";import _ from\"../../../core/PooledArray.js\";import{isAbortError as g,isAborted as m,createAbortError as f}from\"../../../core/promiseUtils.js\";import{watch as T,syncAndInitial as y,sync as v,initial as w}from\"../../../core/reactiveUtils.js\";import{aliasOf as L}from\"../../../core/accessorSupport/decorators/aliasOf.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as S}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as b}from\"../../../core/accessorSupport/decorators/subclass.js\";import{m as E}from\"../../../chunks/mat4.js\";import{c as D}from\"../../../chunks/mat4f64.js\";import{c as x}from\"../../../chunks/vec3.js\";import{c as U}from\"../../../chunks/vec3f64.js\";import{c as C}from\"../../../chunks/vec4f64.js\";import{WatchUpdatingTracking as P}from\"../../../core/support/WatchUpdatingTracking.js\";import{projectVectorToVector as R,projectPointToVector as j}from\"../../../geometry/projection.js\";import{getReferenceEllipsoid as M}from\"../../../geometry/projectionEllipsoid.js\";import{create as A,equals as I,intersection as V,intersectsSphere as O}from\"../../../geometry/support/aaBoundingRect.js\";import{create as N,copy as k}from\"../../../geometry/support/frustum.js\";import{isPlateCarree as B}from\"../../../geometry/support/spatialReferenceUtils.js\";import{isRefreshableLayer as q}from\"../../../layers/mixins/RefreshableLayer.js\";import{ElevationQueryTileCache as G}from\"../../../layers/support/ElevationQueryTileCache.js\";import{isBaseLayer as W}from\"../../../layers/support/layerUtils.js\";import{acquireDecoder as F}from\"../../../layers/support/LercDecoder.js\";import{printAllocations as H}from\"../../2d/engine/vectorTiles/VectorTile.js\";import{directionToHeadingTilt as Q,scaleToZoom as X}from\"../support/cameraUtils.js\";import z from\"../support/debugFlags.js\";import{toBoundingRect as Y}from\"../support/extentUtils.js\";import{ClientType as $}from\"../support/index.js\";import{updatingProgress as K}from\"../support/updatingProperties.js\";import{ElevationBounds as J}from\"./ElevationBounds.js\";import{sampleElevation as Z,ElevationData as ee}from\"./ElevationData.js\";import{create as te}from\"./ExtentHelper.js\";import{LODSnapping as ie,TextureUpdate as re}from\"./interfaces.js\";import{LayerClass as se,LayerClasses as ae}from\"./LayerClass.js\";import{OverlayManager as ne}from\"./OverlayManager.js\";import{PlanarPatch as oe}from\"./PlanarPatch.js\";import{RenderOrder as le}from\"./RenderOrder.js\";import{SphericalPatch as he}from\"./SphericalPatch.js\";import{MAX_ROOT_TILES as de,TOO_MANY_ROOT_TILES_AFTER_CHANGE_ERROR as pe,TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR as ue,MAX_MEMORY_LOD_BIAS as ce,ELEVATION_NODATA_VALUE as _e}from\"./TerrainConst.js\";import ge from\"./TerrainRenderer.js\";import me from\"./TerrainSurfacePerformanceInfo.js\";import{weakAssert as fe,internalAssert as Te,isSurfaceLayerView as ye,isMapTileLayerView as ve,isBlendableLayerView as we,isGroupLayer as Le,isElevationLayerView as Se,isVectorTileLayerView as be,useFetchTileForLayer as Ee,isImageryTileLayerView as De,isTileLayerView as xe,releaseTileData as Ue,ENABLE_WATERPROOFNESS_TESTS as Ce}from\"./terrainUtils.js\";import{SplitLimits as Pe,Tile as Re}from\"./Tile.js\";import{printAllocations as je}from\"./TilePerLayerInfo.js\";import{TileUpdate as Me}from\"./TileUpdate.js\";import{IteratorPreorder as Ae,IteratorPostorder as Ie,hasLoadableSiblings as Ve,sortTilesByPOI as Oe,sortTiles as Ne}from\"./tileUtils.js\";import{TilingSchemeLogic as ke}from\"./TilingSchemeLogic.js\";import{UpsampleInfo as Be}from\"./UpsampleInfo.js\";import{isCompositeBlendMode as qe,blendModeFromString as Ge}from\"../webgl-engine/core/shaderLibrary/output/BlendOptions.js\";import{RenderRequestType as We}from\"../webgl-engine/lib/basicInterfaces.js\";import{ImmediateTask as Fe,TaskPriority as He,noBudget as Qe}from\"../../support/Scheduler.js\";const Xe=o.getLogger(\"esri.views.3d.terrain.TerrainSurface\"),ze=.25;let Ye=class extends(a.EventedMixin(i)){constructor(e){super(e),this._elevationBounds=new J,this._iteratorPool=new c(Ae,(e=>e.remove=()=>this._iteratorPool.release(e))),this._postorderIterator=new Ie,this._hasPendingUpdates=!1,this._pendingUpdates=0,this._asyncWorkItems=0,this._allTilesDirty=!0,this._allTilesSorted=!0,this._visible=!1,this._usedMemory=null,this._performanceInfo=new me,this._viewChanged=!1,this._inFrameTask=!1,this._viewChangeUpdateDirty=!1,this._eyePosRenderSR=U(),this._eyePosSurfaceSR=U(),this._splitLimits=new Pe,this._snapLevel=1/0,this._frustum=N(),this._viewProjectionMatrix=D(),this._layerViews=[new Array,new Array],this._layerIndexByUid=[new Map,new Map],this._basemapLayerViewHandles=new Map,this._handles=new n,this._watchUpdatingTracking=new P,this._frameTask=Fe,this._allTiles=new _,this._upsampleInfoPool=new c(Be),this._rootTilesExtent=A(),this._maxNumUpdating=1,this.maxTextureScale=1.2,this.backgroundColor=null,this._updatingRootTiles=!1,this.deferTileNeighborUpdate=!1,this.neighborTilesToUpdate=new Set,this.totalGeometryUpdates=0,this.totalTileUpdates=0,this._layerViewsDirty=!1,this._isGlobal=!e.view?.state?.isLocal}initialize(){this._lercDecoder=F(this.view.resourceController),this._tilePool=this.view.state.isLocal?new c(oe):new c(he);const e=this.view.resourceController.memoryController;this._upsampleMapCache=e.newCache(\"esri.views.3d.terrain.upsample\",(e=>e.unloadMapData())),this._elevationQueryCache=new G(e.newCache(\"elevation-query\")),this._set(\"overlayManager\",new ne({surface:this})),this._handles.add([T((()=>this.overlayManager.hasHighlights),(e=>this._renderer.setNeedsHighlight(e))),T((()=>this.overlayManager.rendersOccluded),(e=>this._renderer.setRenderOccludedOverlay(e)))],\"overlayManager\"),this._renderer=new ge({overlayRenderer:this.overlayManager.renderer,ellipsoidRadius:M(this.view.spatialReference).radius,stage:this.view._stage,allTiles:this._allTiles}),this._handles.add([T((()=>this.baseOpacity),(e=>{this._handleLayerViewChanges(),this._updateBaseOpacity(e)}),y),T((()=>this.hasCompositeBlendMode),(()=>{this._updateBaseOpacity(this.baseOpacity)}),y),T((()=>this.renderingDisabled),(()=>this._updateTransparentTerrain()),v),T((()=>this.backgroundColor),(e=>{this._handleLayerViewChanges(),this._renderer.updateTileBackground(e)}),y),T((()=>this.view.pointsOfInterest),(e=>{this._renderer.pointsOfInterest=e,this._watchUpdatingTracking.removeAll(),e&&this._watchUpdatingTracking.add((()=>e.focus.renderLocation),(()=>()=>this._allTilesSorted=!1))})),T((()=>z.TERRAIN_TILE_TREE_SHOW_TILES),(e=>{e&&!this._treeDebugger?import(\"../layers/support/TerrainTileTree3DDebugger.js\").then((({TerrainTileTree3DDebugger:e})=>{!this._treeDebugger&&z.TERRAIN_TILE_TREE_SHOW_TILES&&(this._treeDebugger=new e({view:this.view}))})):e||(this._treeDebugger=d(this._treeDebugger))}),w)]),this._extentHelper=te(this.viewingMode,{layers:this.view.map.allLayers,layerViews:this.view.allLayerViews,viewSpatialReference:this.view.spatialReference});const t=this.view.defaultsFromMap?new s({getCollections:()=>this.view?.defaultsFromMap?.mapCollections?.map((({layers:e})=>e)),getChildrenFunction:e=>e&&\"layers\"in e?e.layers:null}):this.view.map.allLayers,i=new ke({layers:t,extentHelper:this._extentHelper,viewingMode:this.viewingMode,viewSpatialReference:this.view.spatialReference});this._set(\"tilingSchemeLogic\",i),this._updateTilingScheme(),this._elevationDataRequester=this.view.resourceController.createStreamDataRequester($.ELEVATION),this._mapDataRequester=this.view.resourceController.createStreamDataRequester($.BASEMAP);const r=this.view.resourceController.scheduler;this._frameTask=r.registerTask(He.TERRAIN_SURFACE,this),this._handles.add([T((()=>this._extentHelper.stencilEnabledExtents),(e=>this._renderer.setStencilEnabledLayerExtents(e)),w),T((()=>this.tilingSchemeLogic.tilingScheme),(()=>this._updateTilingScheme()),v),T((()=>this.extent),(()=>this._updateRootTiles()),w),this.view.on(\"resize\",(()=>this._viewChangeUpdate())),T((()=>{const e=this.view,t=e.state;return[this.lodBias,this.lodSnapping,e.resourceController?.memoryController?.memoryFactor,t.camera,t.contentCamera,t.fixedContentCamera]}),(()=>this._viewChangeUpdate()),y),T((()=>this.view.qualitySettings?.tiledSurface?.textureFadeDuration),(e=>this._renderer.textureFadingEnabled=e>0),w),T((()=>this._userClippingExtent),(()=>this._updateClippingExtent()),v)]),this._handles.add(this.view.allLayerViews.on(\"after-changes\",(()=>this._layerViewsDirty=!0))),this._layerViewsDirty=!0,this._handleLayerViewChanges()}destroy(){this._frameTask.remove(),this._handles.destroy(),this._watchUpdatingTracking.destroy(),this._lercDecoder=h(this._lercDecoder),this._removeAllTiles(),this._upsampleMapCache=d(this._upsampleMapCache),this._elevationQueryCache=d(this._elevationQueryCache),this._set(\"tilingSchemeLogic\",d(this.tilingSchemeLogic)),this._extentHelper=d(this._extentHelper),this._basemapLayerViewHandles.forEach(((e,t)=>this._unregisterTiledLayerView(t))),this._elevationDataRequester=null,this._mapDataRequester=null,this._set(\"overlayManager\",d(this.overlayManager)),this._tilePool=d(this._tilePool),Re.prune(),this._treeDebugger&&(this._treeDebugger.destroy(),this._treeDebugger=null),this._renderer=d(this._renderer),this._iteratorPool=d(this._iteratorPool),this._set(\"view\",null),this._upsampleInfoPool=d(this._upsampleInfoPool),H(),je()}get renderer(){return this._renderer}get frustum(){return this._frustum}get snapLevel(){const e=this.view.pointsOfInterest?.contentCameraOnSurface?.scale;if(e){const t=this.view.state.contentCamera;let i=Q(this.view,t.eye,t.viewForward,t.up).tilt;i>90&&(i=180-i);const r=2*(i/90)**2,s=X(this.view,e)-r;Math.abs(this._snapLevel-s)>ze&&(Math.round(s)!==Math.round(this._snapLevel)&&(this._viewChanged=!0),this._snapLevel=s)}return Math.round(this._snapLevel)}get lodSnapping(){return this.view.qualitySettings.tiledSurface.reduceTileLevelDifferences?ie.ON:ie.OFF}get upsampleInfoPool(){return this._upsampleInfoPool}get upsampleMapCache(){return this._upsampleMapCache}get elevationQueryCache(){return this._elevationQueryCache}get mapTileRequester(){return this._mapDataRequester}get _userClippingExtent(){const{spatialReference:e}=this,{clippingArea:t}=this.view;if(p(t)||p(e))return null;const i=A(),r=Y(t,i,e)?i:null,s=this._get(\"extent\");return I(r,s)?s:r}get rootTilesExtent(){return this._rootTilesExtent}get extent(){const e=V(this.groundExtent,this._userClippingExtent,A()),t=this._get(\"extent\");return I(e,t)?t:e}get groundExtent(){return u(this._tilingSchemeExtent)?this._tilingSchemeExtent:this._rootTilesExtent}get _tilingSchemeExtent(){return this.tilingSchemeLogic?.extent}get updating(){return this._hasPendingUpdates||(this._maxNumUpdating=1),!!((this._watchUpdatingTracking.updating||this._hasPendingUpdates||this._viewChanged||this._allTilesDirty||this._asyncWorkItems>0||!this._allTilesSorted||this._layerViewsDirty)&&this.ready&&!this.suspended||this.overlayManager.updating||this._frameTask.updating)}get updatingProgressValue(){return this._maxNumUpdating=Math.max(this._pendingUpdates,this._maxNumUpdating),1-this._pendingUpdates/this._maxNumUpdating}get viewingMode(){return this.view.state.viewingMode}get ready(){return u(this.rootTiles)}set renderOrder(e){this._renderer.renderOrder=e,this._set(\"renderOrder\",e)}get spatialReference(){return this.tilingScheme?.spatialReference??null}set slicePlaneEnabled(e){this._renderer.slicePlaneEnabled=e,this._set(\"slicePlaneEnabled\",e),this._updateTransparentTerrain()}_updateTransparentTerrain(){const e=!this.renderingDisabled&&!this.opaque;this.view?._stage?.renderView.setRenderParameters({transparentTerrain:e})}set velvetOverground(e){e!==this.velvetOverground&&(this._renderer.velvetOverground=e),this._set(\"velvetOverground\",e)}set visible(e){e!==this._visible&&(this._visible=e,this._renderer.setVisibility(e),this.suspended=!e)}get opaque(){return this._renderer.opaque}set suspended(e){this._set(\"suspended\",e),this._viewChangeUpdate()}intersect(e,t,i,r){this._renderer.intersect(e,t,i,r)}getElevation(e,t,i,r){const s=this.getTileWithElevation(e,t,i,r,et);return p(s)?null:Z(et[0],et[1],s.renderData.geometryState.samplerData)}getTileWithElevation(e,t,i,r,s=et){const a=this.rootTiles;if(p(a)||!a.length)return null;if(0===a[0].layerInfo[se.ELEVATION].length)return null;if(s[0]=e,s[1]=t,s[2]=i,!R(s,r,s,this.tilingScheme?.spatialReference))return Xe.error(\"TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system\"),null;for(let n of a){if(!n.containsPoint(s))continue;for(;n&&!n.rendered&&!n.isLeaf;){let e=0;s[0]>.5*(n.extent[0]+n.extent[2])&&(e+=1),s[1]<.5*(n.extent[1]+n.extent[3])&&(e+=2),n=n.children[e]}const e=n.renderData;return(e?e.geometryState.samplerData:null)?n:null}return null}get elevationBounds(){return this._elevationBounds}getScale(e){if(this.tilingScheme){if(!j(e,et,this.spatialReference))return Xe.error(\"TerrainSurface.getScale(): could not project given point to tiling scheme coordinate system\"),null;const t=this.rootTiles;if(u(t))for(let e of t)if(e?.containsPoint(et)){for(;!e.isLeaf&&!e.rendered;){let t=0;et[0]>e.children[0].extent[2]&&(t+=1),et[1]<e.children[0].extent[1]&&(t+=2),e=e.children[t]}return this._getLodBiasCorrectedScale(e.level)}}return 1e100}getSphereElevationBounds(e,t,i,r,s){if(et[0]=e,et[1]=t,et[2]=i,et[3]=r,!R(et,s,et,this.tilingScheme?.spatialReference))return Xe.error(\"TerrainSurface.getSphereElevationBounds(): could not project given point to tiling scheme coordinate system\"),null;let a=1/0,n=-1/0;const o=e=>{if(e&&O(e.extent,et))if(e.isLeaf||e.rendered)a=Math.min(a,e.elevationBounds[0]),n=Math.max(n,e.elevationBounds[1]);else for(const t of e.children)o(t)},l=this.rootTiles;if(u(l))for(const h of l)o(h);return{min:a,max:n}}getSphereScale(e,t){if(!this.tilingScheme)return null;if(!j(e,et,this.spatialReference))return Xe.error(\"TerrainSurface.getSphereScale(): could not project given point to tiling scheme coordinate system\"),null;et[3]=t;let i=null;const r=e=>{if(e&&O(e.extent,et))if(e.isLeaf||e.rendered){const t=this._getLodBiasCorrectedScale(e.level);i=null==i?t:Math.min(i,t)}else for(const t of e.children)r(t)},s=this.rootTiles;if(u(s))for(const a of s)r(a);return i}queryVisibleScaleRange(e,t,i,r){const s=t?this.tilingScheme.levelAtScale(t):0,a=i?this.tilingScheme.levelAtScale(i):1/0,n=this.lodBias;this._renderer.queryVisibleLevelRange(e,s+n,a+n,r)}_updateBaseOpacity(e){const t=this._renderer.opaque;this._renderer.opaque=e>=1&&!this.hasCompositeBlendMode,this._renderer.isTransparent=this._allSurfaceLayersTransparent();const i=t!==this._renderer.opaque;i&&this._updateTransparentTerrain(),this._updateTileTextures(i?re.UNFADED:re.IMMEDIATE)}_updateTilingScheme(){const e=this.tilingSchemeLogic.tilingScheme;e!==this.tilingScheme&&(fe(!!e,\"tiling scheme cannot be reset to undefined\"),this._isGlobal=!this.view?.state?.isLocal,this.tilingScheme&&this._removeAllTiles(),this._set(\"tilingScheme\",e),this._updateClippingExtent(),e&&(this._updateTiledLayers(),this._renderer.setTileSize(e.pixelSize),this.overlayManager.setSpatialReference(e.spatialReference),this._updateRootTiles()))}_acquireTile(e,t,i,r){const s=this._tilePool.acquire();return it[0]=e,it[1]=t,it[2]=i,s.init(it,r,this),s}get updatingRootTiles(){return this._updatingRootTiles}_updateRootTiles(){const{extent:e,tilingScheme:t}=this;if(!t)return;const i=tt;let s=t.rootTilesInExtent(e,i,5*de);if(u(this.rootTiles)){if(s.length>de)return void Xe.warn(pe);const e=this.rootTiles.map((e=>e.lij)),t=r(e,s,Ke);if(this._updatingRootTiles=!0,t.removed.length>0||t.added.length>0){const e=this.rootTiles.filter((e=>!(t.removed.findIndex((t=>Ke(t,e.lij)))>-1)||(this._purgeTile(e,!0),!1)));t.added.forEach((t=>e.push(this._newRootTile(t)))),this._setRootTiles(e)}}else this._updatingRootTiles=!0,s.length>de&&(Xe.warn(ue),s=t.rootTilesInExtent(e,i,de)),this._setRootTiles(s.map((e=>this._newRootTile(e))));I(i,this._rootTilesExtent)||(this._rootTilesExtent=A(i)),this.visible=!0,this._viewChangeUpdate(),this.overlayManager.setPlacementDirty(),this.notifyChange(\"ready\"),this._allTiles.forEach((e=>{e.isLoaded&&this._prepareToLoadTile(e)})),this._allTiles.forAll((e=>{e.isLoaded&&(this._updateTileGeometry(e),this._updateTileNeighborsAfterGeometryChange(e))})),this._updatingRootTiles=!1,this.checkAllTileWaterproofness()}_newRootTile(e){const t=this._acquireTile(0,e[1],e[2],null);return t.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.lodSnapping)===Me.SPLIT&&t.setPendingUpdate(Me.SPLIT),this._loadTile(t),this.deferTileNeighborUpdate||t.checkGeometryWaterproofness(),t}_setRootTiles(e){if(this._set(\"rootTiles\",e),this._allTiles.clear(),u(e)){const t=this._iteratorPool.acquire();for(t.reset(e);!t.done;)this._allTiles.push(t.next());t.remove()}this._renderer.setRootTiles(this.rootTiles),this._updateTilesVisibility(e)}_runViewChangeUpdateIfDirty(){this._viewChangeUpdateDirty&&(this._viewChangeUpdateDirty=!1,this._viewChangeUpdate())}_viewChangeUpdate(){this.view&&!this.suspended&&this.tilingScheme&&this._visible&&(this._inFrameTask?this._viewChangeUpdateDirty=!0:(this._viewChangeUpdateDirty=!1,this._updateViewDependentParameters(),this._updateTilesVisibility(this.rootTiles)))}_updateClippingStatus(e){e.updateClippingStatus(this.extent)&&e.resetPendingUpdate(Me.GEOMETRY)&&this._updateTileGeometry(e)}_updateTilesVisibility(e){if(p(e))return;const t=Ve(e);let i=t?this._elevationBounds.min:1/0,r=t?this._elevationBounds.max:-1/0;const s=this.view.state.fixedContentCamera,a=this.extent,n=this._viewProjectionMatrix;this.setTileTreeDirty();const o=this._iteratorPool.acquire();for(o.reset(e);!o.done;){const e=o.next();e.updateClippingStatus(a)&&e.resetPendingUpdate(Me.GEOMETRY)&&this._updateTileGeometry(e),e.setPendingUpdate(Me.RENDERDATA);const t=e.computeVisibility();s||t?(e.updateScreenDepth(n),e.renderData&&(i=Math.min(e.elevationBounds[0],i),r=Math.max(e.elevationBounds[1],r))):o.skipSubtree()}o.remove(),this._viewChanged=!0,this._allTilesDirty=!0,isFinite(i)&&isFinite(r)&&(this._elevationBounds.min===i&&this._elevationBounds.max===r||(this._elevationBounds.min=i,this._elevationBounds.max=r,this.emit(\"elevation-bounds-change\",null)))}_updateViewDependentParameters(){const e=this.view.state.camera,t=this.view.state.contentCamera,i=Math.tan(.5*t.fovX),r=Math.tan(.5*t.fovY),s=this.tilingScheme.pixelSize,a=2**-this.lodBias*e.pixelRatio;this._splitLimits.aboveGround=e.aboveGround,this._splitLimits.fovX=i,this._splitLimits.fovY=r,this._splitLimits.relativeWidthLimit=s/e.width*this.maxTextureScale*a,this._splitLimits.relativeHeightLimit=s/e.height*this.maxTextureScale*a,this._splitLimits.maxLod=this.tilingScheme.getMaxLod(),this._splitLimits.angledSplitBias=this.view.qualitySettings.tiledSurface.angledSplitBias,this.view.state.fixedContentCamera?(p(this._splitLimits.frustum)&&(this._splitLimits.frustum=N()),k(this._splitLimits.frustum,t.frustum)):this._splitLimits.frustum=null,k(this._frustum,e.frustum),E(this._viewProjectionMatrix,t.projectionMatrix,t.viewMatrix),x(this._eyePosRenderSR,t.eye),R(e.eye,this.view.renderSpatialReference,this._eyePosSurfaceSR,this.spatialReference)}_updateRenderData(e){e.rendered&&!e.shouldLoad&&(Je(e)?(this._loadChildren(e),this.deferTileNeighborUpdate||(this._checkTileNeighborsWaterproofness(e),e.children.forEach((e=>e.checkGeometryWaterproofness())))):Ze(e)&&this._loadParent(e))}_updateTileGeometry(e){e.updateVisibility(),this._renderer.updateTileGeometry(e),this._updateTileNeighborsAfterGeometryChange(e),this._elevationUpdate(e),this._usedMemory=null,this.deferTileNeighborUpdate&&this.neighborTilesToUpdate.delete(e)}_updateTileNeighborsAfterGeometryChange(e,t){if(this.deferTileNeighborUpdate){const t=this.neighborTilesToUpdate;e.forEachLoadedNeighbor((e=>{t.add(e)}))}else e.updateNeighborsAfterGeometryChange(t)}_updateTileTexture(e,t){const i=e.resetPendingUpdate(Me.TEXTURE_FADING)?Me.TEXTURE_FADING:!!e.resetPendingUpdate(Me.TEXTURE_NOFADING)&&Me.TEXTURE_NOFADING;i&&(this._renderer.updateTileTexture(e,i),this._usedMemory=null,t.madeProgress())}_elevationUpdate(e){st.spatialReference=this.spatialReference,st.tile=e,st.extent=e.extent,this.emit(\"elevation-change\",st)}get running(){return this.updating&&this.ready&&!this.suspended}runTask(e){this._handleLayerViewChanges(e),this._frameTask.processQueue(e),this._inFrameTask=!0,this._pendingUpdates=0,this._hasPendingUpdates=!1,this._updateTileStatus(e),this._sortTiles(e);const t=!this.view.state.fixedContentCamera;this._mergeAndSplit(e,t),e.run((()=>this._updateElevation(e))),e.run((()=>this._updateTextures(e))),t||this._mergeAndSplit(e,!0),this._inFrameTask=!1,this._runViewChangeUpdateIfDirty(),e.done?this.requestUpdate():this._usedMemory=this._recalculateUsedMemory(),this.notifyChange(\"updatingProgressValue\")}_updateTileStatus(e){if(!this._viewChanged||!this.rootTiles||e.done)return;this._viewChanged=!1;const t=this._iteratorPool.acquire();for(t.reset(this.rootTiles);!t.done;){const e=t.next();if(e.loadable){const i=e.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.lodSnapping);if(i===Me.SPLIT){e.resetPendingUpdate(Me.MERGE),e.isLeaf&&(e.setPendingUpdate(Me.SPLIT),t.skipSubtree());continue}e.resetPendingUpdate(Me.SPLIT)&&e.updateAgentSuspension(),i===Me.VSPLITMERGE&&e.updateAgents(se.ELEVATION)}if(t.skipSubtree(),!e.isLeaf){e.setPendingUpdate(Me.MERGE),e.resetPendingUpdate(Me.SPLIT);const t=this._iteratorPool.acquire();t.resetOne(e);for(let e=t.next();!t.done;e=t.next())this._updateClippingStatus(e),e.updateVisibility(),e.loadable&&e.updateScreenDepth(this._viewProjectionMatrix);t.remove()}}t.remove(),this.requestUpdate(),e.madeProgress()}_sortTiles(e){e.done||this._allTilesSorted||(Oe(this._allTiles,this.view.pointsOfInterest.focus.renderLocation),this._allTilesSorted=!0,this._treeDebugger&&this._treeDebugger.update(),e.madeProgress())}_prepareBatchTileGeometryUpdate(){Te(0===this.neighborTilesToUpdate.size),this.deferTileNeighborUpdate=!0}_batchUpdateUpdatedTileNeighbors(){this.deferTileNeighborUpdate=!1;const e=this.neighborTilesToUpdate;(()=>{const t=()=>{for(const t of e)t.updateNeighborsWithChangedEdgeResolution()};(()=>{for(const t of e)t.updateNeighborDataAndGeometryIfNeeded()})(),t(),e.clear()})()}_mergeAndSplit(e,t){if(this.suspended||e.done||!this._allTilesDirty)return;this._allTilesDirty=!1,this.requestUpdate(),this._prepareBatchTileGeometryUpdate();let i=!1;for(;!e.done;){i=!0;let r=!1;const s=!this._allTiles.some((i=>{if(i.resetPendingUpdate(Me.MERGE)){if(!t)return i.setPendingUpdate(Me.MERGE),e.done;this._mergeTile(i),r=!0,e.madeProgress()}else i.resetPendingUpdate(Me.SPLIT)&&(this._splitTile(i),r=!0,e.madeProgress());return!e.done&&i.resetPendingUpdate(Me.RENDERDATA)&&(this._updateRenderData(i),e.madeProgress()),e.done}));if(r&&(this._allTilesSorted=!1,this._allTilesDirty=!0),s){if(!r)break;this._updateTilesVisibility(this.rootTiles)}else this._allTilesDirty=!0}i||(this._allTilesDirty=!0),this._batchUpdateUpdatedTileNeighbors(),this._sortTiles(e)}_updateElevation(e){return this._prepareBatchTileGeometryUpdate(),this._allTiles.some((t=>(t.resetPendingUpdate(Me.GEOMETRY)&&(this._updateTileGeometry(t),this._updateTileTexture(t,e),e.madeProgress()),e.done))),this._batchUpdateUpdatedTileNeighbors(),e.hasProgressed}_updateTextures(e){return this._allTiles.some((t=>(this._updateTileTexture(t,e),e.done))),e.hasProgressed}_updateClippingExtent(){this.spatialReference&&(this.updateTileOverlayParams(We.UPDATE),this.overlayManager.setPlacementDirty(),this._updateRootTiles())}get lodBias(){const e=this.view.resourceController.memoryController.memoryFactor;return this.view.qualitySettings.tiledSurface.lodBias-(1-e)*ce}_getLodBiasCorrectedScale(e){const t=this.tilingScheme.levels,i=l(e-this.lodBias,0,t.length-1),r=i-Math.floor(i);return t[Math.floor(i)].scale*(1-r)+t[Math.ceil(i)].scale*r}_removeAllTiles(){u(this.rootTiles)&&(this.rootTiles.forEach((e=>this._purgeTile(e,!1))),this._setRootTiles(null),this.notifyChange(\"ready\")),this._allTiles.clear(),this.visible=!1}_purgeDescendantTiles(e){if(e.isLeaf)return!1;let t=!1;for(let i=0;i<4;++i)t=this._purgeTile(e.children[i],!1)||t;return e.unsetChildren(),t}_purgeTile(e,t){const i=this._purgeDescendantTiles(e)||e.rendered;return this._allTiles.removeUnordered(e),this._unloadTile(e),t&&this._updateTileNeighborsAfterGeometryChange(e),this._tilePool.release(e),i}_unloadTile(e){this.deferTileNeighborUpdate&&this.neighborTilesToUpdate.delete(e),e.unload(this._renderer)}_splitTile(e){fe(e.isLeaf,\"tile that is already split should not be split again!\");const t=e.level+1,i=2*e.lij[1],r=2*e.lij[2];e.setChildren(this._createTile(t,i,r,e),this._createTile(t,i,r+1,e),this._createTile(t,i+1,r,e),this._createTile(t,i+1,r+1,e)),e.setPendingUpdate(Me.RENDERDATA),e.updateAgentSuspension(),this._allTiles.pushArray(e.children),this._allTilesDirty=!0,this._emitTileScaleChange(e,t),++this._performanceInfo.numSplit}_emitTileScaleChange(e,t=e.level){at.spatialReference=this.spatialReference,at.extent=e.extent,at.scale=this._getLodBiasCorrectedScale(t),this.emit(\"scale-change\",at)}_createTile(e,t,i,r){fe(!!r,\"_createTile sanity check\");const s=this._acquireTile(e,t,i,r);return s.updateClippingStatus(this.extent),s.loadable&&(s.updateScreenDepth(this._viewProjectionMatrix),s.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.lodSnapping)===Me.SPLIT&&s.setPendingUpdate(Me.SPLIT)),s}_mergeTile(e){fe(!e.hasPendingUpdate(Me.SPLIT),\"_mergeTile sanity check\"),this._purgeDescendantTiles(e)&&(fe(!e.renderData,\"_mergeTile sanity check\"),this._loadTile(e),this._updateTileNeighborsAfterGeometryChange(e),this.deferTileNeighborUpdate||this._checkTileAndNeighborsWaterproofness(e)),this._allTilesDirty=!0,++this._performanceInfo.numMerged,this._emitTileScaleChange(e)}_checkTileAndNeighborsWaterproofness(e){e.checkGeometryWaterproofness(),this._checkTileNeighborsWaterproofness(e)}_checkTileNeighborsWaterproofness(e){Ce&&e.forallNeighbors((e=>!!e.isLoaded&&(e.checkGeometryWaterproofness(),!0)))}_loadChildren(e){this.deferTileNeighborUpdate||this._checkTileAndNeighborsWaterproofness(e),fe(e.rendered,\"parent should be rendered\"),this._unloadTile(e);const t=e.children;t.forEach((e=>this._prepareToLoadTile(e))),t.forEach((e=>this._loadTilePrepared(e))),this._updateTileNeighborsAfterGeometryChange(e,e.level+1),this.deferTileNeighborUpdate||(t.forEach((e=>e.updateNeighborsWithChangedEdgeResolution())),t.forEach((e=>e.checkGeometryWaterproofness())),this._checkTileNeighborsWaterproofness(e))}_loadParent(e){this.deferTileNeighborUpdate||this._checkTileAndNeighborsWaterproofness(e);const t=e.parent;this._unloadChildren(t),this._loadTile(t),this._updateTileNeighborsAfterGeometryChange(t),this.deferTileNeighborUpdate||this._checkTileAndNeighborsWaterproofness(t)}_unloadChildren(e){if(!e.isLeaf)for(let t=0;t<4;++t){const i=e.children[t];this._unloadChildren(i),this._unloadTile(i)}}_postLoadTile(e){e.setPendingUpdate(Me.RENDERDATA),this.requestUpdate(),this._allTilesDirty=!0,this.overlayManager&&this.overlayManager.hasOverlays&&this.overlayManager.setTileParameters(e),this._elevationUpdate(e)}_loadTile(e){e.load(this._renderer),this._postLoadTile(e)}_loadTilePrepared(e){e.loadPrepared(this._renderer),this._postLoadTile(e)}_prepareToLoadTile(e){e.prepareToLoad(this._renderer)}_elevationDataArrived(e,t,i){const r=new ee(e.lij,e.extent,i);e.dataArrived(t,se.ELEVATION,r);const s=[e],a=e.level,n=this._iteratorPool.acquire();for(n.reset(s);!n.done;){const e=n.next();e.findElevationBoundsForLayer(t,a),e.computeElevationBounds()}n.remove(),this._updateTilesVisibility(s)}_handleLayerViewChanges(e=Qe){if(!this._layerViewsDirty)return;this._layerViewsDirty=!1;let t=!1;const i=new Set;let r=-1;for(const s of this.view.allLayerViews.items)if(i.add(s.uid),ye(s))if(this._basemapLayerViewHandles.has(s.uid)){const e=this._layerClassFromLayerView(s),i=this._getLayerIdxByUID(e,s.uid);u(i)&&((i<r||p(r))&&(t=!0),r=i)}else this._registerTiledLayerView(s),s.layer.loaded&&(t=!0);this._basemapLayerViewHandles.forEach(((e,r)=>{i.has(r)||(this._unregisterTiledLayerView(r),t=!0)})),t&&this._updateTiledLayers(),this._renderer.isTransparent=this._allSurfaceLayersTransparent(),this.hasCompositeBlendMode=this._hasCompositeBlendMode(),e.madeProgress()}_allSurfaceLayersTransparent(){let e=0===this.view.map?.ground?.opacity;for(const t of this.view.allLayerViews.items)if(ve(t)&&!W(t.layer)&&0!==t.fullOpacity)return e=!1,e;return e}_hasCompositeBlendMode(){for(const e of this.view.allLayerViews.items)if(we(e)){const t=Le(e.layer.parent)?\"normal\":e.layer.blendMode;if(qe(Ge[t]))return!0}return!1}_layerClassFromLayerView(e){return Se(e)?se.ELEVATION:se.MAP}_registerTiledLayerView(e){const t=[],i=this._layerClassFromLayerView(e);t.push(T((()=>e.suspended),(()=>this._updateTiledLayers()))),t.push(T((()=>e.fullOpacity),(()=>this._updateTileTextures(re.UNFADED)))),t.push(T((()=>\"effectiveScaleRange\"in e.layer?e.layer.effectiveScaleRange:null),(()=>this._restartAllAgents(i)))),we(e)&&t.push(T((()=>e.layer.blendMode),(()=>{this.hasCompositeBlendMode=this._hasCompositeBlendMode(),this._updateTileTextures(re.UNFADED)}))),e.on(\"data-changed\",(()=>{const t=this._getLayerIdxByUID(i,e.uid);u(t)&&this._invalidateLayerData(t,i)})),this._basemapLayerViewHandles.set(e.uid,t)}_unregisterTiledLayerView(e){const t=this._basemapLayerViewHandles.get(e);if(t){for(let e=0;e<t.length;e++)t[e].remove();this._basemapLayerViewHandles.delete(e)}}_updateTiledLayers(){if(!this.tilingScheme||this.view.suspended)return;const e=this.view.allLayerViews,t=[[],[]];let i=null;e.forEach((e=>{if(!e.layer||e.suspended||!ye(e)||!e.fullExtent)return;const r=this._layerClassFromLayerView(e);if(r===se.MAP){const t=e.displayLevelRange.maxLevel;t!==1/0&&(null===i||t>i)&&(i=t)}t[r].push(e)}));for(const r of ae){const e=this._layerViews[r],i=t[r];i.reverse();const s=i.length;let a=e.length!==s;const n=new Array(s),o=new Array(e.length);this._layerIndexByUid[r].clear();for(let t=0;t<s;t++){const s=i[t].uid;this._layerIndexByUid[r].set(s,t);const l=e.indexOf(i[t]);n[t]=l,t!==l&&(a=!0),l>-1&&(o[l]=t)}if(a){const e=this._postorderIterator;for(e.reset(this.rootTiles);!e.done;)e.next().modifyLayers(o,n,r);this._layerViews[r]=i,this._restartAllAgents(r),this._updateTilesVisibility(this.rootTiles)}}this.tilingScheme.ensureMaxLod(i)&&this._viewChangeUpdate()}_restartAllAgents(e){const t=this._postorderIterator;for(t.reset(this.rootTiles);!t.done;){const i=t.next();i.restartAgents(e),e===se.ELEVATION&&i.computeElevationBounds()}}layerViewByIndex(e,t){return this._layerViews[t][e]}numLayers(e){return this._layerViews[e].length}_updateTileTextures(e){this._allTiles.forAll((t=>{t.updateAgents(se.MAP),e===re.IMMEDIATE?this.renderer.updateTileTexture(t,Me.TEXTURE_NOFADING):t.updateRenderData(se.MAP,e)})),this._renderer.isTransparent=this._allSurfaceLayersTransparent()}_invalidateLayerData(e,t){this._allTiles.forAll((i=>i.removeLayerAgent(e,t))),this._allTiles.forAll((i=>i.invalidateLayerData(e,t)))}setTileTreeDirty(){this._allTilesDirty=!0}requestRender(e=We.UPDATE){this.renderer.setNeedsRender(e)}requestUpdate(){1==++this._pendingUpdates&&(this._hasPendingUpdates=!0)}requestTileData(e,t,i,r){const s=this.layerViewByIndex(t,i),a=s.layer;return!a.tilemapCache||be(s)?this._requestTileData(e,i,s,r):(++this._asyncWorkItems,a.tilemapCache.fetchAvailability(e.lij[0],e.lij[1],e.lij[2],{...r,timeout:6e3}).then((()=>--this._asyncWorkItems)).catch((t=>{throw--this._asyncWorkItems,g(t)||this._dataMissing(e,i,s,{notInTilemap:!0}),t})).then((()=>this._frameTask.schedule((()=>this._requestTileData(e,i,s,r)),r.signal))))}_requestTileData(e,t,i,r){return t===se.ELEVATION?Se(i)?this._requestElevationTileData(e,i,r):Promise.reject():ve(i)?this._requestMapTileData(e,i,r):Promise.reject()}_requestElevationTileData(e,t,i){++this._asyncWorkItems;const r=r=>{if(m(i))return;const s=this._layerIndexByUid[se.ELEVATION].get(t.uid);null!=s?(this._usedMemory=null,this.requestUpdate(),this._elevationDataArrived(e,s,r)):Xe.warn(\"TerrainSurface: received data from unknown layer %d %s\",se.ELEVATION,e.lij.toString())},s=i=>{g(i)||(this._dataMissing(e,se.ELEVATION,t,i),this.requestUpdate())};if(Ee(t.layer))return t.layer.fetchTile(e.lij[0],e.lij[1],e.lij[2],{noDataValue:_e,signal:i.signal}).then((e=>{if(!m(i))return this._frameTask.schedule((()=>r(e)),i.signal,s);Xe.warnOnce(\"A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.\")}),s).finally((()=>{--this._asyncWorkItems}));const a=t.getTileUrl(e.lij[0],e.lij[1],e.lij[2]);return this._elevationDataRequester.request(a,\"binary\",i).then((e=>this._lercDecoder.decode(e,{noDataValue:_e},i.signal))).then((e=>{e?r({values:e.pixelData,width:e.width,height:e.height,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue}):s(new Error(\"LERC decoding failed\"))}),s).finally((()=>{--this._asyncWorkItems}))}_requestMapTileData(e,t,i){++this._asyncWorkItems;const r=(r,s)=>{--this._asyncWorkItems,Ue(s),m(i)||(this._dataMissing(e,se.MAP,t,r),this.requestUpdate())},s=e=>t=>r(t,e),a=r=>this._frameTask.schedule((()=>{--this._asyncWorkItems,this.requestUpdate(),m(i)?Ue(r):this._mapTileDataArrived(e,t,r)}),i.signal,s(r)).catch(s(r)),n=(e,t=null)=>this._frameTask.schedule((()=>r(e,t)));if(be(t)){const r=t.schemaHelper.getLevelRowColumn(e.lij);return t.fetchTile(r[0],r[1],r[2],i).then(a,n)}if(De(t))return t.fetchTile(e.lij[0],e.lij[1],e.lij[2],i).then(a,n);if(xe(t)&&Ee(t.layer))return t.layer.fetchTile(e.lij[0],e.lij[1],e.lij[2],i).then((e=>{if(m(i))return Xe.warnOnce(\"A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.\"),void n(f());a(e)}),n);let o=t.getTileUrl(e.lij[0],e.lij[1],e.lij[2]);q(t.layer)&&t.layer.refreshTimestamp&&(o+=`${o.includes(\"?\")?\"&\":\"?\"}_ts=${t.layer.refreshTimestamp}`);const l=t.hasMixedImageFormats?\"image+type\":\"image\";return this._mapDataRequester.request(o,l,i).then(a,n)}_mapTileDataArrived(e,t,i){const r=this._getLayerIdxByUID(se.MAP,t.uid);u(r)?e.dataArrived(r,se.MAP,i):(Ue(i),Xe.warn(\"TerrainSurface: received data from unknown layer\"))}_getLayerIdxByUID(e,t){return this._layerIndexByUid[e].get(t)}_dataMissing(e,t,i,r){const s=this._getLayerIdxByUID(t,i.uid);u(s)?e.dataMissing(s,t,r):Xe.warn(\"TerrainSurface: received data from unknown layer\")}updateTileOverlayParams(e){this.rootTiles&&this.overlayManager&&(this._allTiles.forAll((e=>{e.renderData&&this.overlayManager.setTileParameters(e)})),this._renderer.setNeedsRender(e))}get performanceInfo(){const e=this._performanceInfo;return e.numNodes=this._allTiles.length,e.numLeaves=e.numVisible=e.numRendered=e.numLoadedPerLevel.length=e.numRenderedPerLevel.length=0,this._allTiles.forAll((t=>{t.isLeaf&&e.numLeaves++;const i=t.level;t.renderData&&(e.numLoadedPerLevel[i]=(e.numLoadedPerLevel[i]||0)+1),t.visible&&(e.numVisible++,t.rendered&&(e.numRenderedPerLevel[i]=(e.numRenderedPerLevel[i]||0)+1,e.numRendered++))})),e}getUsedMemory(){return this.tilingScheme?(p(this._usedMemory)&&(this._usedMemory=this._recalculateUsedMemory()),u(this._usedMemory)?this._usedMemory:0):0}_recalculateUsedMemory(){return this.tilingScheme?this._allTiles.reduce(((e,t)=>e+t.usedMemory),0):null}getUsedMemoryForLayerView(e){let t=0;const i=this._layerClassFromLayerView(e),r=this._getLayerIdxByUID(i,e.uid);return u(r)&&this._allTiles.forAll((e=>t+=e.getUsedMemoryForLayer(i,r))),t}getTile(e){if(p(e)||p(this.rootTiles))return null;const t=e.split(\"/\").map((e=>+e));if(0===t[0])return this.rootTiles.find((e=>e.lij[1]===t[1]&&e.lij[2]===t[2]));const i=2**t[0],r=Math.floor(t[1]/i),s=Math.floor(t[2]/i);let a;if(this.rootTiles.some((e=>e.lij[1]===r&&e.lij[2]===s&&(a=e,!0))),a){let e=1<<t[0]-1;for(;a.lij[0]<t[0];){let i=t[1]&e?2:0;if((t[2]&e)>0&&i++,!a.children[i])return null;a=a.children[i],e>>=1}return fe(a.lij[0]===t[0]&&a.lij[1]===t[1]&&a.lij[2]===t[2],\"not the right tile?\"),a}return null}get test(){const e=this;return{renderer:e._renderer,lercDecoder:e._lercDecoder,forceReload:()=>{u(e.rootTiles)&&(e._mergeTile(e.rootTiles[0]),e._viewChangeUpdate())},getTiles:()=>e._allTiles.toArray(),getRenderedTiles(){rt.clear(),e._allTiles.forAll((e=>{e.visible&&e.rendered&&rt.push(e)}));const t=rt.toArray();return Ne(e.renderOrder,t),t},lockTilingScheme(t,i){e._extentHelper.defaultTiledLayersExtent=i,e.tilingSchemeLogic.test.lockTilingScheme(t)}}}checkAllTileWaterproofness(){if(!Ce)return;const e=this.rootTiles;if(p(e))return;const t=e=>e?.renderData?.geometryInfo?.indices?.length>0??!1,i=(e,i)=>{t(e)&&console.error(\"Tile[\",e.lij,\"] has geometry although parent[\",i.lij,\"] has geom\")},r=e=>{if(e.renderData&&!e.renderData.geometryState&&console.error(\"Tile[\",e.lij,\"] has renderData but not geometryState\"),e.renderData&&!e.renderData.geometryInfo&&console.error(\"Tile[\",e.lij,\"] has renderData but not geometryInfo\"),!e.renderData?.geometryInfo||(e.renderData.geometryInfo.indices?.length??0)>0||console.error(\"Tile[\",e.lij,\"] has renderData but no indices - geometryInfo: \",e.renderData.geometryInfo),t(e)){e.checkGeometryWaterproofness();for(const t of e.children)i(t,e)}else if(e.isLeaf)console.error(\"Tile[\",e.lij,\"] has no geometry and no children, from root to leaf\");else for(const t of e.children)r(t)},s=e=>{const t=e.parent?.visible??!0,i=e.visible;e.computeVisibility();const r=e.visible;if(i!==r&&t&&console.error(\" Tile[\",e.lij,\"] has out of date visibility: \",i,\" instead of \",r),!e.isLeaf)for(const a of e.children)s(a)};for(const a of e)r(a),s(a)}get isGlobal(){return this._isGlobal}get shadingEnabled(){return this._renderer.shadingEnabled}get isWebMercator(){return!!this.tilingScheme?.spatialReference.isWebMercator}get isWebMercatorOnPlateeCarree(){return this.isWebMercator&&B(this.view?.renderSpatialReference)}isEastEndWrap(e){return this.isGlobal&&e[2]===this.lijEastEnd(e[0])-1}isWestEndWrap(e){return this.isGlobal&&0===e[2]}lijEastEnd(e){return 2**(e+(this.spatialReference.isGeographic?1:0))}wrapEastWest(e){const t=this.lijEastEnd(e[0]),i=e[2];if(0<=i&&i<t)return e;if(!this.isGlobal)return null;const r=(i+(i<0?t:0))%t;return[e[0],e[1],r]}};e([S()],Ye.prototype,\"_renderer\",void 0),e([S()],Ye.prototype,\"_hasPendingUpdates\",void 0),e([S()],Ye.prototype,\"_asyncWorkItems\",void 0),e([S()],Ye.prototype,\"_allTilesDirty\",void 0),e([S()],Ye.prototype,\"_allTilesSorted\",void 0),e([S()],Ye.prototype,\"_viewChanged\",void 0),e([S({readOnly:!0})],Ye.prototype,\"_watchUpdatingTracking\",void 0),e([S()],Ye.prototype,\"_frameTask\",void 0),e([S({readOnly:!0})],Ye.prototype,\"snapLevel\",null),e([S({readOnly:!0})],Ye.prototype,\"lodSnapping\",null),e([S({constructOnly:!0})],Ye.prototype,\"view\",void 0),e([S()],Ye.prototype,\"_userClippingExtent\",null),e([S()],Ye.prototype,\"_rootTilesExtent\",void 0),e([S({readOnly:!0})],Ye.prototype,\"extent\",null),e([S({readOnly:!0})],Ye.prototype,\"groundExtent\",null),e([S({readOnly:!0})],Ye.prototype,\"_tilingSchemeExtent\",null),e([S({readOnly:!0})],Ye.prototype,\"updating\",null),e([S(K)],Ye.prototype,\"updatingProgress\",void 0),e([S({readOnly:!0})],Ye.prototype,\"updatingProgressValue\",null),e([S()],Ye.prototype,\"_maxNumUpdating\",void 0),e([S({aliasOf:\"view.map.ground.opacity\"})],Ye.prototype,\"baseOpacity\",void 0),e([S()],Ye.prototype,\"hasCompositeBlendMode\",void 0),e([S({readOnly:!0})],Ye.prototype,\"overlayManager\",void 0),e([S({readOnly:!0})],Ye.prototype,\"viewingMode\",null),e([S()],Ye.prototype,\"maxTextureScale\",void 0),e([S({readOnly:!0})],Ye.prototype,\"ready\",null),e([S({value:le.FRONT_TO_BACK})],Ye.prototype,\"renderOrder\",null),e([S({readOnly:!0})],Ye.prototype,\"rootTiles\",void 0),e([S({readOnly:!0})],Ye.prototype,\"spatialReference\",null),e([S({type:t,aliasOf:\"view.map.ground.surfaceColor\"})],Ye.prototype,\"backgroundColor\",void 0),e([S({value:!1})],Ye.prototype,\"slicePlaneEnabled\",null),e([S({readOnly:!0})],Ye.prototype,\"tilingScheme\",void 0),e([S({readOnly:!0,aliasOf:\"tilingSchemeLogic.tilingSchemeLocked\"})],Ye.prototype,\"tilingSchemeLocked\",void 0),e([S({readOnly:!0})],Ye.prototype,\"tilingSchemeLogic\",void 0),e([S({value:!0})],Ye.prototype,\"velvetOverground\",null),e([L(\"_renderer.wireframe\")],Ye.prototype,\"wireframe\",void 0),e([S({value:!1})],Ye.prototype,\"suspended\",null),e([S({readOnly:!0,aliasOf:\"view.qualitySettings.tiledSurface.textureFadeDuration\"})],Ye.prototype,\"textureFadeDuration\",void 0),e([S()],Ye.prototype,\"_layerViewsDirty\",void 0),e([L(\"_renderer.renderPatchBorders\")],Ye.prototype,\"renderPatchBorders\",void 0),e([L(\"_renderer.renderingDisabled\")],Ye.prototype,\"renderingDisabled\",void 0),Ye=e([b(\"esri.views.3d.terrain.TerrainSurface\")],Ye);const $e=Ye;function Ke(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Je(e){return!e.isLeaf&&(e.children.some((e=>e.shouldLoad))||e.children.some((e=>Je(e))))}function Ze(e){return e.isLeaf&&e.parent&&e.parent.shouldLoad}const et=C(),tt=A(),it=[0,0,0],rt=new _,st={spatialReference:null,tile:null,extent:null,context:\"ground\"},at={spatialReference:null,extent:null,scale:0};export{$e as default};\n"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,8BAAlB;AAAiD,OAAOC,CAAP,MAAa,mBAAb;AAAiC,OAAOC,CAAP,MAAa,2BAAb;AAAyC,SAAOC,UAAU,IAAIC,CAArB,QAA2B,6BAA3B;AAAyD,OAAOC,CAAP,MAAa,sCAAb;AAAoD,OAAOC,CAAP,MAAa,0BAAb;AAAwC,OAAOC,CAAP,MAAa,0BAAb;AAAwC,OAAOC,CAAP,MAAa,yBAAb;AAAuC,SAAOC,KAAK,IAAIC,CAAhB,QAAsB,4BAAtB;AAAmD,SAAOC,YAAY,IAAIC,CAAvB,EAAyBC,YAAY,IAAIC,CAAzC,EAA2CC,MAAM,IAAIC,CAArD,EAAuDC,MAAM,IAAIC,CAAjE,QAAuE,wBAAvE;AAAgG,OAAOC,CAAP,MAAa,6BAAb;AAA2C,OAAOpB,CAAP,MAAa,8BAAb;AAA4C,SAAOqB,YAAY,IAAIC,CAAvB,EAAyBC,SAAS,IAAIC,CAAtC,EAAwCC,gBAAgB,IAAIC,CAA5D,QAAkE,+BAAlE;AAAkG,SAAOC,KAAK,IAAIC,CAAhB,EAAkBC,cAAc,IAAIC,CAApC,EAAsCC,IAAI,IAAIC,CAA9C,EAAgDC,OAAO,IAAIC,CAA3D,QAAiE,gCAAjE;AAAkG,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,qDAAxB;AAA8E,OAAM,sBAAN;AAA6B,OAAM,6CAAN;AAAoD,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,sDAAzB;AAAgF,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,sDAAzB;AAAgF,SAAOhB,CAAC,IAAIiB,CAAZ,QAAkB,yBAAlB;AAA4C,SAAOrB,CAAC,IAAIsB,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOtB,CAAC,IAAIuB,CAAZ,QAAkB,yBAAlB;AAA4C,SAAOvB,CAAC,IAAIwB,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOxB,CAAC,IAAIyB,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,gDAAtC;AAAuF,SAAOC,qBAAqB,IAAIC,CAAhC,EAAkCC,oBAAoB,IAAIC,CAA1D,QAAgE,iCAAhE;AAAkG,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,0CAAtC;AAAiF,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,EAA+BC,YAAY,IAAIC,CAA/C,EAAiDC,gBAAgB,IAAIC,CAArE,QAA2E,6CAA3E;AAAyH,SAAOP,MAAM,IAAIQ,CAAjB,EAAmBC,IAAI,IAAIC,CAA3B,QAAiC,sCAAjC;AAAwE,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,oDAA9B;AAAmF,SAAOC,kBAAkB,IAAIC,CAA7B,QAAmC,4CAAnC;AAAgF,SAAOC,uBAAuB,IAAIC,CAAlC,QAAwC,oDAAxC;AAA6F,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,uCAA5B;AAAoE,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,wCAA/B;AAAwE,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,2CAAjC;AAA6E,SAAOC,sBAAsB,IAAIC,CAAjC,EAAmCC,WAAW,IAAIC,CAAlD,QAAwD,2BAAxD;AAAoF,OAAOC,CAAP,MAAa,0BAAb;AAAwC,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,2BAA/B;AAA2D,SAAOC,UAAU,IAAIC,CAArB,QAA2B,qBAA3B;AAAiD,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,kCAAjC;AAAoE,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,sBAAhC;AAAuD,SAAOC,eAAe,IAAIC,CAA1B,EAA4BC,aAAa,IAAIC,EAA7C,QAAoD,oBAApD;AAAyE,SAAOvC,MAAM,IAAIwC,EAAjB,QAAwB,mBAAxB;AAA4C,SAAOC,WAAW,IAAIC,EAAtB,EAAyBC,aAAa,IAAIC,EAA1C,QAAiD,iBAAjD;AAAmE,SAAOC,UAAU,IAAIC,EAArB,EAAwBC,YAAY,IAAIC,EAAxC,QAA+C,iBAA/C;AAAiE,SAAOC,cAAc,IAAIC,EAAzB,QAAgC,qBAAhC;AAAsD,SAAOC,WAAW,IAAIC,EAAtB,QAA6B,kBAA7B;AAAgD,SAAOC,WAAW,IAAIC,EAAtB,QAA6B,kBAA7B;AAAgD,SAAOC,cAAc,IAAIC,EAAzB,QAAgC,qBAAhC;AAAsD,SAAOC,cAAc,IAAIC,EAAzB,EAA4BC,sCAAsC,IAAIC,EAAtE,EAAyEC,mCAAmC,IAAIC,EAAhH,EAAmHC,mBAAmB,IAAIC,EAA1I,EAA6IC,sBAAsB,IAAIC,EAAvK,QAA8K,mBAA9K;AAAkM,OAAOC,EAAP,MAAc,sBAAd;AAAqC,OAAOC,EAAP,MAAc,oCAAd;AAAmD,SAAOC,UAAU,IAAIC,EAArB,EAAwBC,cAAc,IAAIC,EAA1C,EAA6CC,kBAAkB,IAAIC,EAAnE,EAAsEC,kBAAkB,IAAIC,EAA5F,EAA+FC,oBAAoB,IAAIC,EAAvH,EAA0HC,YAAY,IAAIC,EAA1I,EAA6IC,oBAAoB,IAAIC,EAArK,EAAwKC,qBAAqB,IAAIC,EAAjM,EAAoMC,oBAAoB,IAAIC,EAA5N,EAA+NC,sBAAsB,IAAIC,EAAzP,EAA4PC,eAAe,IAAIC,EAA/Q,EAAkRC,eAAe,IAAIC,EAArS,EAAwSC,2BAA2B,IAAIC,EAAvU,QAA8U,mBAA9U;AAAkW,SAAOC,WAAW,IAAIC,EAAtB,EAAyBC,IAAI,IAAIC,EAAjC,QAAwC,WAAxC;AAAoD,SAAO7E,gBAAgB,IAAI8E,EAA3B,QAAkC,uBAAlC;AAA0D,SAAOC,UAAU,IAAIC,EAArB,QAA4B,iBAA5B;AAA8C,SAAOC,gBAAgB,IAAIC,EAA3B,EAA8BC,iBAAiB,IAAIC,EAAnD,EAAsDC,mBAAmB,IAAIC,EAA7E,EAAgFC,cAAc,IAAIC,EAAlG,EAAqGC,SAAS,IAAIC,EAAlH,QAAyH,gBAAzH;AAA0I,SAAOC,iBAAiB,IAAIC,EAA5B,QAAmC,wBAAnC;AAA4D,SAAOC,YAAY,IAAIC,EAAvB,QAA8B,mBAA9B;AAAkD,SAAOC,oBAAoB,IAAIC,EAA/B,EAAkCC,mBAAmB,IAAIC,EAAzD,QAAgE,2DAAhE;AAA4H,SAAOC,iBAAiB,IAAIC,EAA5B,QAAmC,wCAAnC;AAA4E,SAAOC,aAAa,IAAIC,EAAxB,EAA2BC,YAAY,IAAIC,EAA3C,EAA8CC,QAAQ,IAAIC,EAA1D,QAAiE,4BAAjE;AAA8F,MAAMC,EAAE,GAAC7K,CAAC,CAAC8K,SAAF,CAAY,sCAAZ,CAAT;AAAA,MAA6DC,EAAE,GAAC,GAAhE;AAAoE,IAAIC,EAAE,GAAC,cAAclL,CAAC,CAACmL,YAAF,CAAevL,CAAf,CAAd,CAAgC;EAACwL,WAAW,CAAC1L,CAAD,EAAG;IAAC,MAAMA,CAAN,GAAS,KAAK2L,gBAAL,GAAsB,IAAInG,CAAJ,EAA/B,EAAqC,KAAKoG,aAAL,GAAmB,IAAIzK,CAAJ,CAAMyI,EAAN,EAAU5J,CAAC,IAAEA,CAAC,CAAC6L,MAAF,GAAS,MAAI,KAAKD,aAAL,CAAmBE,OAAnB,CAA2B9L,CAA3B,CAA1B,CAAxD,EAAkH,KAAK+L,kBAAL,GAAwB,IAAIjC,EAAJ,EAA1I,EAAiJ,KAAKkC,kBAAL,GAAwB,CAAC,CAA1K,EAA4K,KAAKC,eAAL,GAAqB,CAAjM,EAAmM,KAAKC,eAAL,GAAqB,CAAxN,EAA0N,KAAKC,cAAL,GAAoB,CAAC,CAA/O,EAAiP,KAAKC,eAAL,GAAqB,CAAC,CAAvQ,EAAyQ,KAAKC,QAAL,GAAc,CAAC,CAAxR,EAA0R,KAAKC,WAAL,GAAiB,IAA3S,EAAgT,KAAKC,gBAAL,GAAsB,IAAI9E,EAAJ,EAAtU,EAA6U,KAAK+E,YAAL,GAAkB,CAAC,CAAhW,EAAkW,KAAKC,YAAL,GAAkB,CAAC,CAArX,EAAuX,KAAKC,sBAAL,GAA4B,CAAC,CAApZ,EAAsZ,KAAKC,eAAL,GAAqBhK,CAAC,EAA5a,EAA+a,KAAKiK,gBAAL,GAAsBjK,CAAC,EAAtc,EAAyc,KAAKkK,YAAL,GAAkB,IAAIxD,EAAJ,EAA3d,EAAke,KAAKyD,UAAL,GAAgB,IAAE,CAApf,EAAsf,KAAKC,QAAL,GAAclJ,CAAC,EAArgB,EAAwgB,KAAKmJ,qBAAL,GAA2BvK,CAAC,EAApiB,EAAuiB,KAAKwK,WAAL,GAAiB,CAAC,IAAIC,KAAJ,EAAD,EAAW,IAAIA,KAAJ,EAAX,CAAxjB,EAA8kB,KAAKC,gBAAL,GAAsB,CAAC,IAAIC,GAAJ,EAAD,EAAS,IAAIA,GAAJ,EAAT,CAApmB,EAAsnB,KAAKC,wBAAL,GAA8B,IAAID,GAAJ,EAAppB,EAA4pB,KAAKE,QAAL,GAAc,IAAI/M,CAAJ,EAA1qB,EAAgrB,KAAKgN,sBAAL,GAA4B,IAAIzK,CAAJ,EAA5sB,EAAktB,KAAK0K,UAAL,GAAgBxC,EAAluB,EAAquB,KAAKyC,SAAL,GAAe,IAAI1N,CAAJ,EAApvB,EAA0vB,KAAK2N,iBAAL,GAAuB,IAAIvM,CAAJ,CAAMqJ,EAAN,CAAjxB,EAA2xB,KAAKmD,gBAAL,GAAsBrK,CAAC,EAAlzB,EAAqzB,KAAKsK,eAAL,GAAqB,CAA10B,EAA40B,KAAKC,eAAL,GAAqB,GAAj2B,EAAq2B,KAAKC,eAAL,GAAqB,IAA13B,EAA+3B,KAAKC,kBAAL,GAAwB,CAAC,CAAx5B,EAA05B,KAAKC,uBAAL,GAA6B,CAAC,CAAx7B,EAA07B,KAAKC,qBAAL,GAA2B,IAAIC,GAAJ,EAAr9B,EAA69B,KAAKC,oBAAL,GAA0B,CAAv/B,EAAy/B,KAAKC,gBAAL,GAAsB,CAA/gC,EAAihC,KAAKC,gBAAL,GAAsB,CAAC,CAAxiC,EAA0iC,KAAKC,SAAL,GAAe,CAACtO,CAAC,CAACuO,IAAF,EAAQC,KAAR,EAAeC,OAAzkC;EAAilC;;EAAAC,UAAU,GAAE;IAAC,KAAKC,YAAL,GAAkBlK,CAAC,CAAC,KAAK8J,IAAL,CAAUK,kBAAX,CAAnB,EAAkD,KAAKC,SAAL,GAAe,KAAKN,IAAL,CAAUC,KAAV,CAAgBC,OAAhB,GAAwB,IAAItN,CAAJ,CAAMsF,EAAN,CAAxB,GAAkC,IAAItF,CAAJ,CAAM0F,EAAN,CAAnG;IAA6G,MAAM7G,CAAC,GAAC,KAAKuO,IAAL,CAAUK,kBAAV,CAA6BE,gBAArC;IAAsD,KAAKC,iBAAL,GAAuB/O,CAAC,CAACgP,QAAF,CAAW,gCAAX,EAA6ChP,CAAC,IAAEA,CAAC,CAACiP,aAAF,EAAhD,CAAvB,EAA2F,KAAKC,oBAAL,GAA0B,IAAI7K,CAAJ,CAAMrE,CAAC,CAACgP,QAAF,CAAW,iBAAX,CAAN,CAArH,EAA0J,KAAKG,IAAL,CAAU,gBAAV,EAA2B,IAAI5I,EAAJ,CAAO;MAAC6I,OAAO,EAAC;IAAT,CAAP,CAA3B,CAA1J,EAA6M,KAAK9B,QAAL,CAAc+B,GAAd,CAAkB,CAAC1N,CAAC,CAAE,MAAI,KAAK2N,cAAL,CAAoBC,aAA1B,EAA0CvP,CAAC,IAAE,KAAKwP,SAAL,CAAeC,iBAAf,CAAiCzP,CAAjC,CAA7C,CAAF,EAAqF2B,CAAC,CAAE,MAAI,KAAK2N,cAAL,CAAoBI,eAA1B,EAA4C1P,CAAC,IAAE,KAAKwP,SAAL,CAAeG,wBAAf,CAAwC3P,CAAxC,CAA/C,CAAtF,CAAlB,EAAqM,gBAArM,CAA7M,EAAoa,KAAKwP,SAAL,GAAe,IAAIhI,EAAJ,CAAO;MAACoI,eAAe,EAAC,KAAKN,cAAL,CAAoBO,QAArC;MAA8CC,eAAe,EAAC1M,CAAC,CAAC,KAAKmL,IAAL,CAAUwB,gBAAX,CAAD,CAA8BC,MAA5F;MAAmGC,KAAK,EAAC,KAAK1B,IAAL,CAAU2B,MAAnH;MAA0HC,QAAQ,EAAC,KAAK1C;IAAxI,CAAP,CAAnb,EAA8kB,KAAKH,QAAL,CAAc+B,GAAd,CAAkB,CAAC1N,CAAC,CAAE,MAAI,KAAKyO,WAAX,EAAyBpQ,CAAC,IAAE;MAAC,KAAKqQ,uBAAL,IAA+B,KAAKC,kBAAL,CAAwBtQ,CAAxB,CAA/B;IAA0D,CAAvF,EAAyF6B,CAAzF,CAAF,EAA8FF,CAAC,CAAE,MAAI,KAAK4O,qBAAX,EAAmC,MAAI;MAAC,KAAKD,kBAAL,CAAwB,KAAKF,WAA7B;IAA0C,CAAlF,EAAoFvO,CAApF,CAA/F,EAAsLF,CAAC,CAAE,MAAI,KAAK6O,iBAAX,EAA+B,MAAI,KAAKC,yBAAL,EAAnC,EAAqE1O,CAArE,CAAvL,EAA+PJ,CAAC,CAAE,MAAI,KAAKmM,eAAX,EAA6B9N,CAAC,IAAE;MAAC,KAAKqQ,uBAAL,IAA+B,KAAKb,SAAL,CAAekB,oBAAf,CAAoC1Q,CAApC,CAA/B;IAAsE,CAAvG,EAAyG6B,CAAzG,CAAhQ,EAA4WF,CAAC,CAAE,MAAI,KAAK4M,IAAL,CAAUoC,gBAAhB,EAAmC3Q,CAAC,IAAE;MAAC,KAAKwP,SAAL,CAAemB,gBAAf,GAAgC3Q,CAAhC,EAAkC,KAAKuN,sBAAL,CAA4BqD,SAA5B,EAAlC,EAA0E5Q,CAAC,IAAE,KAAKuN,sBAAL,CAA4B8B,GAA5B,CAAiC,MAAIrP,CAAC,CAAC6Q,KAAF,CAAQC,cAA7C,EAA8D,MAAI,MAAI,KAAK1E,eAAL,GAAqB,CAAC,CAA5F,CAA7E;IAA6K,CAApN,CAA7W,EAAokBzK,CAAC,CAAE,MAAIqD,CAAC,CAAC+L,4BAAR,EAAuC/Q,CAAC,IAAE;MAACA,CAAC,IAAE,CAAC,KAAKgR,aAAT,GAAuB,OAAO,gDAAP,EAAyDC,IAAzD,CAA+D,CAAC;QAACC,yBAAyB,EAAClR;MAA3B,CAAD,KAAiC;QAAC,CAAC,KAAKgR,aAAN,IAAqBhM,CAAC,CAAC+L,4BAAvB,KAAsD,KAAKC,aAAL,GAAmB,IAAIhR,CAAJ,CAAM;UAACuO,IAAI,EAAC,KAAKA;QAAX,CAAN,CAAzE;MAAkG,CAAnM,CAAvB,GAA6NvO,CAAC,KAAG,KAAKgR,aAAL,GAAmBlQ,CAAC,CAAC,KAAKkQ,aAAN,CAAvB,CAA9N;IAA2Q,CAAtT,EAAwT/O,CAAxT,CAArkB,CAAlB,CAA9kB,EAAk+C,KAAKkP,aAAL,GAAmBtL,EAAE,CAAC,KAAKuL,WAAN,EAAkB;MAACC,MAAM,EAAC,KAAK9C,IAAL,CAAU+C,GAAV,CAAcC,SAAtB;MAAgCC,UAAU,EAAC,KAAKjD,IAAL,CAAUkD,aAArD;MAAmEC,oBAAoB,EAAC,KAAKnD,IAAL,CAAUwB;IAAlG,CAAlB,CAAv/C;IAA8nD,MAAM9P,CAAC,GAAC,KAAKsO,IAAL,CAAUoD,eAAV,GAA0B,IAAItR,CAAJ,CAAM;MAACuR,cAAc,EAAC,MAAI,KAAKrD,IAAL,EAAWoD,eAAX,EAA4BE,cAA5B,EAA4CP,GAA5C,CAAiD,CAAC;QAACD,MAAM,EAACrR;MAAR,CAAD,KAAcA,CAA/D,CAApB;MAAuF8R,mBAAmB,EAAC9R,CAAC,IAAEA,CAAC,IAAE,YAAWA,CAAd,GAAgBA,CAAC,CAACqR,MAAlB,GAAyB;IAAvI,CAAN,CAA1B,GAA8K,KAAK9C,IAAL,CAAU+C,GAAV,CAAcC,SAApM;IAAA,MAA8MrR,CAAC,GAAC,IAAIoK,EAAJ,CAAO;MAAC+G,MAAM,EAACpR,CAAR;MAAU8R,YAAY,EAAC,KAAKZ,aAA5B;MAA0CC,WAAW,EAAC,KAAKA,WAA3D;MAAuEM,oBAAoB,EAAC,KAAKnD,IAAL,CAAUwB;IAAtG,CAAP,CAAhN;IAAgV,KAAKZ,IAAL,CAAU,mBAAV,EAA8BjP,CAA9B,GAAiC,KAAK8R,mBAAL,EAAjC,EAA4D,KAAKC,uBAAL,GAA6B,KAAK1D,IAAL,CAAUK,kBAAV,CAA6BsD,yBAA7B,CAAuD9M,CAAC,CAAC+M,SAAzD,CAAzF,EAA6J,KAAKC,iBAAL,GAAuB,KAAK7D,IAAL,CAAUK,kBAAV,CAA6BsD,yBAA7B,CAAuD9M,CAAC,CAACiN,OAAzD,CAApL;IAAsP,MAAMjS,CAAC,GAAC,KAAKmO,IAAL,CAAUK,kBAAV,CAA6B0D,SAArC;IAA+C,KAAK9E,UAAL,GAAgBpN,CAAC,CAACmS,YAAF,CAAerH,EAAE,CAACsH,eAAlB,EAAkC,IAAlC,CAAhB,EAAwD,KAAKlF,QAAL,CAAc+B,GAAd,CAAkB,CAAC1N,CAAC,CAAE,MAAI,KAAKwP,aAAL,CAAmBsB,qBAAzB,EAAiDzS,CAAC,IAAE,KAAKwP,SAAL,CAAekD,6BAAf,CAA6C1S,CAA7C,CAApD,EAAqGiC,CAArG,CAAF,EAA0GN,CAAC,CAAE,MAAI,KAAKgR,iBAAL,CAAuBC,YAA7B,EAA4C,MAAI,KAAKZ,mBAAL,EAAhD,EAA4EjQ,CAA5E,CAA3G,EAA0LJ,CAAC,CAAE,MAAI,KAAKkR,MAAX,EAAoB,MAAI,KAAKC,gBAAL,EAAxB,EAAiD7Q,CAAjD,CAA3L,EAA+O,KAAKsM,IAAL,CAAUwE,EAAV,CAAa,QAAb,EAAuB,MAAI,KAAKC,iBAAL,EAA3B,CAA/O,EAAqSrR,CAAC,CAAE,MAAI;MAAC,MAAM3B,CAAC,GAAC,KAAKuO,IAAb;MAAA,MAAkBtO,CAAC,GAACD,CAAC,CAACwO,KAAtB;MAA4B,OAAM,CAAC,KAAKyE,OAAN,EAAc,KAAKC,WAAnB,EAA+BlT,CAAC,CAAC4O,kBAAF,EAAsBE,gBAAtB,EAAwCqE,YAAvE,EAAoFlT,CAAC,CAACmT,MAAtF,EAA6FnT,CAAC,CAACoT,aAA/F,EAA6GpT,CAAC,CAACqT,kBAA/G,CAAN;IAAyI,CAA5K,EAA+K,MAAI,KAAKN,iBAAL,EAAnL,EAA6MnR,CAA7M,CAAtS,EAAsfF,CAAC,CAAE,MAAI,KAAK4M,IAAL,CAAUgF,eAAV,EAA2BC,YAA3B,EAAyCC,mBAA/C,EAAqEzT,CAAC,IAAE,KAAKwP,SAAL,CAAekE,oBAAf,GAAoC1T,CAAC,GAAC,CAA9G,EAAiHiC,CAAjH,CAAvf,EAA2mBN,CAAC,CAAE,MAAI,KAAKgS,mBAAX,EAAiC,MAAI,KAAKC,qBAAL,EAArC,EAAmE7R,CAAnE,CAA5mB,CAAlB,CAAxD,EAA8vB,KAAKuL,QAAL,CAAc+B,GAAd,CAAkB,KAAKd,IAAL,CAAUkD,aAAV,CAAwBsB,EAAxB,CAA2B,eAA3B,EAA4C,MAAI,KAAK1E,gBAAL,GAAsB,CAAC,CAAvE,CAAlB,CAA9vB,EAA41B,KAAKA,gBAAL,GAAsB,CAAC,CAAn3B,EAAq3B,KAAKgC,uBAAL,EAAr3B;EAAo5B;;EAAAwD,OAAO,GAAE;IAAC,KAAKrG,UAAL,CAAgB3B,MAAhB,IAAyB,KAAKyB,QAAL,CAAcuG,OAAd,EAAzB,EAAiD,KAAKtG,sBAAL,CAA4BsG,OAA5B,EAAjD,EAAuF,KAAKlF,YAAL,GAAkB/N,CAAC,CAAC,KAAK+N,YAAN,CAA1G,EAA8H,KAAKmF,eAAL,EAA9H,EAAqJ,KAAK/E,iBAAL,GAAuBjO,CAAC,CAAC,KAAKiO,iBAAN,CAA7K,EAAsM,KAAKG,oBAAL,GAA0BpO,CAAC,CAAC,KAAKoO,oBAAN,CAAjO,EAA6P,KAAKC,IAAL,CAAU,mBAAV,EAA8BrO,CAAC,CAAC,KAAK6R,iBAAN,CAA/B,CAA7P,EAAsT,KAAKxB,aAAL,GAAmBrQ,CAAC,CAAC,KAAKqQ,aAAN,CAA1U,EAA+V,KAAK9D,wBAAL,CAA8B0G,OAA9B,CAAuC,CAAC/T,CAAD,EAAGC,CAAH,KAAO,KAAK+T,yBAAL,CAA+B/T,CAA/B,CAA9C,CAA/V,EAAib,KAAKgS,uBAAL,GAA6B,IAA9c,EAAmd,KAAKG,iBAAL,GAAuB,IAA1e,EAA+e,KAAKjD,IAAL,CAAU,gBAAV,EAA2BrO,CAAC,CAAC,KAAKwO,cAAN,CAA5B,CAA/e,EAAkiB,KAAKT,SAAL,GAAe/N,CAAC,CAAC,KAAK+N,SAAN,CAAljB,EAAmkBtF,EAAE,CAAC0K,KAAH,EAAnkB,EAA8kB,KAAKjD,aAAL,KAAqB,KAAKA,aAAL,CAAmB6C,OAAnB,IAA6B,KAAK7C,aAAL,GAAmB,IAArE,CAA9kB,EAAypB,KAAKxB,SAAL,GAAe1O,CAAC,CAAC,KAAK0O,SAAN,CAAzqB,EAA0rB,KAAK5D,aAAL,GAAmB9K,CAAC,CAAC,KAAK8K,aAAN,CAA9sB,EAAmuB,KAAKuD,IAAL,CAAU,MAAV,EAAiB,IAAjB,CAAnuB,EAA0vB,KAAKzB,iBAAL,GAAuB5M,CAAC,CAAC,KAAK4M,iBAAN,CAAlxB,EAA2yB/I,CAAC,EAA5yB,EAA+yB6E,EAAE,EAAjzB;EAAozB;;EAAY,IAARqG,QAAQ,GAAE;IAAC,OAAO,KAAKL,SAAZ;EAAsB;;EAAW,IAAP0E,OAAO,GAAE;IAAC,OAAO,KAAKnH,QAAZ;EAAqB;;EAAa,IAAToH,SAAS,GAAE;IAAC,MAAMnU,CAAC,GAAC,KAAKuO,IAAL,CAAUoC,gBAAV,EAA4ByD,sBAA5B,EAAoDC,KAA5D;;IAAkE,IAAGrU,CAAH,EAAK;MAAC,MAAMC,CAAC,GAAC,KAAKsO,IAAL,CAAUC,KAAV,CAAgB6E,aAAxB;MAAsC,IAAInT,CAAC,GAAC2E,CAAC,CAAC,KAAK0J,IAAN,EAAWtO,CAAC,CAACqU,GAAb,EAAiBrU,CAAC,CAACsU,WAAnB,EAA+BtU,CAAC,CAACuU,EAAjC,CAAD,CAAsCC,IAA5C;MAAiDvU,CAAC,GAAC,EAAF,KAAOA,CAAC,GAAC,MAAIA,CAAb;MAAgB,MAAME,CAAC,GAAC,IAAE,CAACF,CAAC,GAAC,EAAH,KAAQ,CAAlB;MAAA,MAAoBG,CAAC,GAAC0E,CAAC,CAAC,KAAKwJ,IAAN,EAAWvO,CAAX,CAAD,GAAeI,CAArC;MAAuCsU,IAAI,CAACC,GAAL,CAAS,KAAK7H,UAAL,GAAgBzM,CAAzB,IAA4BkL,EAA5B,KAAiCmJ,IAAI,CAACE,KAAL,CAAWvU,CAAX,MAAgBqU,IAAI,CAACE,KAAL,CAAW,KAAK9H,UAAhB,CAAhB,KAA8C,KAAKN,YAAL,GAAkB,CAAC,CAAjE,GAAoE,KAAKM,UAAL,GAAgBzM,CAArH;IAAwH;;IAAA,OAAOqU,IAAI,CAACE,KAAL,CAAW,KAAK9H,UAAhB,CAAP;EAAmC;;EAAe,IAAXoG,WAAW,GAAE;IAAC,OAAO,KAAK3E,IAAL,CAAUgF,eAAV,CAA0BC,YAA1B,CAAuCqB,0BAAvC,GAAkE9O,EAAE,CAAC+O,EAArE,GAAwE/O,EAAE,CAACgP,GAAlF;EAAsF;;EAAoB,IAAhBC,gBAAgB,GAAE;IAAC,OAAO,KAAKtH,iBAAZ;EAA8B;;EAAoB,IAAhBuH,gBAAgB,GAAE;IAAC,OAAO,KAAKlG,iBAAZ;EAA8B;;EAAuB,IAAnBmG,mBAAmB,GAAE;IAAC,OAAO,KAAKhG,oBAAZ;EAAiC;;EAAoB,IAAhBiG,gBAAgB,GAAE;IAAC,OAAO,KAAK/C,iBAAZ;EAA8B;;EAAuB,IAAnBuB,mBAAmB,GAAE;IAAC,MAAK;MAAC5D,gBAAgB,EAAC/P;IAAlB,IAAqB,IAA1B;IAAA,MAA+B;MAACoV,YAAY,EAACnV;IAAd,IAAiB,KAAKsO,IAArD;IAA0D,IAAGvN,CAAC,CAACf,CAAD,CAAD,IAAMe,CAAC,CAAChB,CAAD,CAAV,EAAc,OAAO,IAAP;;IAAY,MAAME,CAAC,GAACoD,CAAC,EAAT;IAAA,MAAYlD,CAAC,GAAC8E,CAAC,CAACjF,CAAD,EAAGC,CAAH,EAAKF,CAAL,CAAD,GAASE,CAAT,GAAW,IAAzB;IAAA,MAA8BG,CAAC,GAAC,KAAKgV,IAAL,CAAU,QAAV,CAAhC;;IAAoD,OAAO7R,CAAC,CAACpD,CAAD,EAAGC,CAAH,CAAD,GAAOA,CAAP,GAASD,CAAhB;EAAkB;;EAAmB,IAAfkV,eAAe,GAAE;IAAC,OAAO,KAAK3H,gBAAZ;EAA6B;;EAAU,IAANkF,MAAM,GAAE;IAAC,MAAM7S,CAAC,GAAC0D,CAAC,CAAC,KAAK6R,YAAN,EAAmB,KAAK5B,mBAAxB,EAA4CrQ,CAAC,EAA7C,CAAT;IAAA,MAA0DrD,CAAC,GAAC,KAAKoV,IAAL,CAAU,QAAV,CAA5D;;IAAgF,OAAO7R,CAAC,CAACxD,CAAD,EAAGC,CAAH,CAAD,GAAOA,CAAP,GAASD,CAAhB;EAAkB;;EAAgB,IAAZuV,YAAY,GAAE;IAAC,OAAOrU,CAAC,CAAC,KAAKsU,mBAAN,CAAD,GAA4B,KAAKA,mBAAjC,GAAqD,KAAK7H,gBAAjE;EAAkF;;EAAuB,IAAnB6H,mBAAmB,GAAE;IAAC,OAAO,KAAK7C,iBAAL,EAAwBE,MAA/B;EAAsC;;EAAY,IAAR4C,QAAQ,GAAE;IAAC,OAAO,KAAKzJ,kBAAL,KAA0B,KAAK4B,eAAL,GAAqB,CAA/C,GAAkD,CAAC,EAAE,CAAC,KAAKL,sBAAL,CAA4BkI,QAA5B,IAAsC,KAAKzJ,kBAA3C,IAA+D,KAAKQ,YAApE,IAAkF,KAAKL,cAAvF,IAAuG,KAAKD,eAAL,GAAqB,CAA5H,IAA+H,CAAC,KAAKE,eAArI,IAAsJ,KAAKiC,gBAA5J,KAA+K,KAAKqH,KAApL,IAA2L,CAAC,KAAKC,SAAjM,IAA4M,KAAKrG,cAAL,CAAoBmG,QAAhO,IAA0O,KAAKjI,UAAL,CAAgBiI,QAA5P,CAA1D;EAAgU;;EAAyB,IAArBG,qBAAqB,GAAE;IAAC,OAAO,KAAKhI,eAAL,GAAqB8G,IAAI,CAACmB,GAAL,CAAS,KAAK5J,eAAd,EAA8B,KAAK2B,eAAnC,CAArB,EAAyE,IAAE,KAAK3B,eAAL,GAAqB,KAAK2B,eAA5G;EAA4H;;EAAe,IAAXwD,WAAW,GAAE;IAAC,OAAO,KAAK7C,IAAL,CAAUC,KAAV,CAAgB4C,WAAvB;EAAmC;;EAAS,IAALsE,KAAK,GAAE;IAAC,OAAOxU,CAAC,CAAC,KAAK4U,SAAN,CAAR;EAAyB;;EAAe,IAAXC,WAAW,CAAC/V,CAAD,EAAG;IAAC,KAAKwP,SAAL,CAAeuG,WAAf,GAA2B/V,CAA3B,EAA6B,KAAKmP,IAAL,CAAU,aAAV,EAAwBnP,CAAxB,CAA7B;EAAwD;;EAAoB,IAAhB+P,gBAAgB,GAAE;IAAC,OAAO,KAAK6C,YAAL,EAAmB7C,gBAAnB,IAAqC,IAA5C;EAAiD;;EAAqB,IAAjBiG,iBAAiB,CAAChW,CAAD,EAAG;IAAC,KAAKwP,SAAL,CAAewG,iBAAf,GAAiChW,CAAjC,EAAmC,KAAKmP,IAAL,CAAU,mBAAV,EAA8BnP,CAA9B,CAAnC,EAAoE,KAAKyQ,yBAAL,EAApE;EAAqG;;EAAAA,yBAAyB,GAAE;IAAC,MAAMzQ,CAAC,GAAC,CAAC,KAAKwQ,iBAAN,IAAyB,CAAC,KAAKyF,MAAvC;IAA8C,KAAK1H,IAAL,EAAW2B,MAAX,EAAmBgG,UAAnB,CAA8BC,mBAA9B,CAAkD;MAACC,kBAAkB,EAACpW;IAApB,CAAlD;EAA0E;;EAAoB,IAAhBqW,gBAAgB,CAACrW,CAAD,EAAG;IAACA,CAAC,KAAG,KAAKqW,gBAAT,KAA4B,KAAK7G,SAAL,CAAe6G,gBAAf,GAAgCrW,CAA5D,GAA+D,KAAKmP,IAAL,CAAU,kBAAV,EAA6BnP,CAA7B,CAA/D;EAA+F;;EAAW,IAAPsW,OAAO,CAACtW,CAAD,EAAG;IAACA,CAAC,KAAG,KAAKqM,QAAT,KAAoB,KAAKA,QAAL,GAAcrM,CAAd,EAAgB,KAAKwP,SAAL,CAAe+G,aAAf,CAA6BvW,CAA7B,CAAhB,EAAgD,KAAK2V,SAAL,GAAe,CAAC3V,CAApF;EAAuF;;EAAU,IAANiW,MAAM,GAAE;IAAC,OAAO,KAAKzG,SAAL,CAAeyG,MAAtB;EAA6B;;EAAa,IAATN,SAAS,CAAC3V,CAAD,EAAG;IAAC,KAAKmP,IAAL,CAAU,WAAV,EAAsBnP,CAAtB,GAAyB,KAAKgT,iBAAL,EAAzB;EAAkD;;EAAAwD,SAAS,CAACxW,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,KAAKoP,SAAL,CAAegH,SAAf,CAAyBxW,CAAzB,EAA2BC,CAA3B,EAA6BC,CAA7B,EAA+BE,CAA/B;EAAkC;;EAAAqW,YAAY,CAACzW,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,MAAMC,CAAC,GAAC,KAAKqW,oBAAL,CAA0B1W,CAA1B,EAA4BC,CAA5B,EAA8BC,CAA9B,EAAgCE,CAAhC,EAAkCuW,EAAlC,CAAR;IAA8C,OAAO3V,CAAC,CAACX,CAAD,CAAD,GAAK,IAAL,GAAUqF,CAAC,CAACiR,EAAE,CAAC,CAAD,CAAH,EAAOA,EAAE,CAAC,CAAD,CAAT,EAAatW,CAAC,CAACuW,UAAF,CAAaC,aAAb,CAA2BC,WAAxC,CAAlB;EAAuE;;EAAAJ,oBAAoB,CAAC1W,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAASC,CAAC,GAACsW,EAAX,EAAc;IAAC,MAAMrW,CAAC,GAAC,KAAKwV,SAAb;IAAuB,IAAG9U,CAAC,CAACV,CAAD,CAAD,IAAM,CAACA,CAAC,CAACyW,MAAZ,EAAmB,OAAO,IAAP;IAAY,IAAG,MAAIzW,CAAC,CAAC,CAAD,CAAD,CAAK0W,SAAL,CAAe7Q,EAAE,CAACgM,SAAlB,EAA6B4E,MAApC,EAA2C,OAAO,IAAP;IAAY,IAAG1W,CAAC,CAAC,CAAD,CAAD,GAAKL,CAAL,EAAOK,CAAC,CAAC,CAAD,CAAD,GAAKJ,CAAZ,EAAcI,CAAC,CAAC,CAAD,CAAD,GAAKH,CAAnB,EAAqB,CAAC8C,CAAC,CAAC3C,CAAD,EAAGD,CAAH,EAAKC,CAAL,EAAO,KAAKuS,YAAL,EAAmB7C,gBAA1B,CAA1B,EAAsE,OAAO1E,EAAE,CAAC4L,KAAH,CAAS,iGAAT,GAA4G,IAAnH;;IAAwH,KAAI,IAAI1W,CAAR,IAAaD,CAAb,EAAe;MAAC,IAAG,CAACC,CAAC,CAAC2W,aAAF,CAAgB7W,CAAhB,CAAJ,EAAuB;;MAAS,OAAKE,CAAC,IAAE,CAACA,CAAC,CAAC4W,QAAN,IAAgB,CAAC5W,CAAC,CAAC6W,MAAxB,GAAgC;QAAC,IAAIpX,CAAC,GAAC,CAAN;QAAQK,CAAC,CAAC,CAAD,CAAD,GAAK,MAAIE,CAAC,CAACsS,MAAF,CAAS,CAAT,IAAYtS,CAAC,CAACsS,MAAF,CAAS,CAAT,CAAhB,CAAL,KAAoC7S,CAAC,IAAE,CAAvC,GAA0CK,CAAC,CAAC,CAAD,CAAD,GAAK,MAAIE,CAAC,CAACsS,MAAF,CAAS,CAAT,IAAYtS,CAAC,CAACsS,MAAF,CAAS,CAAT,CAAhB,CAAL,KAAoC7S,CAAC,IAAE,CAAvC,CAA1C,EAAoFO,CAAC,GAACA,CAAC,CAAC8W,QAAF,CAAWrX,CAAX,CAAtF;MAAoG;;MAAA,MAAMA,CAAC,GAACO,CAAC,CAACqW,UAAV;MAAqB,OAAM,CAAC5W,CAAC,GAACA,CAAC,CAAC6W,aAAF,CAAgBC,WAAjB,GAA6B,IAA/B,IAAqCvW,CAArC,GAAuC,IAA7C;IAAkD;;IAAA,OAAO,IAAP;EAAY;;EAAmB,IAAf+W,eAAe,GAAE;IAAC,OAAO,KAAK3L,gBAAZ;EAA6B;;EAAA4L,QAAQ,CAACvX,CAAD,EAAG;IAAC,IAAG,KAAK4S,YAAR,EAAqB;MAAC,IAAG,CAAC1P,CAAC,CAAClD,CAAD,EAAG2W,EAAH,EAAM,KAAK5G,gBAAX,CAAL,EAAkC,OAAO1E,EAAE,CAAC4L,KAAH,CAAS,6FAAT,GAAwG,IAA/G;MAAoH,MAAMhX,CAAC,GAAC,KAAK6V,SAAb;MAAuB,IAAG5U,CAAC,CAACjB,CAAD,CAAJ,EAAQ,KAAI,IAAID,CAAR,IAAaC,CAAb,EAAe,IAAGD,CAAC,EAAEkX,aAAH,CAAiBP,EAAjB,CAAH,EAAwB;QAAC,OAAK,CAAC3W,CAAC,CAACoX,MAAH,IAAW,CAACpX,CAAC,CAACmX,QAAnB,GAA6B;UAAC,IAAIlX,CAAC,GAAC,CAAN;UAAQ0W,EAAE,CAAC,CAAD,CAAF,GAAM3W,CAAC,CAACqX,QAAF,CAAW,CAAX,EAAcxE,MAAd,CAAqB,CAArB,CAAN,KAAgC5S,CAAC,IAAE,CAAnC,GAAsC0W,EAAE,CAAC,CAAD,CAAF,GAAM3W,CAAC,CAACqX,QAAF,CAAW,CAAX,EAAcxE,MAAd,CAAqB,CAArB,CAAN,KAAgC5S,CAAC,IAAE,CAAnC,CAAtC,EAA4ED,CAAC,GAACA,CAAC,CAACqX,QAAF,CAAWpX,CAAX,CAA9E;QAA4F;;QAAA,OAAO,KAAKuX,yBAAL,CAA+BxX,CAAC,CAACyX,KAAjC,CAAP;MAA+C;IAAC;;IAAA,OAAO,KAAP;EAAa;;EAAAC,wBAAwB,CAAC1X,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAASC,CAAT,EAAW;IAAC,IAAGsW,EAAE,CAAC,CAAD,CAAF,GAAM3W,CAAN,EAAQ2W,EAAE,CAAC,CAAD,CAAF,GAAM1W,CAAd,EAAgB0W,EAAE,CAAC,CAAD,CAAF,GAAMzW,CAAtB,EAAwByW,EAAE,CAAC,CAAD,CAAF,GAAMvW,CAA9B,EAAgC,CAAC4C,CAAC,CAAC2T,EAAD,EAAItW,CAAJ,EAAMsW,EAAN,EAAS,KAAK/D,YAAL,EAAmB7C,gBAA5B,CAArC,EAAmF,OAAO1E,EAAE,CAAC4L,KAAH,CAAS,6GAAT,GAAwH,IAA/H;IAAoI,IAAI3W,CAAC,GAAC,IAAE,CAAR;IAAA,IAAUC,CAAC,GAAC,CAAC,CAAD,GAAG,CAAf;;IAAiB,MAAMC,CAAC,GAACR,CAAC,IAAE;MAAC,IAAGA,CAAC,IAAE4D,CAAC,CAAC5D,CAAC,CAAC6S,MAAH,EAAU8D,EAAV,CAAP,EAAqB,IAAG3W,CAAC,CAACoX,MAAF,IAAUpX,CAAC,CAACmX,QAAf,EAAwB7W,CAAC,GAACoU,IAAI,CAACiD,GAAL,CAASrX,CAAT,EAAWN,CAAC,CAACsX,eAAF,CAAkB,CAAlB,CAAX,CAAF,EAAmC/W,CAAC,GAACmU,IAAI,CAACmB,GAAL,CAAStV,CAAT,EAAWP,CAAC,CAACsX,eAAF,CAAkB,CAAlB,CAAX,CAArC,CAAxB,KAAmG,KAAI,MAAMrX,CAAV,IAAeD,CAAC,CAACqX,QAAjB,EAA0B7W,CAAC,CAACP,CAAD,CAAD;IAAK,CAAnK;IAAA,MAAoKS,CAAC,GAAC,KAAKoV,SAA3K;;IAAqL,IAAG5U,CAAC,CAACR,CAAD,CAAJ,EAAQ,KAAI,MAAME,CAAV,IAAeF,CAAf,EAAiBF,CAAC,CAACI,CAAD,CAAD;IAAK,OAAM;MAAC+W,GAAG,EAACrX,CAAL;MAAOuV,GAAG,EAACtV;IAAX,CAAN;EAAoB;;EAAAqX,cAAc,CAAC5X,CAAD,EAAGC,CAAH,EAAK;IAAC,IAAG,CAAC,KAAK2S,YAAT,EAAsB,OAAO,IAAP;IAAY,IAAG,CAAC1P,CAAC,CAAClD,CAAD,EAAG2W,EAAH,EAAM,KAAK5G,gBAAX,CAAL,EAAkC,OAAO1E,EAAE,CAAC4L,KAAH,CAAS,mGAAT,GAA8G,IAArH;IAA0HN,EAAE,CAAC,CAAD,CAAF,GAAM1W,CAAN;IAAQ,IAAIC,CAAC,GAAC,IAAN;;IAAW,MAAME,CAAC,GAACJ,CAAC,IAAE;MAAC,IAAGA,CAAC,IAAE4D,CAAC,CAAC5D,CAAC,CAAC6S,MAAH,EAAU8D,EAAV,CAAP,EAAqB,IAAG3W,CAAC,CAACoX,MAAF,IAAUpX,CAAC,CAACmX,QAAf,EAAwB;QAAC,MAAMlX,CAAC,GAAC,KAAKuX,yBAAL,CAA+BxX,CAAC,CAACyX,KAAjC,CAAR;;QAAgDvX,CAAC,GAAC,QAAMA,CAAN,GAAQD,CAAR,GAAUyU,IAAI,CAACiD,GAAL,CAASzX,CAAT,EAAWD,CAAX,CAAZ;MAA0B,CAAnG,MAAwG,KAAI,MAAMA,CAAV,IAAeD,CAAC,CAACqX,QAAjB,EAA0BjX,CAAC,CAACH,CAAD,CAAD;IAAK,CAAxK;IAAA,MAAyKI,CAAC,GAAC,KAAKyV,SAAhL;;IAA0L,IAAG5U,CAAC,CAACb,CAAD,CAAJ,EAAQ,KAAI,MAAMC,CAAV,IAAeD,CAAf,EAAiBD,CAAC,CAACE,CAAD,CAAD;IAAK,OAAOJ,CAAP;EAAS;;EAAA2X,sBAAsB,CAAC7X,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,MAAMC,CAAC,GAACJ,CAAC,GAAC,KAAK2S,YAAL,CAAkBkF,YAAlB,CAA+B7X,CAA/B,CAAD,GAAmC,CAA5C;IAAA,MAA8CK,CAAC,GAACJ,CAAC,GAAC,KAAK0S,YAAL,CAAkBkF,YAAlB,CAA+B5X,CAA/B,CAAD,GAAmC,IAAE,CAAtF;IAAA,MAAwFK,CAAC,GAAC,KAAK0S,OAA/F;;IAAuG,KAAKzD,SAAL,CAAeuI,sBAAf,CAAsC/X,CAAtC,EAAwCK,CAAC,GAACE,CAA1C,EAA4CD,CAAC,GAACC,CAA9C,EAAgDH,CAAhD;EAAmD;;EAAAkQ,kBAAkB,CAACtQ,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,KAAKuP,SAAL,CAAeyG,MAAvB;IAA8B,KAAKzG,SAAL,CAAeyG,MAAf,GAAsBjW,CAAC,IAAE,CAAH,IAAM,CAAC,KAAKuQ,qBAAlC,EAAwD,KAAKf,SAAL,CAAewI,aAAf,GAA6B,KAAKC,4BAAL,EAArF;IAAyH,MAAM/X,CAAC,GAACD,CAAC,KAAG,KAAKuP,SAAL,CAAeyG,MAA3B;IAAkC/V,CAAC,IAAE,KAAKuQ,yBAAL,EAAH,EAAoC,KAAKyH,mBAAL,CAAyBhY,CAAC,GAAC+F,EAAE,CAACkS,OAAJ,GAAYlS,EAAE,CAACmS,SAAzC,CAApC;EAAwF;;EAAApG,mBAAmB,GAAE;IAAC,MAAMhS,CAAC,GAAC,KAAK2S,iBAAL,CAAuBC,YAA/B;IAA4C5S,CAAC,KAAG,KAAK4S,YAAT,KAAwBjL,EAAE,CAAC,CAAC,CAAC3H,CAAH,EAAK,4CAAL,CAAF,EAAqD,KAAKsO,SAAL,GAAe,CAAC,KAAKC,IAAL,EAAWC,KAAX,EAAkBC,OAAvF,EAA+F,KAAKmE,YAAL,IAAmB,KAAKkB,eAAL,EAAlH,EAAyI,KAAK3E,IAAL,CAAU,cAAV,EAAyBnP,CAAzB,CAAzI,EAAqK,KAAK4T,qBAAL,EAArK,EAAkM5T,CAAC,KAAG,KAAKqY,kBAAL,IAA0B,KAAK7I,SAAL,CAAe8I,WAAf,CAA2BtY,CAAC,CAACuY,SAA7B,CAA1B,EAAkE,KAAKjJ,cAAL,CAAoBkJ,mBAApB,CAAwCxY,CAAC,CAAC+P,gBAA1C,CAAlE,EAA8H,KAAK+C,gBAAL,EAAjI,CAA3N;EAAsX;;EAAA2F,YAAY,CAACzY,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,MAAMC,CAAC,GAAC,KAAKwO,SAAL,CAAe6J,OAAf,EAAR;;IAAiC,OAAOC,EAAE,CAAC,CAAD,CAAF,GAAM3Y,CAAN,EAAQ2Y,EAAE,CAAC,CAAD,CAAF,GAAM1Y,CAAd,EAAgB0Y,EAAE,CAAC,CAAD,CAAF,GAAMzY,CAAtB,EAAwBG,CAAC,CAACuY,IAAF,CAAOD,EAAP,EAAUvY,CAAV,EAAY,IAAZ,CAAxB,EAA0CC,CAAjD;EAAmD;;EAAqB,IAAjBwY,iBAAiB,GAAE;IAAC,OAAO,KAAK9K,kBAAZ;EAA+B;;EAAA+E,gBAAgB,GAAE;IAAC,MAAK;MAACD,MAAM,EAAC7S,CAAR;MAAU4S,YAAY,EAAC3S;IAAvB,IAA0B,IAA/B;IAAoC,IAAG,CAACA,CAAJ,EAAM;IAAO,MAAMC,CAAC,GAAC4Y,EAAR;IAAW,IAAIzY,CAAC,GAACJ,CAAC,CAAC8Y,iBAAF,CAAoB/Y,CAApB,EAAsBE,CAAtB,EAAwB,IAAE6G,EAA1B,CAAN;;IAAoC,IAAG7F,CAAC,CAAC,KAAK4U,SAAN,CAAJ,EAAqB;MAAC,IAAGzV,CAAC,CAAC0W,MAAF,GAAShQ,EAAZ,EAAe,OAAO,KAAKsE,EAAE,CAAC2N,IAAH,CAAQ/R,EAAR,CAAZ;MAAwB,MAAMjH,CAAC,GAAC,KAAK8V,SAAL,CAAexE,GAAf,CAAoBtR,CAAC,IAAEA,CAAC,CAACiZ,GAAzB,CAAR;MAAA,MAAuChZ,CAAC,GAACG,CAAC,CAACJ,CAAD,EAAGK,CAAH,EAAK6Y,EAAL,CAA1C;;MAAmD,IAAG,KAAKnL,kBAAL,GAAwB,CAAC,CAAzB,EAA2B9N,CAAC,CAACkZ,OAAF,CAAUpC,MAAV,GAAiB,CAAjB,IAAoB9W,CAAC,CAACmZ,KAAF,CAAQrC,MAAR,GAAe,CAAjE,EAAmE;QAAC,MAAM/W,CAAC,GAAC,KAAK8V,SAAL,CAAeuD,MAAf,CAAuBrZ,CAAC,IAAE,EAAEC,CAAC,CAACkZ,OAAF,CAAUG,SAAV,CAAqBrZ,CAAC,IAAEiZ,EAAE,CAACjZ,CAAD,EAAGD,CAAC,CAACiZ,GAAL,CAA1B,IAAsC,CAAC,CAAzC,MAA8C,KAAKM,UAAL,CAAgBvZ,CAAhB,EAAkB,CAAC,CAAnB,GAAsB,CAAC,CAArE,CAA1B,CAAR;QAA4GC,CAAC,CAACmZ,KAAF,CAAQrF,OAAR,CAAiB9T,CAAC,IAAED,CAAC,CAACwZ,IAAF,CAAO,KAAKC,YAAL,CAAkBxZ,CAAlB,CAAP,CAApB,GAAmD,KAAKyZ,aAAL,CAAmB1Z,CAAnB,CAAnD;MAAyE;IAAC,CAA1W,MAA+W,KAAK+N,kBAAL,GAAwB,CAAC,CAAzB,EAA2B1N,CAAC,CAAC0W,MAAF,GAAShQ,EAAT,KAAcsE,EAAE,CAAC2N,IAAH,CAAQ7R,EAAR,GAAY9G,CAAC,GAACJ,CAAC,CAAC8Y,iBAAF,CAAoB/Y,CAApB,EAAsBE,CAAtB,EAAwB6G,EAAxB,CAA5B,CAA3B,EAAoF,KAAK2S,aAAL,CAAmBrZ,CAAC,CAACiR,GAAF,CAAOtR,CAAC,IAAE,KAAKyZ,YAAL,CAAkBzZ,CAAlB,CAAV,CAAnB,CAApF;;IAAyIwD,CAAC,CAACtD,CAAD,EAAG,KAAKyN,gBAAR,CAAD,KAA6B,KAAKA,gBAAL,GAAsBrK,CAAC,CAACpD,CAAD,CAApD,GAAyD,KAAKoW,OAAL,GAAa,CAAC,CAAvE,EAAyE,KAAKtD,iBAAL,EAAzE,EAAkG,KAAK1D,cAAL,CAAoBqK,iBAApB,EAAlG,EAA0I,KAAKC,YAAL,CAAkB,OAAlB,CAA1I,EAAqK,KAAKnM,SAAL,CAAesG,OAAf,CAAwB/T,CAAC,IAAE;MAACA,CAAC,CAAC6Z,QAAF,IAAY,KAAKC,kBAAL,CAAwB9Z,CAAxB,CAAZ;IAAuC,CAAnE,CAArK,EAA2O,KAAKyN,SAAL,CAAesM,MAAf,CAAuB/Z,CAAC,IAAE;MAACA,CAAC,CAAC6Z,QAAF,KAAa,KAAKG,mBAAL,CAAyBha,CAAzB,GAA4B,KAAKia,uCAAL,CAA6Cja,CAA7C,CAAzC;IAA0F,CAArH,CAA3O,EAAmW,KAAK+N,kBAAL,GAAwB,CAAC,CAA5X,EAA8X,KAAKmM,0BAAL,EAA9X;EAAga;;EAAAT,YAAY,CAACzZ,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,KAAKwY,YAAL,CAAkB,CAAlB,EAAoBzY,CAAC,CAAC,CAAD,CAArB,EAAyBA,CAAC,CAAC,CAAD,CAA1B,EAA8B,IAA9B,CAAR;;IAA4C,OAAOC,CAAC,CAACka,WAAF,CAAc,KAAKtN,YAAnB,EAAgC,KAAKF,eAArC,EAAqD,KAAKuG,WAA1D,MAAyExJ,EAAE,CAAC0Q,KAA5E,IAAmFna,CAAC,CAACoa,gBAAF,CAAmB3Q,EAAE,CAAC0Q,KAAtB,CAAnF,EAAgH,KAAKE,SAAL,CAAera,CAAf,CAAhH,EAAkI,KAAK+N,uBAAL,IAA8B/N,CAAC,CAACsa,2BAAF,EAAhK,EAAgMta,CAAvM;EAAyM;;EAAAyZ,aAAa,CAAC1Z,CAAD,EAAG;IAAC,IAAG,KAAKmP,IAAL,CAAU,WAAV,EAAsBnP,CAAtB,GAAyB,KAAKyN,SAAL,CAAe+M,KAAf,EAAzB,EAAgDtZ,CAAC,CAAClB,CAAD,CAApD,EAAwD;MAAC,MAAMC,CAAC,GAAC,KAAK2L,aAAL,CAAmB8M,OAAnB,EAAR;;MAAqC,KAAIzY,CAAC,CAACwa,KAAF,CAAQza,CAAR,CAAJ,EAAe,CAACC,CAAC,CAACya,IAAlB,GAAwB,KAAKjN,SAAL,CAAe+L,IAAf,CAAoBvZ,CAAC,CAAC0a,IAAF,EAApB;;MAA8B1a,CAAC,CAAC4L,MAAF;IAAW;;IAAA,KAAK2D,SAAL,CAAeoL,YAAf,CAA4B,KAAK9E,SAAjC,GAA4C,KAAK+E,sBAAL,CAA4B7a,CAA5B,CAA5C;EAA2E;;EAAA8a,2BAA2B,GAAE;IAAC,KAAKpO,sBAAL,KAA8B,KAAKA,sBAAL,GAA4B,CAAC,CAA7B,EAA+B,KAAKsG,iBAAL,EAA7D;EAAuF;;EAAAA,iBAAiB,GAAE;IAAC,KAAKzE,IAAL,IAAW,CAAC,KAAKoH,SAAjB,IAA4B,KAAK/C,YAAjC,IAA+C,KAAKvG,QAApD,KAA+D,KAAKI,YAAL,GAAkB,KAAKC,sBAAL,GAA4B,CAAC,CAA/C,IAAkD,KAAKA,sBAAL,GAA4B,CAAC,CAA7B,EAA+B,KAAKqO,8BAAL,EAA/B,EAAqE,KAAKF,sBAAL,CAA4B,KAAK/E,SAAjC,CAAvH,CAA/D;EAAoO;;EAAAkF,qBAAqB,CAAChb,CAAD,EAAG;IAACA,CAAC,CAACib,oBAAF,CAAuB,KAAKpI,MAA5B,KAAqC7S,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAACyR,QAAxB,CAArC,IAAwE,KAAKnB,mBAAL,CAAyBha,CAAzB,CAAxE;EAAoG;;EAAA6a,sBAAsB,CAAC7a,CAAD,EAAG;IAAC,IAAGgB,CAAC,CAAChB,CAAD,CAAJ,EAAQ;IAAO,MAAMC,CAAC,GAAC+J,EAAE,CAAChK,CAAD,CAAV;IAAc,IAAIE,CAAC,GAACD,CAAC,GAAC,KAAK0L,gBAAL,CAAsBgM,GAAvB,GAA2B,IAAE,CAApC;IAAA,IAAsCvX,CAAC,GAACH,CAAC,GAAC,KAAK0L,gBAAL,CAAsBkK,GAAvB,GAA2B,CAAC,CAAD,GAAG,CAAvE;IAAyE,MAAMxV,CAAC,GAAC,KAAKkO,IAAL,CAAUC,KAAV,CAAgB8E,kBAAxB;IAAA,MAA2ChT,CAAC,GAAC,KAAKuS,MAAlD;IAAA,MAAyDtS,CAAC,GAAC,KAAKyM,qBAAhE;IAAsF,KAAKoO,gBAAL;;IAAwB,MAAM5a,CAAC,GAAC,KAAKoL,aAAL,CAAmB8M,OAAnB,EAAR;;IAAqC,KAAIlY,CAAC,CAACia,KAAF,CAAQza,CAAR,CAAJ,EAAe,CAACQ,CAAC,CAACka,IAAlB,GAAwB;MAAC,MAAM1a,CAAC,GAACQ,CAAC,CAACma,IAAF,EAAR;MAAiB3a,CAAC,CAACib,oBAAF,CAAuB3a,CAAvB,KAA2BN,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAACyR,QAAxB,CAA3B,IAA8D,KAAKnB,mBAAL,CAAyBha,CAAzB,CAA9D,EAA0FA,CAAC,CAACqa,gBAAF,CAAmB3Q,EAAE,CAAC2R,UAAtB,CAA1F;MAA4H,MAAMpb,CAAC,GAACD,CAAC,CAACsb,iBAAF,EAAR;MAA8Bjb,CAAC,IAAEJ,CAAH,IAAMD,CAAC,CAACub,iBAAF,CAAoBhb,CAApB,GAAuBP,CAAC,CAAC4W,UAAF,KAAe1W,CAAC,GAACwU,IAAI,CAACiD,GAAL,CAAS3X,CAAC,CAACsX,eAAF,CAAkB,CAAlB,CAAT,EAA8BpX,CAA9B,CAAF,EAAmCE,CAAC,GAACsU,IAAI,CAACmB,GAAL,CAAS7V,CAAC,CAACsX,eAAF,CAAkB,CAAlB,CAAT,EAA8BlX,CAA9B,CAApD,CAA7B,IAAoHI,CAAC,CAACgb,WAAF,EAApH;IAAoI;;IAAAhb,CAAC,CAACqL,MAAF,IAAW,KAAKW,YAAL,GAAkB,CAAC,CAA9B,EAAgC,KAAKL,cAAL,GAAoB,CAAC,CAArD,EAAuDsP,QAAQ,CAACvb,CAAD,CAAR,IAAaub,QAAQ,CAACrb,CAAD,CAArB,KAA2B,KAAKuL,gBAAL,CAAsBgM,GAAtB,KAA4BzX,CAA5B,IAA+B,KAAKyL,gBAAL,CAAsBkK,GAAtB,KAA4BzV,CAA3D,KAA+D,KAAKuL,gBAAL,CAAsBgM,GAAtB,GAA0BzX,CAA1B,EAA4B,KAAKyL,gBAAL,CAAsBkK,GAAtB,GAA0BzV,CAAtD,EAAwD,KAAKsb,IAAL,CAAU,yBAAV,EAAoC,IAApC,CAAvH,CAA3B,CAAvD;EAAqP;;EAAAX,8BAA8B,GAAE;IAAC,MAAM/a,CAAC,GAAC,KAAKuO,IAAL,CAAUC,KAAV,CAAgB4E,MAAxB;IAAA,MAA+BnT,CAAC,GAAC,KAAKsO,IAAL,CAAUC,KAAV,CAAgB6E,aAAjD;IAAA,MAA+DnT,CAAC,GAACwU,IAAI,CAACiH,GAAL,CAAS,KAAG1b,CAAC,CAAC2b,IAAd,CAAjE;IAAA,MAAqFxb,CAAC,GAACsU,IAAI,CAACiH,GAAL,CAAS,KAAG1b,CAAC,CAAC4b,IAAd,CAAvF;IAAA,MAA2Gxb,CAAC,GAAC,KAAKuS,YAAL,CAAkB2F,SAA/H;IAAA,MAAyIjY,CAAC,GAAC,KAAG,CAAC,KAAK2S,OAAT,GAAiBjT,CAAC,CAAC8b,UAA9J;IAAyK,KAAKjP,YAAL,CAAkBkP,WAAlB,GAA8B/b,CAAC,CAAC+b,WAAhC,EAA4C,KAAKlP,YAAL,CAAkB+O,IAAlB,GAAuB1b,CAAnE,EAAqE,KAAK2M,YAAL,CAAkBgP,IAAlB,GAAuBzb,CAA5F,EAA8F,KAAKyM,YAAL,CAAkBmP,kBAAlB,GAAqC3b,CAAC,GAACL,CAAC,CAACic,KAAJ,GAAU,KAAKpO,eAAf,GAA+BvN,CAAlK,EAAoK,KAAKuM,YAAL,CAAkBqP,mBAAlB,GAAsC7b,CAAC,GAACL,CAAC,CAACmc,MAAJ,GAAW,KAAKtO,eAAhB,GAAgCvN,CAA1O,EAA4O,KAAKuM,YAAL,CAAkBuP,MAAlB,GAAyB,KAAKxJ,YAAL,CAAkByJ,SAAlB,EAArQ,EAAmS,KAAKxP,YAAL,CAAkByP,eAAlB,GAAkC,KAAK/N,IAAL,CAAUgF,eAAV,CAA0BC,YAA1B,CAAuC8I,eAA5W,EAA4X,KAAK/N,IAAL,CAAUC,KAAV,CAAgB8E,kBAAhB,IAAoCtS,CAAC,CAAC,KAAK6L,YAAL,CAAkBqH,OAAnB,CAAD,KAA+B,KAAKrH,YAAL,CAAkBqH,OAAlB,GAA0BrQ,CAAC,EAA1D,GAA8DE,CAAC,CAAC,KAAK8I,YAAL,CAAkBqH,OAAnB,EAA2BjU,CAAC,CAACiU,OAA7B,CAAnG,IAA0I,KAAKrH,YAAL,CAAkBqH,OAAlB,GAA0B,IAAhiB,EAAqiBnQ,CAAC,CAAC,KAAKgJ,QAAN,EAAe/M,CAAC,CAACkU,OAAjB,CAAtiB,EAAgkB1R,CAAC,CAAC,KAAKwK,qBAAN,EAA4B/M,CAAC,CAACsc,gBAA9B,EAA+Ctc,CAAC,CAACuc,UAAjD,CAAjkB,EAA8nB9Z,CAAC,CAAC,KAAKiK,eAAN,EAAsB1M,CAAC,CAACqU,GAAxB,CAA/nB,EAA4pBtR,CAAC,CAAChD,CAAC,CAACsU,GAAH,EAAO,KAAK/F,IAAL,CAAUkO,sBAAjB,EAAwC,KAAK7P,gBAA7C,EAA8D,KAAKmD,gBAAnE,CAA7pB;EAAkvB;;EAAA2M,iBAAiB,CAAC1c,CAAD,EAAG;IAACA,CAAC,CAACmX,QAAF,IAAY,CAACnX,CAAC,CAAC2c,UAAf,KAA4BC,EAAE,CAAC5c,CAAD,CAAF,IAAO,KAAK6c,aAAL,CAAmB7c,CAAnB,GAAsB,KAAKgO,uBAAL,KAA+B,KAAK8O,iCAAL,CAAuC9c,CAAvC,GAA0CA,CAAC,CAACqX,QAAF,CAAWtD,OAAX,CAAoB/T,CAAC,IAAEA,CAAC,CAACua,2BAAF,EAAvB,CAAzE,CAA7B,IAAiKwC,EAAE,CAAC/c,CAAD,CAAF,IAAO,KAAKgd,WAAL,CAAiBhd,CAAjB,CAApM;EAAyN;;EAAAga,mBAAmB,CAACha,CAAD,EAAG;IAACA,CAAC,CAACid,gBAAF,IAAqB,KAAKzN,SAAL,CAAe0N,kBAAf,CAAkCld,CAAlC,CAArB,EAA0D,KAAKia,uCAAL,CAA6Cja,CAA7C,CAA1D,EAA0G,KAAKmd,gBAAL,CAAsBnd,CAAtB,CAA1G,EAAmI,KAAKsM,WAAL,GAAiB,IAApJ,EAAyJ,KAAK0B,uBAAL,IAA8B,KAAKC,qBAAL,CAA2BmP,MAA3B,CAAkCpd,CAAlC,CAAvL;EAA4N;;EAAAia,uCAAuC,CAACja,CAAD,EAAGC,CAAH,EAAK;IAAC,IAAG,KAAK+N,uBAAR,EAAgC;MAAC,MAAM/N,CAAC,GAAC,KAAKgO,qBAAb;MAAmCjO,CAAC,CAACqd,qBAAF,CAAyBrd,CAAC,IAAE;QAACC,CAAC,CAACoP,GAAF,CAAMrP,CAAN;MAAS,CAAtC;IAAyC,CAA7G,MAAkHA,CAAC,CAACsd,kCAAF,CAAqCrd,CAArC;EAAwC;;EAAAsd,kBAAkB,CAACvd,CAAD,EAAGC,CAAH,EAAK;IAAC,MAAMC,CAAC,GAACF,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAAC8T,cAAxB,IAAwC9T,EAAE,CAAC8T,cAA3C,GAA0D,CAAC,CAACxd,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAAC+T,gBAAxB,CAAF,IAA6C/T,EAAE,CAAC+T,gBAAlH;IAAmIvd,CAAC,KAAG,KAAKsP,SAAL,CAAekO,iBAAf,CAAiC1d,CAAjC,EAAmCE,CAAnC,GAAsC,KAAKoM,WAAL,GAAiB,IAAvD,EAA4DrM,CAAC,CAAC0d,YAAF,EAA/D,CAAD;EAAkF;;EAAAR,gBAAgB,CAACnd,CAAD,EAAG;IAAC4d,EAAE,CAAC7N,gBAAH,GAAoB,KAAKA,gBAAzB,EAA0C6N,EAAE,CAACC,IAAH,GAAQ7d,CAAlD,EAAoD4d,EAAE,CAAC/K,MAAH,GAAU7S,CAAC,CAAC6S,MAAhE,EAAuE,KAAK6I,IAAL,CAAU,kBAAV,EAA6BkC,EAA7B,CAAvE;EAAwG;;EAAW,IAAPE,OAAO,GAAE;IAAC,OAAO,KAAKrI,QAAL,IAAe,KAAKC,KAApB,IAA2B,CAAC,KAAKC,SAAxC;EAAkD;;EAAAoI,OAAO,CAAC/d,CAAD,EAAG;IAAC,KAAKqQ,uBAAL,CAA6BrQ,CAA7B,GAAgC,KAAKwN,UAAL,CAAgBwQ,YAAhB,CAA6Bhe,CAA7B,CAAhC,EAAgE,KAAKyM,YAAL,GAAkB,CAAC,CAAnF,EAAqF,KAAKR,eAAL,GAAqB,CAA1G,EAA4G,KAAKD,kBAAL,GAAwB,CAAC,CAArI,EAAuI,KAAKiS,iBAAL,CAAuBje,CAAvB,CAAvI,EAAiK,KAAKke,UAAL,CAAgBle,CAAhB,CAAjK;IAAoL,MAAMC,CAAC,GAAC,CAAC,KAAKsO,IAAL,CAAUC,KAAV,CAAgB8E,kBAAzB;IAA4C,KAAK6K,cAAL,CAAoBne,CAApB,EAAsBC,CAAtB,GAAyBD,CAAC,CAACoe,GAAF,CAAO,MAAI,KAAKC,gBAAL,CAAsBre,CAAtB,CAAX,CAAzB,EAA+DA,CAAC,CAACoe,GAAF,CAAO,MAAI,KAAKE,eAAL,CAAqBte,CAArB,CAAX,CAA/D,EAAoGC,CAAC,IAAE,KAAKke,cAAL,CAAoBne,CAApB,EAAsB,CAAC,CAAvB,CAAvG,EAAiI,KAAKyM,YAAL,GAAkB,CAAC,CAApJ,EAAsJ,KAAKqO,2BAAL,EAAtJ,EAAyL9a,CAAC,CAAC0a,IAAF,GAAO,KAAK6D,aAAL,EAAP,GAA4B,KAAKjS,WAAL,GAAiB,KAAKkS,sBAAL,EAAtO,EAAoQ,KAAK5E,YAAL,CAAkB,uBAAlB,CAApQ;EAA+S;;EAAAqE,iBAAiB,CAACje,CAAD,EAAG;IAAC,IAAG,CAAC,KAAKwM,YAAN,IAAoB,CAAC,KAAKsJ,SAA1B,IAAqC9V,CAAC,CAAC0a,IAA1C,EAA+C;IAAO,KAAKlO,YAAL,GAAkB,CAAC,CAAnB;;IAAqB,MAAMvM,CAAC,GAAC,KAAK2L,aAAL,CAAmB8M,OAAnB,EAAR;;IAAqC,KAAIzY,CAAC,CAACwa,KAAF,CAAQ,KAAK3E,SAAb,CAAJ,EAA4B,CAAC7V,CAAC,CAACya,IAA/B,GAAqC;MAAC,MAAM1a,CAAC,GAACC,CAAC,CAAC0a,IAAF,EAAR;;MAAiB,IAAG3a,CAAC,CAACye,QAAL,EAAc;QAAC,MAAMve,CAAC,GAACF,CAAC,CAACma,WAAF,CAAc,KAAKtN,YAAnB,EAAgC,KAAKF,eAArC,EAAqD,KAAKuG,WAA1D,CAAR;;QAA+E,IAAGhT,CAAC,KAAGwJ,EAAE,CAAC0Q,KAAV,EAAgB;UAACpa,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAACgV,KAAxB,GAA+B1e,CAAC,CAACoX,MAAF,KAAWpX,CAAC,CAACqa,gBAAF,CAAmB3Q,EAAE,CAAC0Q,KAAtB,GAA6Bna,CAAC,CAACub,WAAF,EAAxC,CAA/B;UAAwF;QAAS;;QAAAxb,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAAC0Q,KAAxB,KAAgCpa,CAAC,CAAC2e,qBAAF,EAAhC,EAA0Dze,CAAC,KAAGwJ,EAAE,CAACkV,WAAP,IAAoB5e,CAAC,CAAC6e,YAAF,CAAe1Y,EAAE,CAACgM,SAAlB,CAA9E;MAA2G;;MAAA,IAAGlS,CAAC,CAACub,WAAF,IAAgB,CAACxb,CAAC,CAACoX,MAAtB,EAA6B;QAACpX,CAAC,CAACqa,gBAAF,CAAmB3Q,EAAE,CAACgV,KAAtB,GAA6B1e,CAAC,CAACkb,kBAAF,CAAqBxR,EAAE,CAAC0Q,KAAxB,CAA7B;;QAA4D,MAAMna,CAAC,GAAC,KAAK2L,aAAL,CAAmB8M,OAAnB,EAAR;;QAAqCzY,CAAC,CAAC6e,QAAF,CAAW9e,CAAX;;QAAc,KAAI,IAAIA,CAAC,GAACC,CAAC,CAAC0a,IAAF,EAAV,EAAmB,CAAC1a,CAAC,CAACya,IAAtB,EAA2B1a,CAAC,GAACC,CAAC,CAAC0a,IAAF,EAA7B,EAAsC,KAAKK,qBAAL,CAA2Bhb,CAA3B,GAA8BA,CAAC,CAACid,gBAAF,EAA9B,EAAmDjd,CAAC,CAACye,QAAF,IAAYze,CAAC,CAACub,iBAAF,CAAoB,KAAKvO,qBAAzB,CAA/D;;QAA+G/M,CAAC,CAAC4L,MAAF;MAAW;IAAC;;IAAA5L,CAAC,CAAC4L,MAAF,IAAW,KAAK0S,aAAL,EAAX,EAAgCve,CAAC,CAAC2d,YAAF,EAAhC;EAAiD;;EAAAO,UAAU,CAACle,CAAD,EAAG;IAACA,CAAC,CAAC0a,IAAF,IAAQ,KAAKtO,eAAb,KAA+BlC,EAAE,CAAC,KAAKuD,SAAN,EAAgB,KAAKc,IAAL,CAAUoC,gBAAV,CAA2BE,KAA3B,CAAiCC,cAAjD,CAAF,EAAmE,KAAK1E,eAAL,GAAqB,CAAC,CAAzF,EAA2F,KAAK4E,aAAL,IAAoB,KAAKA,aAAL,CAAmB+N,MAAnB,EAA/G,EAA2I/e,CAAC,CAAC2d,YAAF,EAA1K;EAA4L;;EAAAqB,+BAA+B,GAAE;IAACnX,EAAE,CAAC,MAAI,KAAKoG,qBAAL,CAA2BgR,IAAhC,CAAF,EAAwC,KAAKjR,uBAAL,GAA6B,CAAC,CAAtE;EAAwE;;EAAAkR,gCAAgC,GAAE;IAAC,KAAKlR,uBAAL,GAA6B,CAAC,CAA9B;IAAgC,MAAMhO,CAAC,GAAC,KAAKiO,qBAAb;;IAAmC,CAAC,MAAI;MAAC,MAAMhO,CAAC,GAAC,MAAI;QAAC,KAAI,MAAMA,CAAV,IAAeD,CAAf,EAAiBC,CAAC,CAACkf,wCAAF;MAA6C,CAA3E;;MAA4E,CAAC,MAAI;QAAC,KAAI,MAAMlf,CAAV,IAAeD,CAAf,EAAiBC,CAAC,CAACmf,qCAAF;MAA0C,CAAjE,KAAqEnf,CAAC,EAAtE,EAAyED,CAAC,CAACwa,KAAF,EAAzE;IAAmF,CAArK;EAAyK;;EAAA2D,cAAc,CAACne,CAAD,EAAGC,CAAH,EAAK;IAAC,IAAG,KAAK0V,SAAL,IAAgB3V,CAAC,CAAC0a,IAAlB,IAAwB,CAAC,KAAKvO,cAAjC,EAAgD;IAAO,KAAKA,cAAL,GAAoB,CAAC,CAArB,EAAuB,KAAKoS,aAAL,EAAvB,EAA4C,KAAKS,+BAAL,EAA5C;IAAmF,IAAI9e,CAAC,GAAC,CAAC,CAAP;;IAAS,OAAK,CAACF,CAAC,CAAC0a,IAAR,GAAc;MAACxa,CAAC,GAAC,CAAC,CAAH;MAAK,IAAIE,CAAC,GAAC,CAAC,CAAP;MAAS,MAAMC,CAAC,GAAC,CAAC,KAAKoN,SAAL,CAAe4R,IAAf,CAAqBnf,CAAC,IAAE;QAAC,IAAGA,CAAC,CAACgb,kBAAF,CAAqBxR,EAAE,CAACgV,KAAxB,CAAH,EAAkC;UAAC,IAAG,CAACze,CAAJ,EAAM,OAAOC,CAAC,CAACma,gBAAF,CAAmB3Q,EAAE,CAACgV,KAAtB,GAA6B1e,CAAC,CAAC0a,IAAtC;UAA2C,KAAK4E,UAAL,CAAgBpf,CAAhB,GAAmBE,CAAC,GAAC,CAAC,CAAtB,EAAwBJ,CAAC,CAAC2d,YAAF,EAAxB;QAAyC,CAA7H,MAAkIzd,CAAC,CAACgb,kBAAF,CAAqBxR,EAAE,CAAC0Q,KAAxB,MAAiC,KAAKmF,UAAL,CAAgBrf,CAAhB,GAAmBE,CAAC,GAAC,CAAC,CAAtB,EAAwBJ,CAAC,CAAC2d,YAAF,EAAzD;;QAA2E,OAAM,CAAC3d,CAAC,CAAC0a,IAAH,IAASxa,CAAC,CAACgb,kBAAF,CAAqBxR,EAAE,CAAC2R,UAAxB,CAAT,KAA+C,KAAKqB,iBAAL,CAAuBxc,CAAvB,GAA0BF,CAAC,CAAC2d,YAAF,EAAzE,GAA2F3d,CAAC,CAAC0a,IAAnG;MAAwG,CAA9U,CAAT;;MAA0V,IAAGta,CAAC,KAAG,KAAKgM,eAAL,GAAqB,CAAC,CAAtB,EAAwB,KAAKD,cAAL,GAAoB,CAAC,CAAhD,CAAD,EAAoD9L,CAAvD,EAAyD;QAAC,IAAG,CAACD,CAAJ,EAAM;;QAAM,KAAKya,sBAAL,CAA4B,KAAK/E,SAAjC;MAA4C,CAAlH,MAAuH,KAAK3J,cAAL,GAAoB,CAAC,CAArB;IAAuB;;IAAAjM,CAAC,KAAG,KAAKiM,cAAL,GAAoB,CAAC,CAAxB,CAAD,EAA4B,KAAK+S,gCAAL,EAA5B,EAAoE,KAAKhB,UAAL,CAAgBle,CAAhB,CAApE;EAAuF;;EAAAqe,gBAAgB,CAACre,CAAD,EAAG;IAAC,OAAO,KAAKgf,+BAAL,IAAuC,KAAKvR,SAAL,CAAe4R,IAAf,CAAqBpf,CAAC,KAAGA,CAAC,CAACib,kBAAF,CAAqBxR,EAAE,CAACyR,QAAxB,MAAoC,KAAKnB,mBAAL,CAAyB/Z,CAAzB,GAA4B,KAAKsd,kBAAL,CAAwBtd,CAAxB,EAA0BD,CAA1B,CAA5B,EAAyDA,CAAC,CAAC2d,YAAF,EAA7F,GAA+G3d,CAAC,CAAC0a,IAApH,CAAtB,CAAvC,EAAyL,KAAKwE,gCAAL,EAAzL,EAAiOlf,CAAC,CAACwf,aAA1O;EAAwP;;EAAAlB,eAAe,CAACte,CAAD,EAAG;IAAC,OAAO,KAAKyN,SAAL,CAAe4R,IAAf,CAAqBpf,CAAC,KAAG,KAAKsd,kBAAL,CAAwBtd,CAAxB,EAA0BD,CAA1B,GAA6BA,CAAC,CAAC0a,IAAlC,CAAtB,GAAgE1a,CAAC,CAACwf,aAAzE;EAAuF;;EAAA5L,qBAAqB,GAAE;IAAC,KAAK7D,gBAAL,KAAwB,KAAK0P,uBAAL,CAA6B3U,EAAE,CAAC4U,MAAhC,GAAwC,KAAKpQ,cAAL,CAAoBqK,iBAApB,EAAxC,EAAgF,KAAK7G,gBAAL,EAAxG;EAAiI;;EAAW,IAAPG,OAAO,GAAE;IAAC,MAAMjT,CAAC,GAAC,KAAKuO,IAAL,CAAUK,kBAAV,CAA6BE,gBAA7B,CAA8CqE,YAAtD;IAAmE,OAAO,KAAK5E,IAAL,CAAUgF,eAAV,CAA0BC,YAA1B,CAAuCP,OAAvC,GAA+C,CAAC,IAAEjT,CAAH,IAAMqH,EAA5D;EAA+D;;EAAAmQ,yBAAyB,CAACxX,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,KAAK2S,YAAL,CAAkB+M,MAA1B;IAAA,MAAiCzf,CAAC,GAACQ,CAAC,CAACV,CAAC,GAAC,KAAKiT,OAAR,EAAgB,CAAhB,EAAkBhT,CAAC,CAAC8W,MAAF,GAAS,CAA3B,CAApC;IAAA,MAAkE3W,CAAC,GAACF,CAAC,GAACwU,IAAI,CAACkL,KAAL,CAAW1f,CAAX,CAAtE;IAAoF,OAAOD,CAAC,CAACyU,IAAI,CAACkL,KAAL,CAAW1f,CAAX,CAAD,CAAD,CAAiBmU,KAAjB,IAAwB,IAAEjU,CAA1B,IAA6BH,CAAC,CAACyU,IAAI,CAACmL,IAAL,CAAU3f,CAAV,CAAD,CAAD,CAAgBmU,KAAhB,GAAsBjU,CAA1D;EAA4D;;EAAA0T,eAAe,GAAE;IAAC5S,CAAC,CAAC,KAAK4U,SAAN,CAAD,KAAoB,KAAKA,SAAL,CAAe/B,OAAf,CAAwB/T,CAAC,IAAE,KAAKuZ,UAAL,CAAgBvZ,CAAhB,EAAkB,CAAC,CAAnB,CAA3B,GAAmD,KAAK0Z,aAAL,CAAmB,IAAnB,CAAnD,EAA4E,KAAKE,YAAL,CAAkB,OAAlB,CAAhG,GAA4H,KAAKnM,SAAL,CAAe+M,KAAf,EAA5H,EAAmJ,KAAKlE,OAAL,GAAa,CAAC,CAAjK;EAAmK;;EAAAwJ,qBAAqB,CAAC9f,CAAD,EAAG;IAAC,IAAGA,CAAC,CAACoX,MAAL,EAAY,OAAM,CAAC,CAAP;IAAS,IAAInX,CAAC,GAAC,CAAC,CAAP;;IAAS,KAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgB,EAAEA,CAAlB,EAAoBD,CAAC,GAAC,KAAKsZ,UAAL,CAAgBvZ,CAAC,CAACqX,QAAF,CAAWnX,CAAX,CAAhB,EAA8B,CAAC,CAA/B,KAAmCD,CAArC;;IAAuC,OAAOD,CAAC,CAAC+f,aAAF,IAAkB9f,CAAzB;EAA2B;;EAAAsZ,UAAU,CAACvZ,CAAD,EAAGC,CAAH,EAAK;IAAC,MAAMC,CAAC,GAAC,KAAK4f,qBAAL,CAA2B9f,CAA3B,KAA+BA,CAAC,CAACmX,QAAzC;IAAkD,OAAO,KAAK1J,SAAL,CAAeuS,eAAf,CAA+BhgB,CAA/B,GAAkC,KAAKigB,WAAL,CAAiBjgB,CAAjB,CAAlC,EAAsDC,CAAC,IAAE,KAAKga,uCAAL,CAA6Cja,CAA7C,CAAzD,EAAyG,KAAK6O,SAAL,CAAe/C,OAAf,CAAuB9L,CAAvB,CAAzG,EAAmIE,CAA1I;EAA4I;;EAAA+f,WAAW,CAACjgB,CAAD,EAAG;IAAC,KAAKgO,uBAAL,IAA8B,KAAKC,qBAAL,CAA2BmP,MAA3B,CAAkCpd,CAAlC,CAA9B,EAAmEA,CAAC,CAACkgB,MAAF,CAAS,KAAK1Q,SAAd,CAAnE;EAA4F;;EAAA+P,UAAU,CAACvf,CAAD,EAAG;IAAC2H,EAAE,CAAC3H,CAAC,CAACoX,MAAH,EAAU,uDAAV,CAAF;IAAqE,MAAMnX,CAAC,GAACD,CAAC,CAACyX,KAAF,GAAQ,CAAhB;IAAA,MAAkBvX,CAAC,GAAC,IAAEF,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAtB;IAAA,MAA+B7Y,CAAC,GAAC,IAAEJ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAnC;IAA4CjZ,CAAC,CAACmgB,WAAF,CAAc,KAAKC,WAAL,CAAiBngB,CAAjB,EAAmBC,CAAnB,EAAqBE,CAArB,EAAuBJ,CAAvB,CAAd,EAAwC,KAAKogB,WAAL,CAAiBngB,CAAjB,EAAmBC,CAAnB,EAAqBE,CAAC,GAAC,CAAvB,EAAyBJ,CAAzB,CAAxC,EAAoE,KAAKogB,WAAL,CAAiBngB,CAAjB,EAAmBC,CAAC,GAAC,CAArB,EAAuBE,CAAvB,EAAyBJ,CAAzB,CAApE,EAAgG,KAAKogB,WAAL,CAAiBngB,CAAjB,EAAmBC,CAAC,GAAC,CAArB,EAAuBE,CAAC,GAAC,CAAzB,EAA2BJ,CAA3B,CAAhG,GAA+HA,CAAC,CAACqa,gBAAF,CAAmB3Q,EAAE,CAAC2R,UAAtB,CAA/H,EAAiKrb,CAAC,CAAC2e,qBAAF,EAAjK,EAA2L,KAAKlR,SAAL,CAAe4S,SAAf,CAAyBrgB,CAAC,CAACqX,QAA3B,CAA3L,EAAgO,KAAKlL,cAAL,GAAoB,CAAC,CAArP,EAAuP,KAAKmU,oBAAL,CAA0BtgB,CAA1B,EAA4BC,CAA5B,CAAvP,EAAsR,EAAE,KAAKsM,gBAAL,CAAsBgU,QAA9S;EAAuT;;EAAAD,oBAAoB,CAACtgB,CAAD,EAAGC,CAAC,GAACD,CAAC,CAACyX,KAAP,EAAa;IAAC+I,EAAE,CAACzQ,gBAAH,GAAoB,KAAKA,gBAAzB,EAA0CyQ,EAAE,CAAC3N,MAAH,GAAU7S,CAAC,CAAC6S,MAAtD,EAA6D2N,EAAE,CAACnM,KAAH,GAAS,KAAKmD,yBAAL,CAA+BvX,CAA/B,CAAtE,EAAwG,KAAKyb,IAAL,CAAU,cAAV,EAAyB8E,EAAzB,CAAxG;EAAqI;;EAAAJ,WAAW,CAACpgB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAACuH,EAAE,CAAC,CAAC,CAACvH,CAAH,EAAK,0BAAL,CAAF;;IAAmC,MAAMC,CAAC,GAAC,KAAKoY,YAAL,CAAkBzY,CAAlB,EAAoBC,CAApB,EAAsBC,CAAtB,EAAwBE,CAAxB,CAAR;;IAAmC,OAAOC,CAAC,CAAC4a,oBAAF,CAAuB,KAAKpI,MAA5B,GAAoCxS,CAAC,CAACoe,QAAF,KAAape,CAAC,CAACkb,iBAAF,CAAoB,KAAKvO,qBAAzB,GAAgD3M,CAAC,CAAC8Z,WAAF,CAAc,KAAKtN,YAAnB,EAAgC,KAAKF,eAArC,EAAqD,KAAKuG,WAA1D,MAAyExJ,EAAE,CAAC0Q,KAA5E,IAAmF/Z,CAAC,CAACga,gBAAF,CAAmB3Q,EAAE,CAAC0Q,KAAtB,CAAhJ,CAApC,EAAkN/Z,CAAzN;EAA2N;;EAAAif,UAAU,CAACtf,CAAD,EAAG;IAAC2H,EAAE,CAAC,CAAC3H,CAAC,CAACygB,gBAAF,CAAmB/W,EAAE,CAAC0Q,KAAtB,CAAF,EAA+B,yBAA/B,CAAF,EAA4D,KAAK0F,qBAAL,CAA2B9f,CAA3B,MAAgC2H,EAAE,CAAC,CAAC3H,CAAC,CAAC4W,UAAJ,EAAe,yBAAf,CAAF,EAA4C,KAAK0D,SAAL,CAAeta,CAAf,CAA5C,EAA8D,KAAKia,uCAAL,CAA6Cja,CAA7C,CAA9D,EAA8G,KAAKgO,uBAAL,IAA8B,KAAK0S,oCAAL,CAA0C1gB,CAA1C,CAA5K,CAA5D,EAAsR,KAAKmM,cAAL,GAAoB,CAAC,CAA3S,EAA6S,EAAE,KAAKI,gBAAL,CAAsBoU,SAArU,EAA+U,KAAKL,oBAAL,CAA0BtgB,CAA1B,CAA/U;EAA4W;;EAAA0gB,oCAAoC,CAAC1gB,CAAD,EAAG;IAACA,CAAC,CAACua,2BAAF,IAAgC,KAAKuC,iCAAL,CAAuC9c,CAAvC,CAAhC;EAA0E;;EAAA8c,iCAAiC,CAAC9c,CAAD,EAAG;IAACmJ,EAAE,IAAEnJ,CAAC,CAAC4gB,eAAF,CAAmB5gB,CAAC,IAAE,CAAC,CAACA,CAAC,CAAC6Z,QAAJ,KAAe7Z,CAAC,CAACua,2BAAF,IAAgC,CAAC,CAAhD,CAAtB,CAAJ;EAA+E;;EAAAsC,aAAa,CAAC7c,CAAD,EAAG;IAAC,KAAKgO,uBAAL,IAA8B,KAAK0S,oCAAL,CAA0C1gB,CAA1C,CAA9B,EAA2E2H,EAAE,CAAC3H,CAAC,CAACmX,QAAH,EAAY,2BAAZ,CAA7E,EAAsH,KAAK8I,WAAL,CAAiBjgB,CAAjB,CAAtH;IAA0I,MAAMC,CAAC,GAACD,CAAC,CAACqX,QAAV;IAAmBpX,CAAC,CAAC8T,OAAF,CAAW/T,CAAC,IAAE,KAAK8Z,kBAAL,CAAwB9Z,CAAxB,CAAd,GAA2CC,CAAC,CAAC8T,OAAF,CAAW/T,CAAC,IAAE,KAAK6gB,iBAAL,CAAuB7gB,CAAvB,CAAd,CAA3C,EAAqF,KAAKia,uCAAL,CAA6Cja,CAA7C,EAA+CA,CAAC,CAACyX,KAAF,GAAQ,CAAvD,CAArF,EAA+I,KAAKzJ,uBAAL,KAA+B/N,CAAC,CAAC8T,OAAF,CAAW/T,CAAC,IAAEA,CAAC,CAACmf,wCAAF,EAAd,GAA6Dlf,CAAC,CAAC8T,OAAF,CAAW/T,CAAC,IAAEA,CAAC,CAACua,2BAAF,EAAd,CAA7D,EAA6G,KAAKuC,iCAAL,CAAuC9c,CAAvC,CAA5I,CAA/I;EAAsU;;EAAAgd,WAAW,CAAChd,CAAD,EAAG;IAAC,KAAKgO,uBAAL,IAA8B,KAAK0S,oCAAL,CAA0C1gB,CAA1C,CAA9B;IAA2E,MAAMC,CAAC,GAACD,CAAC,CAAC8gB,MAAV;IAAiB,KAAKC,eAAL,CAAqB9gB,CAArB,GAAwB,KAAKqa,SAAL,CAAera,CAAf,CAAxB,EAA0C,KAAKga,uCAAL,CAA6Cha,CAA7C,CAA1C,EAA0F,KAAK+N,uBAAL,IAA8B,KAAK0S,oCAAL,CAA0CzgB,CAA1C,CAAxH;EAAqK;;EAAA8gB,eAAe,CAAC/gB,CAAD,EAAG;IAAC,IAAG,CAACA,CAAC,CAACoX,MAAN,EAAa,KAAI,IAAInX,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgB,EAAEA,CAAlB,EAAoB;MAAC,MAAMC,CAAC,GAACF,CAAC,CAACqX,QAAF,CAAWpX,CAAX,CAAR;MAAsB,KAAK8gB,eAAL,CAAqB7gB,CAArB,GAAwB,KAAK+f,WAAL,CAAiB/f,CAAjB,CAAxB;IAA4C;EAAC;;EAAA8gB,aAAa,CAAChhB,CAAD,EAAG;IAACA,CAAC,CAACqa,gBAAF,CAAmB3Q,EAAE,CAAC2R,UAAtB,GAAkC,KAAKkD,aAAL,EAAlC,EAAuD,KAAKpS,cAAL,GAAoB,CAAC,CAA5E,EAA8E,KAAKmD,cAAL,IAAqB,KAAKA,cAAL,CAAoB2R,WAAzC,IAAsD,KAAK3R,cAAL,CAAoB4R,iBAApB,CAAsClhB,CAAtC,CAApI,EAA6K,KAAKmd,gBAAL,CAAsBnd,CAAtB,CAA7K;EAAsM;;EAAAsa,SAAS,CAACta,CAAD,EAAG;IAACA,CAAC,CAACmhB,IAAF,CAAO,KAAK3R,SAAZ,GAAuB,KAAKwR,aAAL,CAAmBhhB,CAAnB,CAAvB;EAA6C;;EAAA6gB,iBAAiB,CAAC7gB,CAAD,EAAG;IAACA,CAAC,CAACohB,YAAF,CAAe,KAAK5R,SAApB,GAA+B,KAAKwR,aAAL,CAAmBhhB,CAAnB,CAA/B;EAAqD;;EAAA8Z,kBAAkB,CAAC9Z,CAAD,EAAG;IAACA,CAAC,CAACqhB,aAAF,CAAgB,KAAK7R,SAArB;EAAgC;;EAAA8R,qBAAqB,CAACthB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAO;IAAC,MAAME,CAAC,GAAC,IAAIwF,EAAJ,CAAO5F,CAAC,CAACiZ,GAAT,EAAajZ,CAAC,CAAC6S,MAAf,EAAsB3S,CAAtB,CAAR;IAAiCF,CAAC,CAACuhB,WAAF,CAActhB,CAAd,EAAgBkG,EAAE,CAACgM,SAAnB,EAA6B/R,CAA7B;;IAAgC,MAAMC,CAAC,GAAC,CAACL,CAAD,CAAR;IAAA,MAAYM,CAAC,GAACN,CAAC,CAACyX,KAAhB;IAAA,MAAsBlX,CAAC,GAAC,KAAKqL,aAAL,CAAmB8M,OAAnB,EAAxB;;IAAqD,KAAInY,CAAC,CAACka,KAAF,CAAQpa,CAAR,CAAJ,EAAe,CAACE,CAAC,CAACma,IAAlB,GAAwB;MAAC,MAAM1a,CAAC,GAACO,CAAC,CAACoa,IAAF,EAAR;MAAiB3a,CAAC,CAACwhB,2BAAF,CAA8BvhB,CAA9B,EAAgCK,CAAhC,GAAmCN,CAAC,CAACyhB,sBAAF,EAAnC;IAA8D;;IAAAlhB,CAAC,CAACsL,MAAF,IAAW,KAAKgP,sBAAL,CAA4Bxa,CAA5B,CAAX;EAA0C;;EAAAgQ,uBAAuB,CAACrQ,CAAC,GAACoL,EAAH,EAAM;IAAC,IAAG,CAAC,KAAKiD,gBAAT,EAA0B;IAAO,KAAKA,gBAAL,GAAsB,CAAC,CAAvB;IAAyB,IAAIpO,CAAC,GAAC,CAAC,CAAP;IAAS,MAAMC,CAAC,GAAC,IAAIgO,GAAJ,EAAR;IAAgB,IAAI9N,CAAC,GAAC,CAAC,CAAP;;IAAS,KAAI,MAAMC,CAAV,IAAe,KAAKkO,IAAL,CAAUkD,aAAV,CAAwBiQ,KAAvC,EAA6C,IAAGxhB,CAAC,CAACmP,GAAF,CAAMhP,CAAC,CAACshB,GAAR,GAAa5Z,EAAE,CAAC1H,CAAD,CAAlB,EAAsB,IAAG,KAAKgN,wBAAL,CAA8BuU,GAA9B,CAAkCvhB,CAAC,CAACshB,GAApC,CAAH,EAA4C;MAAC,MAAM3hB,CAAC,GAAC,KAAK6hB,wBAAL,CAA8BxhB,CAA9B,CAAR;MAAA,MAAyCH,CAAC,GAAC,KAAK4hB,iBAAL,CAAuB9hB,CAAvB,EAAyBK,CAAC,CAACshB,GAA3B,CAA3C;;MAA2EzgB,CAAC,CAAChB,CAAD,CAAD,KAAO,CAACA,CAAC,GAACE,CAAF,IAAKY,CAAC,CAACZ,CAAD,CAAP,MAAcH,CAAC,GAAC,CAAC,CAAjB,GAAoBG,CAAC,GAACF,CAA7B;IAAgC,CAAxJ,MAA6J,KAAK6hB,uBAAL,CAA6B1hB,CAA7B,GAAgCA,CAAC,CAAC2hB,KAAF,CAAQC,MAAR,KAAiBhiB,CAAC,GAAC,CAAC,CAApB,CAAhC;;IAAuD,KAAKoN,wBAAL,CAA8B0G,OAA9B,CAAuC,CAAC/T,CAAD,EAAGI,CAAH,KAAO;MAACF,CAAC,CAAC0hB,GAAF,CAAMxhB,CAAN,MAAW,KAAK4T,yBAAL,CAA+B5T,CAA/B,GAAkCH,CAAC,GAAC,CAAC,CAAhD;IAAmD,CAAlG,GAAqGA,CAAC,IAAE,KAAKoY,kBAAL,EAAxG,EAAkI,KAAK7I,SAAL,CAAewI,aAAf,GAA6B,KAAKC,4BAAL,EAA/J,EAAmM,KAAK1H,qBAAL,GAA2B,KAAK2R,sBAAL,EAA9N,EAA4PliB,CAAC,CAAC2d,YAAF,EAA5P;EAA6Q;;EAAA1F,4BAA4B,GAAE;IAAC,IAAIjY,CAAC,GAAC,MAAI,KAAKuO,IAAL,CAAU+C,GAAV,EAAe6Q,MAAf,EAAuBC,OAAjC;;IAAyC,KAAI,MAAMniB,CAAV,IAAe,KAAKsO,IAAL,CAAUkD,aAAV,CAAwBiQ,KAAvC,EAA6C,IAAGzZ,EAAE,CAAChI,CAAD,CAAF,IAAO,CAACsE,CAAC,CAACtE,CAAC,CAAC+hB,KAAH,CAAT,IAAoB,MAAI/hB,CAAC,CAACoiB,WAA7B,EAAyC,OAAOriB,CAAC,GAAC,CAAC,CAAH,EAAKA,CAAZ;;IAAc,OAAOA,CAAP;EAAS;;EAAAkiB,sBAAsB,GAAE;IAAC,KAAI,MAAMliB,CAAV,IAAe,KAAKuO,IAAL,CAAUkD,aAAV,CAAwBiQ,KAAvC,EAA6C,IAAGvZ,EAAE,CAACnI,CAAD,CAAL,EAAS;MAAC,MAAMC,CAAC,GAACoI,EAAE,CAACrI,CAAC,CAACgiB,KAAF,CAAQlB,MAAT,CAAF,GAAmB,QAAnB,GAA4B9gB,CAAC,CAACgiB,KAAF,CAAQM,SAA5C;MAAsD,IAAG5X,EAAE,CAACE,EAAE,CAAC3K,CAAD,CAAH,CAAL,EAAa,OAAM,CAAC,CAAP;IAAS;;IAAA,OAAM,CAAC,CAAP;EAAS;;EAAA4hB,wBAAwB,CAAC7hB,CAAD,EAAG;IAAC,OAAOuI,EAAE,CAACvI,CAAD,CAAF,GAAMmG,EAAE,CAACgM,SAAT,GAAmBhM,EAAE,CAACoc,GAA7B;EAAiC;;EAAAR,uBAAuB,CAAC/hB,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,EAAR;IAAA,MAAWC,CAAC,GAAC,KAAK2hB,wBAAL,CAA8B7hB,CAA9B,CAAb;;IAA8CC,CAAC,CAACuZ,IAAF,CAAO7X,CAAC,CAAE,MAAI3B,CAAC,CAAC2V,SAAR,EAAoB,MAAI,KAAK0C,kBAAL,EAAxB,CAAR,GAA6DpY,CAAC,CAACuZ,IAAF,CAAO7X,CAAC,CAAE,MAAI3B,CAAC,CAACqiB,WAAR,EAAsB,MAAI,KAAKnK,mBAAL,CAAyBjS,EAAE,CAACkS,OAA5B,CAA1B,CAAR,CAA7D,EAAuIlY,CAAC,CAACuZ,IAAF,CAAO7X,CAAC,CAAE,MAAI,yBAAwB3B,CAAC,CAACgiB,KAA1B,GAAgChiB,CAAC,CAACgiB,KAAF,CAAQQ,mBAAxC,GAA4D,IAAlE,EAAyE,MAAI,KAAKC,iBAAL,CAAuBviB,CAAvB,CAA7E,CAAR,CAAvI,EAAyPiI,EAAE,CAACnI,CAAD,CAAF,IAAOC,CAAC,CAACuZ,IAAF,CAAO7X,CAAC,CAAE,MAAI3B,CAAC,CAACgiB,KAAF,CAAQM,SAAd,EAA0B,MAAI;MAAC,KAAK/R,qBAAL,GAA2B,KAAK2R,sBAAL,EAA3B,EAAyD,KAAKhK,mBAAL,CAAyBjS,EAAE,CAACkS,OAA5B,CAAzD;IAA8F,CAA7H,CAAR,CAAhQ,EAAyYnY,CAAC,CAAC+S,EAAF,CAAK,cAAL,EAAqB,MAAI;MAAC,MAAM9S,CAAC,GAAC,KAAK6hB,iBAAL,CAAuB5hB,CAAvB,EAAyBF,CAAC,CAAC2hB,GAA3B,CAAR;;MAAwCzgB,CAAC,CAACjB,CAAD,CAAD,IAAM,KAAKyiB,oBAAL,CAA0BziB,CAA1B,EAA4BC,CAA5B,CAAN;IAAqC,CAAvG,CAAzY,EAAmf,KAAKmN,wBAAL,CAA8BsV,GAA9B,CAAkC3iB,CAAC,CAAC2hB,GAApC,EAAwC1hB,CAAxC,CAAnf;EAA8hB;;EAAA+T,yBAAyB,CAAChU,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,KAAKoN,wBAAL,CAA8BuV,GAA9B,CAAkC5iB,CAAlC,CAAR;;IAA6C,IAAGC,CAAH,EAAK;MAAC,KAAI,IAAID,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACC,CAAC,CAAC8W,MAAhB,EAAuB/W,CAAC,EAAxB,EAA2BC,CAAC,CAACD,CAAD,CAAD,CAAK6L,MAAL;;MAAc,KAAKwB,wBAAL,CAA8B+P,MAA9B,CAAqCpd,CAArC;IAAwC;EAAC;;EAAAqY,kBAAkB,GAAE;IAAC,IAAG,CAAC,KAAKzF,YAAN,IAAoB,KAAKrE,IAAL,CAAUoH,SAAjC,EAA2C;IAAO,MAAM3V,CAAC,GAAC,KAAKuO,IAAL,CAAUkD,aAAlB;IAAA,MAAgCxR,CAAC,GAAC,CAAC,EAAD,EAAI,EAAJ,CAAlC;IAA0C,IAAIC,CAAC,GAAC,IAAN;IAAWF,CAAC,CAAC+T,OAAF,CAAW/T,CAAC,IAAE;MAAC,IAAG,CAACA,CAAC,CAACgiB,KAAH,IAAUhiB,CAAC,CAAC2V,SAAZ,IAAuB,CAAC5N,EAAE,CAAC/H,CAAD,CAA1B,IAA+B,CAACA,CAAC,CAAC6iB,UAArC,EAAgD;;MAAO,MAAMziB,CAAC,GAAC,KAAKyhB,wBAAL,CAA8B7hB,CAA9B,CAAR;;MAAyC,IAAGI,CAAC,KAAG+F,EAAE,CAACoc,GAAV,EAAc;QAAC,MAAMtiB,CAAC,GAACD,CAAC,CAAC8iB,iBAAF,CAAoBC,QAA5B;QAAqC9iB,CAAC,KAAG,IAAE,CAAN,KAAU,SAAOC,CAAP,IAAUD,CAAC,GAACC,CAAtB,MAA2BA,CAAC,GAACD,CAA7B;MAAgC;;MAAAA,CAAC,CAACG,CAAD,CAAD,CAAKoZ,IAAL,CAAUxZ,CAAV;IAAa,CAAhN;;IAAmN,KAAI,MAAMI,CAAV,IAAeiG,EAAf,EAAkB;MAAC,MAAMrG,CAAC,GAAC,KAAKiN,WAAL,CAAiB7M,CAAjB,CAAR;MAAA,MAA4BF,CAAC,GAACD,CAAC,CAACG,CAAD,CAA/B;MAAmCF,CAAC,CAAC8iB,OAAF;MAAY,MAAM3iB,CAAC,GAACH,CAAC,CAAC6W,MAAV;MAAiB,IAAIzW,CAAC,GAACN,CAAC,CAAC+W,MAAF,KAAW1W,CAAjB;MAAmB,MAAME,CAAC,GAAC,IAAI2M,KAAJ,CAAU7M,CAAV,CAAR;MAAA,MAAqBG,CAAC,GAAC,IAAI0M,KAAJ,CAAUlN,CAAC,CAAC+W,MAAZ,CAAvB;;MAA2C,KAAK5J,gBAAL,CAAsB/M,CAAtB,EAAyBoa,KAAzB;;MAAiC,KAAI,IAAIva,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACI,CAAd,EAAgBJ,CAAC,EAAjB,EAAoB;QAAC,MAAMI,CAAC,GAACH,CAAC,CAACD,CAAD,CAAD,CAAK0hB,GAAb;;QAAiB,KAAKxU,gBAAL,CAAsB/M,CAAtB,EAAyBuiB,GAAzB,CAA6BtiB,CAA7B,EAA+BJ,CAA/B;;QAAkC,MAAMS,CAAC,GAACV,CAAC,CAACijB,OAAF,CAAU/iB,CAAC,CAACD,CAAD,CAAX,CAAR;QAAwBM,CAAC,CAACN,CAAD,CAAD,GAAKS,CAAL,EAAOT,CAAC,KAAGS,CAAJ,KAAQJ,CAAC,GAAC,CAAC,CAAX,CAAP,EAAqBI,CAAC,GAAC,CAAC,CAAH,KAAOF,CAAC,CAACE,CAAD,CAAD,GAAKT,CAAZ,CAArB;MAAoC;;MAAA,IAAGK,CAAH,EAAK;QAAC,MAAMN,CAAC,GAAC,KAAK+L,kBAAb;;QAAgC,KAAI/L,CAAC,CAACya,KAAF,CAAQ,KAAK3E,SAAb,CAAJ,EAA4B,CAAC9V,CAAC,CAAC0a,IAA/B,GAAqC1a,CAAC,CAAC2a,IAAF,GAASuI,YAAT,CAAsB1iB,CAAtB,EAAwBD,CAAxB,EAA0BH,CAA1B;;QAA6B,KAAK6M,WAAL,CAAiB7M,CAAjB,IAAoBF,CAApB,EAAsB,KAAKuiB,iBAAL,CAAuBriB,CAAvB,CAAtB,EAAgD,KAAKya,sBAAL,CAA4B,KAAK/E,SAAjC,CAAhD;MAA4F;IAAC;;IAAA,KAAKlD,YAAL,CAAkBuQ,YAAlB,CAA+BjjB,CAA/B,KAAmC,KAAK8S,iBAAL,EAAnC;EAA4D;;EAAAyP,iBAAiB,CAACziB,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,KAAK8L,kBAAb;;IAAgC,KAAI9L,CAAC,CAACwa,KAAF,CAAQ,KAAK3E,SAAb,CAAJ,EAA4B,CAAC7V,CAAC,CAACya,IAA/B,GAAqC;MAAC,MAAMxa,CAAC,GAACD,CAAC,CAAC0a,IAAF,EAAR;MAAiBza,CAAC,CAACkjB,aAAF,CAAgBpjB,CAAhB,GAAmBA,CAAC,KAAGmG,EAAE,CAACgM,SAAP,IAAkBjS,CAAC,CAACuhB,sBAAF,EAArC;IAAgE;EAAC;;EAAA4B,gBAAgB,CAACrjB,CAAD,EAAGC,CAAH,EAAK;IAAC,OAAO,KAAKgN,WAAL,CAAiBhN,CAAjB,EAAoBD,CAApB,CAAP;EAA8B;;EAAAsjB,SAAS,CAACtjB,CAAD,EAAG;IAAC,OAAO,KAAKiN,WAAL,CAAiBjN,CAAjB,EAAoB+W,MAA3B;EAAkC;;EAAAmB,mBAAmB,CAAClY,CAAD,EAAG;IAAC,KAAKyN,SAAL,CAAesM,MAAf,CAAuB9Z,CAAC,IAAE;MAACA,CAAC,CAAC4e,YAAF,CAAe1Y,EAAE,CAACoc,GAAlB,GAAuBviB,CAAC,KAAGiG,EAAE,CAACmS,SAAP,GAAiB,KAAKvI,QAAL,CAAc6N,iBAAd,CAAgCzd,CAAhC,EAAkCyJ,EAAE,CAAC+T,gBAArC,CAAjB,GAAwExd,CAAC,CAACsjB,gBAAF,CAAmBpd,EAAE,CAACoc,GAAtB,EAA0BviB,CAA1B,CAA/F;IAA4H,CAAvJ,GAA0J,KAAKwP,SAAL,CAAewI,aAAf,GAA6B,KAAKC,4BAAL,EAAvL;EAA2N;;EAAAyK,oBAAoB,CAAC1iB,CAAD,EAAGC,CAAH,EAAK;IAAC,KAAKwN,SAAL,CAAesM,MAAf,CAAuB7Z,CAAC,IAAEA,CAAC,CAACsjB,gBAAF,CAAmBxjB,CAAnB,EAAqBC,CAArB,CAA1B,GAAoD,KAAKwN,SAAL,CAAesM,MAAf,CAAuB7Z,CAAC,IAAEA,CAAC,CAACujB,mBAAF,CAAsBzjB,CAAtB,EAAwBC,CAAxB,CAA1B,CAApD;EAA2G;;EAAAmb,gBAAgB,GAAE;IAAC,KAAKjP,cAAL,GAAoB,CAAC,CAArB;EAAuB;;EAAAuX,aAAa,CAAC1jB,CAAC,GAAC8K,EAAE,CAAC4U,MAAN,EAAa;IAAC,KAAK7P,QAAL,CAAc8T,cAAd,CAA6B3jB,CAA7B;EAAgC;;EAAAue,aAAa,GAAE;IAAC,KAAG,EAAE,KAAKtS,eAAV,KAA4B,KAAKD,kBAAL,GAAwB,CAAC,CAArD;EAAwD;;EAAA4X,eAAe,CAAC5jB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,MAAMC,CAAC,GAAC,KAAKgjB,gBAAL,CAAsBpjB,CAAtB,EAAwBC,CAAxB,CAAR;IAAA,MAAmCI,CAAC,GAACD,CAAC,CAAC2hB,KAAvC;IAA6C,OAAM,CAAC1hB,CAAC,CAACujB,YAAH,IAAiBpb,EAAE,CAACpI,CAAD,CAAnB,GAAuB,KAAKyjB,gBAAL,CAAsB9jB,CAAtB,EAAwBE,CAAxB,EAA0BG,CAA1B,EAA4BD,CAA5B,CAAvB,IAAuD,EAAE,KAAK8L,eAAP,EAAuB5L,CAAC,CAACujB,YAAF,CAAeE,iBAAf,CAAiC/jB,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAjC,EAA0CjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAA1C,EAAmDjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAnD,EAA4D,EAAC,GAAG7Y,CAAJ;MAAM4jB,OAAO,EAAC;IAAd,CAA5D,EAAgF/S,IAAhF,CAAsF,MAAI,EAAE,KAAK/E,eAAjG,EAAmH+X,KAAnH,CAA0HhkB,CAAC,IAAE;MAAC,MAAK,EAAE,KAAKiM,eAAP,EAAuB7K,CAAC,CAACpB,CAAD,CAAD,IAAM,KAAKikB,YAAL,CAAkBlkB,CAAlB,EAAoBE,CAApB,EAAsBG,CAAtB,EAAwB;QAAC8jB,YAAY,EAAC,CAAC;MAAf,CAAxB,CAA7B,EAAwElkB,CAA7E;IAA+E,CAA7M,EAAgNgR,IAAhN,CAAsN,MAAI,KAAKzD,UAAL,CAAgB4W,QAAhB,CAA0B,MAAI,KAAKN,gBAAL,CAAsB9jB,CAAtB,EAAwBE,CAAxB,EAA0BG,CAA1B,EAA4BD,CAA5B,CAA9B,EAA8DA,CAAC,CAACikB,MAAhE,CAA1N,CAA9E,CAAN;EAAyX;;EAAAP,gBAAgB,CAAC9jB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,OAAOH,CAAC,KAAGkG,EAAE,CAACgM,SAAP,GAAiB5J,EAAE,CAACrI,CAAD,CAAF,GAAM,KAAKokB,yBAAL,CAA+BtkB,CAA/B,EAAiCE,CAAjC,EAAmCE,CAAnC,CAAN,GAA4CmkB,OAAO,CAACC,MAAR,EAA7D,GAA8Evc,EAAE,CAAC/H,CAAD,CAAF,GAAM,KAAKukB,mBAAL,CAAyBzkB,CAAzB,EAA2BE,CAA3B,EAA6BE,CAA7B,CAAN,GAAsCmkB,OAAO,CAACC,MAAR,EAA3H;EAA4I;;EAAAF,yBAAyB,CAACtkB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAO;IAAC,EAAE,KAAKgM,eAAP;;IAAuB,MAAM9L,CAAC,GAACA,CAAC,IAAE;MAAC,IAAGmB,CAAC,CAACrB,CAAD,CAAJ,EAAQ;;MAAO,MAAMG,CAAC,GAAC,KAAK8M,gBAAL,CAAsBhH,EAAE,CAACgM,SAAzB,EAAoCyQ,GAApC,CAAwC3iB,CAAC,CAAC0hB,GAA1C,CAAR;;MAAuD,QAAMthB,CAAN,IAAS,KAAKiM,WAAL,GAAiB,IAAjB,EAAsB,KAAKiS,aAAL,EAAtB,EAA2C,KAAK+C,qBAAL,CAA2BthB,CAA3B,EAA6BK,CAA7B,EAA+BD,CAA/B,CAApD,IAAuFiL,EAAE,CAAC2N,IAAH,CAAQ,wDAAR,EAAiE7S,EAAE,CAACgM,SAApE,EAA8EnS,CAAC,CAACiZ,GAAF,CAAMyL,QAAN,EAA9E,CAAvF;IAAuL,CAAzQ;IAAA,MAA0QrkB,CAAC,GAACH,CAAC,IAAE;MAACmB,CAAC,CAACnB,CAAD,CAAD,KAAO,KAAKgkB,YAAL,CAAkBlkB,CAAlB,EAAoBmG,EAAE,CAACgM,SAAvB,EAAiClS,CAAjC,EAAmCC,CAAnC,GAAsC,KAAKqe,aAAL,EAA7C;IAAmE,CAAnV;;IAAoV,IAAG5V,EAAE,CAAC1I,CAAC,CAAC+hB,KAAH,CAAL,EAAe,OAAO/hB,CAAC,CAAC+hB,KAAF,CAAQ2C,SAAR,CAAkB3kB,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAlB,EAA2BjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAA3B,EAAoCjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAApC,EAA6C;MAAC2L,WAAW,EAACrd,EAAb;MAAgB8c,MAAM,EAACnkB,CAAC,CAACmkB;IAAzB,CAA7C,EAA+EpT,IAA/E,CAAqFjR,CAAC,IAAE;MAAC,IAAG,CAACuB,CAAC,CAACrB,CAAD,CAAL,EAAS,OAAO,KAAKsN,UAAL,CAAgB4W,QAAhB,CAA0B,MAAIhkB,CAAC,CAACJ,CAAD,CAA/B,EAAoCE,CAAC,CAACmkB,MAAtC,EAA6ChkB,CAA7C,CAAP;MAAuDgL,EAAE,CAACwZ,QAAH,CAAY,mIAAZ;IAAiJ,CAA1S,EAA4SxkB,CAA5S,EAA+SykB,OAA/S,CAAwT,MAAI;MAAC,EAAE,KAAK5Y,eAAP;IAAuB,CAApV,CAAP;IAA8V,MAAM5L,CAAC,GAACL,CAAC,CAAC8kB,UAAF,CAAa/kB,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAb,EAAsBjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAtB,EAA+BjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAA/B,CAAR;IAAiD,OAAO,KAAKhH,uBAAL,CAA6B+S,OAA7B,CAAqC1kB,CAArC,EAAuC,QAAvC,EAAgDJ,CAAhD,EAAmD+Q,IAAnD,CAAyDjR,CAAC,IAAE,KAAK2O,YAAL,CAAkBsW,MAAlB,CAAyBjlB,CAAzB,EAA2B;MAAC4kB,WAAW,EAACrd;IAAb,CAA3B,EAA4CrH,CAAC,CAACmkB,MAA9C,CAA5D,EAAoHpT,IAApH,CAA0HjR,CAAC,IAAE;MAACA,CAAC,GAACI,CAAC,CAAC;QAAC8kB,MAAM,EAACllB,CAAC,CAACmlB,SAAV;QAAoBlJ,KAAK,EAACjc,CAAC,CAACic,KAA5B;QAAkCE,MAAM,EAACnc,CAAC,CAACmc,MAA3C;QAAkDyI,WAAW,EAAC5kB,CAAC,CAAC4kB,WAAhE;QAA4EQ,QAAQ,EAACplB,CAAC,CAAColB,QAAvF;QAAgGC,QAAQ,EAACrlB,CAAC,CAACqlB;MAA3G,CAAD,CAAF,GAAyHhlB,CAAC,CAAC,IAAIilB,KAAJ,CAAU,sBAAV,CAAD,CAA3H;IAA+J,CAA7R,EAA+RjlB,CAA/R,EAAkSykB,OAAlS,CAA2S,MAAI;MAAC,EAAE,KAAK5Y,eAAP;IAAuB,CAAvU,CAAP;EAAiV;;EAAAuY,mBAAmB,CAACzkB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAO;IAAC,EAAE,KAAKgM,eAAP;;IAAuB,MAAM9L,CAAC,GAAC,CAACA,CAAD,EAAGC,CAAH,KAAO;MAAC,EAAE,KAAK6L,eAAP,EAAuBjD,EAAE,CAAC5I,CAAD,CAAzB,EAA6BkB,CAAC,CAACrB,CAAD,CAAD,KAAO,KAAKgkB,YAAL,CAAkBlkB,CAAlB,EAAoBmG,EAAE,CAACoc,GAAvB,EAA2BtiB,CAA3B,EAA6BG,CAA7B,GAAgC,KAAKme,aAAL,EAAvC,CAA7B;IAA0F,CAA1G;IAAA,MAA2Gle,CAAC,GAACL,CAAC,IAAEC,CAAC,IAAEG,CAAC,CAACH,CAAD,EAAGD,CAAH,CAApH;IAAA,MAA0HM,CAAC,GAACF,CAAC,IAAE,KAAKoN,UAAL,CAAgB4W,QAAhB,CAA0B,MAAI;MAAC,EAAE,KAAKlY,eAAP,EAAuB,KAAKqS,aAAL,EAAvB,EAA4Chd,CAAC,CAACrB,CAAD,CAAD,GAAK+I,EAAE,CAAC7I,CAAD,CAAP,GAAW,KAAKmlB,mBAAL,CAAyBvlB,CAAzB,EAA2BC,CAA3B,EAA6BG,CAA7B,CAAvD;IAAuF,CAAtH,EAAwHF,CAAC,CAACmkB,MAA1H,EAAiIhkB,CAAC,CAACD,CAAD,CAAlI,EAAuI6jB,KAAvI,CAA6I5jB,CAAC,CAACD,CAAD,CAA9I,CAA/H;IAAA,MAAkRG,CAAC,GAAC,CAACP,CAAD,EAAGC,CAAC,GAAC,IAAL,KAAY,KAAKuN,UAAL,CAAgB4W,QAAhB,CAA0B,MAAIhkB,CAAC,CAACJ,CAAD,EAAGC,CAAH,CAA/B,CAAhS;;IAAuU,IAAGwI,EAAE,CAACxI,CAAD,CAAL,EAAS;MAAC,MAAMG,CAAC,GAACH,CAAC,CAACulB,YAAF,CAAeC,iBAAf,CAAiCzlB,CAAC,CAACiZ,GAAnC,CAAR;MAAgD,OAAOhZ,CAAC,CAAC0kB,SAAF,CAAYvkB,CAAC,CAAC,CAAD,CAAb,EAAiBA,CAAC,CAAC,CAAD,CAAlB,EAAsBA,CAAC,CAAC,CAAD,CAAvB,EAA2BF,CAA3B,EAA8B+Q,IAA9B,CAAmC3Q,CAAnC,EAAqCC,CAArC,CAAP;IAA+C;;IAAA,IAAGsI,EAAE,CAAC5I,CAAD,CAAL,EAAS,OAAOA,CAAC,CAAC0kB,SAAF,CAAY3kB,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAZ,EAAqBjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAArB,EAA8BjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAA9B,EAAuC/Y,CAAvC,EAA0C+Q,IAA1C,CAA+C3Q,CAA/C,EAAiDC,CAAjD,CAAP;IAA2D,IAAGwI,EAAE,CAAC9I,CAAD,CAAF,IAAO0I,EAAE,CAAC1I,CAAC,CAAC+hB,KAAH,CAAZ,EAAsB,OAAO/hB,CAAC,CAAC+hB,KAAF,CAAQ2C,SAAR,CAAkB3kB,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAlB,EAA2BjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAA3B,EAAoCjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAApC,EAA6C/Y,CAA7C,EAAgD+Q,IAAhD,CAAsDjR,CAAC,IAAE;MAAC,IAAGuB,CAAC,CAACrB,CAAD,CAAJ,EAAQ,OAAOmL,EAAE,CAACwZ,QAAH,CAAY,mIAAZ,GAAiJ,KAAKtkB,CAAC,CAACkB,CAAC,EAAF,CAA9J;MAAoKnB,CAAC,CAACN,CAAD,CAAD;IAAK,CAA3O,EAA6OO,CAA7O,CAAP;IAAuP,IAAIC,CAAC,GAACP,CAAC,CAAC8kB,UAAF,CAAa/kB,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAb,EAAsBjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAAtB,EAA+BjZ,CAAC,CAACiZ,GAAF,CAAM,CAAN,CAA/B,CAAN;IAA+C9U,CAAC,CAAClE,CAAC,CAAC+hB,KAAH,CAAD,IAAY/hB,CAAC,CAAC+hB,KAAF,CAAQ0D,gBAApB,KAAuCllB,CAAC,IAAG,GAAEA,CAAC,CAACmlB,QAAF,CAAW,GAAX,IAAgB,GAAhB,GAAoB,GAAI,OAAM1lB,CAAC,CAAC+hB,KAAF,CAAQ0D,gBAAiB,EAApG;IAAuG,MAAMhlB,CAAC,GAACT,CAAC,CAAC2lB,oBAAF,GAAuB,YAAvB,GAAoC,OAA5C;IAAoD,OAAO,KAAKxT,iBAAL,CAAuB4S,OAAvB,CAA+BxkB,CAA/B,EAAiCE,CAAjC,EAAmCR,CAAnC,EAAsC+Q,IAAtC,CAA2C3Q,CAA3C,EAA6CC,CAA7C,CAAP;EAAuD;;EAAAglB,mBAAmB,CAACvlB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAO;IAAC,MAAME,CAAC,GAAC,KAAK0hB,iBAAL,CAAuB3b,EAAE,CAACoc,GAA1B,EAA8BtiB,CAAC,CAAC0hB,GAAhC,CAAR;;IAA6CzgB,CAAC,CAACd,CAAD,CAAD,GAAKJ,CAAC,CAACuhB,WAAF,CAAcnhB,CAAd,EAAgB+F,EAAE,CAACoc,GAAnB,EAAuBriB,CAAvB,CAAL,IAAgC+I,EAAE,CAAC/I,CAAD,CAAF,EAAMmL,EAAE,CAAC2N,IAAH,CAAQ,kDAAR,CAAtC;EAAmG;;EAAA8I,iBAAiB,CAAC9hB,CAAD,EAAGC,CAAH,EAAK;IAAC,OAAO,KAAKkN,gBAAL,CAAsBnN,CAAtB,EAAyB4iB,GAAzB,CAA6B3iB,CAA7B,CAAP;EAAuC;;EAAAikB,YAAY,CAAClkB,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAAS;IAAC,MAAMC,CAAC,GAAC,KAAKyhB,iBAAL,CAAuB7hB,CAAvB,EAAyBC,CAAC,CAACyhB,GAA3B,CAAR;;IAAwCzgB,CAAC,CAACb,CAAD,CAAD,GAAKL,CAAC,CAAC6lB,WAAF,CAAcxlB,CAAd,EAAgBJ,CAAhB,EAAkBG,CAAlB,CAAL,GAA0BiL,EAAE,CAAC2N,IAAH,CAAQ,kDAAR,CAA1B;EAAsF;;EAAAyG,uBAAuB,CAACzf,CAAD,EAAG;IAAC,KAAK8V,SAAL,IAAgB,KAAKxG,cAArB,KAAsC,KAAK7B,SAAL,CAAesM,MAAf,CAAuB/Z,CAAC,IAAE;MAACA,CAAC,CAAC4W,UAAF,IAAc,KAAKtH,cAAL,CAAoB4R,iBAApB,CAAsClhB,CAAtC,CAAd;IAAuD,CAAlF,GAAqF,KAAKwP,SAAL,CAAemU,cAAf,CAA8B3jB,CAA9B,CAA3H;EAA6J;;EAAmB,IAAf8lB,eAAe,GAAE;IAAC,MAAM9lB,CAAC,GAAC,KAAKuM,gBAAb;IAA8B,OAAOvM,CAAC,CAAC+lB,QAAF,GAAW,KAAKtY,SAAL,CAAesJ,MAA1B,EAAiC/W,CAAC,CAACgmB,SAAF,GAAYhmB,CAAC,CAACimB,UAAF,GAAajmB,CAAC,CAACkmB,WAAF,GAAclmB,CAAC,CAACmmB,iBAAF,CAAoBpP,MAApB,GAA2B/W,CAAC,CAAComB,mBAAF,CAAsBrP,MAAtB,GAA6B,CAAhI,EAAkI,KAAKtJ,SAAL,CAAesM,MAAf,CAAuB9Z,CAAC,IAAE;MAACA,CAAC,CAACmX,MAAF,IAAUpX,CAAC,CAACgmB,SAAF,EAAV;MAAwB,MAAM9lB,CAAC,GAACD,CAAC,CAACwX,KAAV;MAAgBxX,CAAC,CAAC2W,UAAF,KAAe5W,CAAC,CAACmmB,iBAAF,CAAoBjmB,CAApB,IAAuB,CAACF,CAAC,CAACmmB,iBAAF,CAAoBjmB,CAApB,KAAwB,CAAzB,IAA4B,CAAlE,GAAqED,CAAC,CAACqW,OAAF,KAAYtW,CAAC,CAACimB,UAAF,IAAehmB,CAAC,CAACkX,QAAF,KAAanX,CAAC,CAAComB,mBAAF,CAAsBlmB,CAAtB,IAAyB,CAACF,CAAC,CAAComB,mBAAF,CAAsBlmB,CAAtB,KAA0B,CAA3B,IAA8B,CAAvD,EAAyDF,CAAC,CAACkmB,WAAF,EAAtE,CAA3B,CAArE;IAAwL,CAA3P,CAAlI,EAAgYlmB,CAAvY;EAAyY;;EAAAqmB,aAAa,GAAE;IAAC,OAAO,KAAKzT,YAAL,IAAmB5R,CAAC,CAAC,KAAKsL,WAAN,CAAD,KAAsB,KAAKA,WAAL,GAAiB,KAAKkS,sBAAL,EAAvC,GAAsEtd,CAAC,CAAC,KAAKoL,WAAN,CAAD,GAAoB,KAAKA,WAAzB,GAAqC,CAA9H,IAAiI,CAAxI;EAA0I;;EAAAkS,sBAAsB,GAAE;IAAC,OAAO,KAAK5L,YAAL,GAAkB,KAAKnF,SAAL,CAAe6Y,MAAf,CAAuB,CAACtmB,CAAD,EAAGC,CAAH,KAAOD,CAAC,GAACC,CAAC,CAACsmB,UAAlC,EAA8C,CAA9C,CAAlB,GAAmE,IAA1E;EAA+E;;EAAAC,yBAAyB,CAACxmB,CAAD,EAAG;IAAC,IAAIC,CAAC,GAAC,CAAN;;IAAQ,MAAMC,CAAC,GAAC,KAAK2hB,wBAAL,CAA8B7hB,CAA9B,CAAR;IAAA,MAAyCI,CAAC,GAAC,KAAK0hB,iBAAL,CAAuB5hB,CAAvB,EAAyBF,CAAC,CAAC2hB,GAA3B,CAA3C;;IAA2E,OAAOzgB,CAAC,CAACd,CAAD,CAAD,IAAM,KAAKqN,SAAL,CAAesM,MAAf,CAAuB/Z,CAAC,IAAEC,CAAC,IAAED,CAAC,CAACymB,qBAAF,CAAwBvmB,CAAxB,EAA0BE,CAA1B,CAA7B,CAAN,EAAkEH,CAAzE;EAA2E;;EAAAymB,OAAO,CAAC1mB,CAAD,EAAG;IAAC,IAAGgB,CAAC,CAAChB,CAAD,CAAD,IAAMgB,CAAC,CAAC,KAAK8U,SAAN,CAAV,EAA2B,OAAO,IAAP;IAAY,MAAM7V,CAAC,GAACD,CAAC,CAAC2mB,KAAF,CAAQ,GAAR,EAAarV,GAAb,CAAkBtR,CAAC,IAAE,CAACA,CAAtB,CAAR;IAAkC,IAAG,MAAIC,CAAC,CAAC,CAAD,CAAR,EAAY,OAAO,KAAK6V,SAAL,CAAe8Q,IAAf,CAAqB5mB,CAAC,IAAEA,CAAC,CAACiZ,GAAF,CAAM,CAAN,MAAWhZ,CAAC,CAAC,CAAD,CAAZ,IAAiBD,CAAC,CAACiZ,GAAF,CAAM,CAAN,MAAWhZ,CAAC,CAAC,CAAD,CAArD,CAAP;IAAkE,MAAMC,CAAC,GAAC,KAAGD,CAAC,CAAC,CAAD,CAAZ;IAAA,MAAgBG,CAAC,GAACsU,IAAI,CAACkL,KAAL,CAAW3f,CAAC,CAAC,CAAD,CAAD,GAAKC,CAAhB,CAAlB;IAAA,MAAqCG,CAAC,GAACqU,IAAI,CAACkL,KAAL,CAAW3f,CAAC,CAAC,CAAD,CAAD,GAAKC,CAAhB,CAAvC;IAA0D,IAAII,CAAJ;;IAAM,IAAG,KAAKwV,SAAL,CAAeuJ,IAAf,CAAqBrf,CAAC,IAAEA,CAAC,CAACiZ,GAAF,CAAM,CAAN,MAAW7Y,CAAX,IAAcJ,CAAC,CAACiZ,GAAF,CAAM,CAAN,MAAW5Y,CAAzB,KAA6BC,CAAC,GAACN,CAAF,EAAI,CAAC,CAAlC,CAAxB,GAA+DM,CAAlE,EAAoE;MAAC,IAAIN,CAAC,GAAC,KAAGC,CAAC,CAAC,CAAD,CAAD,GAAK,CAAd;;MAAgB,OAAKK,CAAC,CAAC2Y,GAAF,CAAM,CAAN,IAAShZ,CAAC,CAAC,CAAD,CAAf,GAAoB;QAAC,IAAIC,CAAC,GAACD,CAAC,CAAC,CAAD,CAAD,GAAKD,CAAL,GAAO,CAAP,GAAS,CAAf;QAAiB,IAAG,CAACC,CAAC,CAAC,CAAD,CAAD,GAAKD,CAAN,IAAS,CAAT,IAAYE,CAAC,EAAb,EAAgB,CAACI,CAAC,CAAC+W,QAAF,CAAWnX,CAAX,CAApB,EAAkC,OAAO,IAAP;QAAYI,CAAC,GAACA,CAAC,CAAC+W,QAAF,CAAWnX,CAAX,CAAF,EAAgBF,CAAC,KAAG,CAApB;MAAsB;;MAAA,OAAO2H,EAAE,CAACrH,CAAC,CAAC2Y,GAAF,CAAM,CAAN,MAAWhZ,CAAC,CAAC,CAAD,CAAZ,IAAiBK,CAAC,CAAC2Y,GAAF,CAAM,CAAN,MAAWhZ,CAAC,CAAC,CAAD,CAA7B,IAAkCK,CAAC,CAAC2Y,GAAF,CAAM,CAAN,MAAWhZ,CAAC,CAAC,CAAD,CAA/C,EAAmD,qBAAnD,CAAF,EAA4EK,CAAnF;IAAqF;;IAAA,OAAO,IAAP;EAAY;;EAAQ,IAAJumB,IAAI,GAAE;IAAC,MAAM7mB,CAAC,GAAC,IAAR;IAAa,OAAM;MAAC6P,QAAQ,EAAC7P,CAAC,CAACwP,SAAZ;MAAsBsX,WAAW,EAAC9mB,CAAC,CAAC2O,YAApC;MAAiDoY,WAAW,EAAC,MAAI;QAAC7lB,CAAC,CAAClB,CAAC,CAAC8V,SAAH,CAAD,KAAiB9V,CAAC,CAACsf,UAAF,CAAatf,CAAC,CAAC8V,SAAF,CAAY,CAAZ,CAAb,GAA6B9V,CAAC,CAACgT,iBAAF,EAA9C;MAAqE,CAAvI;MAAwIgU,QAAQ,EAAC,MAAIhnB,CAAC,CAACyN,SAAF,CAAYwZ,OAAZ,EAArJ;;MAA2KC,gBAAgB,GAAE;QAACC,EAAE,CAAC3M,KAAH,IAAWxa,CAAC,CAACyN,SAAF,CAAYsM,MAAZ,CAAoB/Z,CAAC,IAAE;UAACA,CAAC,CAACsW,OAAF,IAAWtW,CAAC,CAACmX,QAAb,IAAuBgQ,EAAE,CAAC3N,IAAH,CAAQxZ,CAAR,CAAvB;QAAkC,CAA1D,CAAX;QAAwE,MAAMC,CAAC,GAACknB,EAAE,CAACF,OAAH,EAAR;QAAqB,OAAO7c,EAAE,CAACpK,CAAC,CAAC+V,WAAH,EAAe9V,CAAf,CAAF,EAAoBA,CAA3B;MAA6B,CAAxT;;MAAyTmnB,gBAAgB,CAACnnB,CAAD,EAAGC,CAAH,EAAK;QAACF,CAAC,CAACmR,aAAF,CAAgBkW,wBAAhB,GAAyCnnB,CAAzC,EAA2CF,CAAC,CAAC2S,iBAAF,CAAoBkU,IAApB,CAAyBO,gBAAzB,CAA0CnnB,CAA1C,CAA3C;MAAwF;;IAAva,CAAN;EAA+a;;EAAAia,0BAA0B,GAAE;IAAC,IAAG,CAAC/Q,EAAJ,EAAO;IAAO,MAAMnJ,CAAC,GAAC,KAAK8V,SAAb;IAAuB,IAAG9U,CAAC,CAAChB,CAAD,CAAJ,EAAQ;;IAAO,MAAMC,CAAC,GAACD,CAAC,IAAEA,CAAC,EAAE4W,UAAH,EAAe0Q,YAAf,EAA6BC,OAA7B,EAAsCxQ,MAAtC,GAA6C,CAA7C,IAAgD,CAAC,CAA5D;IAAA,MAA8D7W,CAAC,GAAC,CAACF,CAAD,EAAGE,CAAH,KAAO;MAACD,CAAC,CAACD,CAAD,CAAD,IAAMwnB,OAAO,CAACvQ,KAAR,CAAc,OAAd,EAAsBjX,CAAC,CAACiZ,GAAxB,EAA4B,iCAA5B,EAA8D/Y,CAAC,CAAC+Y,GAAhE,EAAoE,YAApE,CAAN;IAAwF,CAAhK;IAAA,MAAiK7Y,CAAC,GAACJ,CAAC,IAAE;MAAC,IAAGA,CAAC,CAAC4W,UAAF,IAAc,CAAC5W,CAAC,CAAC4W,UAAF,CAAaC,aAA5B,IAA2C2Q,OAAO,CAACvQ,KAAR,CAAc,OAAd,EAAsBjX,CAAC,CAACiZ,GAAxB,EAA4B,wCAA5B,CAA3C,EAAiHjZ,CAAC,CAAC4W,UAAF,IAAc,CAAC5W,CAAC,CAAC4W,UAAF,CAAa0Q,YAA5B,IAA0CE,OAAO,CAACvQ,KAAR,CAAc,OAAd,EAAsBjX,CAAC,CAACiZ,GAAxB,EAA4B,uCAA5B,CAA3J,EAAgO,CAACjZ,CAAC,CAAC4W,UAAF,EAAc0Q,YAAf,IAA6B,CAACtnB,CAAC,CAAC4W,UAAF,CAAa0Q,YAAb,CAA0BC,OAA1B,EAAmCxQ,MAAnC,IAA2C,CAA5C,IAA+C,CAA5E,IAA+EyQ,OAAO,CAACvQ,KAAR,CAAc,OAAd,EAAsBjX,CAAC,CAACiZ,GAAxB,EAA4B,kDAA5B,EAA+EjZ,CAAC,CAAC4W,UAAF,CAAa0Q,YAA5F,CAA/S,EAAyZrnB,CAAC,CAACD,CAAD,CAA7Z,EAAia;QAACA,CAAC,CAACua,2BAAF;;QAAgC,KAAI,MAAMta,CAAV,IAAeD,CAAC,CAACqX,QAAjB,EAA0BnX,CAAC,CAACD,CAAD,EAAGD,CAAH,CAAD;MAAO,CAAne,MAAwe,IAAGA,CAAC,CAACoX,MAAL,EAAYoQ,OAAO,CAACvQ,KAAR,CAAc,OAAd,EAAsBjX,CAAC,CAACiZ,GAAxB,EAA4B,sDAA5B,EAAZ,KAAqG,KAAI,MAAMhZ,CAAV,IAAeD,CAAC,CAACqX,QAAjB,EAA0BjX,CAAC,CAACH,CAAD,CAAD;IAAK,CAAnxB;IAAA,MAAoxBI,CAAC,GAACL,CAAC,IAAE;MAAC,MAAMC,CAAC,GAACD,CAAC,CAAC8gB,MAAF,EAAUxK,OAAV,IAAmB,CAAC,CAA5B;MAAA,MAA8BpW,CAAC,GAACF,CAAC,CAACsW,OAAlC;MAA0CtW,CAAC,CAACsb,iBAAF;MAAsB,MAAMlb,CAAC,GAACJ,CAAC,CAACsW,OAAV;MAAkB,IAAGpW,CAAC,KAAGE,CAAJ,IAAOH,CAAP,IAAUunB,OAAO,CAACvQ,KAAR,CAAc,QAAd,EAAuBjX,CAAC,CAACiZ,GAAzB,EAA6B,gCAA7B,EAA8D/Y,CAA9D,EAAgE,cAAhE,EAA+EE,CAA/E,CAAV,EAA4F,CAACJ,CAAC,CAACoX,MAAlG,EAAyG,KAAI,MAAM9W,CAAV,IAAeN,CAAC,CAACqX,QAAjB,EAA0BhX,CAAC,CAACC,CAAD,CAAD;IAAK,CAAp/B;;IAAq/B,KAAI,MAAMA,CAAV,IAAeN,CAAf,EAAiBI,CAAC,CAACE,CAAD,CAAD,EAAKD,CAAC,CAACC,CAAD,CAAN;EAAU;;EAAY,IAARmnB,QAAQ,GAAE;IAAC,OAAO,KAAKnZ,SAAZ;EAAsB;;EAAkB,IAAdoZ,cAAc,GAAE;IAAC,OAAO,KAAKlY,SAAL,CAAekY,cAAtB;EAAqC;;EAAiB,IAAbC,aAAa,GAAE;IAAC,OAAM,CAAC,CAAC,KAAK/U,YAAL,EAAmB7C,gBAAnB,CAAoC4X,aAA5C;EAA0D;;EAA+B,IAA3BC,2BAA2B,GAAE;IAAC,OAAO,KAAKD,aAAL,IAAoB1jB,CAAC,CAAC,KAAKsK,IAAL,EAAWkO,sBAAZ,CAA5B;EAAgE;;EAAAoL,aAAa,CAAC7nB,CAAD,EAAG;IAAC,OAAO,KAAKynB,QAAL,IAAeznB,CAAC,CAAC,CAAD,CAAD,KAAO,KAAK8nB,UAAL,CAAgB9nB,CAAC,CAAC,CAAD,CAAjB,IAAsB,CAAnD;EAAqD;;EAAA+nB,aAAa,CAAC/nB,CAAD,EAAG;IAAC,OAAO,KAAKynB,QAAL,IAAe,MAAIznB,CAAC,CAAC,CAAD,CAA3B;EAA+B;;EAAA8nB,UAAU,CAAC9nB,CAAD,EAAG;IAAC,OAAO,MAAIA,CAAC,IAAE,KAAK+P,gBAAL,CAAsBiY,YAAtB,GAAmC,CAAnC,GAAqC,CAAvC,CAAL,CAAP;EAAuD;;EAAAC,YAAY,CAACjoB,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC,KAAK6nB,UAAL,CAAgB9nB,CAAC,CAAC,CAAD,CAAjB,CAAR;IAAA,MAA8BE,CAAC,GAACF,CAAC,CAAC,CAAD,CAAjC;IAAqC,IAAG,KAAGE,CAAH,IAAMA,CAAC,GAACD,CAAX,EAAa,OAAOD,CAAP;IAAS,IAAG,CAAC,KAAKynB,QAAT,EAAkB,OAAO,IAAP;IAAY,MAAMrnB,CAAC,GAAC,CAACF,CAAC,IAAEA,CAAC,GAAC,CAAF,GAAID,CAAJ,GAAM,CAAR,CAAF,IAAcA,CAAtB;IAAwB,OAAM,CAACD,CAAC,CAAC,CAAD,CAAF,EAAMA,CAAC,CAAC,CAAD,CAAP,EAAWI,CAAX,CAAN;EAAoB;;AAAt0iC,CAAvC;AAA+2iCJ,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,WAApB,EAAgC,KAAK,CAArC,CAAD,EAAyCloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,oBAApB,EAAyC,KAAK,CAA9C,CAA1C,EAA2FloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,iBAApB,EAAsC,KAAK,CAA3C,CAA5F,EAA0IloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,gBAApB,EAAqC,KAAK,CAA1C,CAA3I,EAAwLloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,iBAApB,EAAsC,KAAK,CAA3C,CAAzL,EAAuOloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,cAApB,EAAmC,KAAK,CAAxC,CAAxO,EAAmRloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,wBAAjC,EAA0D,KAAK,CAA/D,CAApR,EAAsVloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,YAApB,EAAiC,KAAK,CAAtC,CAAvV,EAAgYloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,WAAjC,EAA6C,IAA7C,CAAjY,EAAobloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,aAAjC,EAA+C,IAA/C,CAArb,EAA0eloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC+lB,aAAa,EAAC,CAAC;AAAhB,CAAD,CAAF,CAAD,EAAyB5c,EAAE,CAAC0c,SAA5B,EAAsC,MAAtC,EAA6C,KAAK,CAAlD,CAA3e,EAAgiBloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,qBAApB,EAA0C,IAA1C,CAAjiB,EAAilBloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,kBAApB,EAAuC,KAAK,CAA5C,CAAllB,EAAioBloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,QAAjC,EAA0C,IAA1C,CAAloB,EAAkrBloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,cAAjC,EAAgD,IAAhD,CAAnrB,EAAyuBloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,qBAAjC,EAAuD,IAAvD,CAA1uB,EAAuyBloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,UAAjC,EAA4C,IAA5C,CAAxyB,EAA01BloB,CAAC,CAAC,CAACqC,CAAC,CAACiD,CAAD,CAAF,CAAD,EAAQkG,EAAE,CAAC0c,SAAX,EAAqB,kBAArB,EAAwC,KAAK,CAA7C,CAA31B,EAA24BloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,uBAAjC,EAAyD,IAAzD,CAA54B,EAA28BloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,iBAApB,EAAsC,KAAK,CAA3C,CAA58B,EAA0/BloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAACH,OAAO,EAAC;AAAT,CAAD,CAAF,CAAD,EAA0CsJ,EAAE,CAAC0c,SAA7C,EAAuD,aAAvD,EAAqE,KAAK,CAA1E,CAA3/B,EAAwkCloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,uBAApB,EAA4C,KAAK,CAAjD,CAAzkC,EAA6nCloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,gBAAjC,EAAkD,KAAK,CAAvD,CAA9nC,EAAwrCloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,aAAjC,EAA+C,IAA/C,CAAzrC,EAA8uCloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,iBAApB,EAAsC,KAAK,CAA3C,CAA/uC,EAA6xCloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,OAAjC,EAAyC,IAAzC,CAA9xC,EAA60CloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAACgmB,KAAK,EAAC1hB,EAAE,CAAC2hB;AAAV,CAAD,CAAF,CAAD,EAA+B9c,EAAE,CAAC0c,SAAlC,EAA4C,aAA5C,EAA0D,IAA1D,CAA90C,EAA84CloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,WAAjC,EAA6C,KAAK,CAAlD,CAA/4C,EAAo8CloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,kBAAjC,EAAoD,IAApD,CAAr8C,EAA+/CloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAACkmB,IAAI,EAACtoB,CAAN;EAAQiC,OAAO,EAAC;AAAhB,CAAD,CAAF,CAAD,EAAsDsJ,EAAE,CAAC0c,SAAzD,EAAmE,iBAAnE,EAAqF,KAAK,CAA1F,CAAhgD,EAA6lDloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAACgmB,KAAK,EAAC,CAAC;AAAR,CAAD,CAAF,CAAD,EAAiB7c,EAAE,CAAC0c,SAApB,EAA8B,mBAA9B,EAAkD,IAAlD,CAA9lD,EAAspDloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,cAAjC,EAAgD,KAAK,CAArD,CAAvpD,EAA+sDloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC,CAAX;EAAajmB,OAAO,EAAC;AAArB,CAAD,CAAF,CAAD,EAAmEsJ,EAAE,CAAC0c,SAAtE,EAAgF,oBAAhF,EAAqG,KAAK,CAA1G,CAAhtD,EAA6zDloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3c,EAAE,CAAC0c,SAAvB,EAAiC,mBAAjC,EAAqD,KAAK,CAA1D,CAA9zD,EAA23DloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAACgmB,KAAK,EAAC,CAAC;AAAR,CAAD,CAAF,CAAD,EAAiB7c,EAAE,CAAC0c,SAApB,EAA8B,kBAA9B,EAAiD,IAAjD,CAA53D,EAAm7DloB,CAAC,CAAC,CAACmC,CAAC,CAAC,qBAAD,CAAF,CAAD,EAA4BqJ,EAAE,CAAC0c,SAA/B,EAAyC,WAAzC,EAAqD,KAAK,CAA1D,CAAp7D,EAAi/DloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAACgmB,KAAK,EAAC,CAAC;AAAR,CAAD,CAAF,CAAD,EAAiB7c,EAAE,CAAC0c,SAApB,EAA8B,WAA9B,EAA0C,IAA1C,CAAl/D,EAAkiEloB,CAAC,CAAC,CAACqC,CAAC,CAAC;EAAC8lB,QAAQ,EAAC,CAAC,CAAX;EAAajmB,OAAO,EAAC;AAArB,CAAD,CAAF,CAAD,EAAoFsJ,EAAE,CAAC0c,SAAvF,EAAiG,qBAAjG,EAAuH,KAAK,CAA5H,CAAniE,EAAkqEloB,CAAC,CAAC,CAACqC,CAAC,EAAF,CAAD,EAAOmJ,EAAE,CAAC0c,SAAV,EAAoB,kBAApB,EAAuC,KAAK,CAA5C,CAAnqE,EAAktEloB,CAAC,CAAC,CAACmC,CAAC,CAAC,8BAAD,CAAF,CAAD,EAAqCqJ,EAAE,CAAC0c,SAAxC,EAAkD,oBAAlD,EAAuE,KAAK,CAA5E,CAAntE,EAAkyEloB,CAAC,CAAC,CAACmC,CAAC,CAAC,6BAAD,CAAF,CAAD,EAAoCqJ,EAAE,CAAC0c,SAAvC,EAAiD,mBAAjD,EAAqE,KAAK,CAA1E,CAAnyE,EAAg3E1c,EAAE,GAACxL,CAAC,CAAC,CAACuC,CAAC,CAAC,sCAAD,CAAF,CAAD,EAA6CiJ,EAA7C,CAAp3E;AAAq6E,MAAMgd,EAAE,GAAChd,EAAT;;AAAY,SAAS0N,EAAT,CAAYlZ,CAAZ,EAAcC,CAAd,EAAgB;EAAC,OAAOD,CAAC,CAAC,CAAD,CAAD,KAAOC,CAAC,CAAC,CAAD,CAAR,IAAaD,CAAC,CAAC,CAAD,CAAD,KAAOC,CAAC,CAAC,CAAD,CAArB,IAA0BD,CAAC,CAAC,CAAD,CAAD,KAAOC,CAAC,CAAC,CAAD,CAAzC;AAA6C;;AAAA,SAAS2c,EAAT,CAAY5c,CAAZ,EAAc;EAAC,OAAM,CAACA,CAAC,CAACoX,MAAH,KAAYpX,CAAC,CAACqX,QAAF,CAAWgI,IAAX,CAAiBrf,CAAC,IAAEA,CAAC,CAAC2c,UAAtB,KAAoC3c,CAAC,CAACqX,QAAF,CAAWgI,IAAX,CAAiBrf,CAAC,IAAE4c,EAAE,CAAC5c,CAAD,CAAtB,CAAhD,CAAN;AAAmF;;AAAA,SAAS+c,EAAT,CAAY/c,CAAZ,EAAc;EAAC,OAAOA,CAAC,CAACoX,MAAF,IAAUpX,CAAC,CAAC8gB,MAAZ,IAAoB9gB,CAAC,CAAC8gB,MAAF,CAASnE,UAApC;AAA+C;;AAAA,MAAMhG,EAAE,GAAC/T,CAAC,EAAV;AAAA,MAAakW,EAAE,GAACxV,CAAC,EAAjB;AAAA,MAAoBqV,EAAE,GAAC,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAvB;AAAA,MAA+BwO,EAAE,GAAC,IAAIpnB,CAAJ,EAAlC;AAAA,MAAwC6d,EAAE,GAAC;EAAC7N,gBAAgB,EAAC,IAAlB;EAAuB8N,IAAI,EAAC,IAA5B;EAAiChL,MAAM,EAAC,IAAxC;EAA6C4V,OAAO,EAAC;AAArD,CAA3C;AAAA,MAA0GjI,EAAE,GAAC;EAACzQ,gBAAgB,EAAC,IAAlB;EAAuB8C,MAAM,EAAC,IAA9B;EAAmCwB,KAAK,EAAC;AAAzC,CAA7G;AAAyJ,SAAOmU,EAAE,IAAIE,OAAb"},"metadata":{},"sourceType":"module"}