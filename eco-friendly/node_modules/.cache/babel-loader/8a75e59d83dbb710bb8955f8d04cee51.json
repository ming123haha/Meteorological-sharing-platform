{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { isSome as r } from \"../../../../core/maybe.js\";\nimport { property as t } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as s } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { RasterTileContainer as i } from \"../../engine/imagery/RasterTileContainer.js\";\nimport { BaseImageryTileSubView2D as o } from \"./BaseImageryTileSubView2D.js\";\nimport { canUseMajorityInterpolationOnDataSource as a } from \"../support/util.js\";\nlet l = class extends o {\n  constructor() {\n    super(...arguments), this.container = null, this.layer = null, this.type = \"raster\";\n  }\n\n  attach() {\n    super.attach(), this.container = new i(this._tileInfoView), this.container.isCustomTilingScheme = this._isCustomTilingScheme;\n  }\n\n  detach() {\n    super.detach(), this.container.removeAllChildren(), this.container = null;\n  }\n\n  canUseWebGLForProcessing() {\n    return this.useWebGLForProcessing && this.layer.symbolizer.canRenderInWebGL && !(\"majority\" === this.layer.interpolation && a(this.layer));\n  }\n\n  fetchTile(e, r) {\n    return this.layer.fetchTile(e.level, e.row, e.col, r);\n  }\n\n  async updateTileSource(e, t) {\n    const {\n      bandIds: s\n    } = this.layer,\n          i = this._getLayerInterpolation(),\n          o = this.canUseWebGLForProcessing(),\n          {\n      source: a,\n      globalSymbolizerParams: l,\n      suspended: n,\n      coords: c,\n      resolution: p\n    } = t,\n          u = this.layerView.hasTilingEffects ? l : t.symbolizerParams,\n          {\n      bitmap: d\n    } = e;\n\n    if ([d.x, d.y] = c, d.resolution = p, a && r(a) && r(a.pixelBlock)) {\n      const e = {\n        extent: a.extent,\n        pixelBlock: a.pixelBlock\n      };\n      if (d.rawPixelData = e, o) d.source = a.pixelBlock, d.isRendereredSource = !1;else {\n        const r = await this.layer.applyRenderer(e, \"stretch\" === l?.type ? l : null);\n        d.source = r, d.isRendereredSource = !0;\n      }\n      d.symbolizerParameters = o ? u : null, o ? d.transformGrid || (d.transformGrid = a.transformGrid) : d.transformGrid = null;\n    } else {\n      const e = this.createEmptyTilePixelBlock();\n      d.source = e, d.symbolizerParameters = o ? u : null, d.transformGrid = null;\n    }\n\n    d.bandIds = o ? s : null, d.width = this._tileInfoView.tileInfo.size[0], d.height = this._tileInfoView.tileInfo.size[1], d.interpolation = i, d.suspended = n, d.invalidateTexture();\n  }\n\n  async updateTileSymbolizerParameters(e, t) {\n    const {\n      local: s,\n      global: i\n    } = t,\n          {\n      bandIds: o\n    } = this.layer,\n          a = this._getLayerInterpolation(),\n          l = this.canUseWebGLForProcessing(),\n          {\n      bitmap: n\n    } = e,\n          {\n      rawPixelData: c\n    } = n;\n\n    !l && r(c) ? (n.source = await this.layer.applyRenderer(c, \"stretch\" === i?.type ? i : null), n.isRendereredSource = !0) : (n.isRendereredSource && r(c) && (n.source = c.pixelBlock), n.isRendereredSource = !1), n.symbolizerParameters = l ? this.layerView.hasTilingEffects ? i : s : null, n.bandIds = l ? o : null, n.interpolation = a, n.suspended = !1;\n  }\n\n  _getLayerInterpolation() {\n    const e = this.layer.renderer.type;\n    if (\"raster-colormap\" === e || \"unique-value\" === e || \"class-breaks\" === e) return \"nearest\";\n    const {\n      interpolation: r\n    } = this.layer,\n          {\n      renderer: t\n    } = this.layer;\n    return \"raster-stretch\" === t.type && null != t.colorRamp ? \"bilinear\" === r || \"cubic\" === r ? \"bilinear\" : \"nearest\" : r;\n  }\n\n};\ne([t()], l.prototype, \"container\", void 0), e([t()], l.prototype, \"layer\", void 0), e([t()], l.prototype, \"type\", void 0), l = e([s(\"esri.views.2d.layers.imagery.ImageryTileView2D\")], l);\nconst n = l;\nexport { n as default };","map":{"version":3,"names":["_","e","isSome","r","property","t","subclass","s","RasterTileContainer","i","BaseImageryTileSubView2D","o","canUseMajorityInterpolationOnDataSource","a","l","constructor","arguments","container","layer","type","attach","_tileInfoView","isCustomTilingScheme","_isCustomTilingScheme","detach","removeAllChildren","canUseWebGLForProcessing","useWebGLForProcessing","symbolizer","canRenderInWebGL","interpolation","fetchTile","level","row","col","updateTileSource","bandIds","_getLayerInterpolation","source","globalSymbolizerParams","suspended","n","coords","c","resolution","p","u","layerView","hasTilingEffects","symbolizerParams","bitmap","d","x","y","pixelBlock","extent","rawPixelData","isRendereredSource","applyRenderer","symbolizerParameters","transformGrid","createEmptyTilePixelBlock","width","tileInfo","size","height","invalidateTexture","updateTileSymbolizerParameters","local","global","renderer","colorRamp","prototype","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/imagery/ImageryTileView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{property as t}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as s}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{RasterTileContainer as i}from\"../../engine/imagery/RasterTileContainer.js\";import{BaseImageryTileSubView2D as o}from\"./BaseImageryTileSubView2D.js\";import{canUseMajorityInterpolationOnDataSource as a}from\"../support/util.js\";let l=class extends o{constructor(){super(...arguments),this.container=null,this.layer=null,this.type=\"raster\"}attach(){super.attach(),this.container=new i(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme}detach(){super.detach(),this.container.removeAllChildren(),this.container=null}canUseWebGLForProcessing(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!(\"majority\"===this.layer.interpolation&&a(this.layer))}fetchTile(e,r){return this.layer.fetchTile(e.level,e.row,e.col,r)}async updateTileSource(e,t){const{bandIds:s}=this.layer,i=this._getLayerInterpolation(),o=this.canUseWebGLForProcessing(),{source:a,globalSymbolizerParams:l,suspended:n,coords:c,resolution:p}=t,u=this.layerView.hasTilingEffects?l:t.symbolizerParams,{bitmap:d}=e;if([d.x,d.y]=c,d.resolution=p,a&&r(a)&&r(a.pixelBlock)){const e={extent:a.extent,pixelBlock:a.pixelBlock};if(d.rawPixelData=e,o)d.source=a.pixelBlock,d.isRendereredSource=!1;else{const r=await this.layer.applyRenderer(e,\"stretch\"===l?.type?l:null);d.source=r,d.isRendereredSource=!0}d.symbolizerParameters=o?u:null,o?d.transformGrid||(d.transformGrid=a.transformGrid):d.transformGrid=null}else{const e=this.createEmptyTilePixelBlock();d.source=e,d.symbolizerParameters=o?u:null,d.transformGrid=null}d.bandIds=o?s:null,d.width=this._tileInfoView.tileInfo.size[0],d.height=this._tileInfoView.tileInfo.size[1],d.interpolation=i,d.suspended=n,d.invalidateTexture()}async updateTileSymbolizerParameters(e,t){const{local:s,global:i}=t,{bandIds:o}=this.layer,a=this._getLayerInterpolation(),l=this.canUseWebGLForProcessing(),{bitmap:n}=e,{rawPixelData:c}=n;!l&&r(c)?(n.source=await this.layer.applyRenderer(c,\"stretch\"===i?.type?i:null),n.isRendereredSource=!0):(n.isRendereredSource&&r(c)&&(n.source=c.pixelBlock),n.isRendereredSource=!1),n.symbolizerParameters=l?this.layerView.hasTilingEffects?i:s:null,n.bandIds=l?o:null,n.interpolation=a,n.suspended=!1}_getLayerInterpolation(){const e=this.layer.renderer.type;if(\"raster-colormap\"===e||\"unique-value\"===e||\"class-breaks\"===e)return\"nearest\";const{interpolation:r}=this.layer,{renderer:t}=this.layer;return\"raster-stretch\"===t.type&&null!=t.colorRamp?\"bilinear\"===r||\"cubic\"===r?\"bilinear\":\"nearest\":r}};e([t()],l.prototype,\"container\",void 0),e([t()],l.prototype,\"layer\",void 0),e([t()],l.prototype,\"type\",void 0),l=e([s(\"esri.views.2d.layers.imagery.ImageryTileView2D\")],l);const n=l;export{n as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}