{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { clock as t } from \"../../../core/clock.js\";\nimport { someMap as e } from \"../../../core/MapUtils.js\";\nimport { removeMaybe as a } from \"../../../core/maybe.js\";\nimport { createScreenPoint as i } from \"../../../core/screenUtils.js\";\nimport { DragEventSeparator as o } from \"../DragEventSeparator.js\";\nimport { InputHandler as r } from \"../InputHandler.js\";\nimport { DefaultParameters as s } from \"./SingleAndDoubleClick.js\";\nimport { getPointerId as n, manhattanDistance as u } from \"./support.js\";\n\nclass p extends r {\n  constructor(e = s.maximumDoubleClickDelay, a = s.maximumDoubleClickDistance, r = s.maximumDoubleTouchDelay, n = s.maximumDoubleTouchDistance, u = t) {\n    super(!1), this._maximumDoubleClickDelay = e, this._maximumDoubleClickDistance = a, this._maximumDoubleTouchDelay = r, this._maximumDoubleTouchDistance = n, this._clock = u, this._doubleTapDragReady = !1, this._doubleTapDragActive = !1, this._dragStartCenter = i(0, 0), this._pointerState = new Map(), this._doubleTapDrag = this.registerOutgoing(\"double-tap-drag\"), this._dragEventSeparator = new o({\n      start: (t, e) => this._dragStart(t, e),\n      update: (t, e) => this._dragUpdate(e),\n      end: (t, e) => this._dragEnd(e)\n    }), this.registerIncoming(\"drag\", t => this._dragEventSeparator.handle(t)), this.registerIncoming(\"pointer-down\", t => this._handlePointerDown(t)), this.registerIncoming(\"pointer-up\", () => this._handlePointerUp());\n  }\n\n  onUninstall() {\n    this._pointerState.forEach(t => {\n      t.doubleTapTimeout = a(t.doubleTapTimeout);\n    });\n  }\n\n  get hasPendingInputs() {\n    return e(this._pointerState, t => null != t.doubleTapTimeout);\n  }\n\n  _clearPointerDown(t) {\n    const e = this._pointerState.get(t);\n\n    e && (e.doubleTapTimeout = a(e.doubleTapTimeout), this._pointerState.delete(t), this.refreshHasPendingInputs());\n  }\n\n  _createDoubleTapDragData(t, e, a) {\n    const {\n      button: i,\n      buttons: o,\n      pointer: r,\n      pointers: s,\n      pointerType: n,\n      timestamp: u\n    } = a;\n    return {\n      action: t,\n      delta: e,\n      button: i,\n      buttons: o,\n      pointer: r,\n      pointers: s,\n      pointerType: n,\n      timestamp: u\n    };\n  }\n\n  _dragStart(t, e) {\n    if (!this._doubleTapDragReady || 1 !== t) return;\n    this._doubleTapDragReady = !1, this._doubleTapDragActive = !0;\n    const {\n      data: a,\n      modifiers: o\n    } = e,\n          {\n      center: r\n    } = a;\n    this._dragStartCenter = r;\n\n    const s = this._createDoubleTapDragData(\"begin\", i(0, 0), a);\n\n    this._doubleTapDrag.emit(s, void 0, o), e.stopPropagation();\n  }\n\n  _dragUpdate(t) {\n    if (!this._doubleTapDragActive) return;\n\n    const {\n      data: e,\n      modifiers: a\n    } = t,\n          {\n      center: o\n    } = e,\n          r = i(o.x - this._dragStartCenter.x, o.y - this._dragStartCenter.y),\n          s = this._createDoubleTapDragData(\"update\", r, e);\n\n    this._doubleTapDrag.emit(s, void 0, a), t.stopPropagation();\n  }\n\n  _dragEnd(t) {\n    if (!this._doubleTapDragActive) return;\n\n    const {\n      data: e,\n      modifiers: a\n    } = t,\n          {\n      center: o\n    } = e,\n          r = i(o.x - this._dragStartCenter.x, o.y - this._dragStartCenter.y),\n          s = this._createDoubleTapDragData(\"end\", r, e);\n\n    this._doubleTapDrag.emit(s, void 0, a), this._doubleTapDragActive = !1, t.stopPropagation();\n  }\n\n  _handlePointerDown(t) {\n    const {\n      data: e\n    } = t,\n          a = n(e),\n          i = this._pointerState.get(a),\n          {\n      pointerType: o\n    } = e.native;\n\n    if (i) {\n      const r = \"touch\" === o ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;\n      this._clearPointerDown(a), u(i.event.data, e) > r ? this._storePointerDown(t) : this._doubleTapDragReady = !0;\n    } else this._storePointerDown(t);\n  }\n\n  _handlePointerUp() {\n    this._doubleTapDragReady = !1;\n  }\n\n  _storePointerDown(t) {\n    const {\n      data: e\n    } = t,\n          {\n      pointerType: a\n    } = e.native,\n          i = n(e),\n          o = \"touch\" === a ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay,\n          r = this._clock.setTimeout(() => this._clearPointerDown(i), o);\n\n    this._pointerState.set(i, {\n      event: t,\n      doubleTapTimeout: r\n    }), this.refreshHasPendingInputs();\n  }\n\n}\n\nexport { p as DoubleTapDrag };","map":{"version":3,"names":["clock","t","someMap","e","removeMaybe","a","createScreenPoint","i","DragEventSeparator","o","InputHandler","r","DefaultParameters","s","getPointerId","n","manhattanDistance","u","p","constructor","maximumDoubleClickDelay","maximumDoubleClickDistance","maximumDoubleTouchDelay","maximumDoubleTouchDistance","_maximumDoubleClickDelay","_maximumDoubleClickDistance","_maximumDoubleTouchDelay","_maximumDoubleTouchDistance","_clock","_doubleTapDragReady","_doubleTapDragActive","_dragStartCenter","_pointerState","Map","_doubleTapDrag","registerOutgoing","_dragEventSeparator","start","_dragStart","update","_dragUpdate","end","_dragEnd","registerIncoming","handle","_handlePointerDown","_handlePointerUp","onUninstall","forEach","doubleTapTimeout","hasPendingInputs","_clearPointerDown","get","delete","refreshHasPendingInputs","_createDoubleTapDragData","button","buttons","pointer","pointers","pointerType","timestamp","action","delta","data","modifiers","center","emit","stopPropagation","x","y","native","event","_storePointerDown","setTimeout","set","DoubleTapDrag"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/input/recognizers/DoubleTapDrag.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{clock as t}from\"../../../core/clock.js\";import{someMap as e}from\"../../../core/MapUtils.js\";import{removeMaybe as a}from\"../../../core/maybe.js\";import{createScreenPoint as i}from\"../../../core/screenUtils.js\";import{DragEventSeparator as o}from\"../DragEventSeparator.js\";import{InputHandler as r}from\"../InputHandler.js\";import{DefaultParameters as s}from\"./SingleAndDoubleClick.js\";import{getPointerId as n,manhattanDistance as u}from\"./support.js\";class p extends r{constructor(e=s.maximumDoubleClickDelay,a=s.maximumDoubleClickDistance,r=s.maximumDoubleTouchDelay,n=s.maximumDoubleTouchDistance,u=t){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=a,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=u,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=i(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing(\"double-tap-drag\"),this._dragEventSeparator=new o({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming(\"drag\",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming(\"pointer-down\",(t=>this._handlePointerDown(t))),this.registerIncoming(\"pointer-up\",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((t=>{t.doubleTapTimeout=a(t.doubleTapTimeout)}))}get hasPendingInputs(){return e(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout=a(e.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,e,a){const{button:i,buttons:o,pointer:r,pointers:s,pointerType:n,timestamp:u}=a;return{action:t,delta:e,button:i,buttons:o,pointer:r,pointers:s,pointerType:n,timestamp:u}}_dragStart(t,e){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:a,modifiers:o}=e,{center:r}=a;this._dragStartCenter=r;const s=this._createDoubleTapDragData(\"begin\",i(0,0),a);this._doubleTapDrag.emit(s,void 0,o),e.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:a}=t,{center:o}=e,r=i(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),s=this._createDoubleTapDragData(\"update\",r,e);this._doubleTapDrag.emit(s,void 0,a),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:a}=t,{center:o}=e,r=i(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),s=this._createDoubleTapDragData(\"end\",r,e);this._doubleTapDrag.emit(s,void 0,a),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:e}=t,a=n(e),i=this._pointerState.get(a),{pointerType:o}=e.native;if(i){const r=\"touch\"===o?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(a),u(i.event.data,e)>r?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:e}=t,{pointerType:a}=e.native,i=n(e),o=\"touch\"===a?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._clearPointerDown(i)),o);this._pointerState.set(i,{event:t,doubleTapTimeout:r}),this.refreshHasPendingInputs()}}export{p as DoubleTapDrag};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}