{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from \"../request.js\";\nimport t from \"../portal/Portal.js\";\nimport { parseScript as r } from \"./parser.js\";\nimport o from \"./featureset/support/RecentlyUsedCache.js\";\nimport { ModuleError as s, ModuleErrorCodes as i } from \"./executionError.js\";\n\nclass l {\n  constructor(e) {\n    this.portalUri = e;\n  }\n\n  normalizeModuleUri(e) {\n    const r = /^[a-z0-9A-Z]+(@[0-9]+\\.[0-9]+\\.[0-9]+)?([\\?|\\/].*)?$/gi,\n          o = /(?<portalurl>.+)\\/home\\/item\\.html\\?id\\=(?<itemid>.+)$/gi,\n          c = /(?<portalurl>.+)\\/sharing\\/rest\\/content\\/users\\/[a-zA-Z0-9]+\\/items\\/(?<itemid>.+)$/gi,\n          u = /(?<portalurl>.+)\\/sharing\\/rest\\/content\\/items\\/(?<itemid>.+)$/gi,\n          n = /(?<itemid>.*)@(?<versionstring>[0-9]+\\.[0-9]+\\.[0-9]+)([\\?|\\/].*)?$/gi;\n\n    if (e.startsWith(\"portal+\")) {\n      let l = e.substring(7),\n          a = \"\",\n          m = l,\n          d = !1;\n\n      for (const e of [o, u, c]) {\n        const t = e.exec(l);\n\n        if (null !== t) {\n          const e = t.groups;\n          m = e.itemid, a = e.portalurl, d = !0;\n          break;\n        }\n      }\n\n      if (!1 === d) {\n        if (!r.test(l)) throw new s(i.UnsupportedUriProtocol, {\n          uri: e\n        });\n        m = l, a = this.portalUri;\n      }\n\n      m.includes(\"/\") && (m = m.split(\"/\")[0]), m.includes(\"?\") && (m = m.split(\"?\")[0]);\n      let h = \"current\";\n      const p = n.exec(m);\n\n      if (null !== p) {\n        const e = p.groups;\n        m = e.itemid, h = e.versionstring;\n      }\n\n      return l = new t({\n        url: a\n      }).restUrl + \"/content/items/\" + m + \"/resources/\" + h + \".arc\", {\n        url: l,\n        scheme: \"portal\",\n        uri: \"PO:\" + l\n      };\n    }\n\n    if (e.startsWith(\"mock\")) {\n      if (\"mock\" === e) {\n        return {\n          url: \"\",\n          scheme: \"mock\",\n          data: '\\n      export var hello = 1;\\n      export function helloWorld() {\\n          return \"Hello World \" + hello;\\n      }\\n  ',\n          uri: \"mock\"\n        };\n      }\n\n      const t = e.replace(\"mock:\", \"\");\n      if (void 0 !== l.mocks[t]) return {\n        url: \"\",\n        scheme: \"mock\",\n        data: l.mocks[t],\n        uri: e\n      };\n    }\n\n    throw new s(i.UnrecognisedUri, {\n      uri: e\n    });\n  }\n\n  async fetchModule(e) {\n    const t = l.cachedModules.getFromCache(e.uri);\n    if (t) return t;\n    const r = this.fetchSource(e);\n    l.cachedModules.addToCache(e.uri, r);\n    let o = null;\n\n    try {\n      o = await r;\n    } catch (s) {\n      throw l.cachedModules.removeFromCache(e.uri), s;\n    }\n\n    return o;\n  }\n\n  async fetchSource(t) {\n    if (\"portal\" === t.scheme) {\n      const o = await e(t.url, {\n        responseType: \"text\",\n        query: {}\n      });\n      if (o.data) return r(o.data, []);\n    }\n\n    if (\"mock\" === t.scheme) return r(t.data ?? \"\", []);\n    throw new s(i.UnsupportedUriProtocol);\n  }\n\n  static create(e) {\n    return new l(e);\n  }\n\n  static getDefault() {\n    return this._default ?? (l._default = l._moduleResolverFactory());\n  }\n\n  static set moduleResolverClass(e) {\n    this._moduleResolverFactory = e, this._default = null;\n  }\n\n}\n\nl.mocks = {}, l.cachedModules = new o(30), l._default = null, l._moduleResolverFactory = () => {\n  const e = t.getDefault();\n  return new l(e.url);\n};\nexport { l as ArcadeModuleResolver };","map":{"version":3,"names":["e","t","parseScript","r","o","ModuleError","s","ModuleErrorCodes","i","l","constructor","portalUri","normalizeModuleUri","c","u","n","startsWith","substring","a","m","d","exec","groups","itemid","portalurl","test","UnsupportedUriProtocol","uri","includes","split","h","p","versionstring","url","restUrl","scheme","data","replace","mocks","UnrecognisedUri","fetchModule","cachedModules","getFromCache","fetchSource","addToCache","removeFromCache","responseType","query","create","getDefault","_default","_moduleResolverFactory","moduleResolverClass","ArcadeModuleResolver"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/arcade/ArcadeModuleResolver.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";import t from\"../portal/Portal.js\";import{parseScript as r}from\"./parser.js\";import o from\"./featureset/support/RecentlyUsedCache.js\";import{ModuleError as s,ModuleErrorCodes as i}from\"./executionError.js\";class l{constructor(e){this.portalUri=e}normalizeModuleUri(e){const r=/^[a-z0-9A-Z]+(@[0-9]+\\.[0-9]+\\.[0-9]+)?([\\?|\\/].*)?$/gi,o=/(?<portalurl>.+)\\/home\\/item\\.html\\?id\\=(?<itemid>.+)$/gi,c=/(?<portalurl>.+)\\/sharing\\/rest\\/content\\/users\\/[a-zA-Z0-9]+\\/items\\/(?<itemid>.+)$/gi,u=/(?<portalurl>.+)\\/sharing\\/rest\\/content\\/items\\/(?<itemid>.+)$/gi,n=/(?<itemid>.*)@(?<versionstring>[0-9]+\\.[0-9]+\\.[0-9]+)([\\?|\\/].*)?$/gi;if(e.startsWith(\"portal+\")){let l=e.substring(7),a=\"\",m=l,d=!1;for(const e of[o,u,c]){const t=e.exec(l);if(null!==t){const e=t.groups;m=e.itemid,a=e.portalurl,d=!0;break}}if(!1===d){if(!r.test(l))throw new s(i.UnsupportedUriProtocol,{uri:e});m=l,a=this.portalUri}m.includes(\"/\")&&(m=m.split(\"/\")[0]),m.includes(\"?\")&&(m=m.split(\"?\")[0]);let h=\"current\";const p=n.exec(m);if(null!==p){const e=p.groups;m=e.itemid,h=e.versionstring}return l=new t({url:a}).restUrl+\"/content/items/\"+m+\"/resources/\"+h+\".arc\",{url:l,scheme:\"portal\",uri:\"PO:\"+l}}if(e.startsWith(\"mock\")){if(\"mock\"===e){return{url:\"\",scheme:\"mock\",data:'\\n      export var hello = 1;\\n      export function helloWorld() {\\n          return \"Hello World \" + hello;\\n      }\\n  ',uri:\"mock\"}}const t=e.replace(\"mock:\",\"\");if(void 0!==l.mocks[t])return{url:\"\",scheme:\"mock\",data:l.mocks[t],uri:e}}throw new s(i.UnrecognisedUri,{uri:e})}async fetchModule(e){const t=l.cachedModules.getFromCache(e.uri);if(t)return t;const r=this.fetchSource(e);l.cachedModules.addToCache(e.uri,r);let o=null;try{o=await r}catch(s){throw l.cachedModules.removeFromCache(e.uri),s}return o}async fetchSource(t){if(\"portal\"===t.scheme){const o=await e(t.url,{responseType:\"text\",query:{}});if(o.data)return r(o.data,[])}if(\"mock\"===t.scheme)return r(t.data??\"\",[]);throw new s(i.UnsupportedUriProtocol)}static create(e){return new l(e)}static getDefault(){return this._default??(l._default=l._moduleResolverFactory())}static set moduleResolverClass(e){this._moduleResolverFactory=e,this._default=null}}l.mocks={},l.cachedModules=new o(30),l._default=null,l._moduleResolverFactory=()=>{const e=t.getDefault();return new l(e.url)};export{l as ArcadeModuleResolver};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}