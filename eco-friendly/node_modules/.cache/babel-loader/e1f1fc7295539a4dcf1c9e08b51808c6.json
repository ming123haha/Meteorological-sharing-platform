{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { isNone as t } from \"../../../core/maybe.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as s } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport r from \"./BaseRasterFunction.js\";\nimport n from \"./ConvolutionFunctionArguments.js\";\nimport { convolutionKernels as i, ConvolutionKernel as u, convolute as c } from \"./convolutionUtils.js\";\nlet p = class extends r {\n  constructor() {\n    super(...arguments), this.functionName = \"Convolution\", this.rasterArgumentNames = [\"raster\"];\n  }\n\n  _bindSourceRasters() {\n    const {\n      kernelType: e,\n      rows: t,\n      cols: o,\n      kernel: s\n    } = this.functionArguments;\n    if (!i.has(e)) return {\n      success: !1,\n      error: `convolution-function: the specified kernel type is not supported ${e}`\n    };\n    if (e !== u.None && t * o !== s.length) return {\n      success: !1,\n      error: \"convolution-function: the specified rows and cols do not match the length of the kernel\"\n    };\n    const r = this.sourceRasterInfos[0];\n    this.outputPixelType = this._getOutputPixelType(r.pixelType);\n    const n = r.clone();\n    n.pixelType = this.outputPixelType;\n    const c = [u.None, u.Sharpen, u.Sharpen2, u.Sharpening3x3, u.Sharpening5x5];\n    return \"u8\" === this.outputPixelType || c.includes(e) || (n.statistics = null, n.histograms = null), this.rasterInfo = n, {\n      success: !0\n    };\n  }\n\n  _processPixels(e) {\n    const o = e.pixelBlocks?.[0];\n    if (t(o) || this.functionArguments.kernelType === u.None) return o;\n    let {\n      kernel: s,\n      rows: r,\n      cols: n\n    } = this.functionArguments;\n    const i = s.reduce((e, t) => e + t);\n    return 0 !== i && 1 !== i && (s = s.map(e => e / i)), c(o, {\n      kernel: s,\n      rows: r,\n      cols: n,\n      outputPixelType: this.outputPixelType\n    });\n  }\n\n};\ne([o({\n  json: {\n    write: !0,\n    name: \"rasterFunction\"\n  }\n})], p.prototype, \"functionName\", void 0), e([o({\n  type: n,\n  json: {\n    write: !0,\n    name: \"rasterFunctionArguments\"\n  }\n})], p.prototype, \"functionArguments\", void 0), e([o()], p.prototype, \"rasterArgumentNames\", void 0), p = e([s(\"esri.layers.support.rasterFunctions.ConvolutionFunction\")], p);\nconst l = p;\nexport { l as default };","map":{"version":3,"names":["_","e","isNone","t","property","o","subclass","s","r","n","convolutionKernels","i","ConvolutionKernel","u","convolute","c","p","constructor","arguments","functionName","rasterArgumentNames","_bindSourceRasters","kernelType","rows","cols","kernel","functionArguments","has","success","error","None","length","sourceRasterInfos","outputPixelType","_getOutputPixelType","pixelType","clone","Sharpen","Sharpen2","Sharpening3x3","Sharpening5x5","includes","statistics","histograms","rasterInfo","_processPixels","pixelBlocks","reduce","map","json","write","name","prototype","type","l","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/support/rasterFunctions/ConvolutionFunction.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{isNone as t}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./BaseRasterFunction.js\";import n from\"./ConvolutionFunctionArguments.js\";import{convolutionKernels as i,ConvolutionKernel as u,convolute as c}from\"./convolutionUtils.js\";let p=class extends r{constructor(){super(...arguments),this.functionName=\"Convolution\",this.rasterArgumentNames=[\"raster\"]}_bindSourceRasters(){const{kernelType:e,rows:t,cols:o,kernel:s}=this.functionArguments;if(!i.has(e))return{success:!1,error:`convolution-function: the specified kernel type is not supported ${e}`};if(e!==u.None&&t*o!==s.length)return{success:!1,error:\"convolution-function: the specified rows and cols do not match the length of the kernel\"};const r=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(r.pixelType);const n=r.clone();n.pixelType=this.outputPixelType;const c=[u.None,u.Sharpen,u.Sharpen2,u.Sharpening3x3,u.Sharpening5x5];return\"u8\"===this.outputPixelType||c.includes(e)||(n.statistics=null,n.histograms=null),this.rasterInfo=n,{success:!0}}_processPixels(e){const o=e.pixelBlocks?.[0];if(t(o)||this.functionArguments.kernelType===u.None)return o;let{kernel:s,rows:r,cols:n}=this.functionArguments;const i=s.reduce(((e,t)=>e+t));return 0!==i&&1!==i&&(s=s.map((e=>e/i))),c(o,{kernel:s,rows:r,cols:n,outputPixelType:this.outputPixelType})}};e([o({json:{write:!0,name:\"rasterFunction\"}})],p.prototype,\"functionName\",void 0),e([o({type:n,json:{write:!0,name:\"rasterFunctionArguments\"}})],p.prototype,\"functionArguments\",void 0),e([o()],p.prototype,\"rasterArgumentNames\",void 0),p=e([s(\"esri.layers.support.rasterFunctions.ConvolutionFunction\")],p);const l=p;export{l as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}