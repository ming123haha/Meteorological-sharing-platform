{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { remove as e } from \"../arrayUtils.js\";\nimport { makeHandle as t } from \"../handleUtils.js\";\nimport r from \"../Logger.js\";\nimport { isSome as s } from \"../maybe.js\";\nimport { throwIfAborted as i } from \"../promiseUtils.js\";\nimport { open as o } from \"./workers.js\";\nconst h = r.getLogger(\"esri.core.workers.WorkerHandle\");\n\nclass n {\n  constructor(e, t, r, s, i = {}) {\n    this._mainMethod = t, this._transferLists = r, this._listeners = [], this._promise = o(e, { ...i,\n      schedule: s\n    }).then(e => {\n      if (void 0 === this._thread) {\n        this._thread = e, this._promise = null, i.hasInitialize && this.broadcast({}, \"initialize\");\n\n        for (const e of this._listeners) this._connectListener(e);\n      } else e.close();\n    }), this._promise.catch(t => h.error(`Failed to initialize ${e} worker: ${t}`));\n  }\n\n  on(r, i) {\n    const o = {\n      removed: !1,\n      eventName: r,\n      callback: i,\n      threadHandle: null\n    };\n    return this._listeners.push(o), this._connectListener(o), t(() => {\n      o.removed = !0, e(this._listeners, o), this._thread && s(o.threadHandle) && o.threadHandle.remove();\n    });\n  }\n\n  destroy() {\n    this._thread && (this._thread.close(), this._thread = null), this._promise = null;\n  }\n\n  invoke(e, t) {\n    return this.invokeMethod(this._mainMethod, e, t);\n  }\n\n  invokeMethod(e, t, r) {\n    if (this._thread) {\n      const s = this._transferLists[e],\n            i = s ? s(t) : [];\n      return this._thread.invoke(e, t, {\n        transferList: i,\n        signal: r\n      });\n    }\n\n    return this._promise ? this._promise.then(() => (i(r), this.invokeMethod(e, t, r))) : Promise.reject(null);\n  }\n\n  broadcast(e, t) {\n    return this._thread ? Promise.all(this._thread.broadcast(t, e)).then(() => {}) : this._promise ? this._promise.then(() => this.broadcast(e, t)) : Promise.reject();\n  }\n\n  get promise() {\n    return this._promise;\n  }\n\n  _connectListener(e) {\n    this._thread && this._thread.on(e.eventName, e.callback).then(t => {\n      e.removed || (e.threadHandle = t);\n    });\n  }\n\n}\n\nexport { n as WorkerHandle };","map":{"version":3,"names":["remove","e","makeHandle","t","r","isSome","s","throwIfAborted","i","open","o","h","getLogger","n","constructor","_mainMethod","_transferLists","_listeners","_promise","schedule","then","_thread","hasInitialize","broadcast","_connectListener","close","catch","error","on","removed","eventName","callback","threadHandle","push","destroy","invoke","invokeMethod","transferList","signal","Promise","reject","all","promise","WorkerHandle"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/core/workers/WorkerHandle.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{remove as e}from\"../arrayUtils.js\";import{makeHandle as t}from\"../handleUtils.js\";import r from\"../Logger.js\";import{isSome as s}from\"../maybe.js\";import{throwIfAborted as i}from\"../promiseUtils.js\";import{open as o}from\"./workers.js\";const h=r.getLogger(\"esri.core.workers.WorkerHandle\");class n{constructor(e,t,r,s,i={}){this._mainMethod=t,this._transferLists=r,this._listeners=[],this._promise=o(e,{...i,schedule:s}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,i.hasInitialize&&this.broadcast({},\"initialize\");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>h.error(`Failed to initialize ${e} worker: ${t}`)))}on(r,i){const o={removed:!1,eventName:r,callback:i,threadHandle:null};return this._listeners.push(o),this._connectListener(o),t((()=>{o.removed=!0,e(this._listeners,o),this._thread&&s(o.threadHandle)&&o.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,r){if(this._thread){const s=this._transferLists[e],i=s?s(t):[];return this._thread.invoke(e,t,{transferList:i,signal:r})}return this._promise?this._promise.then((()=>(i(r),this.invokeMethod(e,t,r)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}export{n as WorkerHandle};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,QAAuB,kBAAvB;AAA0C,SAAOC,UAAU,IAAIC,CAArB,QAA2B,mBAA3B;AAA+C,OAAOC,CAAP,MAAa,cAAb;AAA4B,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,aAAvB;AAAqC,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,oBAA/B;AAAoD,SAAOC,IAAI,IAAIC,CAAf,QAAqB,cAArB;AAAoC,MAAMC,CAAC,GAACP,CAAC,CAACQ,SAAF,CAAY,gCAAZ,CAAR;;AAAsD,MAAMC,CAAN,CAAO;EAACC,WAAW,CAACb,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAOE,CAAP,EAASE,CAAC,GAAC,EAAX,EAAc;IAAC,KAAKO,WAAL,GAAiBZ,CAAjB,EAAmB,KAAKa,cAAL,GAAoBZ,CAAvC,EAAyC,KAAKa,UAAL,GAAgB,EAAzD,EAA4D,KAAKC,QAAL,GAAcR,CAAC,CAACT,CAAD,EAAG,EAAC,GAAGO,CAAJ;MAAMW,QAAQ,EAACb;IAAf,CAAH,CAAD,CAAuBc,IAAvB,CAA6BnB,CAAC,IAAE;MAAC,IAAG,KAAK,CAAL,KAAS,KAAKoB,OAAjB,EAAyB;QAAC,KAAKA,OAAL,GAAapB,CAAb,EAAe,KAAKiB,QAAL,GAAc,IAA7B,EAAkCV,CAAC,CAACc,aAAF,IAAiB,KAAKC,SAAL,CAAe,EAAf,EAAkB,YAAlB,CAAnD;;QAAmF,KAAI,MAAMtB,CAAV,IAAe,KAAKgB,UAApB,EAA+B,KAAKO,gBAAL,CAAsBvB,CAAtB;MAAyB,CAArK,MAA0KA,CAAC,CAACwB,KAAF;IAAU,CAArN,CAA1E,EAAkS,KAAKP,QAAL,CAAcQ,KAAd,CAAqBvB,CAAC,IAAEQ,CAAC,CAACgB,KAAF,CAAS,wBAAuB1B,CAAE,YAAWE,CAAE,EAA/C,CAAxB,CAAlS;EAA8W;;EAAAyB,EAAE,CAACxB,CAAD,EAAGI,CAAH,EAAK;IAAC,MAAME,CAAC,GAAC;MAACmB,OAAO,EAAC,CAAC,CAAV;MAAYC,SAAS,EAAC1B,CAAtB;MAAwB2B,QAAQ,EAACvB,CAAjC;MAAmCwB,YAAY,EAAC;IAAhD,CAAR;IAA8D,OAAO,KAAKf,UAAL,CAAgBgB,IAAhB,CAAqBvB,CAArB,GAAwB,KAAKc,gBAAL,CAAsBd,CAAtB,CAAxB,EAAiDP,CAAC,CAAE,MAAI;MAACO,CAAC,CAACmB,OAAF,GAAU,CAAC,CAAX,EAAa5B,CAAC,CAAC,KAAKgB,UAAN,EAAiBP,CAAjB,CAAd,EAAkC,KAAKW,OAAL,IAAcf,CAAC,CAACI,CAAC,CAACsB,YAAH,CAAf,IAAiCtB,CAAC,CAACsB,YAAF,CAAehC,MAAf,EAAnE;IAA2F,CAAlG,CAAzD;EAA8J;;EAAAkC,OAAO,GAAE;IAAC,KAAKb,OAAL,KAAe,KAAKA,OAAL,CAAaI,KAAb,IAAqB,KAAKJ,OAAL,GAAa,IAAjD,GAAuD,KAAKH,QAAL,GAAc,IAArE;EAA0E;;EAAAiB,MAAM,CAAClC,CAAD,EAAGE,CAAH,EAAK;IAAC,OAAO,KAAKiC,YAAL,CAAkB,KAAKrB,WAAvB,EAAmCd,CAAnC,EAAqCE,CAArC,CAAP;EAA+C;;EAAAiC,YAAY,CAACnC,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAO;IAAC,IAAG,KAAKiB,OAAR,EAAgB;MAAC,MAAMf,CAAC,GAAC,KAAKU,cAAL,CAAoBf,CAApB,CAAR;MAAA,MAA+BO,CAAC,GAACF,CAAC,GAACA,CAAC,CAACH,CAAD,CAAF,GAAM,EAAxC;MAA2C,OAAO,KAAKkB,OAAL,CAAac,MAAb,CAAoBlC,CAApB,EAAsBE,CAAtB,EAAwB;QAACkC,YAAY,EAAC7B,CAAd;QAAgB8B,MAAM,EAAClC;MAAvB,CAAxB,CAAP;IAA0D;;IAAA,OAAO,KAAKc,QAAL,GAAc,KAAKA,QAAL,CAAcE,IAAd,CAAoB,OAAKZ,CAAC,CAACJ,CAAD,CAAD,EAAK,KAAKgC,YAAL,CAAkBnC,CAAlB,EAAoBE,CAApB,EAAsBC,CAAtB,CAAV,CAApB,CAAd,GAAwEmC,OAAO,CAACC,MAAR,CAAe,IAAf,CAA/E;EAAoG;;EAAAjB,SAAS,CAACtB,CAAD,EAAGE,CAAH,EAAK;IAAC,OAAO,KAAKkB,OAAL,GAAakB,OAAO,CAACE,GAAR,CAAY,KAAKpB,OAAL,CAAaE,SAAb,CAAuBpB,CAAvB,EAAyBF,CAAzB,CAAZ,EAAyCmB,IAAzC,CAA+C,MAAI,CAAE,CAArD,CAAb,GAAqE,KAAKF,QAAL,GAAc,KAAKA,QAAL,CAAcE,IAAd,CAAoB,MAAI,KAAKG,SAAL,CAAetB,CAAf,EAAiBE,CAAjB,CAAxB,CAAd,GAA4DoC,OAAO,CAACC,MAAR,EAAxI;EAAyJ;;EAAW,IAAPE,OAAO,GAAE;IAAC,OAAO,KAAKxB,QAAZ;EAAqB;;EAAAM,gBAAgB,CAACvB,CAAD,EAAG;IAAC,KAAKoB,OAAL,IAAc,KAAKA,OAAL,CAAaO,EAAb,CAAgB3B,CAAC,CAAC6B,SAAlB,EAA4B7B,CAAC,CAAC8B,QAA9B,EAAwCX,IAAxC,CAA8CjB,CAAC,IAAE;MAACF,CAAC,CAAC4B,OAAF,KAAY5B,CAAC,CAAC+B,YAAF,GAAe7B,CAA3B;IAA8B,CAAhF,CAAd;EAAiG;;AAA1yC;;AAA2yC,SAAOU,CAAC,IAAI8B,YAAZ"},"metadata":{},"sourceType":"module"}