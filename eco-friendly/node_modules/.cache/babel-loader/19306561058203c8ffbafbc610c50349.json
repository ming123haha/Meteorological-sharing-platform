{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isNone as e, isSome as t, abortMaybe as n } from \"../../../core/maybe.js\";\nimport { ignoreAbortErrors as r, debounce as a } from \"../../../core/promiseUtils.js\";\nimport { pointEquals as o } from \"../../../layers/graphics/dehydratedFeatureComparison.js\";\nimport { EventPipeline as i } from \"../dragEventPipeline.js\";\nimport { SnappingContext as s } from \"./SnappingContext.js\";\nimport { TaskPriority as p, ImmediateTask as l } from \"../../support/Scheduler.js\";\n\nclass d {\n  constructor() {\n    this.next = new i();\n  }\n\n  createSnapDragEventPipelineStep({\n    predicate: d = () => !0,\n    cancel: c,\n    snappingManager: m,\n    snappingContext: x,\n    updatingHandles: u\n  }) {\n    if (e(m)) return e => e;\n    let y = null,\n        f = null;\n\n    const g = () => {\n      y = n(y), m.doneSnapping(), t(f) && f.frameTask.remove(), f = null;\n    };\n\n    c.next(e => (g(), e)), this.next = new i();\n    const v = a(async ({\n      frameTask: e,\n      point: t,\n      context: n,\n      event: r,\n      dx: a,\n      dy: i\n    }, s) => {\n      const p = await e.schedule(() => m.snap(t, n, s), s);\n\n      if (p.valid) {\n        let l = await e.schedule(() => p.apply(), s);\n        t !== P && (l = m.update(P, n)), o(l, h) || (r.mapEnd.x = l.x + a, r.mapEnd.y = l.y + i, this.next.execute(r));\n      }\n    });\n    let P, h;\n    return e => {\n      if (!d(e)) return e;\n\n      if (\"start\" === e.action) {\n        const n = \"3d\" === m.view.type ? m.view.resourceController.scheduler.registerTask(p.SNAPPING) : l;\n        f = {\n          context: new s({\n            editGeometryOperations: x.editGeometryOperations,\n            elevationInfo: x.elevationInfo,\n            pointer: x.pointer,\n            vertexHandle: t(e.info) ? e.info.handle : null,\n            excludeFeature: x.excludeFeature,\n            visualizer: x.visualizer\n          }),\n          originalPos: t(e.snapOrigin) ? x.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin) : e.mapStart,\n          frameTask: n\n        };\n      }\n\n      if (t(f)) {\n        const n = f.context.coordinateHelper.vectorToDehydratedPoint(f.context.coordinateHelper.arrayToVector([f.originalPos.x, f.originalPos.y, f.originalPos.z]));\n        n.x += e.mapEnd.x - e.mapStart.x, n.y += e.mapEnd.y - e.mapStart.y;\n        const a = e.mapStart.x - f.originalPos.x,\n              o = e.mapStart.y - f.originalPos.y,\n              i = { ...e,\n          action: \"update\"\n        },\n              s = f.context,\n              p = m.update(n, f.context);\n\n        if (h = p, e.mapEnd.x = p.x + a, e.mapEnd.y = p.y + o, P = n, \"end\" !== e.action) {\n          const e = f.frameTask;\n          t(y) || (y = new AbortController()), u.addPromise(r(v({\n            frameTask: e,\n            event: i,\n            context: s,\n            point: n,\n            dx: a,\n            dy: o\n          }, y.signal)));\n        }\n      }\n\n      return \"end\" === e.action && g(), e;\n    };\n  }\n\n}\n\nexport { d as SnappingPipeline };","map":{"version":3,"names":["isNone","e","isSome","t","abortMaybe","n","ignoreAbortErrors","r","debounce","a","pointEquals","o","EventPipeline","i","SnappingContext","s","TaskPriority","p","ImmediateTask","l","d","constructor","next","createSnapDragEventPipelineStep","predicate","cancel","c","snappingManager","m","snappingContext","x","updatingHandles","u","y","f","g","doneSnapping","frameTask","remove","v","point","context","event","dx","dy","schedule","snap","valid","apply","P","update","h","mapEnd","execute","action","view","type","resourceController","scheduler","registerTask","SNAPPING","editGeometryOperations","elevationInfo","pointer","vertexHandle","info","handle","excludeFeature","visualizer","originalPos","snapOrigin","coordinateHelper","vectorToDehydratedPoint","mapStart","arrayToVector","z","AbortController","addPromise","signal","SnappingPipeline"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as t,abortMaybe as n}from\"../../../core/maybe.js\";import{ignoreAbortErrors as r,debounce as a}from\"../../../core/promiseUtils.js\";import{pointEquals as o}from\"../../../layers/graphics/dehydratedFeatureComparison.js\";import{EventPipeline as i}from\"../dragEventPipeline.js\";import{SnappingContext as s}from\"./SnappingContext.js\";import{TaskPriority as p,ImmediateTask as l}from\"../../support/Scheduler.js\";class d{constructor(){this.next=new i}createSnapDragEventPipelineStep({predicate:d=(()=>!0),cancel:c,snappingManager:m,snappingContext:x,updatingHandles:u}){if(e(m))return e=>e;let y=null,f=null;const g=()=>{y=n(y),m.doneSnapping(),t(f)&&f.frameTask.remove(),f=null};c.next((e=>(g(),e))),this.next=new i;const v=a((async({frameTask:e,point:t,context:n,event:r,dx:a,dy:i},s)=>{const p=await e.schedule((()=>m.snap(t,n,s)),s);if(p.valid){let l=await e.schedule((()=>p.apply()),s);t!==P&&(l=m.update(P,n)),o(l,h)||(r.mapEnd.x=l.x+a,r.mapEnd.y=l.y+i,this.next.execute(r))}}));let P,h;return e=>{if(!d(e))return e;if(\"start\"===e.action){const n=\"3d\"===m.view.type?m.view.resourceController.scheduler.registerTask(p.SNAPPING):l;f={context:new s({editGeometryOperations:x.editGeometryOperations,elevationInfo:x.elevationInfo,pointer:x.pointer,vertexHandle:t(e.info)?e.info.handle:null,excludeFeature:x.excludeFeature,visualizer:x.visualizer}),originalPos:t(e.snapOrigin)?x.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,frameTask:n}}if(t(f)){const n=f.context.coordinateHelper.vectorToDehydratedPoint(f.context.coordinateHelper.arrayToVector([f.originalPos.x,f.originalPos.y,f.originalPos.z]));n.x+=e.mapEnd.x-e.mapStart.x,n.y+=e.mapEnd.y-e.mapStart.y;const a=e.mapStart.x-f.originalPos.x,o=e.mapStart.y-f.originalPos.y,i={...e,action:\"update\"},s=f.context,p=m.update(n,f.context);if(h=p,e.mapEnd.x=p.x+a,e.mapEnd.y=p.y+o,P=n,\"end\"!==e.action){const e=f.frameTask;t(y)||(y=new AbortController),u.addPromise(r(v({frameTask:e,event:i,context:s,point:n,dx:a,dy:o},y.signal)))}}return\"end\"===e.action&&g(),e}}}export{d as SnappingPipeline};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,EAA+BC,UAAU,IAAIC,CAA7C,QAAmD,wBAAnD;AAA4E,SAAOC,iBAAiB,IAAIC,CAA5B,EAA8BC,QAAQ,IAAIC,CAA1C,QAAgD,+BAAhD;AAAgF,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,yDAA5B;AAAsF,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,yBAA9B;AAAwD,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,sBAAhC;AAAuD,SAAOC,YAAY,IAAIC,CAAvB,EAAyBC,aAAa,IAAIC,CAA1C,QAAgD,4BAAhD;;AAA6E,MAAMC,CAAN,CAAO;EAACC,WAAW,GAAE;IAAC,KAAKC,IAAL,GAAU,IAAIT,CAAJ,EAAV;EAAgB;;EAAAU,+BAA+B,CAAC;IAACC,SAAS,EAACJ,CAAC,GAAE,MAAI,CAAC,CAAnB;IAAsBK,MAAM,EAACC,CAA7B;IAA+BC,eAAe,EAACC,CAA/C;IAAiDC,eAAe,EAACC,CAAjE;IAAmEC,eAAe,EAACC;EAAnF,CAAD,EAAuF;IAAC,IAAG/B,CAAC,CAAC2B,CAAD,CAAJ,EAAQ,OAAO3B,CAAC,IAAEA,CAAV;IAAY,IAAIgC,CAAC,GAAC,IAAN;IAAA,IAAWC,CAAC,GAAC,IAAb;;IAAkB,MAAMC,CAAC,GAAC,MAAI;MAACF,CAAC,GAAC5B,CAAC,CAAC4B,CAAD,CAAH,EAAOL,CAAC,CAACQ,YAAF,EAAP,EAAwBjC,CAAC,CAAC+B,CAAD,CAAD,IAAMA,CAAC,CAACG,SAAF,CAAYC,MAAZ,EAA9B,EAAmDJ,CAAC,GAAC,IAArD;IAA0D,CAAvE;;IAAwER,CAAC,CAACJ,IAAF,CAAQrB,CAAC,KAAGkC,CAAC,IAAGlC,CAAP,CAAT,GAAqB,KAAKqB,IAAL,GAAU,IAAIT,CAAJ,EAA/B;IAAqC,MAAM0B,CAAC,GAAC9B,CAAC,CAAE,OAAM;MAAC4B,SAAS,EAACpC,CAAX;MAAauC,KAAK,EAACrC,CAAnB;MAAqBsC,OAAO,EAACpC,CAA7B;MAA+BqC,KAAK,EAACnC,CAArC;MAAuCoC,EAAE,EAAClC,CAA1C;MAA4CmC,EAAE,EAAC/B;IAA/C,CAAN,EAAwDE,CAAxD,KAA4D;MAAC,MAAME,CAAC,GAAC,MAAMhB,CAAC,CAAC4C,QAAF,CAAY,MAAIjB,CAAC,CAACkB,IAAF,CAAO3C,CAAP,EAASE,CAAT,EAAWU,CAAX,CAAhB,EAA+BA,CAA/B,CAAd;;MAAgD,IAAGE,CAAC,CAAC8B,KAAL,EAAW;QAAC,IAAI5B,CAAC,GAAC,MAAMlB,CAAC,CAAC4C,QAAF,CAAY,MAAI5B,CAAC,CAAC+B,KAAF,EAAhB,EAA2BjC,CAA3B,CAAZ;QAA0CZ,CAAC,KAAG8C,CAAJ,KAAQ9B,CAAC,GAACS,CAAC,CAACsB,MAAF,CAASD,CAAT,EAAW5C,CAAX,CAAV,GAAyBM,CAAC,CAACQ,CAAD,EAAGgC,CAAH,CAAD,KAAS5C,CAAC,CAAC6C,MAAF,CAAStB,CAAT,GAAWX,CAAC,CAACW,CAAF,GAAIrB,CAAf,EAAiBF,CAAC,CAAC6C,MAAF,CAASnB,CAAT,GAAWd,CAAC,CAACc,CAAF,GAAIpB,CAAhC,EAAkC,KAAKS,IAAL,CAAU+B,OAAV,CAAkB9C,CAAlB,CAA3C,CAAzB;MAA0F;IAAC,CAAhQ,CAAT;IAA4Q,IAAI0C,CAAJ,EAAME,CAAN;IAAQ,OAAOlD,CAAC,IAAE;MAAC,IAAG,CAACmB,CAAC,CAACnB,CAAD,CAAL,EAAS,OAAOA,CAAP;;MAAS,IAAG,YAAUA,CAAC,CAACqD,MAAf,EAAsB;QAAC,MAAMjD,CAAC,GAAC,SAAOuB,CAAC,CAAC2B,IAAF,CAAOC,IAAd,GAAmB5B,CAAC,CAAC2B,IAAF,CAAOE,kBAAP,CAA0BC,SAA1B,CAAoCC,YAApC,CAAiD1C,CAAC,CAAC2C,QAAnD,CAAnB,GAAgFzC,CAAxF;QAA0Fe,CAAC,GAAC;UAACO,OAAO,EAAC,IAAI1B,CAAJ,CAAM;YAAC8C,sBAAsB,EAAC/B,CAAC,CAAC+B,sBAA1B;YAAiDC,aAAa,EAAChC,CAAC,CAACgC,aAAjE;YAA+EC,OAAO,EAACjC,CAAC,CAACiC,OAAzF;YAAiGC,YAAY,EAAC7D,CAAC,CAACF,CAAC,CAACgE,IAAH,CAAD,GAAUhE,CAAC,CAACgE,IAAF,CAAOC,MAAjB,GAAwB,IAAtI;YAA2IC,cAAc,EAACrC,CAAC,CAACqC,cAA5J;YAA2KC,UAAU,EAACtC,CAAC,CAACsC;UAAxL,CAAN,CAAT;UAAoNC,WAAW,EAAClE,CAAC,CAACF,CAAC,CAACqE,UAAH,CAAD,GAAgBxC,CAAC,CAACyC,gBAAF,CAAmBC,uBAAnB,CAA2CvE,CAAC,CAACqE,UAA7C,CAAhB,GAAyErE,CAAC,CAACwE,QAA3S;UAAoTpC,SAAS,EAAChC;QAA9T,CAAF;MAAmU;;MAAA,IAAGF,CAAC,CAAC+B,CAAD,CAAJ,EAAQ;QAAC,MAAM7B,CAAC,GAAC6B,CAAC,CAACO,OAAF,CAAU8B,gBAAV,CAA2BC,uBAA3B,CAAmDtC,CAAC,CAACO,OAAF,CAAU8B,gBAAV,CAA2BG,aAA3B,CAAyC,CAACxC,CAAC,CAACmC,WAAF,CAAcvC,CAAf,EAAiBI,CAAC,CAACmC,WAAF,CAAcpC,CAA/B,EAAiCC,CAAC,CAACmC,WAAF,CAAcM,CAA/C,CAAzC,CAAnD,CAAR;QAAwJtE,CAAC,CAACyB,CAAF,IAAK7B,CAAC,CAACmD,MAAF,CAAStB,CAAT,GAAW7B,CAAC,CAACwE,QAAF,CAAW3C,CAA3B,EAA6BzB,CAAC,CAAC4B,CAAF,IAAKhC,CAAC,CAACmD,MAAF,CAASnB,CAAT,GAAWhC,CAAC,CAACwE,QAAF,CAAWxC,CAAxD;QAA0D,MAAMxB,CAAC,GAACR,CAAC,CAACwE,QAAF,CAAW3C,CAAX,GAAaI,CAAC,CAACmC,WAAF,CAAcvC,CAAnC;QAAA,MAAqCnB,CAAC,GAACV,CAAC,CAACwE,QAAF,CAAWxC,CAAX,GAAaC,CAAC,CAACmC,WAAF,CAAcpC,CAAlE;QAAA,MAAoEpB,CAAC,GAAC,EAAC,GAAGZ,CAAJ;UAAMqD,MAAM,EAAC;QAAb,CAAtE;QAAA,MAA6FvC,CAAC,GAACmB,CAAC,CAACO,OAAjG;QAAA,MAAyGxB,CAAC,GAACW,CAAC,CAACsB,MAAF,CAAS7C,CAAT,EAAW6B,CAAC,CAACO,OAAb,CAA3G;;QAAiI,IAAGU,CAAC,GAAClC,CAAF,EAAIhB,CAAC,CAACmD,MAAF,CAAStB,CAAT,GAAWb,CAAC,CAACa,CAAF,GAAIrB,CAAnB,EAAqBR,CAAC,CAACmD,MAAF,CAASnB,CAAT,GAAWhB,CAAC,CAACgB,CAAF,GAAItB,CAApC,EAAsCsC,CAAC,GAAC5C,CAAxC,EAA0C,UAAQJ,CAAC,CAACqD,MAAvD,EAA8D;UAAC,MAAMrD,CAAC,GAACiC,CAAC,CAACG,SAAV;UAAoBlC,CAAC,CAAC8B,CAAD,CAAD,KAAOA,CAAC,GAAC,IAAI2C,eAAJ,EAAT,GAA8B5C,CAAC,CAAC6C,UAAF,CAAatE,CAAC,CAACgC,CAAC,CAAC;YAACF,SAAS,EAACpC,CAAX;YAAayC,KAAK,EAAC7B,CAAnB;YAAqB4B,OAAO,EAAC1B,CAA7B;YAA+ByB,KAAK,EAACnC,CAArC;YAAuCsC,EAAE,EAAClC,CAA1C;YAA4CmC,EAAE,EAACjC;UAA/C,CAAD,EAAmDsB,CAAC,CAAC6C,MAArD,CAAF,CAAd,CAA9B;QAA6G;MAAC;;MAAA,OAAM,UAAQ7E,CAAC,CAACqD,MAAV,IAAkBnB,CAAC,EAAnB,EAAsBlC,CAA5B;IAA8B,CAA5gC;EAA6gC;;AAA1kD;;AAA2kD,SAAOmB,CAAC,IAAI2D,gBAAZ"},"metadata":{},"sourceType":"module"}