{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as r } from \"../../../../core/maybe.js\";\nimport { WGLDrawPhase as e } from \"./enums.js\";\nimport { createProgramTemplate as t } from \"./shaders/MaterialPrograms.js\";\n\nconst a = r => r === e.HITTEST || r === e.LABEL_ALPHA,\n      s = r => (a(r) ? 1 : 0) | (r === e.HIGHLIGHT ? 2 : 0),\n      o = ({\n  rendererInfo: e,\n  drawPhase: t\n}, a, o, i) => `${a.getVariationHash()}-${i.join(\".\")}-${s(t)}-${e.getVariationHash()}-${r(o) && o.join(\".\")}`,\n      i = (t, s, o, i) => {\n  const h = i.reduce((r, e) => ({ ...r,\n    [e]: t.context.driverTest[e]\n  }), {}),\n        n = { ...s.getVariation(),\n    ...t.rendererInfo.getVariation(),\n    highlight: t.drawPhase === e.HIGHLIGHT,\n    id: a(t.drawPhase),\n    ...h\n  };\n  if (r(o)) for (const r of o) n[r] = !0;\n  return n;\n};\n\nclass h {\n  constructor(r) {\n    this._rctx = r, this._programByKey = new Map();\n  }\n\n  dispose() {\n    this._programByKey.forEach(r => r.dispose()), this._programByKey.clear();\n  }\n\n  getProgram(r, e = [], a = []) {\n    const s = r.vsPath + \".\" + r.fsPath + JSON.stringify(e) + a.join(\".\");\n    if (this._programByKey.has(s)) return this._programByKey.get(s);\n\n    const o = a.reduce((r, e) => ({ ...r,\n      [e]: this._rctx.driverTest[e]\n    }), {}),\n          i = { ...e.map(r => \"string\" == typeof r ? {\n        name: r,\n        value: !0\n      } : r).reduce((r, e) => ({ ...r,\n        [e.name]: e.value\n      }), {}),\n      ...o\n    },\n          {\n      vsPath: h,\n      fsPath: n,\n      attributes: g\n    } = r,\n          m = t(h, n, g, i),\n          c = this._rctx.programCache.acquire(m.shaders.vertexShader, m.shaders.fragmentShader, m.attributes);\n\n    if (!c) throw new Error(\"Unable to get program for key: ${key}\");\n    return this._programByKey.set(s, c), c;\n  }\n\n  getMaterialProgram(r, e, a, s, h, n = [\"ignoresSamplerPrecision\"]) {\n    const g = o(r, e, h, n);\n    if (this._programByKey.has(g)) return this._programByKey.get(g);\n\n    const m = i(r, e, h, n),\n          c = t(a, a, s, m),\n          y = this._rctx.programCache.acquire(c.shaders.vertexShader, c.shaders.fragmentShader, c.attributes);\n\n    if (!y) throw new Error(\"Unable to get program for key: ${key}\");\n    return this._programByKey.set(g, y), y;\n  }\n\n}\n\nexport { h as default };","map":{"version":3,"names":["isSome","r","WGLDrawPhase","e","createProgramTemplate","t","a","HITTEST","LABEL_ALPHA","s","HIGHLIGHT","o","rendererInfo","drawPhase","i","getVariationHash","join","h","reduce","context","driverTest","n","getVariation","highlight","id","constructor","_rctx","_programByKey","Map","dispose","forEach","clear","getProgram","vsPath","fsPath","JSON","stringify","has","get","map","name","value","attributes","g","m","c","programCache","acquire","shaders","vertexShader","fragmentShader","Error","set","getMaterialProgram","y","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/MaterialManager.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../../core/maybe.js\";import{WGLDrawPhase as e}from\"./enums.js\";import{createProgramTemplate as t}from\"./shaders/MaterialPrograms.js\";const a=r=>r===e.HITTEST||r===e.LABEL_ALPHA,s=r=>(a(r)?1:0)|(r===e.HIGHLIGHT?2:0),o=({rendererInfo:e,drawPhase:t},a,o,i)=>`${a.getVariationHash()}-${i.join(\".\")}-${s(t)}-${e.getVariationHash()}-${r(o)&&o.join(\".\")}`,i=(t,s,o,i)=>{const h=i.reduce(((r,e)=>({...r,[e]:t.context.driverTest[e]})),{}),n={...s.getVariation(),...t.rendererInfo.getVariation(),highlight:t.drawPhase===e.HIGHLIGHT,id:a(t.drawPhase),...h};if(r(o))for(const r of o)n[r]=!0;return n};class h{constructor(r){this._rctx=r,this._programByKey=new Map}dispose(){this._programByKey.forEach((r=>r.dispose())),this._programByKey.clear()}getProgram(r,e=[],a=[]){const s=r.vsPath+\".\"+r.fsPath+JSON.stringify(e)+a.join(\".\");if(this._programByKey.has(s))return this._programByKey.get(s);const o=a.reduce(((r,e)=>({...r,[e]:this._rctx.driverTest[e]})),{}),i={...e.map((r=>\"string\"==typeof r?{name:r,value:!0}:r)).reduce(((r,e)=>({...r,[e.name]:e.value})),{}),...o},{vsPath:h,fsPath:n,attributes:g}=r,m=t(h,n,g,i),c=this._rctx.programCache.acquire(m.shaders.vertexShader,m.shaders.fragmentShader,m.attributes);if(!c)throw new Error(\"Unable to get program for key: ${key}\");return this._programByKey.set(s,c),c}getMaterialProgram(r,e,a,s,h,n=[\"ignoresSamplerPrecision\"]){const g=o(r,e,h,n);if(this._programByKey.has(g))return this._programByKey.get(g);const m=i(r,e,h,n),c=t(a,a,s,m),y=this._rctx.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes);if(!y)throw new Error(\"Unable to get program for key: ${key}\");return this._programByKey.set(g,y),y}}export{h as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}