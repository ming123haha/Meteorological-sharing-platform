{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../Graphic.js\";\nimport { FeatureSetQueryInterceptor as r } from \"../../arcade/featureset/support/FeatureSetQueryInterceptor.js\";\nimport i from \"../../core/Accessor.js\";\nimport o from \"../../core/Handles.js\";\nimport s from \"../../core/Logger.js\";\nimport { isSome as n } from \"../../core/maybe.js\";\nimport { isAbortError as a, eachAlways as l } from \"../../core/promiseUtils.js\";\nimport { watch as p, initial as c } from \"../../core/reactiveUtils.js\";\nimport { throttle as d } from \"../../core/throttle.js\";\nimport { property as u } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/has.js\";\nimport { cast as f } from \"../../core/accessorSupport/decorators/cast.js\";\nimport { subclass as h } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport m from \"../../popup/content/TextContent.js\";\nimport _ from \"./FeatureAttachments/FeatureAttachmentsViewModel.js\";\nimport y from \"./FeatureContent/FeatureContentViewModel.js\";\nimport b from \"./FeatureExpression/FeatureExpressionViewModel.js\";\nimport g from \"./FeatureFields/FeatureFieldsViewModel.js\";\nimport A from \"./FeatureMedia/FeatureMediaViewModel.js\";\nimport { createCompiledExpressions as I } from \"./support/arcadeFeatureUtils.js\";\nimport { preLayerQueryCallback as M, preRequestCallback as x, createfieldInfoMap as v, getAllFieldInfos as w, getSourceLayer as C, substituteFieldsInLinksAndAttributes as F, isExpressionField as E, isRelatedField as T, formatEditInfo as V, graphicCallback as P, queryUpdatedFeature as j, formatAttributes as L } from \"./support/featureUtils.js\";\nimport { queryLayerInfos as R, queryRelatedFeatures as O, setRelatedFeatures as S, getRelatedFieldInfo as k, createRelatedInfo as U, updateRelatedInfo as N } from \"./support/relatedFeatureUtils.js\";\nvar q;\nconst D = 1,\n      Q = \"content-view-models\",\n      B = \"esri.widgets.FeatureViewModel\",\n      G = s.getLogger(B),\n      H = {\n  attachmentsContent: !0,\n  chartAnimation: !0,\n  customContent: !0,\n  expressionContent: !0,\n  fieldsContent: !0,\n  mediaContent: !0,\n  textContent: !0\n};\nlet z = q = class extends i {\n  constructor(e) {\n    super(e), this._handles = new o(), this._error = null, this._featureAbortController = null, this.graphicChangedThrottled = d(this._graphicChanged, D, this), this._expressionAttributes = null, this._graphicExpressionAttributes = null, this.abilities = { ...H\n    }, this.content = null, this.contentViewModels = [], this.defaultPopupTemplateEnabled = !1, this.formattedAttributes = null, this.lastEditInfo = null, this.relatedInfos = new Map(), this.title = \"\", this.view = null, this._isAllowedContentType = e => {\n      const {\n        abilities: t\n      } = this;\n      return \"attachments\" === e.type && t.attachmentsContent || \"custom\" === e.type && t.customContent || \"fields\" === e.type && t.fieldsContent || \"media\" === e.type && t.mediaContent || \"text\" === e.type && t.textContent || \"expression\" === e.type && t.expressionContent;\n    }, this._handles.add(p(() => [this.graphic, this._effectivePopupTemplate, this.abilities], () => this.graphicChangedThrottled(), c));\n  }\n\n  destroy() {\n    this._clear(), this._cancelFeatureQuery(), this._error = null, this._handles.destroy(), this._handles = null, this.graphic = null, this._destroyContentViewModels(), this.relatedInfos.clear();\n  }\n\n  get _effectivePopupTemplate() {\n    return n(this.graphic) ? this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled) : null;\n  }\n\n  get _fieldInfoMap() {\n    return v(w(this._effectivePopupTemplate), this._sourceLayer);\n  }\n\n  get _sourceLayer() {\n    return C(this.graphic);\n  }\n\n  castAbilities(e) {\n    return { ...H,\n      ...e\n    };\n  }\n\n  get state() {\n    return this.graphic ? this._error ? \"error\" : this.waitingForContent ? \"loading\" : \"ready\" : \"disabled\";\n  }\n\n  set graphic(e) {\n    this._set(\"graphic\", e ? e.clone() : null);\n  }\n\n  get spatialReference() {\n    return this.get(\"view.spatialReference\") || null;\n  }\n\n  set spatialReference(e) {\n    void 0 !== e ? this._override(\"spatialReference\", e) : this._clearOverride(\"spatialReference\");\n  }\n\n  get map() {\n    return this.get(\"view.map\") || null;\n  }\n\n  set map(e) {\n    void 0 !== e ? this._override(\"map\", e) : this._clearOverride(\"map\");\n  }\n\n  get waitingForContent() {\n    return !!this._featureAbortController;\n  }\n\n  setActiveMedia(e, t) {\n    const r = this.contentViewModels[e];\n    r instanceof A && r.setActiveMedia(t);\n  }\n\n  nextMedia(e) {\n    const t = this.contentViewModels[e];\n    t instanceof A && t.next();\n  }\n\n  previousMedia(e) {\n    const t = this.contentViewModels[e];\n    t instanceof A && t.previous();\n  }\n\n  _clear() {\n    this._set(\"title\", \"\"), this._set(\"content\", null), this._set(\"formattedAttributes\", null);\n  }\n\n  async _graphicChanged() {\n    this._cancelFeatureQuery(), this._error = null, this._clear();\n    const {\n      graphic: e\n    } = this;\n    if (!e) return;\n    const t = new AbortController();\n    this._featureAbortController = t;\n\n    try {\n      await this._queryFeature({\n        signal: t.signal\n      });\n    } catch (r) {\n      a(r) || (this._error = r, G.error(\"error\", \"The popupTemplate could not be displayed for this feature.\", {\n        error: r,\n        graphic: e,\n        popupTemplate: this._effectivePopupTemplate\n      }));\n    }\n\n    this._featureAbortController === t && (this._featureAbortController = null);\n  }\n\n  _cancelFeatureQuery() {\n    const {\n      _featureAbortController: e\n    } = this;\n    e && e.abort(), this._featureAbortController = null;\n  }\n\n  _compileContentElement(e, t) {\n    return \"attachments\" === e.type ? this._compileAttachments(e, t) : \"custom\" === e.type ? this._compileCustom(e, t) : \"fields\" === e.type ? this._compileFields(e, t) : \"media\" === e.type ? this._compileMedia(e, t) : \"text\" === e.type ? this._compileText(e, t) : \"expression\" === e.type ? this._compileExpression(e, t) : void 0;\n  }\n\n  _compileContent(e) {\n    if (this._destroyContentViewModels(), this.graphic) return Array.isArray(e) ? e.filter(this._isAllowedContentType).map((e, t) => this._compileContentElement(e, t)) : \"string\" == typeof e ? this._compileText(new m({\n      text: e\n    }), 0).text : e;\n  }\n\n  _destroyContentViewModels() {\n    this._handles?.remove(Q), this.contentViewModels.forEach(e => e && !e.destroyed && e.destroy()), this._set(\"contentViewModels\", []);\n  }\n\n  _setExpressionContentVM(e, t) {\n    const {\n      formattedAttributes: r\n    } = this,\n          {\n      contentElement: i,\n      contentElementViewModel: o\n    } = e,\n          s = i?.type;\n    o && s && (\"fields\" === s && (this._createFieldsFormattedAttributes({\n      contentElement: i,\n      contentElementIndex: t,\n      formattedAttributes: r\n    }), o.set(this._createFieldsVMParams(i, t))), \"media\" === s && (this._createMediaFormattedAttributes({\n      contentElement: i,\n      contentElementIndex: t,\n      formattedAttributes: r\n    }), o.set(this._createMediaVMParams(i, t))), \"text\" === s && o.set(this._createTextVMParams(i)));\n  }\n\n  _compileExpression(e, t) {\n    const {\n      expressionInfo: r\n    } = e,\n          {\n      graphic: i,\n      map: o,\n      spatialReference: s,\n      view: n\n    } = this,\n          a = new b({\n      expressionInfo: r,\n      graphic: i,\n      interceptor: q.interceptor,\n      map: o,\n      spatialReference: s,\n      view: n\n    });\n    return this.contentViewModels[t] = a, this._handles.add(p(() => a.contentElementViewModel, () => this._setExpressionContentVM(a, t), c), Q), e;\n  }\n\n  _compileAttachments(e, t) {\n    const {\n      graphic: r\n    } = this,\n          {\n      description: i,\n      title: o\n    } = e;\n    return this.contentViewModels[t] = new _({\n      graphic: r,\n      ...this._compileTitleAndDesc({\n        title: o,\n        description: i\n      })\n    }), e;\n  }\n\n  _compileCustom(e, t) {\n    const {\n      graphic: r\n    } = this,\n          {\n      creator: i,\n      destroyer: o\n    } = e;\n    return this.contentViewModels[t] = new y({\n      graphic: r,\n      creator: i,\n      destroyer: o\n    }), e;\n  }\n\n  _compileTitleAndDesc({\n    title: e,\n    description: t\n  }) {\n    const {\n      _fieldInfoMap: r,\n      _sourceLayer: i,\n      graphic: o,\n      formattedAttributes: s,\n      _expressionAttributes: n\n    } = this,\n          {\n      attributes: a\n    } = o,\n          l = s.global;\n    return {\n      title: F({\n        attributes: a,\n        fieldInfoMap: r,\n        globalAttributes: l,\n        expressionAttributes: n,\n        layer: i,\n        text: e\n      }),\n      description: F({\n        attributes: a,\n        fieldInfoMap: r,\n        globalAttributes: l,\n        expressionAttributes: n,\n        layer: i,\n        text: t\n      })\n    };\n  }\n\n  _createFieldsVMParams(e, t) {\n    const {\n      _effectivePopupTemplate: r,\n      formattedAttributes: i\n    } = this,\n          o = { ...i.global,\n      ...i.content[t]\n    },\n          s = (e?.fieldInfos || r?.fieldInfos)?.filter(({\n      fieldName: e\n    }) => E(e) || T(e) || o.hasOwnProperty(e)),\n          n = r?.expressionInfos,\n          {\n      description: a,\n      title: l\n    } = e;\n    return {\n      attributes: o,\n      expressionInfos: n,\n      fieldInfos: s,\n      ...this._compileTitleAndDesc({\n        title: l,\n        description: a\n      })\n    };\n  }\n\n  _compileFields(e, t) {\n    const r = e.clone(),\n          i = new g(this._createFieldsVMParams(e, t));\n    return this.contentViewModels[t] = i, r.fieldInfos = i.formattedFieldInfos.slice(0), r;\n  }\n\n  _createMediaVMParams(e, t) {\n    const {\n      abilities: r,\n      graphic: i,\n      _fieldInfoMap: o,\n      formattedAttributes: s,\n      _effectivePopupTemplate: n,\n      relatedInfos: a,\n      _sourceLayer: l,\n      _expressionAttributes: p\n    } = this,\n          {\n      attributes: c\n    } = i,\n          {\n      description: d,\n      mediaInfos: u,\n      title: f\n    } = e;\n    return {\n      abilities: {\n        chartAnimation: r.chartAnimation\n      },\n      activeMediaInfoIndex: e.activeMediaInfoIndex || 0,\n      attributes: c,\n      layer: l,\n      fieldInfoMap: o,\n      formattedAttributes: { ...s.global,\n        ...s.content[t]\n      },\n      expressionAttributes: p,\n      mediaInfos: u,\n      popupTemplate: n,\n      relatedInfos: a,\n      ...this._compileTitleAndDesc({\n        title: f,\n        description: d\n      })\n    };\n  }\n\n  _compileMedia(e, t) {\n    const r = e.clone(),\n          i = new A(this._createMediaVMParams(e, t));\n    return r.mediaInfos = i.formattedMediaInfos.slice(0), this.contentViewModels[t] = i, r;\n  }\n\n  _createTextVMParams(e) {\n    const {\n      graphic: t,\n      _fieldInfoMap: r,\n      _sourceLayer: i,\n      _expressionAttributes: o\n    } = this;\n\n    if (e && e.text) {\n      const {\n        attributes: s\n      } = t,\n            n = this.formattedAttributes.global;\n      e.text = F({\n        attributes: s,\n        fieldInfoMap: r,\n        globalAttributes: n,\n        expressionAttributes: o,\n        layer: i,\n        text: e.text\n      });\n    }\n\n    return {\n      graphic: t,\n      creator: e.text\n    };\n  }\n\n  _compileText(e, t) {\n    const r = e.clone();\n    return this.contentViewModels[t] = new y(this._createTextVMParams(r)), r;\n  }\n\n  _compileLastEditInfo() {\n    const {\n      _effectivePopupTemplate: e,\n      _sourceLayer: t,\n      graphic: r\n    } = this;\n    if (!e) return;\n    const {\n      lastEditInfoEnabled: i\n    } = e,\n          o = t?.editFieldsInfo;\n    return i && o ? V(o, r.attributes) : void 0;\n  }\n\n  _compileTitle(e) {\n    const {\n      _fieldInfoMap: t,\n      _sourceLayer: r,\n      graphic: i,\n      _expressionAttributes: o\n    } = this,\n          {\n      attributes: s\n    } = i,\n          n = this.formattedAttributes.global;\n    return F({\n      attributes: s,\n      fieldInfoMap: t,\n      globalAttributes: n,\n      expressionAttributes: o,\n      layer: r,\n      text: e\n    });\n  }\n\n  async _getTitle() {\n    const {\n      _effectivePopupTemplate: e,\n      graphic: t\n    } = this,\n          r = e?.title;\n    return P(r, {\n      graphic: t\n    });\n  }\n\n  async _getContent() {\n    const {\n      _effectivePopupTemplate: e,\n      graphic: t\n    } = this,\n          r = e?.content;\n    return P(r, {\n      graphic: t\n    });\n  }\n\n  async _queryFeature(e) {\n    const {\n      _featureAbortController: t,\n      _sourceLayer: r,\n      graphic: i,\n      _effectivePopupTemplate: o,\n      spatialReference: s,\n      map: n,\n      view: a\n    } = this,\n          {\n      content: {\n        value: p\n      },\n      title: {\n        value: c\n      }\n    } = await l({\n      content: this._getContent(),\n      title: this._getTitle()\n    });\n    if (t !== this._featureAbortController || !i) return;\n    await j({\n      graphic: i,\n      popupTemplate: o,\n      layer: r,\n      spatialReference: s\n    }, e);\n    const {\n      expressionAttributes: {\n        value: d\n      }\n    } = await l({\n      checkForRelatedFeatures: this._checkForRelatedFeatures(e),\n      expressionAttributes: I({\n        expressionInfos: o?.expressionInfos,\n        spatialReference: s,\n        graphic: i,\n        map: n,\n        interceptor: q.interceptor,\n        view: a\n      })\n    });\n    t === this._featureAbortController && i && (this._expressionAttributes = d, this._graphicExpressionAttributes = { ...i.attributes,\n      ...d\n    }, this._set(\"formattedAttributes\", this._createFormattedAttributes(p)), this._set(\"title\", this._compileTitle(c)), this._set(\"lastEditInfo\", this._compileLastEditInfo() || null), this._set(\"content\", this._compileContent(p) || null));\n  }\n\n  _createMediaFormattedAttributes({\n    contentElement: e,\n    contentElementIndex: t,\n    formattedAttributes: r\n  }) {\n    const {\n      _effectivePopupTemplate: i,\n      graphic: o,\n      relatedInfos: s,\n      _sourceLayer: n,\n      _fieldInfoMap: a,\n      _graphicExpressionAttributes: l\n    } = this;\n    r.content[t] = L({\n      fieldInfos: i?.fieldInfos,\n      graphic: o,\n      attributes: { ...l,\n        ...e.attributes\n      },\n      layer: n,\n      fieldInfoMap: a,\n      relatedInfos: s\n    });\n  }\n\n  _createFieldsFormattedAttributes({\n    contentElement: e,\n    contentElementIndex: t,\n    formattedAttributes: r\n  }) {\n    if (e.fieldInfos) {\n      const {\n        graphic: i,\n        relatedInfos: o,\n        _sourceLayer: s,\n        _fieldInfoMap: n,\n        _graphicExpressionAttributes: a\n      } = this;\n      r.content[t] = L({\n        fieldInfos: e.fieldInfos,\n        graphic: i,\n        attributes: { ...a,\n          ...e.attributes\n        },\n        layer: s,\n        fieldInfoMap: n,\n        relatedInfos: o\n      });\n    }\n  }\n\n  _createFormattedAttributes(e) {\n    const {\n      _effectivePopupTemplate: t,\n      graphic: r,\n      relatedInfos: i,\n      _sourceLayer: o,\n      _fieldInfoMap: s,\n      _graphicExpressionAttributes: n\n    } = this,\n          a = t?.fieldInfos,\n          l = {\n      global: L({\n        fieldInfos: a,\n        graphic: r,\n        attributes: n,\n        layer: o,\n        fieldInfoMap: s,\n        relatedInfos: i\n      }),\n      content: []\n    };\n    return Array.isArray(e) && e.forEach((e, t) => {\n      \"fields\" === e.type && this._createFieldsFormattedAttributes({\n        contentElement: e,\n        contentElementIndex: t,\n        formattedAttributes: l\n      }), \"media\" === e.type && this._createMediaFormattedAttributes({\n        contentElement: e,\n        contentElementIndex: t,\n        formattedAttributes: l\n      });\n    }), l;\n  }\n\n  _checkForRelatedFeatures(e) {\n    const {\n      graphic: t,\n      _effectivePopupTemplate: r\n    } = this;\n    return this._queryRelatedInfos(t, w(r), e);\n  }\n\n  async _queryRelatedInfos(e, t, r) {\n    const {\n      relatedInfos: i,\n      _sourceLayer: o\n    } = this;\n    i.clear();\n    const s = n(o.associatedLayer) ? await o.associatedLayer.load(r) : o;\n    if (!s) return;\n    const a = t.filter(e => e && T(e.fieldName));\n    if (!a || !a.length) return;\n    t.forEach(e => this._configureRelatedInfo(e, s));\n    const l = await R({\n      relatedInfos: i,\n      layer: s\n    }, r);\n    Object.keys(l).forEach(e => {\n      const t = i.get(e.toString()),\n            r = l[e]?.value;\n      t && r && (t.layerInfo = r.data);\n    });\n    const p = await O({\n      graphic: e,\n      relatedInfos: i,\n      layer: s\n    }, r);\n    Object.keys(p).forEach(e => {\n      S(p[e]?.value, i.get(e.toString()));\n    });\n  }\n\n  _configureRelatedInfo(e, t) {\n    const {\n      relatedInfos: r\n    } = this,\n          i = k(e.fieldName);\n    if (!i) return;\n    const {\n      layerId: o,\n      fieldName: s\n    } = i;\n    if (!o) return;\n    const n = r.get(o.toString()) || U(o, t);\n    n && (N({\n      relatedInfo: n,\n      fieldName: s,\n      fieldInfo: e\n    }), this.relatedInfos.set(o, n));\n  }\n\n};\nz.interceptor = new r(M, x), e([u()], z.prototype, \"_error\", void 0), e([u()], z.prototype, \"_featureAbortController\", void 0), e([u({\n  readOnly: !0\n})], z.prototype, \"_effectivePopupTemplate\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"_fieldInfoMap\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"_sourceLayer\", null), e([u()], z.prototype, \"abilities\", void 0), e([f(\"abilities\")], z.prototype, \"castAbilities\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"content\", void 0), e([u({\n  readOnly: !0\n})], z.prototype, \"contentViewModels\", void 0), e([u({\n  type: Boolean\n})], z.prototype, \"defaultPopupTemplateEnabled\", void 0), e([u({\n  readOnly: !0\n})], z.prototype, \"state\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"formattedAttributes\", void 0), e([u({\n  type: t,\n  value: null\n})], z.prototype, \"graphic\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"lastEditInfo\", void 0), e([u({\n  readOnly: !0\n})], z.prototype, \"relatedInfos\", void 0), e([u()], z.prototype, \"spatialReference\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"title\", void 0), e([u()], z.prototype, \"map\", null), e([u({\n  readOnly: !0\n})], z.prototype, \"waitingForContent\", null), e([u()], z.prototype, \"view\", void 0), z = q = e([h(B)], z);\nconst J = z;\nexport { J as default };","map":{"version":3,"names":["_","e","t","FeatureSetQueryInterceptor","r","i","o","s","isSome","n","isAbortError","a","eachAlways","l","watch","p","initial","c","throttle","d","property","u","cast","f","subclass","h","m","y","b","g","A","createCompiledExpressions","I","preLayerQueryCallback","M","preRequestCallback","x","createfieldInfoMap","v","getAllFieldInfos","w","getSourceLayer","C","substituteFieldsInLinksAndAttributes","F","isExpressionField","E","isRelatedField","T","formatEditInfo","V","graphicCallback","P","queryUpdatedFeature","j","formatAttributes","L","queryLayerInfos","R","queryRelatedFeatures","O","setRelatedFeatures","S","getRelatedFieldInfo","k","createRelatedInfo","U","updateRelatedInfo","N","q","D","Q","B","G","getLogger","H","attachmentsContent","chartAnimation","customContent","expressionContent","fieldsContent","mediaContent","textContent","z","constructor","_handles","_error","_featureAbortController","graphicChangedThrottled","_graphicChanged","_expressionAttributes","_graphicExpressionAttributes","abilities","content","contentViewModels","defaultPopupTemplateEnabled","formattedAttributes","lastEditInfo","relatedInfos","Map","title","view","_isAllowedContentType","type","add","graphic","_effectivePopupTemplate","destroy","_clear","_cancelFeatureQuery","_destroyContentViewModels","clear","getEffectivePopupTemplate","_fieldInfoMap","_sourceLayer","castAbilities","state","waitingForContent","_set","clone","spatialReference","get","_override","_clearOverride","map","setActiveMedia","nextMedia","next","previousMedia","previous","AbortController","_queryFeature","signal","error","popupTemplate","abort","_compileContentElement","_compileAttachments","_compileCustom","_compileFields","_compileMedia","_compileText","_compileExpression","_compileContent","Array","isArray","filter","text","remove","forEach","destroyed","_setExpressionContentVM","contentElement","contentElementViewModel","_createFieldsFormattedAttributes","contentElementIndex","set","_createFieldsVMParams","_createMediaFormattedAttributes","_createMediaVMParams","_createTextVMParams","expressionInfo","interceptor","description","_compileTitleAndDesc","creator","destroyer","attributes","global","fieldInfoMap","globalAttributes","expressionAttributes","layer","fieldInfos","fieldName","hasOwnProperty","expressionInfos","formattedFieldInfos","slice","mediaInfos","activeMediaInfoIndex","formattedMediaInfos","_compileLastEditInfo","lastEditInfoEnabled","editFieldsInfo","_compileTitle","_getTitle","_getContent","value","checkForRelatedFeatures","_checkForRelatedFeatures","_createFormattedAttributes","_queryRelatedInfos","associatedLayer","load","length","_configureRelatedInfo","Object","keys","toString","layerInfo","data","layerId","relatedInfo","fieldInfo","prototype","readOnly","Boolean","J","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/widgets/Feature/FeatureViewModel.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../Graphic.js\";import{FeatureSetQueryInterceptor as r}from\"../../arcade/featureset/support/FeatureSetQueryInterceptor.js\";import i from\"../../core/Accessor.js\";import o from\"../../core/Handles.js\";import s from\"../../core/Logger.js\";import{isSome as n}from\"../../core/maybe.js\";import{isAbortError as a,eachAlways as l}from\"../../core/promiseUtils.js\";import{watch as p,initial as c}from\"../../core/reactiveUtils.js\";import{throttle as d}from\"../../core/throttle.js\";import{property as u}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{cast as f}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as h}from\"../../core/accessorSupport/decorators/subclass.js\";import m from\"../../popup/content/TextContent.js\";import _ from\"./FeatureAttachments/FeatureAttachmentsViewModel.js\";import y from\"./FeatureContent/FeatureContentViewModel.js\";import b from\"./FeatureExpression/FeatureExpressionViewModel.js\";import g from\"./FeatureFields/FeatureFieldsViewModel.js\";import A from\"./FeatureMedia/FeatureMediaViewModel.js\";import{createCompiledExpressions as I}from\"./support/arcadeFeatureUtils.js\";import{preLayerQueryCallback as M,preRequestCallback as x,createfieldInfoMap as v,getAllFieldInfos as w,getSourceLayer as C,substituteFieldsInLinksAndAttributes as F,isExpressionField as E,isRelatedField as T,formatEditInfo as V,graphicCallback as P,queryUpdatedFeature as j,formatAttributes as L}from\"./support/featureUtils.js\";import{queryLayerInfos as R,queryRelatedFeatures as O,setRelatedFeatures as S,getRelatedFieldInfo as k,createRelatedInfo as U,updateRelatedInfo as N}from\"./support/relatedFeatureUtils.js\";var q;const D=1,Q=\"content-view-models\",B=\"esri.widgets.FeatureViewModel\",G=s.getLogger(B),H={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};let z=q=class extends i{constructor(e){super(e),this._handles=new o,this._error=null,this._featureAbortController=null,this.graphicChangedThrottled=d(this._graphicChanged,D,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...H},this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title=\"\",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return\"attachments\"===e.type&&t.attachmentsContent||\"custom\"===e.type&&t.customContent||\"fields\"===e.type&&t.fieldsContent||\"media\"===e.type&&t.mediaContent||\"text\"===e.type&&t.textContent||\"expression\"===e.type&&t.expressionContent},this._handles.add(p((()=>[this.graphic,this._effectivePopupTemplate,this.abilities]),(()=>this.graphicChangedThrottled()),c))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return n(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return v(w(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return C(this.graphic)}castAbilities(e){return{...H,...e}}get state(){return this.graphic?this._error?\"error\":this.waitingForContent?\"loading\":\"ready\":\"disabled\"}set graphic(e){this._set(\"graphic\",e?e.clone():null)}get spatialReference(){return this.get(\"view.spatialReference\")||null}set spatialReference(e){void 0!==e?this._override(\"spatialReference\",e):this._clearOverride(\"spatialReference\")}get map(){return this.get(\"view.map\")||null}set map(e){void 0!==e?this._override(\"map\",e):this._clearOverride(\"map\")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof A&&r.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof A&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof A&&t.previous()}_clear(){this._set(\"title\",\"\"),this._set(\"content\",null),this._set(\"formattedAttributes\",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(r){a(r)||(this._error=r,G.error(\"error\",\"The popupTemplate could not be displayed for this feature.\",{error:r,graphic:e,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContentElement(e,t){return\"attachments\"===e.type?this._compileAttachments(e,t):\"custom\"===e.type?this._compileCustom(e,t):\"fields\"===e.type?this._compileFields(e,t):\"media\"===e.type?this._compileMedia(e,t):\"text\"===e.type?this._compileText(e,t):\"expression\"===e.type?this._compileExpression(e,t):void 0}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map(((e,t)=>this._compileContentElement(e,t))):\"string\"==typeof e?this._compileText(new m({text:e}),0).text:e}_destroyContentViewModels(){this._handles?.remove(Q),this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set(\"contentViewModels\",[])}_setExpressionContentVM(e,t){const{formattedAttributes:r}=this,{contentElement:i,contentElementViewModel:o}=e,s=i?.type;o&&s&&(\"fields\"===s&&(this._createFieldsFormattedAttributes({contentElement:i,contentElementIndex:t,formattedAttributes:r}),o.set(this._createFieldsVMParams(i,t))),\"media\"===s&&(this._createMediaFormattedAttributes({contentElement:i,contentElementIndex:t,formattedAttributes:r}),o.set(this._createMediaVMParams(i,t))),\"text\"===s&&o.set(this._createTextVMParams(i)))}_compileExpression(e,t){const{expressionInfo:r}=e,{graphic:i,map:o,spatialReference:s,view:n}=this,a=new b({expressionInfo:r,graphic:i,interceptor:q.interceptor,map:o,spatialReference:s,view:n});return this.contentViewModels[t]=a,this._handles.add(p((()=>a.contentElementViewModel),(()=>this._setExpressionContentVM(a,t)),c),Q),e}_compileAttachments(e,t){const{graphic:r}=this,{description:i,title:o}=e;return this.contentViewModels[t]=new _({graphic:r,...this._compileTitleAndDesc({title:o,description:i})}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:i,destroyer:o}=e;return this.contentViewModels[t]=new y({graphic:r,creator:i,destroyer:o}),e}_compileTitleAndDesc({title:e,description:t}){const{_fieldInfoMap:r,_sourceLayer:i,graphic:o,formattedAttributes:s,_expressionAttributes:n}=this,{attributes:a}=o,l=s.global;return{title:F({attributes:a,fieldInfoMap:r,globalAttributes:l,expressionAttributes:n,layer:i,text:e}),description:F({attributes:a,fieldInfoMap:r,globalAttributes:l,expressionAttributes:n,layer:i,text:t})}}_createFieldsVMParams(e,t){const{_effectivePopupTemplate:r,formattedAttributes:i}=this,o={...i.global,...i.content[t]},s=(e?.fieldInfos||r?.fieldInfos)?.filter((({fieldName:e})=>E(e)||T(e)||o.hasOwnProperty(e))),n=r?.expressionInfos,{description:a,title:l}=e;return{attributes:o,expressionInfos:n,fieldInfos:s,...this._compileTitleAndDesc({title:l,description:a})}}_compileFields(e,t){const r=e.clone(),i=new g(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=i,r.fieldInfos=i.formattedFieldInfos.slice(0),r}_createMediaVMParams(e,t){const{abilities:r,graphic:i,_fieldInfoMap:o,formattedAttributes:s,_effectivePopupTemplate:n,relatedInfos:a,_sourceLayer:l,_expressionAttributes:p}=this,{attributes:c}=i,{description:d,mediaInfos:u,title:f}=e;return{abilities:{chartAnimation:r.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:c,layer:l,fieldInfoMap:o,formattedAttributes:{...s.global,...s.content[t]},expressionAttributes:p,mediaInfos:u,popupTemplate:n,relatedInfos:a,...this._compileTitleAndDesc({title:f,description:d})}}_compileMedia(e,t){const r=e.clone(),i=new A(this._createMediaVMParams(e,t));return r.mediaInfos=i.formattedMediaInfos.slice(0),this.contentViewModels[t]=i,r}_createTextVMParams(e){const{graphic:t,_fieldInfoMap:r,_sourceLayer:i,_expressionAttributes:o}=this;if(e&&e.text){const{attributes:s}=t,n=this.formattedAttributes.global;e.text=F({attributes:s,fieldInfoMap:r,globalAttributes:n,expressionAttributes:o,layer:i,text:e.text})}return{graphic:t,creator:e.text}}_compileText(e,t){const r=e.clone();return this.contentViewModels[t]=new y(this._createTextVMParams(r)),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:i}=e,o=t?.editFieldsInfo;return i&&o?V(o,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:i,_expressionAttributes:o}=this,{attributes:s}=i,n=this.formattedAttributes.global;return F({attributes:s,fieldInfoMap:t,globalAttributes:n,expressionAttributes:o,layer:r,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=e?.title;return P(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=e?.content;return P(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:i,_effectivePopupTemplate:o,spatialReference:s,map:n,view:a}=this,{content:{value:p},title:{value:c}}=await l({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!i)return;await j({graphic:i,popupTemplate:o,layer:r,spatialReference:s},e);const{expressionAttributes:{value:d}}=await l({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:I({expressionInfos:o?.expressionInfos,spatialReference:s,graphic:i,map:n,interceptor:q.interceptor,view:a})});t===this._featureAbortController&&i&&(this._expressionAttributes=d,this._graphicExpressionAttributes={...i.attributes,...d},this._set(\"formattedAttributes\",this._createFormattedAttributes(p)),this._set(\"title\",this._compileTitle(c)),this._set(\"lastEditInfo\",this._compileLastEditInfo()||null),this._set(\"content\",this._compileContent(p)||null))}_createMediaFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:r}){const{_effectivePopupTemplate:i,graphic:o,relatedInfos:s,_sourceLayer:n,_fieldInfoMap:a,_graphicExpressionAttributes:l}=this;r.content[t]=L({fieldInfos:i?.fieldInfos,graphic:o,attributes:{...l,...e.attributes},layer:n,fieldInfoMap:a,relatedInfos:s})}_createFieldsFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:r}){if(e.fieldInfos){const{graphic:i,relatedInfos:o,_sourceLayer:s,_fieldInfoMap:n,_graphicExpressionAttributes:a}=this;r.content[t]=L({fieldInfos:e.fieldInfos,graphic:i,attributes:{...a,...e.attributes},layer:s,fieldInfoMap:n,relatedInfos:o})}}_createFormattedAttributes(e){const{_effectivePopupTemplate:t,graphic:r,relatedInfos:i,_sourceLayer:o,_fieldInfoMap:s,_graphicExpressionAttributes:n}=this,a=t?.fieldInfos,l={global:L({fieldInfos:a,graphic:r,attributes:n,layer:o,fieldInfoMap:s,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{\"fields\"===e.type&&this._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:l}),\"media\"===e.type&&this._createMediaFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:l})})),l}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,w(r),e)}async _queryRelatedInfos(e,t,r){const{relatedInfos:i,_sourceLayer:o}=this;i.clear();const s=n(o.associatedLayer)?await o.associatedLayer.load(r):o;if(!s)return;const a=t.filter((e=>e&&T(e.fieldName)));if(!a||!a.length)return;t.forEach((e=>this._configureRelatedInfo(e,s)));const l=await R({relatedInfos:i,layer:s},r);Object.keys(l).forEach((e=>{const t=i.get(e.toString()),r=l[e]?.value;t&&r&&(t.layerInfo=r.data)}));const p=await O({graphic:e,relatedInfos:i,layer:s},r);Object.keys(p).forEach((e=>{S(p[e]?.value,i.get(e.toString()))}))}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,i=k(e.fieldName);if(!i)return;const{layerId:o,fieldName:s}=i;if(!o)return;const n=r.get(o.toString())||U(o,t);n&&(N({relatedInfo:n,fieldName:s,fieldInfo:e}),this.relatedInfos.set(o,n))}};z.interceptor=new r(M,x),e([u()],z.prototype,\"_error\",void 0),e([u()],z.prototype,\"_featureAbortController\",void 0),e([u({readOnly:!0})],z.prototype,\"_effectivePopupTemplate\",null),e([u({readOnly:!0})],z.prototype,\"_fieldInfoMap\",null),e([u({readOnly:!0})],z.prototype,\"_sourceLayer\",null),e([u()],z.prototype,\"abilities\",void 0),e([f(\"abilities\")],z.prototype,\"castAbilities\",null),e([u({readOnly:!0})],z.prototype,\"content\",void 0),e([u({readOnly:!0})],z.prototype,\"contentViewModels\",void 0),e([u({type:Boolean})],z.prototype,\"defaultPopupTemplateEnabled\",void 0),e([u({readOnly:!0})],z.prototype,\"state\",null),e([u({readOnly:!0})],z.prototype,\"formattedAttributes\",void 0),e([u({type:t,value:null})],z.prototype,\"graphic\",null),e([u({readOnly:!0})],z.prototype,\"lastEditInfo\",void 0),e([u({readOnly:!0})],z.prototype,\"relatedInfos\",void 0),e([u()],z.prototype,\"spatialReference\",null),e([u({readOnly:!0})],z.prototype,\"title\",void 0),e([u()],z.prototype,\"map\",null),e([u({readOnly:!0})],z.prototype,\"waitingForContent\",null),e([u()],z.prototype,\"view\",void 0),z=q=e([h(B)],z);const J=z;export{J as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}