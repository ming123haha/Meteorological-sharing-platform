{"ast":null,"code":"import { loadModules } from \"esri-loader\";\nexport default {\n  name: \"web-map\",\n\n  mounted() {\n    // lazy load the required ArcGIS API for JavaScript modules and CSS\n    loadModules(['esri/Map', 'esri/views/MapView', 'esri/widgets/Expand', //展开\n    'esri/layers/FeatureLayer', 'esri/widgets/BasemapGallery', //底图切换\n    'esri/widgets/Legend', //图例功能\n    'esri/widgets/Search', //查询\n    'esri/widgets/LayerList', //图层列表\n    'esri/widgets/Compass', //指南针\n    'esri/widgets/CoordinateConversion', //地理坐标xy\n    'esri/widgets/Measurement'], {\n      css: true\n    }).then(([Map, MapView, Expand, FeatureLayer, BasemapGallery, Legend, Search, LayerList, Compass, CoordinateConversion, Measurement]) => {\n      //栅格图层\n      const myMapUrl = \"http://localhost:6080/arcgis/rest/services/MyMapService/MapServer\";\n      const myMap = new MapView({\n        url: myMapUrl\n      }); //矢量图层\n\n      const myServer = \"http://localhost:6080/arcgis/rest/services/MyMapService/FeatureServer\";\n      const feat = new FeatureLayer({\n        url: myServer,\n        // 弹出框的样式\n        popupTemplate: {\n          title: \"这里是头部\",\n          // 这里设置弹出框的内容，包括字段信息，text，图表等\n          content: [{\n            type: \"fields\",\n            // FieldsContentElement\n            fieldInfos: [{\n              fieldName: \"CJQYDM\",\n              visible: true,\n              label: \"村级区域代码\",\n              format: {\n                places: 0,\n                digitSeparator: true\n              }\n            }, {\n              fieldName: \"CJQYMC\",\n              visible: true,\n              label: \"村级区域名称\",\n              format: {\n                places: 0,\n                digitSeparator: true\n              }\n            }]\n          }, {\n            type: \"text\",\n            // TextContentElement\n            text: \"这里可以显示描述性信息\"\n          } // {\n          //   type: \"media\",\n          //   mediaInfos: [\n          //     {\n          //       title: \"<b>图片</b>\",\n          //       type: \"image\",\n          //       caption: \"tree species\",\n          //       value: {\n          //         sourceURL:\n          //             \"https://www.sunset.com/wp-content/uploads/96006df453533f4c982212b8cc7882f5-800x0-c-default.jpg\",\n          //       },\n          //     },\n          //   ],\n          // },\n          ]\n        }\n      });\n      const map = new Map({\n        basemap: \"satellite\",\n        layers: [feat, myMap]\n      });\n      const view = new MapView({\n        container: \"viewDiv\",\n        map: map,\n        center: [125.65, 46.72],\n        zoom: 14\n      }); ////////////////////////定义查询工具，设置每个图层的查询字段/////////////////////////\n\n      const searchWidget = new Search({\n        view: view,\n        allPlaceholder: \"输入框\",\n        sources: [{\n          layer: feat,\n          // 村级区域代码\n          searchFields: [\"CJQYDM\"],\n          displayField: \"CJQYDM\",\n          exactMatch: false,\n          outFields: [\"CJQYDM\", \"CJQYMC\"],\n          name: \"村级区域\" // placeholder: \"example: 3708\"\n\n        }]\n      }); ///////////////////////////添加查询控件至视图////////////////////////////\n\n      view.ui.add(searchWidget, \"top-right\");\n      const legend = new Expand({\n        content: new Legend({\n          view: view,\n          style: \"card\" // other styles include 'classic'\n\n        }),\n        view: view,\n        expanded: true\n      });\n      view.ui.add(legend, \"bottom-left\"); //左下角放置图例\n\n      const measurement = new Measurement({\n        view: view,\n        activeTool: \"distance\"\n      });\n      view.ui.add(measurement, \"top-right\"); // Switch between area and distance measurement\n\n      function switchTool() {\n        const tool = measurement.activeTool === \"distance\" ? \"area\" : \"distance\";\n        measurement.activeTool = tool;\n      }\n\n      const basemapGallery = new BasemapGallery({\n        view: view,\n        container: document.createElement(\"div\")\n      });\n      const bgexpand = new Expand({\n        expandIconClass: \"esri-icon-layer-list\",\n        view: view,\n        content: basemapGallery,\n        group: \"top-right\"\n      });\n      basemapGallery.watch(\"activeBasemap\", () => {\n        const mobileSize = view.heightBreakpoint === \"xsmall\" || view.widthBreakpoint === \"xsmall\";\n\n        if (mobileSize) {\n          bgexpand.collapse();\n        }\n      });\n      const layerList = new LayerList({\n        container: document.createElement(\"div\"),\n        view: view\n      });\n      const layerListExpand = new Expand({\n        expandIconClass: \"esri-icon-layer-list\",\n        view: view,\n        content: layerList,\n        group: \"top-right\"\n      });\n      view.ui.add([layerListExpand, bgexpand], \"top-right\"); //右上角第二个图层管理\n      // view.ui.add([expand1, expand2], \"bottom-right\");\n\n      var compass = new Compass({\n        view: view\n      });\n      view.ui.add(compass, \"top-left\"); //左上角放置指南针\n\n      const ccWidget = new CoordinateConversion({\n        view: view\n      });\n      view.ui.add(ccWidget, \"bottom-right\"); //左下角鼠标位置的地理坐标\n    });\n  },\n\n  beforeUnmount() {\n    if (this.view) {\n      // destroy the map view\n      this.view.container = null;\n    }\n  }\n\n};","map":{"version":3,"mappings":"AAOA;AAEA;EACAA,eADA;;EAEAC;IACA;IACAC,YACA,CACA,UADA,EAEA,oBAFA,EAGA,qBAHA,EAGA;IACA,0BAJA,EAKA,6BALA,EAKA;IACA,qBANA,EAMA;IACA,qBAPA,EAOA;IACA,wBARA,EAQA;IACA,sBATA,EASA;IACA,mCAVA,EAUA;IACA,0BAXA,CADA,EAcA;MAAAC;IAAA,CAdA,EAeAC,IAfA,CAeA;MAEA;MACA;MACA;QACAC;MADA,GAJA,CAOA;;MACA,iBACA,uEADA;MAEA;QACAA,aADA;QAEA;QACAC;UACAC,cADA;UAEA;UACAC,UACA;YACAC,cADA;YACA;YACAC,aACA;cACAC,mBADA;cAEAC,aAFA;cAGAC,eAHA;cAIAC;gBACAC,SADA;gBAEAC;cAFA;YAJA,CADA,EAUA;cACAL,mBADA;cAEAC,aAFA;cAGAC,eAHA;cAIAC;gBACAC,SADA;gBAEAC;cAFA;YAJA,CAVA;UAFA,CADA,EAwBA;YACAP,YADA;YACA;YACAQ;UAFA,CAxBA,CA4BA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UAzCA;QAHA;MAHA;MAuDA;QACAC,oBADA;QAEAC;MAFA;MAKA;QACAC,oBADA;QAEAC,QAFA;QAGAC,uBAHA;QAIAC;MAJA,GAtEA,CA8EA;;MACA;QACAC,UADA;QAEAC,qBAFA;QAGAC,UACA;UACAC,WADA;UAEA;UACAC,wBAHA;UAIAC,sBAJA;UAKAC,iBALA;UAMAC,+BANA;UAOA/B,YAPA,CAQA;;QARA,CADA;MAHA,GA/EA,CAgGA;;MAEAwB;MAGA;QACAhB;UACAgB,UADA;UAEAQ,aAFA,CAEA;;QAFA,EADA;QAKAR,UALA;QAMAS;MANA;MAQAT,mCA7GA,CA6GA;;MAGA;QACAA,UADA;QAEAU;MAFA;MAIAV,sCApHA,CAsHA;;MACA;QACA;QACAW;MACA;;MAGA;QACAX,UADA;QAEAJ;MAFA;MAIA;QACAgB,uCADA;QAEAZ,UAFA;QAGAhB,uBAHA;QAIA6B;MAJA;MAMAC;QACA,mBACAd,sCACAA,iCAFA;;QAGA;UACAe;QACA;MACA,CAPA;MAUA;QACAnB,wCADA;QAEAI;MAFA;MAIA;QACAY,uCADA;QAEAZ,UAFA;QAGAhB,kBAHA;QAIA6B;MAJA;MAMAb,sDA3JA,CA2JA;MAEA;;MAGA;QACAA;MADA;MAGAA,iCAnKA,CAmKA;;MAEA;QACAA;MADA;MAGAA,sCAxKA,CAwKA;IAGA,CA1LA;EA2LA,CA/LA;;EAgMAgB;IACA;MACA;MACA;IACA;EACA;;AArMA","names":["name","mounted","loadModules","css","then","url","popupTemplate","title","content","type","fieldInfos","fieldName","visible","label","format","places","digitSeparator","text","basemap","layers","container","map","center","zoom","view","allPlaceholder","sources","layer","searchFields","displayField","exactMatch","outFields","style","expanded","activeTool","measurement","expandIconClass","group","basemapGallery","bgexpand","beforeUnmount"],"sourceRoot":"src/views","sources":["SpatialAnalysis.vue"],"sourcesContent":["<template>\r\n\r\n  <body>\r\n  <div id=\"viewDiv\"></div>\r\n  </body>\r\n</template>\r\n<script>\r\nimport { loadModules } from \"esri-loader\";\r\n\r\nexport default {\r\n  name: \"web-map\",\r\n  mounted() {\r\n    // lazy load the required ArcGIS API for JavaScript modules and CSS\r\n    loadModules(\r\n        [\r\n          'esri/Map',\r\n          'esri/views/MapView',\r\n          'esri/widgets/Expand',//展开\r\n          'esri/layers/FeatureLayer',\r\n          'esri/widgets/BasemapGallery',//底图切换\r\n          'esri/widgets/Legend',//图例功能\r\n          'esri/widgets/Search',//查询\r\n          'esri/widgets/LayerList',//图层列表\r\n          'esri/widgets/Compass',//指南针\r\n          'esri/widgets/CoordinateConversion',//地理坐标xy\r\n          'esri/widgets/Measurement'\r\n        ],\r\n        { css: true }\r\n    ).then(([Map, MapView, Expand, FeatureLayer, BasemapGallery, Legend, Search, LayerList, Compass, CoordinateConversion,Measurement]) => {\r\n\r\n      //栅格图层\r\n      const myMapUrl=\"http://localhost:6080/arcgis/rest/services/MyMapService/MapServer\"\r\n      const myMap=new MapView({\r\n        url:myMapUrl\r\n      })\r\n      //矢量图层\r\n      const myServer =\r\n          \"http://localhost:6080/arcgis/rest/services/MyMapService/FeatureServer\";\r\n      const feat = new FeatureLayer({\r\n        url: myServer,\r\n        // 弹出框的样式\r\n        popupTemplate: {\r\n          title: \"这里是头部\",\r\n          // 这里设置弹出框的内容，包括字段信息，text，图表等\r\n          content: [\r\n            {\r\n              type: \"fields\", // FieldsContentElement\r\n              fieldInfos: [\r\n                {\r\n                  fieldName: \"CJQYDM\",\r\n                  visible: true,\r\n                  label: \"村级区域代码\",\r\n                  format: {\r\n                    places: 0,\r\n                    digitSeparator: true,\r\n                  },\r\n                },\r\n                {\r\n                  fieldName: \"CJQYMC\",\r\n                  visible: true,\r\n                  label: \"村级区域名称\",\r\n                  format: {\r\n                    places: 0,\r\n                    digitSeparator: true,\r\n                  },\r\n                },\r\n              ],\r\n            },\r\n            {\r\n              type: \"text\", // TextContentElement\r\n              text: \"这里可以显示描述性信息\",\r\n            },\r\n            // {\r\n            //   type: \"media\",\r\n            //   mediaInfos: [\r\n            //     {\r\n            //       title: \"<b>图片</b>\",\r\n            //       type: \"image\",\r\n            //       caption: \"tree species\",\r\n            //       value: {\r\n            //         sourceURL:\r\n            //             \"https://www.sunset.com/wp-content/uploads/96006df453533f4c982212b8cc7882f5-800x0-c-default.jpg\",\r\n            //       },\r\n            //     },\r\n            //   ],\r\n            // },\r\n          ],\r\n        },\r\n      });\r\n\r\n\r\n\r\n\r\n      const map = new Map({\r\n        basemap: \"satellite\",\r\n        layers: [feat,myMap],\r\n      });\r\n\r\n      const view = new MapView({\r\n        container: \"viewDiv\",\r\n        map: map,\r\n        center: [125.65, 46.72],\r\n        zoom: 14,\r\n      });\r\n\r\n\r\n      ////////////////////////定义查询工具，设置每个图层的查询字段/////////////////////////\r\n      const searchWidget = new Search({\r\n        view: view,\r\n        allPlaceholder: \"输入框\",\r\n        sources: [\r\n          {\r\n            layer: feat,\r\n            // 村级区域代码\r\n            searchFields: [\"CJQYDM\"],\r\n            displayField: \"CJQYDM\",\r\n            exactMatch: false,\r\n            outFields: [\"CJQYDM\", \"CJQYMC\"],\r\n            name: \"村级区域\",\r\n            // placeholder: \"example: 3708\"\r\n          },\r\n        ],\r\n      });\r\n\r\n      ///////////////////////////添加查询控件至视图////////////////////////////\r\n\r\n      view.ui.add(searchWidget, \"top-right\");\r\n\r\n\r\n      const legend = new Expand({\r\n        content: new Legend({\r\n          view: view,\r\n          style: \"card\" // other styles include 'classic'\r\n        }),\r\n        view: view,\r\n        expanded: true\r\n      });\r\n      view.ui.add(legend, \"bottom-left\");//左下角放置图例\r\n\r\n\r\n      const measurement = new Measurement({\r\n        view: view,\r\n        activeTool: \"distance\"\r\n      });\r\n      view.ui.add(measurement, \"top-right\");\r\n\r\n// Switch between area and distance measurement\r\n      function switchTool() {\r\n        const tool = measurement.activeTool === \"distance\" ? \"area\" : \"distance\";\r\n        measurement.activeTool = tool;\r\n      }\r\n\r\n\r\n      const basemapGallery = new BasemapGallery({\r\n        view: view,\r\n        container: document.createElement(\"div\")\r\n      });\r\n      const bgexpand = new Expand({\r\n        expandIconClass: \"esri-icon-layer-list\",\r\n        view: view,\r\n        content: basemapGallery,\r\n        group: \"top-right\"\r\n      });\r\n      basemapGallery.watch(\"activeBasemap\", () => {\r\n        const mobileSize =\r\n            view.heightBreakpoint === \"xsmall\" ||\r\n            view.widthBreakpoint === \"xsmall\";\r\n        if (mobileSize) {\r\n          bgexpand.collapse();\r\n        }\r\n      });\r\n\r\n\r\n      const layerList = new LayerList({\r\n        container: document.createElement(\"div\"),\r\n        view: view\r\n      });\r\n      const layerListExpand = new Expand({\r\n        expandIconClass: \"esri-icon-layer-list\",\r\n        view: view,\r\n        content: layerList,\r\n        group: \"top-right\"\r\n      });\r\n      view.ui.add([layerListExpand, bgexpand], \"top-right\");//右上角第二个图层管理\r\n\r\n      // view.ui.add([expand1, expand2], \"bottom-right\");\r\n\r\n\r\n      var compass = new Compass({\r\n        view: view\r\n      });\r\n      view.ui.add(compass, \"top-left\");//左上角放置指南针\r\n\r\n      const ccWidget = new CoordinateConversion({\r\n        view: view\r\n      });\r\n      view.ui.add(ccWidget, \"bottom-right\");//左下角鼠标位置的地理坐标\r\n\r\n\r\n    });\r\n  },\r\n  beforeUnmount() {\r\n    if (this.view) {\r\n      // destroy the map view\r\n      this.view.container = null;\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import \"https://js.arcgis.com/4.24/esri/themes/dark/main.css\";\r\n\r\nbody {\r\n  height: 100%;\r\n  width: 100%;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\n\r\n\r\n#viewDiv {\r\n  height: 100%;\r\n  max-width: 100%;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}