{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { disposeMaybe as t } from \"../../../../core/maybe.js\";\nimport { t as s } from \"../../../../chunks/common.js\";\nimport { j as i, d as r, r as e, h as o } from \"../../../../chunks/mat3.js\";\nimport { c as a } from \"../../../../chunks/mat3f32.js\";\nimport { f as n } from \"../../../../chunks/vec2f64.js\";\nimport { s as h } from \"../../../../chunks/vec3.js\";\nimport { c as m } from \"../../../../chunks/vec3f64.js\";\nimport c from \"./VertexStream.js\";\nimport { stencil as d } from \"./shaders/StencilPrograms.js\";\nimport { StencilOperation as p, CompareFunction as _ } from \"../../../webgl/enums.js\";\nimport { createProgram as l } from \"../../../webgl/ProgramTemplate.js\";\nconst u = n(-.5, -.5);\n\nclass f {\n  constructor() {\n    this._centerNdc = m(), this._pxToNdc = m(), this._worldDimensionsPx = m(), this._mat3 = a(), this._initialized = !1;\n  }\n\n  dispose() {\n    this._program = t(this._program), this._quad = t(this._quad);\n  }\n\n  render(t, s) {\n    const {\n      context: i\n    } = t;\n    return !!this._updateGeometry(t, s) && (this._initialized || this._initialize(i), i.setDepthWriteEnabled(!1), i.setDepthTestEnabled(!1), i.setColorMask(!1, !1, !1, !1), i.setBlendingEnabled(!1), i.setStencilOp(p.KEEP, p.KEEP, p.REPLACE), i.setStencilFunction(_.ALWAYS, 1, 255), i.setStencilTestEnabled(!0), i.useProgram(this._program), this._program.setUniformMatrix3fv(\"u_worldExtent\", this._mat3), this._quad.draw(), this._quad.unbind(), !0);\n  }\n\n  _initialize(t) {\n    if (this._initialized) return;\n    const s = l(t, d);\n    s && (this._program = s, this._quad = new c(t, [0, 0, 1, 0, 0, 1, 1, 1]), this._initialized = !0);\n  }\n\n  _updateGeometry(t, a) {\n    const {\n      state: n,\n      pixelRatio: m\n    } = t,\n          {\n      size: c,\n      rotation: d\n    } = n,\n          p = Math.round(c[0] * m),\n          _ = Math.round(c[1] * m);\n\n    if (!n.spatialReference.isWrappable) return !1;\n    const l = s(d),\n          f = Math.abs(Math.cos(l)),\n          b = Math.abs(Math.sin(l)),\n          g = Math.round(p * f + _ * b),\n          j = Math.round(n.worldScreenWidth);\n    if (g <= j) return !1;\n    const x = p * b + _ * f,\n          E = j * m,\n          M = (a.left - a.right) * m / p,\n          w = (a.bottom - a.top) * m / _;\n    h(this._worldDimensionsPx, E, x, 1), h(this._pxToNdc, 2 / p, -2 / _, 1), h(this._centerNdc, M, w, 1);\n    const P = this._mat3;\n    return i(P, this._centerNdc), r(P, P, this._pxToNdc), 0 !== d && e(P, P, l), r(P, P, this._worldDimensionsPx), o(P, P, u), !0;\n  }\n\n}\n\nexport { f as WorldExtentClipRenderer };","map":{"version":3,"names":["disposeMaybe","t","s","j","i","d","r","e","h","o","c","a","f","n","m","stencil","StencilOperation","p","CompareFunction","_","createProgram","l","u","constructor","_centerNdc","_pxToNdc","_worldDimensionsPx","_mat3","_initialized","dispose","_program","_quad","render","context","_updateGeometry","_initialize","setDepthWriteEnabled","setDepthTestEnabled","setColorMask","setBlendingEnabled","setStencilOp","KEEP","REPLACE","setStencilFunction","ALWAYS","setStencilTestEnabled","useProgram","setUniformMatrix3fv","draw","unbind","state","pixelRatio","size","rotation","Math","round","spatialReference","isWrappable","abs","cos","b","sin","g","worldScreenWidth","x","E","M","left","right","w","bottom","top","P","WorldExtentClipRenderer"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/WorldExtentClipRenderer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{t as s}from\"../../../../chunks/common.js\";import{j as i,d as r,r as e,h as o}from\"../../../../chunks/mat3.js\";import{c as a}from\"../../../../chunks/mat3f32.js\";import{f as n}from\"../../../../chunks/vec2f64.js\";import{s as h}from\"../../../../chunks/vec3.js\";import{c as m}from\"../../../../chunks/vec3f64.js\";import c from\"./VertexStream.js\";import{stencil as d}from\"./shaders/StencilPrograms.js\";import{StencilOperation as p,CompareFunction as _}from\"../../../webgl/enums.js\";import{createProgram as l}from\"../../../webgl/ProgramTemplate.js\";const u=n(-.5,-.5);class f{constructor(){this._centerNdc=m(),this._pxToNdc=m(),this._worldDimensionsPx=m(),this._mat3=a(),this._initialized=!1}dispose(){this._program=t(this._program),this._quad=t(this._quad)}render(t,s){const{context:i}=t;return!!this._updateGeometry(t,s)&&(this._initialized||this._initialize(i),i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setBlendingEnabled(!1),i.setStencilOp(p.KEEP,p.KEEP,p.REPLACE),i.setStencilFunction(_.ALWAYS,1,255),i.setStencilTestEnabled(!0),i.useProgram(this._program),this._program.setUniformMatrix3fv(\"u_worldExtent\",this._mat3),this._quad.draw(),this._quad.unbind(),!0)}_initialize(t){if(this._initialized)return;const s=l(t,d);s&&(this._program=s,this._quad=new c(t,[0,0,1,0,0,1,1,1]),this._initialized=!0)}_updateGeometry(t,a){const{state:n,pixelRatio:m}=t,{size:c,rotation:d}=n,p=Math.round(c[0]*m),_=Math.round(c[1]*m);if(!n.spatialReference.isWrappable)return!1;const l=s(d),f=Math.abs(Math.cos(l)),b=Math.abs(Math.sin(l)),g=Math.round(p*f+_*b),j=Math.round(n.worldScreenWidth);if(g<=j)return!1;const x=p*b+_*f,E=j*m,M=(a.left-a.right)*m/p,w=(a.bottom-a.top)*m/_;h(this._worldDimensionsPx,E,x,1),h(this._pxToNdc,2/p,-2/_,1),h(this._centerNdc,M,w,1);const P=this._mat3;return i(P,this._centerNdc),r(P,P,this._pxToNdc),0!==d&&e(P,P,l),r(P,P,this._worldDimensionsPx),o(P,P,u),!0}}export{f as WorldExtentClipRenderer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}