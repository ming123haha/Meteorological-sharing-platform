{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isNone as t, isSome as e } from \"../../../../core/maybe.js\";\nimport r from \"../../../../core/PooledArray.js\";\nimport { BindType as i } from \"../core/shaderTechnique/BindType.js\";\nimport { webglDebugEnabled as s } from \"../../../webgl/checkWebGLError.js\";\n\nclass o {\n  constructor(t, e, o) {\n    this._context = t, this._locations = o, this._textures = new Map(), this._freeTextureUnits = new r({\n      deallocator: null\n    }), this._glProgram = t.programCache.acquire(e.generate(\"vertex\"), e.generate(\"fragment\"), o), this._glProgram.stop = () => {\n      throw new Error(\"Wrapped _glProgram used directly\");\n    }, this.bindPass = e.generateBind(i.Pass, this), this.bindDraw = e.generateBind(i.Draw, this), this._fragmentUniforms = s() ? e.fragmentUniforms : null;\n  }\n\n  dispose() {\n    this._glProgram.dispose();\n  }\n\n  get glName() {\n    return this._glProgram.glName;\n  }\n\n  get isCompiled() {\n    return this._glProgram.isCompiled;\n  }\n\n  setUniform1b(t, e) {\n    this._glProgram.setUniform1i(t, e ? 1 : 0);\n  }\n\n  setUniform1i(t, e) {\n    this._glProgram.setUniform1i(t, e);\n  }\n\n  setUniform1f(t, e) {\n    this._glProgram.setUniform1f(t, e);\n  }\n\n  setUniform2fv(t, e) {\n    this._glProgram.setUniform2fv(t, e);\n  }\n\n  setUniform3fv(t, e) {\n    this._glProgram.setUniform3fv(t, e);\n  }\n\n  setUniform4fv(t, e) {\n    this._glProgram.setUniform4fv(t, e);\n  }\n\n  setUniformMatrix3fv(t, e) {\n    this._glProgram.setUniformMatrix3fv(t, e);\n  }\n\n  setUniformMatrix4fv(t, e) {\n    this._glProgram.setUniformMatrix4fv(t, e);\n  }\n\n  setUniform1fv(t, e) {\n    this._glProgram.setUniform1fv(t, e);\n  }\n\n  setUniform1iv(t, e) {\n    this._glProgram.setUniform1iv(t, e);\n  }\n\n  setUniform2iv(t, e) {\n    this._glProgram.setUniform3iv(t, e);\n  }\n\n  setUniform3iv(t, e) {\n    this._glProgram.setUniform3iv(t, e);\n  }\n\n  setUniform4iv(t, e) {\n    this._glProgram.setUniform4iv(t, e);\n  }\n\n  assertCompatibleVertexAttributeLocations(t) {\n    t.locations !== this._locations && console.error(\"VertexAttributeLocations are incompatible\");\n  }\n\n  stop() {\n    this._textures.clear(), this._freeTextureUnits.clear();\n  }\n\n  bindTexture(e, r) {\n    if (t(r) || null == r.glName) {\n      const t = this._textures.get(e);\n\n      return t && (this._context.bindTexture(null, t.unit), this._freeTextureUnit(t), this._textures.delete(e)), null;\n    }\n\n    let i = this._textures.get(e);\n\n    return null == i ? (i = this._allocTextureUnit(r), this._textures.set(e, i)) : i.texture = r, this._context.useProgram(this), this.setUniform1i(e, i.unit), this._context.bindTexture(r, i.unit), i.unit;\n  }\n\n  rebindTextures() {\n    this._context.useProgram(this), this._textures.forEach((t, e) => {\n      this._context.bindTexture(t.texture, t.unit), this.setUniform1i(e, t.unit);\n    }), e(this._fragmentUniforms) && this._fragmentUniforms.forEach(t => {\n      \"sampler2D\" !== t.type && \"samplerCube\" !== t.type || this._textures.has(t.name) || console.error(`Texture sampler ${t.name} has no bound texture`);\n    });\n  }\n\n  _allocTextureUnit(t) {\n    return {\n      texture: t,\n      unit: 0 === this._freeTextureUnits.length ? this._textures.size : this._freeTextureUnits.pop()\n    };\n  }\n\n  _freeTextureUnit(t) {\n    this._freeTextureUnits.push(t.unit);\n  }\n\n}\n\nexport { o as Program };","map":{"version":3,"names":["isNone","t","isSome","e","r","BindType","i","webglDebugEnabled","s","o","constructor","_context","_locations","_textures","Map","_freeTextureUnits","deallocator","_glProgram","programCache","acquire","generate","stop","Error","bindPass","generateBind","Pass","bindDraw","Draw","_fragmentUniforms","fragmentUniforms","dispose","glName","isCompiled","setUniform1b","setUniform1i","setUniform1f","setUniform2fv","setUniform3fv","setUniform4fv","setUniformMatrix3fv","setUniformMatrix4fv","setUniform1fv","setUniform1iv","setUniform2iv","setUniform3iv","setUniform4iv","assertCompatibleVertexAttributeLocations","locations","console","error","clear","bindTexture","get","unit","_freeTextureUnit","delete","_allocTextureUnit","set","texture","useProgram","rebindTextures","forEach","type","has","name","length","size","pop","push","Program"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/webgl-engine/lib/Program.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isNone as t,isSome as e}from\"../../../../core/maybe.js\";import r from\"../../../../core/PooledArray.js\";import{BindType as i}from\"../core/shaderTechnique/BindType.js\";import{webglDebugEnabled as s}from\"../../../webgl/checkWebGLError.js\";class o{constructor(t,e,o){this._context=t,this._locations=o,this._textures=new Map,this._freeTextureUnits=new r({deallocator:null}),this._glProgram=t.programCache.acquire(e.generate(\"vertex\"),e.generate(\"fragment\"),o),this._glProgram.stop=()=>{throw new Error(\"Wrapped _glProgram used directly\")},this.bindPass=e.generateBind(i.Pass,this),this.bindDraw=e.generateBind(i.Draw,this),this._fragmentUniforms=s()?e.fragmentUniforms:null}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get isCompiled(){return this._glProgram.isCompiled}setUniform1b(t,e){this._glProgram.setUniform1i(t,e?1:0)}setUniform1i(t,e){this._glProgram.setUniform1i(t,e)}setUniform1f(t,e){this._glProgram.setUniform1f(t,e)}setUniform2fv(t,e){this._glProgram.setUniform2fv(t,e)}setUniform3fv(t,e){this._glProgram.setUniform3fv(t,e)}setUniform4fv(t,e){this._glProgram.setUniform4fv(t,e)}setUniformMatrix3fv(t,e){this._glProgram.setUniformMatrix3fv(t,e)}setUniformMatrix4fv(t,e){this._glProgram.setUniformMatrix4fv(t,e)}setUniform1fv(t,e){this._glProgram.setUniform1fv(t,e)}setUniform1iv(t,e){this._glProgram.setUniform1iv(t,e)}setUniform2iv(t,e){this._glProgram.setUniform3iv(t,e)}setUniform3iv(t,e){this._glProgram.setUniform3iv(t,e)}setUniform4iv(t,e){this._glProgram.setUniform4iv(t,e)}assertCompatibleVertexAttributeLocations(t){t.locations!==this._locations&&console.error(\"VertexAttributeLocations are incompatible\")}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(e,r){if(t(r)||null==r.glName){const t=this._textures.get(e);return t&&(this._context.bindTexture(null,t.unit),this._freeTextureUnit(t),this._textures.delete(e)),null}let i=this._textures.get(e);return null==i?(i=this._allocTextureUnit(r),this._textures.set(e,i)):i.texture=r,this._context.useProgram(this),this.setUniform1i(e,i.unit),this._context.bindTexture(r,i.unit),i.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach(((t,e)=>{this._context.bindTexture(t.texture,t.unit),this.setUniform1i(e,t.unit)})),e(this._fragmentUniforms)&&this._fragmentUniforms.forEach((t=>{\"sampler2D\"!==t.type&&\"samplerCube\"!==t.type||this._textures.has(t.name)||console.error(`Texture sampler ${t.name} has no bound texture`)}))}_allocTextureUnit(t){return{texture:t,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(t){this._freeTextureUnits.push(t.unit)}}export{o as Program};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}