{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from \"../request.js\";\nimport r from \"../core/Error.js\";\nimport t from \"../core/Logger.js\";\nimport { isSome as o } from \"../core/maybe.js\";\nimport { getDeepValue as s } from \"../core/object.js\";\nimport { removeTrailingSlash as a } from \"../core/urlUtils.js\";\nimport { asValidOptions as n, parseUrl as l } from \"./utils.js\";\nimport i from \"./support/NetworkServiceDescription.js\";\nconst d = t.getLogger(\"esri.rest.networkService\");\n\nfunction u(e, r, t, o) {\n  o[t] = [r.length, r.length + e.length], e.forEach(e => {\n    r.push(e.geometry);\n  });\n}\n\nfunction f(e, r) {\n  for (let t = 0; t < r.length; t++) {\n    const o = e[r[t]];\n    if (o && o.length) for (const e of o) e.z = void 0;\n  }\n\n  d.warnOnce(\"The remote Network Analysis service is powered by a network dataset which is not Z-aware.\\nZ-coordinates of the input geometry are ignored.\");\n}\n\nfunction c(e, r) {\n  for (let t = 0; t < r.length; t++) {\n    const s = e[r[t]];\n    if (s && s.length) for (const e of s) if (o(e) && e.hasZ) return !0;\n  }\n\n  return !1;\n}\n\nasync function p(t, o, s) {\n  if (!t) throw new r(\"network-service:missing-url\", \"Url to Network service is missing\");\n  const a = n({\n    f: \"json\",\n    token: o\n  }, s),\n        {\n    data: l\n  } = await e(t, a);\n  l.supportedTravelModes || (l.supportedTravelModes = []);\n\n  for (let e = 0; e < l.supportedTravelModes.length; e++) l.supportedTravelModes[e].id || (l.supportedTravelModes[e].id = l.supportedTravelModes[e].itemId);\n\n  const d = l.currentVersion >= 10.4 ? m(t, o, s) : v(t, s),\n        {\n    defaultTravelMode: u,\n    supportedTravelModes: f\n  } = await d;\n  return l.defaultTravelMode = u, l.supportedTravelModes = f, i.fromJSON(l);\n}\n\nasync function v(r, t) {\n  const o = n({\n    f: \"json\"\n  }, t),\n        {\n    data: i\n  } = await e(r.replace(/\\/rest\\/.*$/i, \"/info\"), o);\n  if (!i || !i.owningSystemUrl) return {\n    supportedTravelModes: [],\n    defaultTravelMode: null\n  };\n  const {\n    owningSystemUrl: d\n  } = i,\n        u = a(d) + \"/sharing/rest/portals/self\",\n        {\n    data: f\n  } = await e(u, o),\n        c = s(\"helperServices.routingUtilities.url\", f);\n  if (!c) return {\n    supportedTravelModes: [],\n    defaultTravelMode: null\n  };\n  const p = l(d),\n        v = /\\/solve$/i.test(p.path) ? \"Route\" : /\\/solveclosestfacility$/i.test(p.path) ? \"ClosestFacility\" : \"ServiceAreas\",\n        m = n({\n    f: \"json\",\n    serviceName: v\n  }, t),\n        T = a(c) + \"/GetTravelModes/execute\",\n        M = await e(T, m),\n        h = [];\n  let g = null;\n\n  if (M?.data?.results?.length) {\n    const e = M.data.results;\n\n    for (const r of e) if (\"supportedTravelModes\" === r.paramName) {\n      if (r.value?.features) for (const {\n        attributes: e\n      } of r.value.features) if (e) {\n        const r = JSON.parse(e.TravelMode);\n        h.push(r);\n      }\n    } else \"defaultTravelMode\" === r.paramName && (g = r.value);\n  }\n\n  return {\n    supportedTravelModes: h,\n    defaultTravelMode: g\n  };\n}\n\nasync function m(t, o, s) {\n  try {\n    const r = n({\n      f: \"json\",\n      token: o\n    }, s),\n          l = a(t) + \"/retrieveTravelModes\",\n          {\n      data: {\n        supportedTravelModes: i,\n        defaultTravelMode: d\n      }\n    } = await e(l, r);\n    return {\n      supportedTravelModes: i,\n      defaultTravelMode: d\n    };\n  } catch (l) {\n    throw new r(\"network-service:retrieveTravelModes\", \"Could not get to the NAServer's retrieveTravelModes.\", {\n      error: l\n    });\n  }\n}\n\nexport { u as collectGeometries, f as dropZValuesOffInputGeometry, p as fetchServiceDescription, c as isInputGeometryZAware };","map":{"version":3,"names":["e","r","t","isSome","o","getDeepValue","s","removeTrailingSlash","a","asValidOptions","n","parseUrl","l","i","d","getLogger","u","length","forEach","push","geometry","f","z","warnOnce","c","hasZ","p","token","data","supportedTravelModes","id","itemId","currentVersion","m","v","defaultTravelMode","fromJSON","replace","owningSystemUrl","test","path","serviceName","T","M","h","g","results","paramName","value","features","attributes","JSON","parse","TravelMode","error","collectGeometries","dropZValuesOffInputGeometry","fetchServiceDescription","isInputGeometryZAware"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/rest/networkService.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";import r from\"../core/Error.js\";import t from\"../core/Logger.js\";import{isSome as o}from\"../core/maybe.js\";import{getDeepValue as s}from\"../core/object.js\";import{removeTrailingSlash as a}from\"../core/urlUtils.js\";import{asValidOptions as n,parseUrl as l}from\"./utils.js\";import i from\"./support/NetworkServiceDescription.js\";const d=t.getLogger(\"esri.rest.networkService\");function u(e,r,t,o){o[t]=[r.length,r.length+e.length],e.forEach((e=>{r.push(e.geometry)}))}function f(e,r){for(let t=0;t<r.length;t++){const o=e[r[t]];if(o&&o.length)for(const e of o)e.z=void 0}d.warnOnce(\"The remote Network Analysis service is powered by a network dataset which is not Z-aware.\\nZ-coordinates of the input geometry are ignored.\")}function c(e,r){for(let t=0;t<r.length;t++){const s=e[r[t]];if(s&&s.length)for(const e of s)if(o(e)&&e.hasZ)return!0}return!1}async function p(t,o,s){if(!t)throw new r(\"network-service:missing-url\",\"Url to Network service is missing\");const a=n({f:\"json\",token:o},s),{data:l}=await e(t,a);l.supportedTravelModes||(l.supportedTravelModes=[]);for(let e=0;e<l.supportedTravelModes.length;e++)l.supportedTravelModes[e].id||(l.supportedTravelModes[e].id=l.supportedTravelModes[e].itemId);const d=l.currentVersion>=10.4?m(t,o,s):v(t,s),{defaultTravelMode:u,supportedTravelModes:f}=await d;return l.defaultTravelMode=u,l.supportedTravelModes=f,i.fromJSON(l)}async function v(r,t){const o=n({f:\"json\"},t),{data:i}=await e(r.replace(/\\/rest\\/.*$/i,\"/info\"),o);if(!i||!i.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:d}=i,u=a(d)+\"/sharing/rest/portals/self\",{data:f}=await e(u,o),c=s(\"helperServices.routingUtilities.url\",f);if(!c)return{supportedTravelModes:[],defaultTravelMode:null};const p=l(d),v=/\\/solve$/i.test(p.path)?\"Route\":/\\/solveclosestfacility$/i.test(p.path)?\"ClosestFacility\":\"ServiceAreas\",m=n({f:\"json\",serviceName:v},t),T=a(c)+\"/GetTravelModes/execute\",M=await e(T,m),h=[];let g=null;if(M?.data?.results?.length){const e=M.data.results;for(const r of e)if(\"supportedTravelModes\"===r.paramName){if(r.value?.features)for(const{attributes:e}of r.value.features)if(e){const r=JSON.parse(e.TravelMode);h.push(r)}}else\"defaultTravelMode\"===r.paramName&&(g=r.value)}return{supportedTravelModes:h,defaultTravelMode:g}}async function m(t,o,s){try{const r=n({f:\"json\",token:o},s),l=a(t)+\"/retrieveTravelModes\",{data:{supportedTravelModes:i,defaultTravelMode:d}}=await e(l,r);return{supportedTravelModes:i,defaultTravelMode:d}}catch(l){throw new r(\"network-service:retrieveTravelModes\",\"Could not get to the NAServer's retrieveTravelModes.\",{error:l})}}export{u as collectGeometries,f as dropZValuesOffInputGeometry,p as fetchServiceDescription,c as isInputGeometryZAware};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}