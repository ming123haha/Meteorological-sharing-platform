{"ast":null,"code":"/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n\n/**\r\n * AUTO-GENERATED FILE. DO NOT MODIFY.\r\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport VisualMapModel from './VisualMapModel.js';\nimport VisualMapping from '../../visual/VisualMapping.js';\nimport visualDefault from '../../visual/visualDefault.js';\nimport { reformIntervals } from '../../util/number.js';\nimport { inheritDefaultOption } from '../../util/component.js';\n\nvar PiecewiseModel =\n/** @class */\nfunction (_super) {\n  __extends(PiecewiseModel, _super);\n\n  function PiecewiseModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = PiecewiseModel.type;\n    /**\r\n     * The order is always [low, ..., high].\r\n     * [{text: string, interval: Array.<number>}, ...]\r\n     */\n\n    _this._pieceList = [];\n    return _this;\n  }\n\n  PiecewiseModel.prototype.optionUpdated = function (newOption, isInit) {\n    _super.prototype.optionUpdated.apply(this, arguments);\n\n    this.resetExtent();\n\n    var mode = this._mode = this._determineMode();\n\n    this._pieceList = [];\n\n    resetMethods[this._mode].call(this, this._pieceList);\n\n    this._resetSelected(newOption, isInit);\n\n    var categories = this.option.categories;\n    this.resetVisual(function (mappingOption, state) {\n      if (mode === 'categories') {\n        mappingOption.mappingMethod = 'category';\n        mappingOption.categories = zrUtil.clone(categories);\n      } else {\n        mappingOption.dataExtent = this.getExtent();\n        mappingOption.mappingMethod = 'piecewise';\n        mappingOption.pieceList = zrUtil.map(this._pieceList, function (piece) {\n          piece = zrUtil.clone(piece);\n\n          if (state !== 'inRange') {\n            // FIXME\n            // outOfRange do not support special visual in pieces.\n            piece.visual = null;\n          }\n\n          return piece;\n        });\n      }\n    });\n  };\n  /**\r\n   * @protected\r\n   * @override\r\n   */\n\n\n  PiecewiseModel.prototype.completeVisualOption = function () {\n    // Consider this case:\n    // visualMap: {\n    //      pieces: [{symbol: 'circle', lt: 0}, {symbol: 'rect', gte: 0}]\n    // }\n    // where no inRange/outOfRange set but only pieces. So we should make\n    // default inRange/outOfRange for this case, otherwise visuals that only\n    // appear in `pieces` will not be taken into account in visual encoding.\n    var option = this.option;\n    var visualTypesInPieces = {};\n    var visualTypes = VisualMapping.listVisualTypes();\n    var isCategory = this.isCategory();\n    zrUtil.each(option.pieces, function (piece) {\n      zrUtil.each(visualTypes, function (visualType) {\n        if (piece.hasOwnProperty(visualType)) {\n          visualTypesInPieces[visualType] = 1;\n        }\n      });\n    });\n    zrUtil.each(visualTypesInPieces, function (v, visualType) {\n      var exists = false;\n      zrUtil.each(this.stateList, function (state) {\n        exists = exists || has(option, state, visualType) || has(option.target, state, visualType);\n      }, this);\n      !exists && zrUtil.each(this.stateList, function (state) {\n        (option[state] || (option[state] = {}))[visualType] = visualDefault.get(visualType, state === 'inRange' ? 'active' : 'inactive', isCategory);\n      });\n    }, this);\n\n    function has(obj, state, visualType) {\n      return obj && obj[state] && obj[state].hasOwnProperty(visualType);\n    }\n\n    _super.prototype.completeVisualOption.apply(this, arguments);\n  };\n\n  PiecewiseModel.prototype._resetSelected = function (newOption, isInit) {\n    var thisOption = this.option;\n    var pieceList = this._pieceList; // Selected do not merge but all override.\n\n    var selected = (isInit ? thisOption : newOption).selected || {};\n    thisOption.selected = selected; // Consider 'not specified' means true.\n\n    zrUtil.each(pieceList, function (piece, index) {\n      var key = this.getSelectedMapKey(piece);\n\n      if (!selected.hasOwnProperty(key)) {\n        selected[key] = true;\n      }\n    }, this);\n\n    if (thisOption.selectedMode === 'single') {\n      // Ensure there is only one selected.\n      var hasSel_1 = false;\n      zrUtil.each(pieceList, function (piece, index) {\n        var key = this.getSelectedMapKey(piece);\n\n        if (selected[key]) {\n          hasSel_1 ? selected[key] = false : hasSel_1 = true;\n        }\n      }, this);\n    } // thisOption.selectedMode === 'multiple', default: all selected.\n\n  };\n  /**\r\n   * @public\r\n   */\n\n\n  PiecewiseModel.prototype.getItemSymbol = function () {\n    return this.get('itemSymbol');\n  };\n  /**\r\n   * @public\r\n   */\n\n\n  PiecewiseModel.prototype.getSelectedMapKey = function (piece) {\n    return this._mode === 'categories' ? piece.value + '' : piece.index + '';\n  };\n  /**\r\n   * @public\r\n   */\n\n\n  PiecewiseModel.prototype.getPieceList = function () {\n    return this._pieceList;\n  };\n  /**\r\n   * @return {string}\r\n   */\n\n\n  PiecewiseModel.prototype._determineMode = function () {\n    var option = this.option;\n    return option.pieces && option.pieces.length > 0 ? 'pieces' : this.option.categories ? 'categories' : 'splitNumber';\n  };\n  /**\r\n   * @override\r\n   */\n\n\n  PiecewiseModel.prototype.setSelected = function (selected) {\n    this.option.selected = zrUtil.clone(selected);\n  };\n  /**\r\n   * @override\r\n   */\n\n\n  PiecewiseModel.prototype.getValueState = function (value) {\n    var index = VisualMapping.findPieceIndex(value, this._pieceList);\n    return index != null ? this.option.selected[this.getSelectedMapKey(this._pieceList[index])] ? 'inRange' : 'outOfRange' : 'outOfRange';\n  };\n  /**\r\n   * @public\r\n   * @param pieceIndex piece index in visualMapModel.getPieceList()\r\n   */\n\n\n  PiecewiseModel.prototype.findTargetDataIndices = function (pieceIndex) {\n    var result = [];\n    var pieceList = this._pieceList;\n    this.eachTargetSeries(function (seriesModel) {\n      var dataIndices = [];\n      var data = seriesModel.getData();\n      data.each(this.getDataDimensionIndex(data), function (value, dataIndex) {\n        // Should always base on model pieceList, because it is order sensitive.\n        var pIdx = VisualMapping.findPieceIndex(value, pieceList);\n        pIdx === pieceIndex && dataIndices.push(dataIndex);\n      }, this);\n      result.push({\n        seriesId: seriesModel.id,\n        dataIndex: dataIndices\n      });\n    }, this);\n    return result;\n  };\n  /**\r\n   * @private\r\n   * @param piece piece.value or piece.interval is required.\r\n   * @return  Can be Infinity or -Infinity\r\n   */\n\n\n  PiecewiseModel.prototype.getRepresentValue = function (piece) {\n    var representValue;\n\n    if (this.isCategory()) {\n      representValue = piece.value;\n    } else {\n      if (piece.value != null) {\n        representValue = piece.value;\n      } else {\n        var pieceInterval = piece.interval || [];\n        representValue = pieceInterval[0] === -Infinity && pieceInterval[1] === Infinity ? 0 : (pieceInterval[0] + pieceInterval[1]) / 2;\n      }\n    }\n\n    return representValue;\n  };\n\n  PiecewiseModel.prototype.getVisualMeta = function (getColorVisual) {\n    // Do not support category. (category axis is ordinal, numerical)\n    if (this.isCategory()) {\n      return;\n    }\n\n    var stops = [];\n    var outerColors = ['', ''];\n    var visualMapModel = this;\n\n    function setStop(interval, valueState) {\n      var representValue = visualMapModel.getRepresentValue({\n        interval: interval\n      }); // Not category\n\n      if (!valueState) {\n        valueState = visualMapModel.getValueState(representValue);\n      }\n\n      var color = getColorVisual(representValue, valueState);\n\n      if (interval[0] === -Infinity) {\n        outerColors[0] = color;\n      } else if (interval[1] === Infinity) {\n        outerColors[1] = color;\n      } else {\n        stops.push({\n          value: interval[0],\n          color: color\n        }, {\n          value: interval[1],\n          color: color\n        });\n      }\n    } // Suplement\n\n\n    var pieceList = this._pieceList.slice();\n\n    if (!pieceList.length) {\n      pieceList.push({\n        interval: [-Infinity, Infinity]\n      });\n    } else {\n      var edge = pieceList[0].interval[0];\n      edge !== -Infinity && pieceList.unshift({\n        interval: [-Infinity, edge]\n      });\n      edge = pieceList[pieceList.length - 1].interval[1];\n      edge !== Infinity && pieceList.push({\n        interval: [edge, Infinity]\n      });\n    }\n\n    var curr = -Infinity;\n    zrUtil.each(pieceList, function (piece) {\n      var interval = piece.interval;\n\n      if (interval) {\n        // Fulfill gap.\n        interval[0] > curr && setStop([curr, interval[0]], 'outOfRange');\n        setStop(interval.slice());\n        curr = interval[1];\n      }\n    }, this);\n    return {\n      stops: stops,\n      outerColors: outerColors\n    };\n  };\n\n  PiecewiseModel.type = 'visualMap.piecewise';\n  PiecewiseModel.defaultOption = inheritDefaultOption(VisualMapModel.defaultOption, {\n    selected: null,\n    minOpen: false,\n    maxOpen: false,\n    align: 'auto',\n    itemWidth: 20,\n    itemHeight: 14,\n    itemSymbol: 'roundRect',\n    pieces: null,\n    categories: null,\n    splitNumber: 5,\n    selectedMode: 'multiple',\n    itemGap: 10,\n    hoverLink: true // Enable hover highlight.\n\n  });\n  return PiecewiseModel;\n}(VisualMapModel);\n\n;\n/**\r\n * Key is this._mode\r\n * @type {Object}\r\n * @this {module:echarts/component/viusalMap/PiecewiseMode}\r\n */\n\nvar resetMethods = {\n  splitNumber: function (outPieceList) {\n    var thisOption = this.option;\n    var precision = Math.min(thisOption.precision, 20);\n    var dataExtent = this.getExtent();\n    var splitNumber = thisOption.splitNumber;\n    splitNumber = Math.max(parseInt(splitNumber, 10), 1);\n    thisOption.splitNumber = splitNumber;\n    var splitStep = (dataExtent[1] - dataExtent[0]) / splitNumber; // Precision auto-adaption\n\n    while (+splitStep.toFixed(precision) !== splitStep && precision < 5) {\n      precision++;\n    }\n\n    thisOption.precision = precision;\n    splitStep = +splitStep.toFixed(precision);\n\n    if (thisOption.minOpen) {\n      outPieceList.push({\n        interval: [-Infinity, dataExtent[0]],\n        close: [0, 0]\n      });\n    }\n\n    for (var index = 0, curr = dataExtent[0]; index < splitNumber; curr += splitStep, index++) {\n      var max = index === splitNumber - 1 ? dataExtent[1] : curr + splitStep;\n      outPieceList.push({\n        interval: [curr, max],\n        close: [1, 1]\n      });\n    }\n\n    if (thisOption.maxOpen) {\n      outPieceList.push({\n        interval: [dataExtent[1], Infinity],\n        close: [0, 0]\n      });\n    }\n\n    reformIntervals(outPieceList);\n    zrUtil.each(outPieceList, function (piece, index) {\n      piece.index = index;\n      piece.text = this.formatValueText(piece.interval);\n    }, this);\n  },\n  categories: function (outPieceList) {\n    var thisOption = this.option;\n    zrUtil.each(thisOption.categories, function (cate) {\n      // FIXME category模式也使用pieceList，但在visualMapping中不是使用pieceList。\n      // 是否改一致。\n      outPieceList.push({\n        text: this.formatValueText(cate, true),\n        value: cate\n      });\n    }, this); // See \"Order Rule\".\n\n    normalizeReverse(thisOption, outPieceList);\n  },\n  pieces: function (outPieceList) {\n    var thisOption = this.option;\n    zrUtil.each(thisOption.pieces, function (pieceListItem, index) {\n      if (!zrUtil.isObject(pieceListItem)) {\n        pieceListItem = {\n          value: pieceListItem\n        };\n      }\n\n      var item = {\n        text: '',\n        index: index\n      };\n\n      if (pieceListItem.label != null) {\n        item.text = pieceListItem.label;\n      }\n\n      if (pieceListItem.hasOwnProperty('value')) {\n        var value = item.value = pieceListItem.value;\n        item.interval = [value, value];\n        item.close = [1, 1];\n      } else {\n        // `min` `max` is legacy option.\n        // `lt` `gt` `lte` `gte` is recommanded.\n        var interval = item.interval = [];\n        var close_1 = item.close = [0, 0];\n        var closeList = [1, 0, 1];\n        var infinityList = [-Infinity, Infinity];\n        var useMinMax = [];\n\n        for (var lg = 0; lg < 2; lg++) {\n          var names = [['gte', 'gt', 'min'], ['lte', 'lt', 'max']][lg];\n\n          for (var i = 0; i < 3 && interval[lg] == null; i++) {\n            interval[lg] = pieceListItem[names[i]];\n            close_1[lg] = closeList[i];\n            useMinMax[lg] = i === 2;\n          }\n\n          interval[lg] == null && (interval[lg] = infinityList[lg]);\n        }\n\n        useMinMax[0] && interval[1] === Infinity && (close_1[0] = 0);\n        useMinMax[1] && interval[0] === -Infinity && (close_1[1] = 0);\n\n        if (process.env.NODE_ENV !== 'production') {\n          if (interval[0] > interval[1]) {\n            console.warn('Piece ' + index + 'is illegal: ' + interval + ' lower bound should not greater then uppper bound.');\n          }\n        }\n\n        if (interval[0] === interval[1] && close_1[0] && close_1[1]) {\n          // Consider: [{min: 5, max: 5, visual: {...}}, {min: 0, max: 5}],\n          // we use value to lift the priority when min === max\n          item.value = interval[0];\n        }\n      }\n\n      item.visual = VisualMapping.retrieveVisuals(pieceListItem);\n      outPieceList.push(item);\n    }, this); // See \"Order Rule\".\n\n    normalizeReverse(thisOption, outPieceList); // Only pieces\n\n    reformIntervals(outPieceList);\n    zrUtil.each(outPieceList, function (piece) {\n      var close = piece.close;\n      var edgeSymbols = [['<', '≤'][close[1]], ['>', '≥'][close[0]]];\n      piece.text = piece.text || this.formatValueText(piece.value != null ? piece.value : piece.interval, false, edgeSymbols);\n    }, this);\n  }\n};\n\nfunction normalizeReverse(thisOption, pieceList) {\n  var inverse = thisOption.inverse;\n\n  if (thisOption.orient === 'vertical' ? !inverse : inverse) {\n    pieceList.reverse();\n  }\n}\n\nexport default PiecewiseModel;","map":{"version":3,"names":["__extends","zrUtil","VisualMapModel","VisualMapping","visualDefault","reformIntervals","inheritDefaultOption","PiecewiseModel","_super","_this","apply","arguments","type","_pieceList","prototype","optionUpdated","newOption","isInit","resetExtent","mode","_mode","_determineMode","resetMethods","call","_resetSelected","categories","option","resetVisual","mappingOption","state","mappingMethod","clone","dataExtent","getExtent","pieceList","map","piece","visual","completeVisualOption","visualTypesInPieces","visualTypes","listVisualTypes","isCategory","each","pieces","visualType","hasOwnProperty","v","exists","stateList","has","target","get","obj","thisOption","selected","index","key","getSelectedMapKey","selectedMode","hasSel_1","getItemSymbol","value","getPieceList","length","setSelected","getValueState","findPieceIndex","findTargetDataIndices","pieceIndex","result","eachTargetSeries","seriesModel","dataIndices","data","getData","getDataDimensionIndex","dataIndex","pIdx","push","seriesId","id","getRepresentValue","representValue","pieceInterval","interval","Infinity","getVisualMeta","getColorVisual","stops","outerColors","visualMapModel","setStop","valueState","color","slice","edge","unshift","curr","defaultOption","minOpen","maxOpen","align","itemWidth","itemHeight","itemSymbol","splitNumber","itemGap","hoverLink","outPieceList","precision","Math","min","max","parseInt","splitStep","toFixed","close","text","formatValueText","cate","normalizeReverse","pieceListItem","isObject","item","label","close_1","closeList","infinityList","useMinMax","lg","names","i","process","env","NODE_ENV","console","warn","retrieveVisuals","edgeSymbols","inverse","orient","reverse"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/echarts/lib/component/visualMap/PiecewiseModel.js"],"sourcesContent":["\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n\r\n/**\r\n * AUTO-GENERATED FILE. DO NOT MODIFY.\r\n */\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\nimport { __extends } from \"tslib\";\r\nimport * as zrUtil from 'zrender/lib/core/util.js';\r\nimport VisualMapModel from './VisualMapModel.js';\r\nimport VisualMapping from '../../visual/VisualMapping.js';\r\nimport visualDefault from '../../visual/visualDefault.js';\r\nimport { reformIntervals } from '../../util/number.js';\r\nimport { inheritDefaultOption } from '../../util/component.js';\r\n\r\nvar PiecewiseModel =\r\n/** @class */\r\nfunction (_super) {\r\n  __extends(PiecewiseModel, _super);\r\n\r\n  function PiecewiseModel() {\r\n    var _this = _super !== null && _super.apply(this, arguments) || this;\r\n\r\n    _this.type = PiecewiseModel.type;\r\n    /**\r\n     * The order is always [low, ..., high].\r\n     * [{text: string, interval: Array.<number>}, ...]\r\n     */\r\n\r\n    _this._pieceList = [];\r\n    return _this;\r\n  }\r\n\r\n  PiecewiseModel.prototype.optionUpdated = function (newOption, isInit) {\r\n    _super.prototype.optionUpdated.apply(this, arguments);\r\n\r\n    this.resetExtent();\r\n\r\n    var mode = this._mode = this._determineMode();\r\n\r\n    this._pieceList = [];\r\n\r\n    resetMethods[this._mode].call(this, this._pieceList);\r\n\r\n    this._resetSelected(newOption, isInit);\r\n\r\n    var categories = this.option.categories;\r\n    this.resetVisual(function (mappingOption, state) {\r\n      if (mode === 'categories') {\r\n        mappingOption.mappingMethod = 'category';\r\n        mappingOption.categories = zrUtil.clone(categories);\r\n      } else {\r\n        mappingOption.dataExtent = this.getExtent();\r\n        mappingOption.mappingMethod = 'piecewise';\r\n        mappingOption.pieceList = zrUtil.map(this._pieceList, function (piece) {\r\n          piece = zrUtil.clone(piece);\r\n\r\n          if (state !== 'inRange') {\r\n            // FIXME\r\n            // outOfRange do not support special visual in pieces.\r\n            piece.visual = null;\r\n          }\r\n\r\n          return piece;\r\n        });\r\n      }\r\n    });\r\n  };\r\n  /**\r\n   * @protected\r\n   * @override\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.completeVisualOption = function () {\r\n    // Consider this case:\r\n    // visualMap: {\r\n    //      pieces: [{symbol: 'circle', lt: 0}, {symbol: 'rect', gte: 0}]\r\n    // }\r\n    // where no inRange/outOfRange set but only pieces. So we should make\r\n    // default inRange/outOfRange for this case, otherwise visuals that only\r\n    // appear in `pieces` will not be taken into account in visual encoding.\r\n    var option = this.option;\r\n    var visualTypesInPieces = {};\r\n    var visualTypes = VisualMapping.listVisualTypes();\r\n    var isCategory = this.isCategory();\r\n    zrUtil.each(option.pieces, function (piece) {\r\n      zrUtil.each(visualTypes, function (visualType) {\r\n        if (piece.hasOwnProperty(visualType)) {\r\n          visualTypesInPieces[visualType] = 1;\r\n        }\r\n      });\r\n    });\r\n    zrUtil.each(visualTypesInPieces, function (v, visualType) {\r\n      var exists = false;\r\n      zrUtil.each(this.stateList, function (state) {\r\n        exists = exists || has(option, state, visualType) || has(option.target, state, visualType);\r\n      }, this);\r\n      !exists && zrUtil.each(this.stateList, function (state) {\r\n        (option[state] || (option[state] = {}))[visualType] = visualDefault.get(visualType, state === 'inRange' ? 'active' : 'inactive', isCategory);\r\n      });\r\n    }, this);\r\n\r\n    function has(obj, state, visualType) {\r\n      return obj && obj[state] && obj[state].hasOwnProperty(visualType);\r\n    }\r\n\r\n    _super.prototype.completeVisualOption.apply(this, arguments);\r\n  };\r\n\r\n  PiecewiseModel.prototype._resetSelected = function (newOption, isInit) {\r\n    var thisOption = this.option;\r\n    var pieceList = this._pieceList; // Selected do not merge but all override.\r\n\r\n    var selected = (isInit ? thisOption : newOption).selected || {};\r\n    thisOption.selected = selected; // Consider 'not specified' means true.\r\n\r\n    zrUtil.each(pieceList, function (piece, index) {\r\n      var key = this.getSelectedMapKey(piece);\r\n\r\n      if (!selected.hasOwnProperty(key)) {\r\n        selected[key] = true;\r\n      }\r\n    }, this);\r\n\r\n    if (thisOption.selectedMode === 'single') {\r\n      // Ensure there is only one selected.\r\n      var hasSel_1 = false;\r\n      zrUtil.each(pieceList, function (piece, index) {\r\n        var key = this.getSelectedMapKey(piece);\r\n\r\n        if (selected[key]) {\r\n          hasSel_1 ? selected[key] = false : hasSel_1 = true;\r\n        }\r\n      }, this);\r\n    } // thisOption.selectedMode === 'multiple', default: all selected.\r\n\r\n  };\r\n  /**\r\n   * @public\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.getItemSymbol = function () {\r\n    return this.get('itemSymbol');\r\n  };\r\n  /**\r\n   * @public\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.getSelectedMapKey = function (piece) {\r\n    return this._mode === 'categories' ? piece.value + '' : piece.index + '';\r\n  };\r\n  /**\r\n   * @public\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.getPieceList = function () {\r\n    return this._pieceList;\r\n  };\r\n  /**\r\n   * @return {string}\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype._determineMode = function () {\r\n    var option = this.option;\r\n    return option.pieces && option.pieces.length > 0 ? 'pieces' : this.option.categories ? 'categories' : 'splitNumber';\r\n  };\r\n  /**\r\n   * @override\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.setSelected = function (selected) {\r\n    this.option.selected = zrUtil.clone(selected);\r\n  };\r\n  /**\r\n   * @override\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.getValueState = function (value) {\r\n    var index = VisualMapping.findPieceIndex(value, this._pieceList);\r\n    return index != null ? this.option.selected[this.getSelectedMapKey(this._pieceList[index])] ? 'inRange' : 'outOfRange' : 'outOfRange';\r\n  };\r\n  /**\r\n   * @public\r\n   * @param pieceIndex piece index in visualMapModel.getPieceList()\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.findTargetDataIndices = function (pieceIndex) {\r\n    var result = [];\r\n    var pieceList = this._pieceList;\r\n    this.eachTargetSeries(function (seriesModel) {\r\n      var dataIndices = [];\r\n      var data = seriesModel.getData();\r\n      data.each(this.getDataDimensionIndex(data), function (value, dataIndex) {\r\n        // Should always base on model pieceList, because it is order sensitive.\r\n        var pIdx = VisualMapping.findPieceIndex(value, pieceList);\r\n        pIdx === pieceIndex && dataIndices.push(dataIndex);\r\n      }, this);\r\n      result.push({\r\n        seriesId: seriesModel.id,\r\n        dataIndex: dataIndices\r\n      });\r\n    }, this);\r\n    return result;\r\n  };\r\n  /**\r\n   * @private\r\n   * @param piece piece.value or piece.interval is required.\r\n   * @return  Can be Infinity or -Infinity\r\n   */\r\n\r\n\r\n  PiecewiseModel.prototype.getRepresentValue = function (piece) {\r\n    var representValue;\r\n\r\n    if (this.isCategory()) {\r\n      representValue = piece.value;\r\n    } else {\r\n      if (piece.value != null) {\r\n        representValue = piece.value;\r\n      } else {\r\n        var pieceInterval = piece.interval || [];\r\n        representValue = pieceInterval[0] === -Infinity && pieceInterval[1] === Infinity ? 0 : (pieceInterval[0] + pieceInterval[1]) / 2;\r\n      }\r\n    }\r\n\r\n    return representValue;\r\n  };\r\n\r\n  PiecewiseModel.prototype.getVisualMeta = function (getColorVisual) {\r\n    // Do not support category. (category axis is ordinal, numerical)\r\n    if (this.isCategory()) {\r\n      return;\r\n    }\r\n\r\n    var stops = [];\r\n    var outerColors = ['', ''];\r\n    var visualMapModel = this;\r\n\r\n    function setStop(interval, valueState) {\r\n      var representValue = visualMapModel.getRepresentValue({\r\n        interval: interval\r\n      }); // Not category\r\n\r\n      if (!valueState) {\r\n        valueState = visualMapModel.getValueState(representValue);\r\n      }\r\n\r\n      var color = getColorVisual(representValue, valueState);\r\n\r\n      if (interval[0] === -Infinity) {\r\n        outerColors[0] = color;\r\n      } else if (interval[1] === Infinity) {\r\n        outerColors[1] = color;\r\n      } else {\r\n        stops.push({\r\n          value: interval[0],\r\n          color: color\r\n        }, {\r\n          value: interval[1],\r\n          color: color\r\n        });\r\n      }\r\n    } // Suplement\r\n\r\n\r\n    var pieceList = this._pieceList.slice();\r\n\r\n    if (!pieceList.length) {\r\n      pieceList.push({\r\n        interval: [-Infinity, Infinity]\r\n      });\r\n    } else {\r\n      var edge = pieceList[0].interval[0];\r\n      edge !== -Infinity && pieceList.unshift({\r\n        interval: [-Infinity, edge]\r\n      });\r\n      edge = pieceList[pieceList.length - 1].interval[1];\r\n      edge !== Infinity && pieceList.push({\r\n        interval: [edge, Infinity]\r\n      });\r\n    }\r\n\r\n    var curr = -Infinity;\r\n    zrUtil.each(pieceList, function (piece) {\r\n      var interval = piece.interval;\r\n\r\n      if (interval) {\r\n        // Fulfill gap.\r\n        interval[0] > curr && setStop([curr, interval[0]], 'outOfRange');\r\n        setStop(interval.slice());\r\n        curr = interval[1];\r\n      }\r\n    }, this);\r\n    return {\r\n      stops: stops,\r\n      outerColors: outerColors\r\n    };\r\n  };\r\n\r\n  PiecewiseModel.type = 'visualMap.piecewise';\r\n  PiecewiseModel.defaultOption = inheritDefaultOption(VisualMapModel.defaultOption, {\r\n    selected: null,\r\n    minOpen: false,\r\n    maxOpen: false,\r\n    align: 'auto',\r\n    itemWidth: 20,\r\n    itemHeight: 14,\r\n    itemSymbol: 'roundRect',\r\n    pieces: null,\r\n    categories: null,\r\n    splitNumber: 5,\r\n    selectedMode: 'multiple',\r\n    itemGap: 10,\r\n    hoverLink: true // Enable hover highlight.\r\n\r\n  });\r\n  return PiecewiseModel;\r\n}(VisualMapModel);\r\n\r\n;\r\n/**\r\n * Key is this._mode\r\n * @type {Object}\r\n * @this {module:echarts/component/viusalMap/PiecewiseMode}\r\n */\r\n\r\nvar resetMethods = {\r\n  splitNumber: function (outPieceList) {\r\n    var thisOption = this.option;\r\n    var precision = Math.min(thisOption.precision, 20);\r\n    var dataExtent = this.getExtent();\r\n    var splitNumber = thisOption.splitNumber;\r\n    splitNumber = Math.max(parseInt(splitNumber, 10), 1);\r\n    thisOption.splitNumber = splitNumber;\r\n    var splitStep = (dataExtent[1] - dataExtent[0]) / splitNumber; // Precision auto-adaption\r\n\r\n    while (+splitStep.toFixed(precision) !== splitStep && precision < 5) {\r\n      precision++;\r\n    }\r\n\r\n    thisOption.precision = precision;\r\n    splitStep = +splitStep.toFixed(precision);\r\n\r\n    if (thisOption.minOpen) {\r\n      outPieceList.push({\r\n        interval: [-Infinity, dataExtent[0]],\r\n        close: [0, 0]\r\n      });\r\n    }\r\n\r\n    for (var index = 0, curr = dataExtent[0]; index < splitNumber; curr += splitStep, index++) {\r\n      var max = index === splitNumber - 1 ? dataExtent[1] : curr + splitStep;\r\n      outPieceList.push({\r\n        interval: [curr, max],\r\n        close: [1, 1]\r\n      });\r\n    }\r\n\r\n    if (thisOption.maxOpen) {\r\n      outPieceList.push({\r\n        interval: [dataExtent[1], Infinity],\r\n        close: [0, 0]\r\n      });\r\n    }\r\n\r\n    reformIntervals(outPieceList);\r\n    zrUtil.each(outPieceList, function (piece, index) {\r\n      piece.index = index;\r\n      piece.text = this.formatValueText(piece.interval);\r\n    }, this);\r\n  },\r\n  categories: function (outPieceList) {\r\n    var thisOption = this.option;\r\n    zrUtil.each(thisOption.categories, function (cate) {\r\n      // FIXME category模式也使用pieceList，但在visualMapping中不是使用pieceList。\r\n      // 是否改一致。\r\n      outPieceList.push({\r\n        text: this.formatValueText(cate, true),\r\n        value: cate\r\n      });\r\n    }, this); // See \"Order Rule\".\r\n\r\n    normalizeReverse(thisOption, outPieceList);\r\n  },\r\n  pieces: function (outPieceList) {\r\n    var thisOption = this.option;\r\n    zrUtil.each(thisOption.pieces, function (pieceListItem, index) {\r\n      if (!zrUtil.isObject(pieceListItem)) {\r\n        pieceListItem = {\r\n          value: pieceListItem\r\n        };\r\n      }\r\n\r\n      var item = {\r\n        text: '',\r\n        index: index\r\n      };\r\n\r\n      if (pieceListItem.label != null) {\r\n        item.text = pieceListItem.label;\r\n      }\r\n\r\n      if (pieceListItem.hasOwnProperty('value')) {\r\n        var value = item.value = pieceListItem.value;\r\n        item.interval = [value, value];\r\n        item.close = [1, 1];\r\n      } else {\r\n        // `min` `max` is legacy option.\r\n        // `lt` `gt` `lte` `gte` is recommanded.\r\n        var interval = item.interval = [];\r\n        var close_1 = item.close = [0, 0];\r\n        var closeList = [1, 0, 1];\r\n        var infinityList = [-Infinity, Infinity];\r\n        var useMinMax = [];\r\n\r\n        for (var lg = 0; lg < 2; lg++) {\r\n          var names = [['gte', 'gt', 'min'], ['lte', 'lt', 'max']][lg];\r\n\r\n          for (var i = 0; i < 3 && interval[lg] == null; i++) {\r\n            interval[lg] = pieceListItem[names[i]];\r\n            close_1[lg] = closeList[i];\r\n            useMinMax[lg] = i === 2;\r\n          }\r\n\r\n          interval[lg] == null && (interval[lg] = infinityList[lg]);\r\n        }\r\n\r\n        useMinMax[0] && interval[1] === Infinity && (close_1[0] = 0);\r\n        useMinMax[1] && interval[0] === -Infinity && (close_1[1] = 0);\r\n\r\n        if (process.env.NODE_ENV !== 'production') {\r\n          if (interval[0] > interval[1]) {\r\n            console.warn('Piece ' + index + 'is illegal: ' + interval + ' lower bound should not greater then uppper bound.');\r\n          }\r\n        }\r\n\r\n        if (interval[0] === interval[1] && close_1[0] && close_1[1]) {\r\n          // Consider: [{min: 5, max: 5, visual: {...}}, {min: 0, max: 5}],\r\n          // we use value to lift the priority when min === max\r\n          item.value = interval[0];\r\n        }\r\n      }\r\n\r\n      item.visual = VisualMapping.retrieveVisuals(pieceListItem);\r\n      outPieceList.push(item);\r\n    }, this); // See \"Order Rule\".\r\n\r\n    normalizeReverse(thisOption, outPieceList); // Only pieces\r\n\r\n    reformIntervals(outPieceList);\r\n    zrUtil.each(outPieceList, function (piece) {\r\n      var close = piece.close;\r\n      var edgeSymbols = [['<', '≤'][close[1]], ['>', '≥'][close[0]]];\r\n      piece.text = piece.text || this.formatValueText(piece.value != null ? piece.value : piece.interval, false, edgeSymbols);\r\n    }, this);\r\n  }\r\n};\r\n\r\nfunction normalizeReverse(thisOption, pieceList) {\r\n  var inverse = thisOption.inverse;\r\n\r\n  if (thisOption.orient === 'vertical' ? !inverse : inverse) {\r\n    pieceList.reverse();\r\n  }\r\n}\r\n\r\nexport default PiecewiseModel;"],"mappings":"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"},"metadata":{},"sourceType":"module"}