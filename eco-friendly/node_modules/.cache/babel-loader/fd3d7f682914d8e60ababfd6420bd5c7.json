{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { isNone as t } from \"../../../core/maybe.js\";\nimport { debounce as a } from \"../../../core/promiseUtils.js\";\nimport { when as i } from \"../../../core/reactiveUtils.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/set.js\";\nimport { subclass as r } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport s from \"./DynamicLayerView3D.js\";\nimport o from \"../../layers/ImageryLayerView.js\";\nlet n = class extends o(s) {\n  constructor() {\n    super(...arguments), this.type = \"imagery-3d\", this.redrawDebounced = a(async e => {\n      this.redraw((e, t) => this._redrawImage(e, t), e);\n    }, 2e3);\n  }\n\n  initialize() {\n    this.handles.add([i(() => this.view.basemapTerrain.ready, () => this._initializeMaximumDataResolution(), {\n      once: !0,\n      initial: !0\n    }), this.layer.on(\"redraw\", () => this.updatingHandles.addPromise(this.redrawDebounced()))]), this.updatingHandles.add(() => this.layer?.exportImageServiceParameters?.version, () => {\n      this.updatingHandles.addPromise(this.refreshDebounced());\n    }), this.updatingHandles.add(() => this.timeExtent, () => this.updatingHandles.addPromise(this.refreshDebounced()));\n  }\n\n  _initializeMaximumDataResolution() {\n    const e = this.view.basemapTerrain.spatialReference,\n          t = this.layer.fullExtent;\n    !t || e.equals(t.spatialReference), this.maximumDataResolution = {\n      x: this.layer.pixelSizeX,\n      y: this.layer.pixelSizeY\n    };\n  }\n\n  getFetchOptions() {\n    return {\n      timeExtent: this.timeExtent\n    };\n  }\n\n  async processResult(e, t, a) {\n    t.imageElement ? e.image = t.imageElement : (e.image = document.createElement(\"canvas\"), e.pixelData = t.pixelData, await this._redrawImage(e, a));\n  }\n\n  async _redrawImage(e, a) {\n    if (!(e.image instanceof HTMLCanvasElement) || t(e.pixelData)) throw new Error();\n    const i = e.image,\n          r = i.getContext(\"2d\"),\n          s = await this.layer.applyRenderer(e.pixelData, {\n      signal: a\n    }),\n          o = this.layer.applyFilter(s).pixelBlock;\n    if (t(o)) throw new Error();\n    i.width = o.width, i.height = o.height;\n    const n = r.createImageData(o.width, o.height);\n    n.data.set(o.getAsRGBA()), r.putImageData(n, 0, 0);\n  }\n\n};\nn = e([r(\"esri.views.3d.layers.ImageryLayerView3D\")], n);\nconst m = n;\nexport { m as default };","map":{"version":3,"names":["_","e","isNone","t","debounce","a","when","i","subclass","r","s","o","n","constructor","arguments","type","redrawDebounced","redraw","_redrawImage","initialize","handles","add","view","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","layer","on","updatingHandles","addPromise","exportImageServiceParameters","version","refreshDebounced","timeExtent","spatialReference","fullExtent","equals","maximumDataResolution","x","pixelSizeX","y","pixelSizeY","getFetchOptions","processResult","imageElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","signal","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData","m","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{isNone as t}from\"../../../core/maybe.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/set.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"./DynamicLayerView3D.js\";import o from\"../../layers/ImageryLayerView.js\";let n=class extends(o(s)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,t)=>this._redrawImage(e,t)),e)}),2e3)}initialize(){this.handles.add([i((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this.updatingHandles.addPromise(this.redrawDebounced())))]),this.updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this.updatingHandles.addPromise(this.refreshDebounced())})),this.updatingHandles.add((()=>this.timeExtent),(()=>this.updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){const e=this.view.basemapTerrain.spatialReference,t=this.layer.fullExtent;!t||e.equals(t.spatialReference),this.maximumDataResolution={x:this.layer.pixelSizeX,y:this.layer.pixelSizeY}}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,t,a){t.imageElement?e.image=t.imageElement:(e.image=document.createElement(\"canvas\"),e.pixelData=t.pixelData,await this._redrawImage(e,a))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||t(e.pixelData))throw new Error;const i=e.image,r=i.getContext(\"2d\"),s=await this.layer.applyRenderer(e.pixelData,{signal:a}),o=this.layer.applyFilter(s).pixelBlock;if(t(o))throw new Error;i.width=o.width,i.height=o.height;const n=r.createImageData(o.width,o.height);n.data.set(o.getAsRGBA()),r.putImageData(n,0,0)}};n=e([r(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const m=n;export{m as default};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,8BAAlB;AAAiD,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,wBAAvB;AAAgD,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,+BAAzB;AAAyD,SAAOC,IAAI,IAAIC,CAAf,QAAqB,gCAArB;AAAsD,OAAM,yBAAN;AAAgC,OAAM,6CAAN;AAAoD,OAAM,6BAAN;AAAoC,OAAM,sBAAN;AAA6B,OAAM,sCAAN;AAA6C,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,sDAAzB;AAAgF,OAAOC,CAAP,MAAa,yBAAb;AAAuC,OAAOC,CAAP,MAAa,kCAAb;AAAgD,IAAIC,CAAC,GAAC,cAAcD,CAAC,CAACD,CAAD,CAAf,CAAmB;EAACG,WAAW,GAAE;IAAC,MAAM,GAAGC,SAAT,GAAoB,KAAKC,IAAL,GAAU,YAA9B,EAA2C,KAAKC,eAAL,GAAqBX,CAAC,CAAE,MAAMJ,CAAN,IAAS;MAAC,KAAKgB,MAAL,CAAa,CAAChB,CAAD,EAAGE,CAAH,KAAO,KAAKe,YAAL,CAAkBjB,CAAlB,EAAoBE,CAApB,CAApB,EAA4CF,CAA5C;IAA+C,CAA3D,EAA6D,GAA7D,CAAjE;EAAmI;;EAAAkB,UAAU,GAAE;IAAC,KAAKC,OAAL,CAAaC,GAAb,CAAiB,CAACd,CAAC,CAAE,MAAI,KAAKe,IAAL,CAAUC,cAAV,CAAyBC,KAA/B,EAAuC,MAAI,KAAKC,gCAAL,EAA3C,EAAoF;MAACC,IAAI,EAAC,CAAC,CAAP;MAASC,OAAO,EAAC,CAAC;IAAlB,CAApF,CAAF,EAA4G,KAAKC,KAAL,CAAWC,EAAX,CAAc,QAAd,EAAwB,MAAI,KAAKC,eAAL,CAAqBC,UAArB,CAAgC,KAAKf,eAAL,EAAhC,CAA5B,CAA5G,CAAjB,GAAqN,KAAKc,eAAL,CAAqBT,GAArB,CAA0B,MAAI,KAAKO,KAAL,EAAYI,4BAAZ,EAA0CC,OAAxE,EAAkF,MAAI;MAAC,KAAKH,eAAL,CAAqBC,UAArB,CAAgC,KAAKG,gBAAL,EAAhC;IAAyD,CAAhJ,CAArN,EAAwW,KAAKJ,eAAL,CAAqBT,GAArB,CAA0B,MAAI,KAAKc,UAAnC,EAAgD,MAAI,KAAKL,eAAL,CAAqBC,UAArB,CAAgC,KAAKG,gBAAL,EAAhC,CAApD,CAAxW;EAAud;;EAAAT,gCAAgC,GAAE;IAAC,MAAMxB,CAAC,GAAC,KAAKqB,IAAL,CAAUC,cAAV,CAAyBa,gBAAjC;IAAA,MAAkDjC,CAAC,GAAC,KAAKyB,KAAL,CAAWS,UAA/D;IAA0E,CAAClC,CAAD,IAAIF,CAAC,CAACqC,MAAF,CAASnC,CAAC,CAACiC,gBAAX,CAAJ,EAAiC,KAAKG,qBAAL,GAA2B;MAACC,CAAC,EAAC,KAAKZ,KAAL,CAAWa,UAAd;MAAyBC,CAAC,EAAC,KAAKd,KAAL,CAAWe;IAAtC,CAA5D;EAA8G;;EAAAC,eAAe,GAAE;IAAC,OAAM;MAACT,UAAU,EAAC,KAAKA;IAAjB,CAAN;EAAmC;;EAAmB,MAAbU,aAAa,CAAC5C,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAO;IAACF,CAAC,CAAC2C,YAAF,GAAe7C,CAAC,CAAC8C,KAAF,GAAQ5C,CAAC,CAAC2C,YAAzB,IAAuC7C,CAAC,CAAC8C,KAAF,GAAQC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAR,EAAyChD,CAAC,CAACiD,SAAF,GAAY/C,CAAC,CAAC+C,SAAvD,EAAiE,MAAM,KAAKhC,YAAL,CAAkBjB,CAAlB,EAAoBI,CAApB,CAA9G;EAAsI;;EAAkB,MAAZa,YAAY,CAACjB,CAAD,EAAGI,CAAH,EAAK;IAAC,IAAG,EAAEJ,CAAC,CAAC8C,KAAF,YAAmBI,iBAArB,KAAyChD,CAAC,CAACF,CAAC,CAACiD,SAAH,CAA7C,EAA2D,MAAM,IAAIE,KAAJ,EAAN;IAAgB,MAAM7C,CAAC,GAACN,CAAC,CAAC8C,KAAV;IAAA,MAAgBtC,CAAC,GAACF,CAAC,CAAC8C,UAAF,CAAa,IAAb,CAAlB;IAAA,MAAqC3C,CAAC,GAAC,MAAM,KAAKkB,KAAL,CAAW0B,aAAX,CAAyBrD,CAAC,CAACiD,SAA3B,EAAqC;MAACK,MAAM,EAAClD;IAAR,CAArC,CAA7C;IAAA,MAA8FM,CAAC,GAAC,KAAKiB,KAAL,CAAW4B,WAAX,CAAuB9C,CAAvB,EAA0B+C,UAA1H;IAAqI,IAAGtD,CAAC,CAACQ,CAAD,CAAJ,EAAQ,MAAM,IAAIyC,KAAJ,EAAN;IAAgB7C,CAAC,CAACmD,KAAF,GAAQ/C,CAAC,CAAC+C,KAAV,EAAgBnD,CAAC,CAACoD,MAAF,GAAShD,CAAC,CAACgD,MAA3B;IAAkC,MAAM/C,CAAC,GAACH,CAAC,CAACmD,eAAF,CAAkBjD,CAAC,CAAC+C,KAApB,EAA0B/C,CAAC,CAACgD,MAA5B,CAAR;IAA4C/C,CAAC,CAACiD,IAAF,CAAOC,GAAP,CAAWnD,CAAC,CAACoD,SAAF,EAAX,GAA0BtD,CAAC,CAACuD,YAAF,CAAepD,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,CAA1B;EAAgD;;AAAr6C,CAAzB;AAAg8CA,CAAC,GAACX,CAAC,CAAC,CAACQ,CAAC,CAAC,yCAAD,CAAF,CAAD,EAAgDG,CAAhD,CAAH;AAAsD,MAAMqD,CAAC,GAACrD,CAAR;AAAU,SAAOqD,CAAC,IAAIC,OAAZ"},"metadata":{},"sourceType":"module"}