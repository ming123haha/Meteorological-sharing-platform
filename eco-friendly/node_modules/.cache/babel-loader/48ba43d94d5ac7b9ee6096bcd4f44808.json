{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isNone as e, isSome as t, unwrapOr as r } from \"../../../../core/maybe.js\";\nimport i from \"../../../../core/PooledArray.js\";\nimport { castRenderScreenPointArray3 as n, createRenderScreenPointArray3 as s } from \"../../../../core/screenUtils.js\";\nimport { a as o, n as a, g as c, l } from \"../../../../chunks/vec3.js\";\nimport { c as h } from \"../../../../chunks/vec3f64.js\";\nimport { create as u, copy as m, NEGATIVE_INFINITY as d, width as p, height as y, expandPointInPlace as g } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { create as f } from \"../../../../geometry/support/ray.js\";\nimport { sv3d as R } from \"../../../../geometry/support/vectorStacks.js\";\nimport { ViewingMode as v } from \"../../../ViewingMode.js\";\nimport { fromRenderAtEye as x, fromScreen as w } from \"../../support/geometryUtils/ray.js\";\nimport { DEFAULT_TOLERANCE as b, newIntersector as I } from \"../../webgl-engine/lib/Intersector.js\";\nimport { StoreResults as M, IntersectorType as P } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nimport { isValidIntersectorResult as j, sliceFilterPredicate as E } from \"../../webgl-engine/lib/intersectorUtils.js\";\n\nclass H {\n  constructor(e, t, r) {\n    this.viewingMode = e, this._forEachLayer = t, this.view = r, this.externalIntersectionHandlers = new i(), this.tolerance = b, this.tmpRay = f(), this.tmpRegion = u(), this.validateHUDIntersector = I(this.viewingMode), this.validateHUDIntersector.options.hud = !1;\n  }\n\n  intersectScreen(e, t, r) {\n    return this.intersectRay(this._getPickRay(e, this.tmpRay), k(this.viewingMode), t, r);\n  }\n\n  intersectScreenFreePointFallback(e, t, r) {\n    return this.intersectRayFreePointFallback(this._getPickRay(e, this.tmpRay), t, r);\n  }\n\n  intersectRayFreePointFallback(e, t, r) {\n    return this.intersectRay(e, k(this.viewingMode), t, r) || this._intersectRayFreePointLocal(e, t);\n  }\n\n  intersectRay(e, t, r, i) {\n    return t.options.selectionMode = !1, t.options.store = M.MIN, this.computeIntersection(e, t, i), !!t.results.min && t.results.min.getIntersectionPoint(r);\n  }\n\n  getCenterRayWithSubpixelOffset(e, t, r = .5, i = .5) {\n    return e.getRenderCenter(N, r, i), N[0] += .0466, N[1] -= .0123, x(e, N, t);\n  }\n\n  intersectIntersectorScreen(e, t, r) {\n    this.computeIntersection(this._getPickRay(e, this.tmpRay), t, r);\n  }\n\n  intersectToolIntersectorScreen(e, t, r) {\n    const i = this._getPickRay(e, this.tmpRay);\n\n    this.intersectToolIntersectorRay(i, t, r);\n  }\n\n  intersectToolIntersectorRay(e, t, r) {\n    t.options.selectionMode = !0, this.computeIntersection(e, t, r);\n    const i = t.results.min;\n    !!this.view.basemapTerrain && this.view.basemapTerrain.opaque || j(i) && i.intersector !== P.TERRAIN || (t.options.selectionMode = !1, this.computeIntersection(e, t, r));\n  }\n\n  setTolerance(e = b) {\n    this.tolerance = e;\n  }\n\n  addIntersectionHandler(e) {\n    this.externalIntersectionHandlers.push(e), this.externalIntersectionHandlers.sort((e, t) => e.type === P.TERRAIN ? 1 : t.type === P.TERRAIN ? -1 : 0);\n  }\n\n  removeIntersectionHandler(e) {\n    null != this.externalIntersectionHandlers.removeUnordered(e) && this.externalIntersectionHandlers.sort((e, t) => e.type === P.TERRAIN ? 1 : t.type === P.TERRAIN ? -1 : 0);\n  }\n\n  _getPickRay(e, t) {\n    const r = this.view.state.camera;\n    return w(r, e, t);\n  }\n\n  _intersectRayFreePointLocal(t, r) {\n    if (this.viewingMode !== v.Local || e(t)) return !1;\n    const i = this.view.renderDataExtent;\n    if (e(i)) return o(r, t.origin, a(R.get(), t.direction)), !0;\n    const n = {\n      x: i.xmax - i.xmin,\n      y: i.ymax - i.ymin,\n      z: 8 * Math.max(i.xmax - i.xmin, i.ymax - i.ymin)\n    },\n          s = Math.max(n.x, n.y, n.z);\n    if (0 === s) return o(r, t.origin, a(R.get(), t.direction)), !0;\n    const h = this.view.state.camera,\n          u = Math.max(0, i.xmin - h.eye[0], h.eye[0] - i.xmax),\n          m = Math.max(0, i.ymin - h.eye[1], h.eye[1] - i.ymax),\n          d = Math.sqrt(u * u + m * m),\n          p = Math.abs(h.relativeElevation) + Number.MIN_VALUE,\n          y = Math.max(0, Math.log(s / p)) ** 2;\n    let g = s / Math.max(1, y);\n    g = Math.max(g, Math.min(d, s));\n    const f = c(R.get(), t.direction, g / l(t.direction));\n    return o(r, t.origin, f), !0;\n  }\n\n  intersectElevationFromScreen(e, t, r = 0, i = null) {\n    return this._intersectElevation(this._getPickRay(e, this.tmpRay), t, r, i);\n  }\n\n  _intersectElevation(i, s, a = 0, c = null) {\n    if (e(i)) return null;\n    const l = t(s) ? s.mode : \"absolute-height\",\n          h = t(s) ? r(s.offset, 0) : 0,\n          u = \"on-the-ground\" !== l ? h + a : 0,\n          m = u / this.view.renderCoordsHelper.unitInMeters;\n\n    if (\"absolute-height\" === l) {\n      if (this.view.renderCoordsHelper.intersectInfiniteManifold(i, u, S)) {\n        const e = this.view.computeMapPointFromVec3d(S);\n        return e.z -= h, e;\n      }\n\n      return null;\n    }\n\n    const d = this.view.state.camera,\n          p = n(R.get());\n    d.projectToRenderScreen(i.origin, p);\n    const y = new A(null, this._forEachLayer),\n          g = this.view.slicePlane,\n          f = t(g) ? E(g) : null,\n          v = I(this.viewingMode);\n    v.options.store = M.MIN, v.options.verticalOffset = m;\n    const x = i.origin,\n          w = o(R.get(), x, i.direction);\n    v.reset(x, w, d), v.point = p;\n    const b = t(c) ? \"type\" in c && \"graphics\" === c.type ? e => e.metadata.layerUid !== c.uid : e => e.metadata.graphicUid !== c.uid : null;\n\n    switch (l) {\n      case \"relative-to-scene\":\n        {\n          const t = t => (e(b) || b(t)) && t.metadata && t.metadata.isElevationSource;\n\n          v.intersect(y.layers, p, this.tolerance, null, t), this.externalIntersectionHandlers.forAll(e => {\n            if (e.type === P.I3S || e.type === P.TERRAIN) {\n              const t = e.slicePlaneEnabled ? f : null;\n              e.intersect(v, t, v.rayBegin, v.rayEnd, p);\n            }\n          });\n        }\n        break;\n\n      case \"on-the-ground\":\n      case \"relative-to-ground\":\n        this.externalIntersectionHandlers.forAll(e => {\n          if (e.isGround) {\n            const t = e.slicePlaneEnabled ? f : null;\n            e.intersect(v, t, v.rayBegin, v.rayEnd, p);\n          }\n        });\n    }\n\n    if (v.results.min.getIntersectionPoint(S)) {\n      const e = this.view.computeMapPointFromVec3d(S);\n      return e.z = a, e;\n    }\n\n    return null;\n  }\n\n  computeIntersection(i, s, a) {\n    if (e(i)) return;\n    const c = this.view.state.camera,\n          l = n(R.get());\n    c.projectToRenderScreen(i.origin, l);\n    const h = new A(a, this._forEachLayer);\n    s.options.selectOpaqueTerrainOnly = !a || !(\"include\" in a || \"exclude\" in a);\n    const u = i.origin,\n          m = o(R.get(), i.origin, i.direction);\n    s.reset(u, m, c), s.intersect(h.layers, l, this.tolerance);\n    const d = this.view.slicePlane,\n          p = t(d) ? E(d) : null;\n    s.intersect(h.sliceableLayers, l, this.tolerance, p);\n    const y = a && (a.requiresGroundFeedback || a.enableDraped);\n    this.externalIntersectionHandlers.forAll(e => {\n      if (s.options.isFiltered = !h.filterLayerUid(e.layerUid), e.isGround && y || !s.options.isFiltered) {\n        const t = e.slicePlaneEnabled ? p : null;\n        e.intersect(s, t, u, m, l);\n      }\n    });\n    const g = R.get();\n\n    if (a && a.enableDraped && s.results.ground.getIntersectionPoint(g)) {\n      const e = this.view.basemapTerrain,\n            t = e.overlayManager.renderer,\n            i = this.view.renderCoordsHelper.spatialReference,\n            n = R.get();\n      this.view.renderCoordsHelper.fromRenderCoords(g, n, e.spatialReference), n[2] = r(this.view.elevationProvider.getElevation(g[0], g[1], g[2], i, \"ground\"), 0), t.intersect(s, n, s.results.ground, e => h.filterRenderGeometry(e));\n    }\n\n    s.sortResults(), this._processHUDResults(s);\n  }\n\n  _processHUDResults(r) {\n    const i = r.results.hud;\n    m(this.tmpRegion, d);\n\n    const n = this.view.state.camera,\n          s = [],\n          o = this.tmpRegion,\n          a = e => {\n      const t = new T(e);\n      n.projectToRenderScreen(e.target.center, t.screenPoint), t.screenPoint[0] = Math.floor(t.screenPoint[0]), t.screenPoint[1] = Math.floor(t.screenPoint[1]), s.push(t), g(o, t.screenPoint);\n    };\n\n    r.sortResults(i.all), t(i.min.dist) && a(i.min);\n\n    for (const e of i.all) i.min.target.object !== e.target.object && i.max.target.object !== e.target.object && a(e);\n\n    if (t(i.max.dist) && i.max.target.object !== i.min.target.object && a(i.max), !s.length) return;\n    o[0] === o[2] && (o[2] += 1), o[1] === o[3] && (o[3] += 1);\n    const c = n.fullWidth,\n          l = n.fullHeight,\n          h = Math.max(0, o[0] - U),\n          u = Math.max(0, o[1] - U),\n          f = Math.min(p(o) + 2 * U, c - h),\n          R = Math.min(y(o) + 2 * U, l - u),\n          v = new Uint8Array(f * R * 4);\n\n    this.view._stage.renderView.readHUDVisibility(h, u, f, R, v);\n\n    let x = !0;\n    const w = e(r.results.max.dist);\n    let b = 0;\n\n    for (const e of s) for (const t of L) {\n      if (v[4 * (Math.min(e.screenPoint[0] + t[0], c) - o[0] + (Math.min(e.screenPoint[1] + t[1], l) - o[1]) * f)]) {\n        x && (r.results.min.copy(e.result), x = !1), w && r.results.max.copy(e.result), r.options.store === M.ALL && r.results.all.splice(b++, 0, e.result);\n        break;\n      }\n    }\n  }\n\n}\n\nconst U = 1,\n      L = (() => {\n  const e = [],\n        t = U;\n\n  for (let r = -t; r <= t; r++) for (let i = -t; i <= t; i++) e.push([i + t, r + t]);\n\n  return e;\n})();\n\nclass T {\n  constructor(e) {\n    this.result = e, this.screenPoint = s();\n  }\n\n}\n\nlet _;\n\nfunction k(e) {\n  return _ && _.viewingMode === e || (_ = I(e)), _;\n}\n\nclass A {\n  constructor(e, t) {\n    this.layers = new Array(), this.sliceableLayers = new Array(), this.include = e?.include, this.exclude = e?.exclude, t(e => {\n      e.isPickable && this.filterLayerUid(e.apiLayerUid) && (e.isSliceable ? this.sliceableLayers : this.layers).push(e);\n    });\n  }\n\n  filterLayerUid(t) {\n    const {\n      include: r,\n      exclude: i\n    } = this;\n    return e(t) ? null == r && null == i : (null == r || r.has(t)) && (null == i || !i.has(t));\n  }\n\n  filterRenderGeometry(e) {\n    return this.filterLayerUid(e.layerUid);\n  }\n\n}\n\nfunction F(e) {\n  return \"object\" == typeof e && \"intersect\" in e;\n}\n\nconst S = h(),\n      N = s();\nexport { H as SceneIntersectionHelper, F as isIntersectionHandler };","map":{"version":3,"names":["isNone","e","isSome","t","unwrapOr","r","i","castRenderScreenPointArray3","n","createRenderScreenPointArray3","s","a","o","g","c","l","h","create","u","copy","m","NEGATIVE_INFINITY","d","width","p","height","y","expandPointInPlace","f","sv3d","R","ViewingMode","v","fromRenderAtEye","x","fromScreen","w","DEFAULT_TOLERANCE","b","newIntersector","I","StoreResults","M","IntersectorType","P","isValidIntersectorResult","j","sliceFilterPredicate","E","H","constructor","viewingMode","_forEachLayer","view","externalIntersectionHandlers","tolerance","tmpRay","tmpRegion","validateHUDIntersector","options","hud","intersectScreen","intersectRay","_getPickRay","k","intersectScreenFreePointFallback","intersectRayFreePointFallback","_intersectRayFreePointLocal","selectionMode","store","MIN","computeIntersection","results","min","getIntersectionPoint","getCenterRayWithSubpixelOffset","getRenderCenter","N","intersectIntersectorScreen","intersectToolIntersectorScreen","intersectToolIntersectorRay","basemapTerrain","opaque","intersector","TERRAIN","setTolerance","addIntersectionHandler","push","sort","type","removeIntersectionHandler","removeUnordered","state","camera","Local","renderDataExtent","origin","get","direction","xmax","xmin","ymax","ymin","z","Math","max","eye","sqrt","abs","relativeElevation","Number","MIN_VALUE","log","intersectElevationFromScreen","_intersectElevation","mode","offset","renderCoordsHelper","unitInMeters","intersectInfiniteManifold","S","computeMapPointFromVec3d","projectToRenderScreen","A","slicePlane","verticalOffset","reset","point","metadata","layerUid","uid","graphicUid","isElevationSource","intersect","layers","forAll","I3S","slicePlaneEnabled","rayBegin","rayEnd","isGround","selectOpaqueTerrainOnly","sliceableLayers","requiresGroundFeedback","enableDraped","isFiltered","filterLayerUid","ground","overlayManager","renderer","spatialReference","fromRenderCoords","elevationProvider","getElevation","filterRenderGeometry","sortResults","_processHUDResults","T","target","center","screenPoint","floor","all","dist","object","length","fullWidth","fullHeight","U","Uint8Array","_stage","renderView","readHUDVisibility","L","result","ALL","splice","_","Array","include","exclude","isPickable","apiLayerUid","isSliceable","has","F","SceneIntersectionHelper","isIntersectionHandler"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/state/helpers/SceneIntersectionHelper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as t,unwrapOr as r}from\"../../../../core/maybe.js\";import i from\"../../../../core/PooledArray.js\";import{castRenderScreenPointArray3 as n,createRenderScreenPointArray3 as s}from\"../../../../core/screenUtils.js\";import{a as o,n as a,g as c,l}from\"../../../../chunks/vec3.js\";import{c as h}from\"../../../../chunks/vec3f64.js\";import{create as u,copy as m,NEGATIVE_INFINITY as d,width as p,height as y,expandPointInPlace as g}from\"../../../../geometry/support/aaBoundingRect.js\";import{create as f}from\"../../../../geometry/support/ray.js\";import{sv3d as R}from\"../../../../geometry/support/vectorStacks.js\";import{ViewingMode as v}from\"../../../ViewingMode.js\";import{fromRenderAtEye as x,fromScreen as w}from\"../../support/geometryUtils/ray.js\";import{DEFAULT_TOLERANCE as b,newIntersector as I}from\"../../webgl-engine/lib/Intersector.js\";import{StoreResults as M,IntersectorType as P}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";import{isValidIntersectorResult as j,sliceFilterPredicate as E}from\"../../webgl-engine/lib/intersectorUtils.js\";class H{constructor(e,t,r){this.viewingMode=e,this._forEachLayer=t,this.view=r,this.externalIntersectionHandlers=new i,this.tolerance=b,this.tmpRay=f(),this.tmpRegion=u(),this.validateHUDIntersector=I(this.viewingMode),this.validateHUDIntersector.options.hud=!1}intersectScreen(e,t,r){return this.intersectRay(this._getPickRay(e,this.tmpRay),k(this.viewingMode),t,r)}intersectScreenFreePointFallback(e,t,r){return this.intersectRayFreePointFallback(this._getPickRay(e,this.tmpRay),t,r)}intersectRayFreePointFallback(e,t,r){return this.intersectRay(e,k(this.viewingMode),t,r)||this._intersectRayFreePointLocal(e,t)}intersectRay(e,t,r,i){return t.options.selectionMode=!1,t.options.store=M.MIN,this.computeIntersection(e,t,i),!!t.results.min&&t.results.min.getIntersectionPoint(r)}getCenterRayWithSubpixelOffset(e,t,r=.5,i=.5){return e.getRenderCenter(N,r,i),N[0]+=.0466,N[1]-=.0123,x(e,N,t)}intersectIntersectorScreen(e,t,r){this.computeIntersection(this._getPickRay(e,this.tmpRay),t,r)}intersectToolIntersectorScreen(e,t,r){const i=this._getPickRay(e,this.tmpRay);this.intersectToolIntersectorRay(i,t,r)}intersectToolIntersectorRay(e,t,r){t.options.selectionMode=!0,this.computeIntersection(e,t,r);const i=t.results.min;!!this.view.basemapTerrain&&this.view.basemapTerrain.opaque||j(i)&&i.intersector!==P.TERRAIN||(t.options.selectionMode=!1,this.computeIntersection(e,t,r))}setTolerance(e=b){this.tolerance=e}addIntersectionHandler(e){this.externalIntersectionHandlers.push(e),this.externalIntersectionHandlers.sort(((e,t)=>e.type===P.TERRAIN?1:t.type===P.TERRAIN?-1:0))}removeIntersectionHandler(e){null!=this.externalIntersectionHandlers.removeUnordered(e)&&this.externalIntersectionHandlers.sort(((e,t)=>e.type===P.TERRAIN?1:t.type===P.TERRAIN?-1:0))}_getPickRay(e,t){const r=this.view.state.camera;return w(r,e,t)}_intersectRayFreePointLocal(t,r){if(this.viewingMode!==v.Local||e(t))return!1;const i=this.view.renderDataExtent;if(e(i))return o(r,t.origin,a(R.get(),t.direction)),!0;const n={x:i.xmax-i.xmin,y:i.ymax-i.ymin,z:8*Math.max(i.xmax-i.xmin,i.ymax-i.ymin)},s=Math.max(n.x,n.y,n.z);if(0===s)return o(r,t.origin,a(R.get(),t.direction)),!0;const h=this.view.state.camera,u=Math.max(0,i.xmin-h.eye[0],h.eye[0]-i.xmax),m=Math.max(0,i.ymin-h.eye[1],h.eye[1]-i.ymax),d=Math.sqrt(u*u+m*m),p=Math.abs(h.relativeElevation)+Number.MIN_VALUE,y=Math.max(0,Math.log(s/p))**2;let g=s/Math.max(1,y);g=Math.max(g,Math.min(d,s));const f=c(R.get(),t.direction,g/l(t.direction));return o(r,t.origin,f),!0}intersectElevationFromScreen(e,t,r=0,i=null){return this._intersectElevation(this._getPickRay(e,this.tmpRay),t,r,i)}_intersectElevation(i,s,a=0,c=null){if(e(i))return null;const l=t(s)?s.mode:\"absolute-height\",h=t(s)?r(s.offset,0):0,u=\"on-the-ground\"!==l?h+a:0,m=u/this.view.renderCoordsHelper.unitInMeters;if(\"absolute-height\"===l){if(this.view.renderCoordsHelper.intersectInfiniteManifold(i,u,S)){const e=this.view.computeMapPointFromVec3d(S);return e.z-=h,e}return null}const d=this.view.state.camera,p=n(R.get());d.projectToRenderScreen(i.origin,p);const y=new A(null,this._forEachLayer),g=this.view.slicePlane,f=t(g)?E(g):null,v=I(this.viewingMode);v.options.store=M.MIN,v.options.verticalOffset=m;const x=i.origin,w=o(R.get(),x,i.direction);v.reset(x,w,d),v.point=p;const b=t(c)?\"type\"in c&&\"graphics\"===c.type?e=>e.metadata.layerUid!==c.uid:e=>e.metadata.graphicUid!==c.uid:null;switch(l){case\"relative-to-scene\":{const t=t=>(e(b)||b(t))&&t.metadata&&t.metadata.isElevationSource;v.intersect(y.layers,p,this.tolerance,null,t),this.externalIntersectionHandlers.forAll((e=>{if(e.type===P.I3S||e.type===P.TERRAIN){const t=e.slicePlaneEnabled?f:null;e.intersect(v,t,v.rayBegin,v.rayEnd,p)}}))}break;case\"on-the-ground\":case\"relative-to-ground\":this.externalIntersectionHandlers.forAll((e=>{if(e.isGround){const t=e.slicePlaneEnabled?f:null;e.intersect(v,t,v.rayBegin,v.rayEnd,p)}}))}if(v.results.min.getIntersectionPoint(S)){const e=this.view.computeMapPointFromVec3d(S);return e.z=a,e}return null}computeIntersection(i,s,a){if(e(i))return;const c=this.view.state.camera,l=n(R.get());c.projectToRenderScreen(i.origin,l);const h=new A(a,this._forEachLayer);s.options.selectOpaqueTerrainOnly=!a||!(\"include\"in a||\"exclude\"in a);const u=i.origin,m=o(R.get(),i.origin,i.direction);s.reset(u,m,c),s.intersect(h.layers,l,this.tolerance);const d=this.view.slicePlane,p=t(d)?E(d):null;s.intersect(h.sliceableLayers,l,this.tolerance,p);const y=a&&(a.requiresGroundFeedback||a.enableDraped);this.externalIntersectionHandlers.forAll((e=>{if(s.options.isFiltered=!h.filterLayerUid(e.layerUid),e.isGround&&y||!s.options.isFiltered){const t=e.slicePlaneEnabled?p:null;e.intersect(s,t,u,m,l)}}));const g=R.get();if(a&&a.enableDraped&&s.results.ground.getIntersectionPoint(g)){const e=this.view.basemapTerrain,t=e.overlayManager.renderer,i=this.view.renderCoordsHelper.spatialReference,n=R.get();this.view.renderCoordsHelper.fromRenderCoords(g,n,e.spatialReference),n[2]=r(this.view.elevationProvider.getElevation(g[0],g[1],g[2],i,\"ground\"),0),t.intersect(s,n,s.results.ground,(e=>h.filterRenderGeometry(e)))}s.sortResults(),this._processHUDResults(s)}_processHUDResults(r){const i=r.results.hud;m(this.tmpRegion,d);const n=this.view.state.camera,s=[],o=this.tmpRegion,a=e=>{const t=new T(e);n.projectToRenderScreen(e.target.center,t.screenPoint),t.screenPoint[0]=Math.floor(t.screenPoint[0]),t.screenPoint[1]=Math.floor(t.screenPoint[1]),s.push(t),g(o,t.screenPoint)};r.sortResults(i.all),t(i.min.dist)&&a(i.min);for(const e of i.all)i.min.target.object!==e.target.object&&i.max.target.object!==e.target.object&&a(e);if(t(i.max.dist)&&i.max.target.object!==i.min.target.object&&a(i.max),!s.length)return;o[0]===o[2]&&(o[2]+=1),o[1]===o[3]&&(o[3]+=1);const c=n.fullWidth,l=n.fullHeight,h=Math.max(0,o[0]-U),u=Math.max(0,o[1]-U),f=Math.min(p(o)+2*U,c-h),R=Math.min(y(o)+2*U,l-u),v=new Uint8Array(f*R*4);this.view._stage.renderView.readHUDVisibility(h,u,f,R,v);let x=!0;const w=e(r.results.max.dist);let b=0;for(const e of s)for(const t of L){if(v[4*(Math.min(e.screenPoint[0]+t[0],c)-o[0]+(Math.min(e.screenPoint[1]+t[1],l)-o[1])*f)]){x&&(r.results.min.copy(e.result),x=!1),w&&r.results.max.copy(e.result),r.options.store===M.ALL&&r.results.all.splice(b++,0,e.result);break}}}}const U=1,L=(()=>{const e=[],t=U;for(let r=-t;r<=t;r++)for(let i=-t;i<=t;i++)e.push([i+t,r+t]);return e})();class T{constructor(e){this.result=e,this.screenPoint=s()}}let _;function k(e){return _&&_.viewingMode===e||(_=I(e)),_}class A{constructor(e,t){this.layers=new Array,this.sliceableLayers=new Array,this.include=e?.include,this.exclude=e?.exclude,t((e=>{e.isPickable&&this.filterLayerUid(e.apiLayerUid)&&(e.isSliceable?this.sliceableLayers:this.layers).push(e)}))}filterLayerUid(t){const{include:r,exclude:i}=this;return e(t)?null==r&&null==i:(null==r||r.has(t))&&(null==i||!i.has(t))}filterRenderGeometry(e){return this.filterLayerUid(e.layerUid)}}function F(e){return\"object\"==typeof e&&\"intersect\"in e}const S=h(),N=s();export{H as SceneIntersectionHelper,F as isIntersectionHandler};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}