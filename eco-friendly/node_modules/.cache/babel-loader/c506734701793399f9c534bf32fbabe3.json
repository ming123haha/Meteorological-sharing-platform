{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { neverReached as t } from \"../../../../core/compilerUtils.js\";\nimport e from \"../../../../core/Error.js\";\nimport r from \"../../../../core/Evented.js\";\nimport { isPowerOfTwo as i, nextHighestPowerOfTwo as s } from \"../../../../core/mathUtils.js\";\nimport { isNone as a, isSome as o, removeMaybe as n } from \"../../../../core/maybe.js\";\nimport { throwIfAborted as m, onAbort as h, createAbortError as l } from \"../../../../core/promiseUtils.js\";\nimport { isArrayBuffer as p, isUint8Array as d } from \"../../../../core/typedArrayUtil.js\";\nimport { isBlobProtocol as _, isDataProtocol as c } from \"../../../../core/urlUtils.js\";\nimport { requestImage as u } from \"../../../../support/requestImageUtils.js\";\nimport { loadImageAsync as T } from \"../../../../support/requestUtils.js\";\nimport { T as g } from \"../../../../chunks/TextureOnly.glsl.js\";\nimport { PowerOfTwoResizeMode as f } from \"./basicInterfaces.js\";\nimport { estimateMemoryKTX2 as w, estimateMemoryBasis as E, createTextureKTX2 as A, createTextureBasis as x } from \"./BasisUtil.js\";\nimport { ContentObject as D } from \"./ContentObject.js\";\nimport { ContentObjectType as I } from \"./ContentObjectType.js\";\nimport { createDDSTexture as M } from \"./DDSUtil.js\";\nimport { createQuadVAO as y } from \"./glUtil3D.js\";\nimport { assert as F } from \"./Util.js\";\nimport { TextureWrapMode as O, TextureType as N, PixelFormat as R, PixelType as U, TextureSamplingMode as b, TargetType as C, DepthStencilTargetType as P, PrimitiveType as S } from \"../../../webgl/enums.js\";\nimport { FramebufferObject as H } from \"../../../webgl/FramebufferObject.js\";\nimport { Texture as v } from \"../../../webgl/Texture.js\";\nimport { vertexCount as V } from \"../../../webgl/Util.js\";\nimport j from \"../../../webgl/capabilities/isWebGL2Context.js\";\n\nclass L extends D {\n  constructor(t, e) {\n    super(), this._data = t, this.type = I.Texture, this._glTexture = null, this._powerOfTwoStretchInfo = null, this._loadingPromise = null, this._loadingController = null, this.events = new r(), this._passParameters = new g(), this.params = e || {}, this.params.mipmap = !1 !== this.params.mipmap, this.params.noUnpackFlip = this.params.noUnpackFlip || !1, this.params.preMultiplyAlpha = this.params.preMultiplyAlpha || !1, this.params.wrap = this.params.wrap || {\n      s: O.REPEAT,\n      t: O.REPEAT\n    }, this.params.powerOfTwoResizeMode = this.params.powerOfTwoResizeMode || f.STRETCH, this.estimatedTexMemRequired = L._estimateTexMemRequired(this._data, this.params), this._startPreload();\n  }\n\n  _startPreload() {\n    const t = this._data;\n    a(t) || (t instanceof HTMLVideoElement ? this._startPreloadVideoElement(t) : t instanceof HTMLImageElement && this._startPreloadImageElement(t));\n  }\n\n  _startPreloadVideoElement(t) {\n    if (!(_(t.src) || \"auto\" === t.preload && t.crossOrigin)) {\n      t.preload = \"auto\", t.crossOrigin = \"anonymous\";\n      const e = !t.paused;\n\n      if (t.src = t.src, e && t.autoplay) {\n        const e = () => {\n          t.removeEventListener(\"canplay\", e), t.play();\n        };\n\n        t.addEventListener(\"canplay\", e);\n      }\n    }\n  }\n\n  _startPreloadImageElement(t) {\n    c(t.src) || _(t.src) || t.crossOrigin || (t.crossOrigin = \"anonymous\", t.src = t.src);\n  }\n\n  static _getDataDimensions(t) {\n    return t instanceof HTMLVideoElement ? {\n      width: t.videoWidth,\n      height: t.videoHeight\n    } : t;\n  }\n\n  static _estimateTexMemRequired(t, e) {\n    if (a(t)) return 0;\n    if (p(t) || d(t)) return e.encoding === L.KTX2_ENCODING ? w(t, e.mipmap) : e.encoding === L.BASIS_ENCODING ? E(t, e.mipmap) : t.byteLength;\n    const {\n      width: r,\n      height: i\n    } = t instanceof Image || t instanceof ImageData || t instanceof HTMLCanvasElement || t instanceof HTMLVideoElement ? L._getDataDimensions(t) : e;\n    return (e.mipmap ? 4 / 3 : 1) * r * i * (e.components || 4) || 0;\n  }\n\n  dispose() {\n    this._data = void 0;\n  }\n\n  get width() {\n    return this.params.width;\n  }\n\n  get height() {\n    return this.params.height;\n  }\n\n  _createDescriptor(t) {\n    return {\n      target: N.TEXTURE_2D,\n      pixelFormat: R.RGBA,\n      dataType: U.UNSIGNED_BYTE,\n      wrapMode: this.params.wrap,\n      flipped: !this.params.noUnpackFlip,\n      samplingMode: this.params.mipmap ? b.LINEAR_MIPMAP_LINEAR : b.LINEAR,\n      hasMipmap: this.params.mipmap,\n      preMultiplyAlpha: this.params.preMultiplyAlpha,\n      maxAnisotropy: this.params.maxAnisotropy ?? (this.params.mipmap ? t.parameters.maxMaxAnisotropy : 1)\n    };\n  }\n\n  get glTexture() {\n    return this._glTexture;\n  }\n\n  load(t, e) {\n    if (o(this._glTexture)) return this._glTexture;\n    if (o(this._loadingPromise)) return this._loadingPromise;\n    const r = this._data;\n    return a(r) ? (this._glTexture = new v(t, this._createDescriptor(t), null), this._glTexture) : \"string\" == typeof r ? this._loadFromURL(t, e, r) : r instanceof Image ? this._loadFromImageElement(t, e, r) : r instanceof HTMLVideoElement ? this._loadFromVideoElement(t, e, r) : r instanceof ImageData || r instanceof HTMLCanvasElement ? this._loadFromImage(t, r, e) : (p(r) || d(r)) && this.params.encoding === L.DDS_ENCODING ? (this._data = void 0, this._loadFromDDSData(t, r)) : (p(r) || d(r)) && this.params.encoding === L.KTX2_ENCODING ? (this._data = void 0, this._loadFromKTX2(t, r)) : (p(r) || d(r)) && this.params.encoding === L.BASIS_ENCODING ? (this._data = void 0, this._loadFromBasis(t, r)) : d(r) ? this._loadFromPixelData(t, r) : p(r) ? this._loadFromPixelData(t, new Uint8Array(r)) : null;\n  }\n\n  get requiresFrameUpdates() {\n    return this._data instanceof HTMLVideoElement;\n  }\n\n  frameUpdate(t, e, r) {\n    if (!(this._data instanceof HTMLVideoElement) || a(this._glTexture)) return r;\n    if (this._data.readyState < G.HAVE_CURRENT_DATA || r === this._data.currentTime) return r;\n\n    if (o(this._powerOfTwoStretchInfo)) {\n      const {\n        framebuffer: r,\n        vao: i,\n        sourceTexture: s\n      } = this._powerOfTwoStretchInfo;\n      s.setData(this._data), this._drawStretchedTexture(t, e, r, i, s, this._glTexture);\n    } else {\n      const {\n        videoWidth: t,\n        videoHeight: e\n      } = this._data,\n            {\n        width: r,\n        height: i\n      } = this._glTexture.descriptor;\n      t !== r || e !== i ? this._glTexture.updateData(0, 0, 0, Math.min(t, r), Math.min(e, i), this._data) : this._glTexture.setData(this._data);\n    }\n\n    return this._glTexture.descriptor.hasMipmap && this._glTexture.generateMipmap(), this.params.updateCallback && this.params.updateCallback(), this._data.currentTime;\n  }\n\n  _loadFromDDSData(t, e) {\n    return this._glTexture = M(t, this._createDescriptor(t), e), this._glTexture;\n  }\n\n  _loadFromKTX2(t, e) {\n    return this._loadAsync(() => A(t, this._createDescriptor(t), e).then(t => (this._glTexture = t, t)));\n  }\n\n  _loadFromBasis(t, e) {\n    return this._loadAsync(() => x(t, this._createDescriptor(t), e).then(t => (this._glTexture = t, t)));\n  }\n\n  _loadFromPixelData(t, e) {\n    F(this.params.width > 0 && this.params.height > 0);\n\n    const r = this._createDescriptor(t);\n\n    return r.pixelFormat = 1 === this.params.components ? R.LUMINANCE : 3 === this.params.components ? R.RGB : R.RGBA, r.width = this.params.width, r.height = this.params.height, this._glTexture = new v(t, r, e), this._glTexture;\n  }\n\n  _loadFromURL(t, e, r) {\n    return this._loadAsync(async i => {\n      const s = await u(r, {\n        signal: i\n      });\n      return m(i), this._loadFromImage(t, s, e);\n    });\n  }\n\n  _loadFromImageElement(t, e, r) {\n    return r.complete ? this._loadFromImage(t, r, e) : this._loadAsync(async i => {\n      const s = await T(r, r.src, !1, i);\n      return m(i), this._loadFromImage(t, s, e);\n    });\n  }\n\n  _loadFromVideoElement(t, e, r) {\n    return r.readyState >= G.HAVE_CURRENT_DATA ? this._loadFromImage(t, r, e) : this._loadFromVideoElementAsync(t, e, r);\n  }\n\n  _loadFromVideoElementAsync(t, r, i) {\n    return this._loadAsync(s => new Promise((a, o) => {\n      const m = () => {\n        i.removeEventListener(\"loadeddata\", p), i.removeEventListener(\"error\", d), n(_);\n      },\n            p = () => {\n        i.readyState >= G.HAVE_CURRENT_DATA && (m(), a(this._loadFromImage(t, i, r)));\n      },\n            d = t => {\n        m(), o(t || new e(\"Failed to load video\"));\n      };\n\n      i.addEventListener(\"loadeddata\", p), i.addEventListener(\"error\", d);\n\n      const _ = h(s, () => d(l()));\n    }));\n  }\n\n  _loadFromImage(t, e, r) {\n    const s = L._getDataDimensions(e);\n\n    this.params.width = s.width, this.params.height = s.height;\n\n    const a = this._createDescriptor(t);\n\n    return a.pixelFormat = 3 === this.params.components ? R.RGB : R.RGBA, !this._requiresPowerOfTwo(t, a) || i(s.width) && i(s.height) ? (a.width = s.width, a.height = s.height, this._glTexture = new v(t, a, e), this._glTexture) : (this._glTexture = this._makePowerOfTwoTexture(t, e, s, a, r), this._glTexture);\n  }\n\n  _loadAsync(t) {\n    const e = new AbortController();\n    this._loadingController = e;\n    const r = t(e.signal);\n    this._loadingPromise = r;\n\n    const i = () => {\n      this._loadingController === e && (this._loadingController = null), this._loadingPromise === r && (this._loadingPromise = null);\n    };\n\n    return r.then(i, i), r;\n  }\n\n  _requiresPowerOfTwo(t, e) {\n    const r = O.CLAMP_TO_EDGE,\n          i = \"number\" == typeof e.wrapMode ? e.wrapMode === r : e.wrapMode.s === r && e.wrapMode.t === r;\n    return !j(t.gl) && (e.hasMipmap || !i);\n  }\n\n  _makePowerOfTwoTexture(e, r, i, a, o) {\n    const {\n      width: n,\n      height: m\n    } = i,\n          h = s(n),\n          l = s(m);\n    let p;\n\n    switch (a.width = h, a.height = l, this.params.powerOfTwoResizeMode) {\n      case f.PAD:\n        a.textureCoordinateScaleFactor = [n / h, m / l], p = new v(e, a), p.updateData(0, 0, 0, n, m, r);\n        break;\n\n      case f.STRETCH:\n      case null:\n      case void 0:\n        p = this._stretchToPowerOfTwo(e, r, a, o());\n        break;\n\n      default:\n        t(this.params.powerOfTwoResizeMode);\n    }\n\n    return a.hasMipmap && p.generateMipmap(), p;\n  }\n\n  _stretchToPowerOfTwo(t, e, r, i) {\n    const s = new v(t, r),\n          a = new H(t, {\n      colorTarget: C.TEXTURE,\n      depthStencilTarget: P.NONE\n    }, s),\n          o = new v(t, {\n      target: N.TEXTURE_2D,\n      pixelFormat: r.pixelFormat,\n      dataType: U.UNSIGNED_BYTE,\n      wrapMode: O.CLAMP_TO_EDGE,\n      samplingMode: b.LINEAR,\n      flipped: !!r.flipped,\n      maxAnisotropy: 8,\n      preMultiplyAlpha: r.preMultiplyAlpha\n    }, e),\n          n = y(t),\n          m = t.getBoundFramebufferObject();\n    return this._drawStretchedTexture(t, i, a, n, o, s), this.requiresFrameUpdates ? this._powerOfTwoStretchInfo = {\n      vao: n,\n      sourceTexture: o,\n      framebuffer: a\n    } : (n.dispose(!0), o.dispose(), a.detachColorTexture(), a.dispose()), t.bindFramebuffer(m), s;\n  }\n\n  _drawStretchedTexture(t, e, r, i, s, a) {\n    this._passParameters.texture = s, t.bindFramebuffer(r);\n    const o = t.getViewport();\n    t.setViewport(0, 0, a.descriptor.width, a.descriptor.height), t.bindTechnique(e, this._passParameters, null), t.bindVAO(i), t.drawArrays(S.TRIANGLE_STRIP, 0, V(i, \"geometry\")), t.bindFramebuffer(null), t.setViewport(o.x, o.y, o.width, o.height), this._passParameters.texture = null;\n  }\n\n  unload() {\n    if (o(this._powerOfTwoStretchInfo)) {\n      const {\n        framebuffer: t,\n        vao: e,\n        sourceTexture: r\n      } = this._powerOfTwoStretchInfo;\n      e.dispose(!0), r.dispose(), t.dispose(), this._glTexture = null, this._powerOfTwoStretchInfo = null;\n    }\n\n    if (o(this._glTexture) && (this._glTexture.dispose(), this._glTexture = null), o(this._loadingController)) {\n      const t = this._loadingController;\n      this._loadingController = null, this._loadingPromise = null, t.abort();\n    }\n\n    this.events.emit(\"unloaded\");\n  }\n\n}\n\nvar G;\nL.DDS_ENCODING = \"image/vnd-ms.dds\", L.KTX2_ENCODING = \"image/ktx2\", L.BASIS_ENCODING = \"image/x.basis\", function (t) {\n  t[t.HAVE_NOTHING = 0] = \"HAVE_NOTHING\", t[t.HAVE_METADATA = 1] = \"HAVE_METADATA\", t[t.HAVE_CURRENT_DATA = 2] = \"HAVE_CURRENT_DATA\", t[t.HAVE_FUTURE_DATA = 3] = \"HAVE_FUTURE_DATA\", t[t.HAVE_ENOUGH_DATA = 4] = \"HAVE_ENOUGH_DATA\";\n}(G || (G = {}));\nexport { L as Texture };","map":{"version":3,"names":["neverReached","t","e","r","isPowerOfTwo","i","nextHighestPowerOfTwo","s","isNone","a","isSome","o","removeMaybe","n","throwIfAborted","m","onAbort","h","createAbortError","l","isArrayBuffer","p","isUint8Array","d","isBlobProtocol","_","isDataProtocol","c","requestImage","u","loadImageAsync","T","g","PowerOfTwoResizeMode","f","estimateMemoryKTX2","w","estimateMemoryBasis","E","createTextureKTX2","A","createTextureBasis","x","ContentObject","D","ContentObjectType","I","createDDSTexture","M","createQuadVAO","y","assert","F","TextureWrapMode","O","TextureType","N","PixelFormat","R","PixelType","U","TextureSamplingMode","b","TargetType","C","DepthStencilTargetType","P","PrimitiveType","S","FramebufferObject","H","Texture","v","vertexCount","V","j","L","constructor","_data","type","_glTexture","_powerOfTwoStretchInfo","_loadingPromise","_loadingController","events","_passParameters","params","mipmap","noUnpackFlip","preMultiplyAlpha","wrap","REPEAT","powerOfTwoResizeMode","STRETCH","estimatedTexMemRequired","_estimateTexMemRequired","_startPreload","HTMLVideoElement","_startPreloadVideoElement","HTMLImageElement","_startPreloadImageElement","src","preload","crossOrigin","paused","autoplay","removeEventListener","play","addEventListener","_getDataDimensions","width","videoWidth","height","videoHeight","encoding","KTX2_ENCODING","BASIS_ENCODING","byteLength","Image","ImageData","HTMLCanvasElement","components","dispose","_createDescriptor","target","TEXTURE_2D","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","wrapMode","flipped","samplingMode","LINEAR_MIPMAP_LINEAR","LINEAR","hasMipmap","maxAnisotropy","parameters","maxMaxAnisotropy","glTexture","load","_loadFromURL","_loadFromImageElement","_loadFromVideoElement","_loadFromImage","DDS_ENCODING","_loadFromDDSData","_loadFromKTX2","_loadFromBasis","_loadFromPixelData","Uint8Array","requiresFrameUpdates","frameUpdate","readyState","G","HAVE_CURRENT_DATA","currentTime","framebuffer","vao","sourceTexture","setData","_drawStretchedTexture","descriptor","updateData","Math","min","generateMipmap","updateCallback","_loadAsync","then","LUMINANCE","RGB","signal","complete","_loadFromVideoElementAsync","Promise","_requiresPowerOfTwo","_makePowerOfTwoTexture","AbortController","CLAMP_TO_EDGE","gl","PAD","textureCoordinateScaleFactor","_stretchToPowerOfTwo","colorTarget","TEXTURE","depthStencilTarget","NONE","getBoundFramebufferObject","detachColorTexture","bindFramebuffer","texture","getViewport","setViewport","bindTechnique","bindVAO","drawArrays","TRIANGLE_STRIP","unload","abort","emit","HAVE_NOTHING","HAVE_METADATA","HAVE_FUTURE_DATA","HAVE_ENOUGH_DATA"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{neverReached as t}from\"../../../../core/compilerUtils.js\";import e from\"../../../../core/Error.js\";import r from\"../../../../core/Evented.js\";import{isPowerOfTwo as i,nextHighestPowerOfTwo as s}from\"../../../../core/mathUtils.js\";import{isNone as a,isSome as o,removeMaybe as n}from\"../../../../core/maybe.js\";import{throwIfAborted as m,onAbort as h,createAbortError as l}from\"../../../../core/promiseUtils.js\";import{isArrayBuffer as p,isUint8Array as d}from\"../../../../core/typedArrayUtil.js\";import{isBlobProtocol as _,isDataProtocol as c}from\"../../../../core/urlUtils.js\";import{requestImage as u}from\"../../../../support/requestImageUtils.js\";import{loadImageAsync as T}from\"../../../../support/requestUtils.js\";import{T as g}from\"../../../../chunks/TextureOnly.glsl.js\";import{PowerOfTwoResizeMode as f}from\"./basicInterfaces.js\";import{estimateMemoryKTX2 as w,estimateMemoryBasis as E,createTextureKTX2 as A,createTextureBasis as x}from\"./BasisUtil.js\";import{ContentObject as D}from\"./ContentObject.js\";import{ContentObjectType as I}from\"./ContentObjectType.js\";import{createDDSTexture as M}from\"./DDSUtil.js\";import{createQuadVAO as y}from\"./glUtil3D.js\";import{assert as F}from\"./Util.js\";import{TextureWrapMode as O,TextureType as N,PixelFormat as R,PixelType as U,TextureSamplingMode as b,TargetType as C,DepthStencilTargetType as P,PrimitiveType as S}from\"../../../webgl/enums.js\";import{FramebufferObject as H}from\"../../../webgl/FramebufferObject.js\";import{Texture as v}from\"../../../webgl/Texture.js\";import{vertexCount as V}from\"../../../webgl/Util.js\";import j from\"../../../webgl/capabilities/isWebGL2Context.js\";class L extends D{constructor(t,e){super(),this._data=t,this.type=I.Texture,this._glTexture=null,this._powerOfTwoStretchInfo=null,this._loadingPromise=null,this._loadingController=null,this.events=new r,this._passParameters=new g,this.params=e||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:O.REPEAT,t:O.REPEAT},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||f.STRETCH,this.estimatedTexMemRequired=L._estimateTexMemRequired(this._data,this.params),this._startPreload()}_startPreload(){const t=this._data;a(t)||(t instanceof HTMLVideoElement?this._startPreloadVideoElement(t):t instanceof HTMLImageElement&&this._startPreloadImageElement(t))}_startPreloadVideoElement(t){if(!(_(t.src)||\"auto\"===t.preload&&t.crossOrigin)){t.preload=\"auto\",t.crossOrigin=\"anonymous\";const e=!t.paused;if(t.src=t.src,e&&t.autoplay){const e=()=>{t.removeEventListener(\"canplay\",e),t.play()};t.addEventListener(\"canplay\",e)}}}_startPreloadImageElement(t){c(t.src)||_(t.src)||t.crossOrigin||(t.crossOrigin=\"anonymous\",t.src=t.src)}static _getDataDimensions(t){return t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t}static _estimateTexMemRequired(t,e){if(a(t))return 0;if(p(t)||d(t))return e.encoding===L.KTX2_ENCODING?w(t,e.mipmap):e.encoding===L.BASIS_ENCODING?E(t,e.mipmap):t.byteLength;const{width:r,height:i}=t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement?L._getDataDimensions(t):e;return(e.mipmap?4/3:1)*r*i*(e.components||4)||0}dispose(){this._data=void 0}get width(){return this.params.width}get height(){return this.params.height}_createDescriptor(t){return{target:N.TEXTURE_2D,pixelFormat:R.RGBA,dataType:U.UNSIGNED_BYTE,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?b.LINEAR_MIPMAP_LINEAR:b.LINEAR,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.maxAnisotropy??(this.params.mipmap?t.parameters.maxMaxAnisotropy:1)}}get glTexture(){return this._glTexture}load(t,e){if(o(this._glTexture))return this._glTexture;if(o(this._loadingPromise))return this._loadingPromise;const r=this._data;return a(r)?(this._glTexture=new v(t,this._createDescriptor(t),null),this._glTexture):\"string\"==typeof r?this._loadFromURL(t,e,r):r instanceof Image?this._loadFromImageElement(t,e,r):r instanceof HTMLVideoElement?this._loadFromVideoElement(t,e,r):r instanceof ImageData||r instanceof HTMLCanvasElement?this._loadFromImage(t,r,e):(p(r)||d(r))&&this.params.encoding===L.DDS_ENCODING?(this._data=void 0,this._loadFromDDSData(t,r)):(p(r)||d(r))&&this.params.encoding===L.KTX2_ENCODING?(this._data=void 0,this._loadFromKTX2(t,r)):(p(r)||d(r))&&this.params.encoding===L.BASIS_ENCODING?(this._data=void 0,this._loadFromBasis(t,r)):d(r)?this._loadFromPixelData(t,r):p(r)?this._loadFromPixelData(t,new Uint8Array(r)):null}get requiresFrameUpdates(){return this._data instanceof HTMLVideoElement}frameUpdate(t,e,r){if(!(this._data instanceof HTMLVideoElement)||a(this._glTexture))return r;if(this._data.readyState<G.HAVE_CURRENT_DATA||r===this._data.currentTime)return r;if(o(this._powerOfTwoStretchInfo)){const{framebuffer:r,vao:i,sourceTexture:s}=this._powerOfTwoStretchInfo;s.setData(this._data),this._drawStretchedTexture(t,e,r,i,s,this._glTexture)}else{const{videoWidth:t,videoHeight:e}=this._data,{width:r,height:i}=this._glTexture.descriptor;t!==r||e!==i?this._glTexture.updateData(0,0,0,Math.min(t,r),Math.min(e,i),this._data):this._glTexture.setData(this._data)}return this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this.params.updateCallback&&this.params.updateCallback(),this._data.currentTime}_loadFromDDSData(t,e){return this._glTexture=M(t,this._createDescriptor(t),e),this._glTexture}_loadFromKTX2(t,e){return this._loadAsync((()=>A(t,this._createDescriptor(t),e).then((t=>(this._glTexture=t,t)))))}_loadFromBasis(t,e){return this._loadAsync((()=>x(t,this._createDescriptor(t),e).then((t=>(this._glTexture=t,t)))))}_loadFromPixelData(t,e){F(this.params.width>0&&this.params.height>0);const r=this._createDescriptor(t);return r.pixelFormat=1===this.params.components?R.LUMINANCE:3===this.params.components?R.RGB:R.RGBA,r.width=this.params.width,r.height=this.params.height,this._glTexture=new v(t,r,e),this._glTexture}_loadFromURL(t,e,r){return this._loadAsync((async i=>{const s=await u(r,{signal:i});return m(i),this._loadFromImage(t,s,e)}))}_loadFromImageElement(t,e,r){return r.complete?this._loadFromImage(t,r,e):this._loadAsync((async i=>{const s=await T(r,r.src,!1,i);return m(i),this._loadFromImage(t,s,e)}))}_loadFromVideoElement(t,e,r){return r.readyState>=G.HAVE_CURRENT_DATA?this._loadFromImage(t,r,e):this._loadFromVideoElementAsync(t,e,r)}_loadFromVideoElementAsync(t,r,i){return this._loadAsync((s=>new Promise(((a,o)=>{const m=()=>{i.removeEventListener(\"loadeddata\",p),i.removeEventListener(\"error\",d),n(_)},p=()=>{i.readyState>=G.HAVE_CURRENT_DATA&&(m(),a(this._loadFromImage(t,i,r)))},d=t=>{m(),o(t||new e(\"Failed to load video\"))};i.addEventListener(\"loadeddata\",p),i.addEventListener(\"error\",d);const _=h(s,(()=>d(l())))}))))}_loadFromImage(t,e,r){const s=L._getDataDimensions(e);this.params.width=s.width,this.params.height=s.height;const a=this._createDescriptor(t);return a.pixelFormat=3===this.params.components?R.RGB:R.RGBA,!this._requiresPowerOfTwo(t,a)||i(s.width)&&i(s.height)?(a.width=s.width,a.height=s.height,this._glTexture=new v(t,a,e),this._glTexture):(this._glTexture=this._makePowerOfTwoTexture(t,e,s,a,r),this._glTexture)}_loadAsync(t){const e=new AbortController;this._loadingController=e;const r=t(e.signal);this._loadingPromise=r;const i=()=>{this._loadingController===e&&(this._loadingController=null),this._loadingPromise===r&&(this._loadingPromise=null)};return r.then(i,i),r}_requiresPowerOfTwo(t,e){const r=O.CLAMP_TO_EDGE,i=\"number\"==typeof e.wrapMode?e.wrapMode===r:e.wrapMode.s===r&&e.wrapMode.t===r;return!j(t.gl)&&(e.hasMipmap||!i)}_makePowerOfTwoTexture(e,r,i,a,o){const{width:n,height:m}=i,h=s(n),l=s(m);let p;switch(a.width=h,a.height=l,this.params.powerOfTwoResizeMode){case f.PAD:a.textureCoordinateScaleFactor=[n/h,m/l],p=new v(e,a),p.updateData(0,0,0,n,m,r);break;case f.STRETCH:case null:case void 0:p=this._stretchToPowerOfTwo(e,r,a,o());break;default:t(this.params.powerOfTwoResizeMode)}return a.hasMipmap&&p.generateMipmap(),p}_stretchToPowerOfTwo(t,e,r,i){const s=new v(t,r),a=new H(t,{colorTarget:C.TEXTURE,depthStencilTarget:P.NONE},s),o=new v(t,{target:N.TEXTURE_2D,pixelFormat:r.pixelFormat,dataType:U.UNSIGNED_BYTE,wrapMode:O.CLAMP_TO_EDGE,samplingMode:b.LINEAR,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},e),n=y(t),m=t.getBoundFramebufferObject();return this._drawStretchedTexture(t,i,a,n,o,s),this.requiresFrameUpdates?this._powerOfTwoStretchInfo={vao:n,sourceTexture:o,framebuffer:a}:(n.dispose(!0),o.dispose(),a.detachColorTexture(),a.dispose()),t.bindFramebuffer(m),s}_drawStretchedTexture(t,e,r,i,s,a){this._passParameters.texture=s,t.bindFramebuffer(r);const o=t.getViewport();t.setViewport(0,0,a.descriptor.width,a.descriptor.height),t.bindTechnique(e,this._passParameters,null),t.bindVAO(i),t.drawArrays(S.TRIANGLE_STRIP,0,V(i,\"geometry\")),t.bindFramebuffer(null),t.setViewport(o.x,o.y,o.width,o.height),this._passParameters.texture=null}unload(){if(o(this._powerOfTwoStretchInfo)){const{framebuffer:t,vao:e,sourceTexture:r}=this._powerOfTwoStretchInfo;e.dispose(!0),r.dispose(),t.dispose(),this._glTexture=null,this._powerOfTwoStretchInfo=null}if(o(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),o(this._loadingController)){const t=this._loadingController;this._loadingController=null,this._loadingPromise=null,t.abort()}this.events.emit(\"unloaded\")}}var G;L.DDS_ENCODING=\"image/vnd-ms.dds\",L.KTX2_ENCODING=\"image/ktx2\",L.BASIS_ENCODING=\"image/x.basis\",function(t){t[t.HAVE_NOTHING=0]=\"HAVE_NOTHING\",t[t.HAVE_METADATA=1]=\"HAVE_METADATA\",t[t.HAVE_CURRENT_DATA=2]=\"HAVE_CURRENT_DATA\",t[t.HAVE_FUTURE_DATA=3]=\"HAVE_FUTURE_DATA\",t[t.HAVE_ENOUGH_DATA=4]=\"HAVE_ENOUGH_DATA\"}(G||(G={}));export{L as Texture};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}