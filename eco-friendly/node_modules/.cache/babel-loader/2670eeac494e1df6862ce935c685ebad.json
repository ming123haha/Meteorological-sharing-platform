{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../core/maybe.js\";\nimport { hasSource as t } from \"./RasterBitmap.js\";\nimport r from \"../webgl/VertexStream.js\";\nimport s from \"../webgl/brushes/WGLBrush.js\";\nimport { BlendFactor as a, CompareFunction as i } from \"../../../webgl/enums.js\";\nimport { setTextures as o, getCommonUniforms as n, setUniforms as h, getColormapUniforms as l, getStretchUniforms as c, getShadedReliefUniforms as p, getUniformLocationInfos as d, getBasicGridUniforms as u } from \"../../../webgl/rasterUtils.js\";\n\nclass m extends s {\n  constructor() {\n    super(...arguments), this._desc = {\n      lut: {\n        vsPath: \"raster/lut\",\n        fsPath: \"raster/lut\",\n        attributes: new Map([[\"a_position\", 0], [\"a_texcoord\", 1]])\n      },\n      stretch: {\n        vsPath: \"raster/stretch\",\n        fsPath: \"raster/stretch\",\n        attributes: new Map([[\"a_position\", 0], [\"a_texcoord\", 1]])\n      },\n      hillshade: {\n        vsPath: \"raster/hillshade\",\n        fsPath: \"raster/hillshade\",\n        attributes: new Map([[\"a_position\", 0], [\"a_texcoord\", 1]])\n      }\n    }, this._rendererUniformInfos = new Map();\n  }\n\n  dispose() {\n    this._quad && this._quad.dispose();\n  }\n\n  prepareState({\n    context: e\n  }, t) {\n    e.setBlendingEnabled(!0), e.setBlendFunctionSeparate(a.ONE, a.ONE_MINUS_SRC_ALPHA, a.ONE, a.ONE_MINUS_SRC_ALPHA), e.setColorMask(!0, !0, !0, !0), e.setStencilWriteMask(0), e.setStencilTestEnabled(!0), e.setStencilFunction(i.EQUAL, t.stencilRef, 255);\n  }\n\n  draw(e, r) {\n    if (!t(r) || r.suspended) return;\n    const {\n      timeline: s,\n      context: a,\n      painter: i,\n      requestRender: o\n    } = e;\n    s.begin(this.name);\n    const n = !a.capabilities.textureFloat?.textureFloatLinear;\n    r.updateTexture(e);\n\n    const h = this._getShaderVariations(r, n),\n          l = i.materialManager.getProgram(this._desc[r.symbolizerParameters.type], h);\n\n    this._drawWithProgram(a, l, r, o), s.end(this.name);\n  }\n\n  _drawWithProgram(t, s, a, i, d = 1, m = [0, 0], f = !1) {\n    if (this._quad || (this._quad = new r(t, [0, 0, 1, 0, 0, 1, 1, 1])), e(i) && !s.isCompiled) return void i();\n    const {\n      symbolizerParameters: _,\n      transformGrid: g,\n      width: b,\n      height: P,\n      opacity: S\n    } = a,\n          w = _.type;\n    t.useProgram(s);\n\n    const x = this._getShaderVariations(a),\n          y = this._getUniformInfos(w, t, s, x),\n          {\n      names: M,\n      textures: U\n    } = a.getTextures();\n\n    o(t, s, M, U);\n    const j = u(d, m),\n          I = n(g, [b, P], [a.source.width, a.source.height], S, f);\n\n    if (h(s, y, {\n      u_coordScale: a.coordScale,\n      u_dvsMat3: a.transforms.dvs,\n      ...j,\n      ...I\n    }), _.colormap) {\n      const {\n        colormap: e,\n        colormapOffset: t\n      } = _,\n            r = l(e, t);\n      h(s, y, r);\n    }\n\n    if (\"stretch\" === _.type) {\n      const e = c(_);\n      h(s, y, e);\n    } else if (\"hillshade\" === _.type) {\n      const e = p(_);\n      h(s, y, e);\n    }\n\n    this._quad.draw();\n  }\n\n  _getUniformInfos(e, t, r, s) {\n    const a = s.length > 0 ? e + \"-\" + s.join(\"-\") : e;\n    if (this._rendererUniformInfos.has(a)) return this._rendererUniformInfos.get(a);\n    const i = d(t, r);\n    return this._rendererUniformInfos.set(a, i), i;\n  }\n\n  _getShaderVariations(e, t = !1) {\n    const r = [],\n          {\n      interpolation: s\n    } = e,\n          {\n      type: a,\n      colormap: i\n    } = e.symbolizerParameters;\n    return \"cubic\" === s ? r.push(\"bicubic\") : \"bilinear\" === s && \"stretch\" === a && null != i ? (r.push(\"bilinear\"), r.push(\"nnedge\")) : t && \"bilinear\" === s && r.push(\"bilinear\"), e.isRendereredSource ? r.push(\"noop\") : i && r.push(\"applyColormap\"), e.transformGrid && (r.push(\"applyProjection\"), 1 === e.transformGrid.spacing[0] && r.push(\"lookupProjection\")), r;\n  }\n\n}\n\nexport { m as default };","map":{"version":3,"names":["isSome","e","hasSource","t","r","s","BlendFactor","a","CompareFunction","i","setTextures","o","getCommonUniforms","n","setUniforms","h","getColormapUniforms","l","getStretchUniforms","c","getShadedReliefUniforms","p","getUniformLocationInfos","d","getBasicGridUniforms","u","m","constructor","arguments","_desc","lut","vsPath","fsPath","attributes","Map","stretch","hillshade","_rendererUniformInfos","dispose","_quad","prepareState","context","setBlendingEnabled","setBlendFunctionSeparate","ONE","ONE_MINUS_SRC_ALPHA","setColorMask","setStencilWriteMask","setStencilTestEnabled","setStencilFunction","EQUAL","stencilRef","draw","suspended","timeline","painter","requestRender","begin","name","capabilities","textureFloat","textureFloatLinear","updateTexture","_getShaderVariations","materialManager","getProgram","symbolizerParameters","type","_drawWithProgram","end","f","isCompiled","_","transformGrid","g","width","b","height","P","opacity","S","w","useProgram","x","y","_getUniformInfos","names","M","textures","U","getTextures","j","I","source","u_coordScale","coordScale","u_dvsMat3","transforms","dvs","colormap","colormapOffset","length","join","has","get","set","interpolation","push","isRendereredSource","spacing","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/imagery/BrushRasterBitmap.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../core/maybe.js\";import{hasSource as t}from\"./RasterBitmap.js\";import r from\"../webgl/VertexStream.js\";import s from\"../webgl/brushes/WGLBrush.js\";import{BlendFactor as a,CompareFunction as i}from\"../../../webgl/enums.js\";import{setTextures as o,getCommonUniforms as n,setUniforms as h,getColormapUniforms as l,getStretchUniforms as c,getShadedReliefUniforms as p,getUniformLocationInfos as d,getBasicGridUniforms as u}from\"../../../webgl/rasterUtils.js\";class m extends s{constructor(){super(...arguments),this._desc={lut:{vsPath:\"raster/lut\",fsPath:\"raster/lut\",attributes:new Map([[\"a_position\",0],[\"a_texcoord\",1]])},stretch:{vsPath:\"raster/stretch\",fsPath:\"raster/stretch\",attributes:new Map([[\"a_position\",0],[\"a_texcoord\",1]])},hillshade:{vsPath:\"raster/hillshade\",fsPath:\"raster/hillshade\",attributes:new Map([[\"a_position\",0],[\"a_texcoord\",1]])}},this._rendererUniformInfos=new Map}dispose(){this._quad&&this._quad.dispose()}prepareState({context:e},t){e.setBlendingEnabled(!0),e.setBlendFunctionSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(i.EQUAL,t.stencilRef,255)}draw(e,r){if(!t(r)||r.suspended)return;const{timeline:s,context:a,painter:i,requestRender:o}=e;s.begin(this.name);const n=!a.capabilities.textureFloat?.textureFloatLinear;r.updateTexture(e);const h=this._getShaderVariations(r,n),l=i.materialManager.getProgram(this._desc[r.symbolizerParameters.type],h);this._drawWithProgram(a,l,r,o),s.end(this.name)}_drawWithProgram(t,s,a,i,d=1,m=[0,0],f=!1){if(this._quad||(this._quad=new r(t,[0,0,1,0,0,1,1,1])),e(i)&&!s.isCompiled)return void i();const{symbolizerParameters:_,transformGrid:g,width:b,height:P,opacity:S}=a,w=_.type;t.useProgram(s);const x=this._getShaderVariations(a),y=this._getUniformInfos(w,t,s,x),{names:M,textures:U}=a.getTextures();o(t,s,M,U);const j=u(d,m),I=n(g,[b,P],[a.source.width,a.source.height],S,f);if(h(s,y,{u_coordScale:a.coordScale,u_dvsMat3:a.transforms.dvs,...j,...I}),_.colormap){const{colormap:e,colormapOffset:t}=_,r=l(e,t);h(s,y,r)}if(\"stretch\"===_.type){const e=c(_);h(s,y,e)}else if(\"hillshade\"===_.type){const e=p(_);h(s,y,e)}this._quad.draw()}_getUniformInfos(e,t,r,s){const a=s.length>0?e+\"-\"+s.join(\"-\"):e;if(this._rendererUniformInfos.has(a))return this._rendererUniformInfos.get(a);const i=d(t,r);return this._rendererUniformInfos.set(a,i),i}_getShaderVariations(e,t=!1){const r=[],{interpolation:s}=e,{type:a,colormap:i}=e.symbolizerParameters;return\"cubic\"===s?r.push(\"bicubic\"):\"bilinear\"===s&&\"stretch\"===a&&null!=i?(r.push(\"bilinear\"),r.push(\"nnedge\")):t&&\"bilinear\"===s&&r.push(\"bilinear\"),e.isRendereredSource?r.push(\"noop\"):i&&r.push(\"applyColormap\"),e.transformGrid&&(r.push(\"applyProjection\"),1===e.transformGrid.spacing[0]&&r.push(\"lookupProjection\")),r}}export{m as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}