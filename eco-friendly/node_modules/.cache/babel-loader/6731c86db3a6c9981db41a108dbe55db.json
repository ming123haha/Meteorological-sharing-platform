{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from \"../../../../core/Error.js\";\nimport e from \"../../../../core/Logger.js\";\nimport { isSome as r, isNone as s } from \"../../../../core/maybe.js\";\nimport { watch as i } from \"../../../../core/reactiveUtils.js\";\nimport { c as o } from \"../../../../chunks/mat3f32.js\";\nimport { DisplayObject as h } from \"../DisplayObject.js\";\nimport a from \"./Mesh2D.js\";\nimport { VertexArrayObject as c } from \"../../../webgl/VertexArrayObject.js\";\n\nconst n = t => parseFloat(t) / 100;\n\nclass m extends h {\n  constructor(t, e) {\n    super(), this._clip = e, this._cache = {}, this.stage = t, this._handle = i(() => e.version, () => this._invalidate()), this.ready();\n  }\n\n  static fromClipArea(t, e) {\n    return new m(t, e);\n  }\n\n  _destroyGL() {\n    r(this._cache.mesh) && (this._cache.mesh.destroy(), this._cache.mesh = null), r(this._cache.vao) && (this._cache.vao.dispose(), this._cache.vao = null);\n  }\n\n  destroy() {\n    this._destroyGL(), this._handle.remove();\n  }\n\n  getVAO(t, e, r, i) {\n    const [o, h] = e.size;\n\n    if (\"geometry\" !== this._clip.type && this._lastWidth === o && this._lastHeight === h || (this._lastWidth = o, this._lastHeight = h, this._destroyGL()), s(this._cache.vao)) {\n      const s = this._createMesh(e, this._clip),\n            o = s.getIndexBuffer(t),\n            h = s.getVertexBuffers(t);\n\n      this._cache.mesh = s, this._cache.vao = new c(t, r, i, h, o);\n    }\n\n    return this._cache.vao;\n  }\n\n  _createTransforms() {\n    return {\n      dvs: o()\n    };\n  }\n\n  _invalidate() {\n    this._destroyGL(), this.requestRender();\n  }\n\n  _createScreenRect(t, e) {\n    const [r, s] = t.size,\n          i = \"string\" == typeof e.left ? n(e.left) * r : e.left,\n          o = \"string\" == typeof e.right ? n(e.right) * r : e.right,\n          h = \"string\" == typeof e.top ? n(e.top) * s : e.top,\n          a = \"string\" == typeof e.bottom ? n(e.bottom) * s : e.bottom,\n          c = i,\n          m = h;\n    return {\n      x: c,\n      y: m,\n      width: Math.max(r - o - c, 0),\n      height: Math.max(s - a - m, 0)\n    };\n  }\n\n  _createMesh(r, s) {\n    switch (s.type) {\n      case \"rect\":\n        return a.fromRect(this._createScreenRect(r, s));\n\n      case \"path\":\n        return a.fromPath(s);\n\n      case \"geometry\":\n        return a.fromGeometry(r, s);\n\n      default:\n        return e.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\").error(new t(\"mapview-bad-type\", \"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")), a.fromRect({\n          x: 0,\n          y: 0,\n          width: 1,\n          height: 1\n        });\n    }\n  }\n\n}\n\nexport { m as default };","map":{"version":3,"names":["t","e","isSome","r","isNone","s","watch","i","c","o","DisplayObject","h","a","VertexArrayObject","n","parseFloat","m","constructor","_clip","_cache","stage","_handle","version","_invalidate","ready","fromClipArea","_destroyGL","mesh","destroy","vao","dispose","remove","getVAO","size","type","_lastWidth","_lastHeight","_createMesh","getIndexBuffer","getVertexBuffers","_createTransforms","dvs","requestRender","_createScreenRect","left","right","top","bottom","x","y","width","Math","max","height","fromRect","fromPath","fromGeometry","getLogger","error","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/ClippingInfo.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Error.js\";import e from\"../../../../core/Logger.js\";import{isSome as r,isNone as s}from\"../../../../core/maybe.js\";import{watch as i}from\"../../../../core/reactiveUtils.js\";import{c as o}from\"../../../../chunks/mat3f32.js\";import{DisplayObject as h}from\"../DisplayObject.js\";import a from\"./Mesh2D.js\";import{VertexArrayObject as c}from\"../../../webgl/VertexArrayObject.js\";const n=t=>parseFloat(t)/100;class m extends h{constructor(t,e){super(),this._clip=e,this._cache={},this.stage=t,this._handle=i((()=>e.version),(()=>this._invalidate())),this.ready()}static fromClipArea(t,e){return new m(t,e)}_destroyGL(){r(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),r(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(t,e,r,i){const[o,h]=e.size;if(\"geometry\"!==this._clip.type&&this._lastWidth===o&&this._lastHeight===h||(this._lastWidth=o,this._lastHeight=h,this._destroyGL()),s(this._cache.vao)){const s=this._createMesh(e,this._clip),o=s.getIndexBuffer(t),h=s.getVertexBuffers(t);this._cache.mesh=s,this._cache.vao=new c(t,r,i,h,o)}return this._cache.vao}_createTransforms(){return{dvs:o()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(t,e){const[r,s]=t.size,i=\"string\"==typeof e.left?n(e.left)*r:e.left,o=\"string\"==typeof e.right?n(e.right)*r:e.right,h=\"string\"==typeof e.top?n(e.top)*s:e.top,a=\"string\"==typeof e.bottom?n(e.bottom)*s:e.bottom,c=i,m=h;return{x:c,y:m,width:Math.max(r-o-c,0),height:Math.max(s-a-m,0)}}_createMesh(r,s){switch(s.type){case\"rect\":return a.fromRect(this._createScreenRect(r,s));case\"path\":return a.fromPath(s);case\"geometry\":return a.fromGeometry(r,s);default:return e.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\").error(new t(\"mapview-bad-type\",\"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")),a.fromRect({x:0,y:0,width:1,height:1})}}}export{m as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}