{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../../config.js\";\nimport t from \"../../../../request.js\";\nimport { bidiText as i } from \"../../../../core/BidiText.js\";\nimport s from \"../../../../core/Error.js\";\nimport r from \"../../../../core/Logger.js\";\nimport { isNone as n, isSome as o } from \"../../../../core/maybe.js\";\nimport { throwIfAborted as a, isAbortError as h } from \"../../../../core/promiseUtils.js\";\nimport { pt2px as c } from \"../../../../core/screenUtils.js\";\nimport { a as u } from \"../../../../chunks/vec2.js\";\nimport { c as d } from \"../../../../chunks/vec2f32.js\";\nimport m from \"../../../../symbols/cim/Rasterizer.js\";\nimport { TEXTURE_BINDING_GLYPH_ATLAS as l, TEXTURE_BINDING_SPRITE_ATLAS as g } from \"./definitions.js\";\nimport { MosaicType as p } from \"./enums.js\";\nimport { getFullyQualifiedFontName as f } from \"./fontUtils.js\";\nimport _ from \"./GlyphMosaic.js\";\nimport w from \"./GlyphSource.js\";\nimport y from \"./SDFConverter.js\";\nimport M from \"./SpriteMosaic.js\";\nimport { is3D as I, charCodes as v, isSimple as R, isSVGResource as b, isImageResource as z, isMarkerPlacementInsidePolygon as T, shouldRepeat as j, getPMSResourceSize as x, isGIF as S, isPNG as U, getUrl as B, isSVGImage as G } from \"./Utils.js\";\nimport { isPNG as P, isAnimatedPNG as q, APNG as C } from \"./animatedFormats/apng.js\";\nimport { isGIF as L, isAnimatedGIF as F, GIF as A } from \"./animatedFormats/gif.js\";\nimport { ok as N } from \"./util/Result.js\";\nimport { keyFromSymbol as $ } from \"./util/symbolUtils.js\";\nimport { QueueProcessor as E } from \"../../../support/QueueProcessor.js\";\nimport { TextureSamplingMode as k } from \"../../../webgl/enums.js\";\nconst O = d(),\n      Q = \"arial-unicode-ms-regular\",\n      H = 126,\n      V = r.getLogger(\"esri.views.2d.engine.webgl.TextureManager\");\n\nasync function Y(e, i) {\n  const r = B(e);\n  let n;\n  const o = \";base64,\";\n\n  if (r.includes(o)) {\n    const e = r.indexOf(o) + o.length,\n          t = r.substring(e),\n          i = atob(t),\n          s = new Uint8Array(i.length);\n\n    for (let r = 0; r < i.length; r++) s[r] = i.charCodeAt(r);\n\n    n = s.buffer;\n  } else try {\n    const {\n      data: e\n    } = await t(r, {\n      responseType: \"array-buffer\",\n      ...i\n    });\n    n = e;\n  } catch (a) {\n    if (!h(a)) return new s(\"mapview-invalid-resource\", `Could not fetch requested resource at ${r}`);\n  }\n\n  return n;\n}\n\nfunction D(e, t) {\n  const i = Math.round(c(t) * window.devicePixelRatio),\n        s = i >= 128 ? 2 : 4;\n  return Math.min(e, i * s);\n}\n\nconst J = (e, t, i) => V.error(new s(e, t, i));\n\nclass W {\n  constructor(e, t, i) {\n    this.mosaicType = e, this.page = t, this.sdf = i;\n  }\n\n  static fromMosaic(e, t) {\n    return new W(e, t.page, t.sdf);\n  }\n\n}\n\nclass X {\n  constructor(i, r) {\n    this._requestRender = i, this.resourceManager = r, this._invalidFontsMap = new Map(), this._sdfConverter = new y(H), this._bindingInfos = new Array(), this._hashToBindingIndex = new Map(), this._ongoingRasterizations = new Map(), this._imageRequestQueue = new E({\n      concurrency: 10,\n      process: async (e, i) => {\n        a(i);\n\n        try {\n          return await t(e, {\n            responseType: \"image\",\n            signal: i\n          });\n        } catch (r) {\n          if (!h(r)) throw new s(\"mapview-invalid-resource\", `Could not fetch requested resource at ${e}`, r);\n          throw r;\n        }\n      }\n    }), this._spriteMosaic = new M(2048, 2048, 500), this._glyphSource = new w(`${e.fontsUrl}/{fontstack}/{range}.pbf`), this._glyphMosaic = new _(1024, 1024, this._glyphSource), this._rasterizer = new m(r);\n  }\n\n  dispose() {\n    this._spriteMosaic.dispose(), this._glyphMosaic.dispose(), this._rasterizer.dispose(), this._sdfConverter.dispose(), this._spriteMosaic = null, this._glyphMosaic = null, this._sdfConverter = null, this._hashToBindingIndex.clear(), this._hashToBindingIndex = null, this._bindingInfos = null, this._ongoingRasterizations.clear(), this._ongoingRasterizations = null, this._imageRequestQueue.clear(), this._imageRequestQueue = null;\n  }\n\n  get sprites() {\n    return this._spriteMosaic;\n  }\n\n  get glyphs() {\n    return this._glyphMosaic;\n  }\n\n  async rasterizeItem(e, t, i, s) {\n    if (n(e)) return J(\"mapview-null-resource\", \"Unable to rasterize null resource\"), null;\n\n    switch (e.type) {\n      case \"text\":\n      case \"esriTS\":\n        {\n          const t = await this._rasterizeText(e, i, s);\n          return t.forEach(e => this._setTextureBinding(p.GLYPH, e)), {\n            glyphMosaicItems: t\n          };\n        }\n\n      default:\n        {\n          if (I(e)) return J(\"mapview-invalid-type\", `MapView does not support symbol type: ${e.type}`, e), null;\n          const i = await this._rasterizeSpriteSymbol(e, t, s);\n          return N(i) && i && this._setTextureBinding(p.SPRITE, i), {\n            spriteMosaicItem: i\n          };\n        }\n    }\n  }\n\n  bindTextures(e, t, i, s = !1) {\n    if (0 === i.textureBinding) return;\n    const r = this._bindingInfos[i.textureBinding - 1],\n          n = r.page,\n          o = s ? k.LINEAR_MIPMAP_LINEAR : k.LINEAR;\n\n    switch (r.mosaicType) {\n      case p.SPRITE:\n        {\n          const i = this.sprites.getWidth(n),\n                s = this.sprites.getHeight(n),\n                r = u(O, i, s);\n          return this._spriteMosaic.bind(e, o, n, g), t.setUniform1i(\"u_texture\", g), void t.setUniform2fv(\"u_mosaicSize\", r);\n        }\n\n      case p.GLYPH:\n        {\n          const i = this.glyphs.width,\n                s = this.glyphs.height,\n                r = u(O, i, s);\n          return this._glyphMosaic.bind(e, o, n, l), t.setUniform1i(\"u_texture\", l), void t.setUniform2fv(\"u_mosaicSize\", r);\n        }\n\n      default:\n        V.error(\"mapview-texture-manager\", `Cannot handle unknown type ${r.mosaicType}`);\n    }\n  }\n\n  _hashMosaic(e, t) {\n    return 1 | e << 1 | (t.sdf ? 1 : 0) << 2 | t.page << 3;\n  }\n\n  _setTextureBinding(e, t) {\n    const i = this._hashMosaic(e, t);\n\n    if (!this._hashToBindingIndex.has(i)) {\n      const s = W.fromMosaic(e, t),\n            r = this._bindingInfos.length + 1;\n      this._hashToBindingIndex.set(i, r), this._bindingInfos.push(s);\n    }\n\n    t.textureBinding = this._hashToBindingIndex.get(i);\n  }\n\n  async _rasterizeText(e, t, s) {\n    let r, n;\n\n    if (\"cim\" in e) {\n      const t = e;\n      r = t.fontName, n = t.text;\n    } else {\n      const t = e;\n      r = f(t.font), n = t.text;\n    }\n\n    const o = this._invalidFontsMap.has(r),\n          a = t || v(i(n)[0]);\n\n    try {\n      return await this._glyphMosaic.getGlyphItems(o ? Q : r, a, s);\n    } catch (h) {\n      return J(\"mapview-invalid-resource\", `Couldn't find font ${r}. Falling back to Arial Unicode MS Regular`), this._invalidFontsMap.set(r, !0), this._glyphMosaic.getGlyphItems(Q, a, s);\n    }\n  }\n\n  async _rasterizeSpriteSymbol(e, t, i) {\n    if (R(e)) return null;\n    const r = $(e);\n    if (this._spriteMosaic.has(r)) return this._spriteMosaic.getSpriteItem(r);\n    if (b(e) || z(e) && !T(e)) return this._handleAsyncResource(r, e, i);\n\n    const n = 1,\n          o = this._rasterizer.rasterizeJSONResource(e, n);\n\n    if (o) {\n      const {\n        size: t,\n        image: i,\n        sdf: s,\n        simplePattern: n\n      } = o;\n      return this._addItemToMosaic(r, t, {\n        type: \"static\",\n        data: i\n      }, j(e), s, n);\n    }\n\n    return new s(\"TextureManager\", \"unrecognized or null rasterized image\");\n  }\n\n  async _handleAsyncResource(e, t, i) {\n    if (this._ongoingRasterizations.has(e)) return this._ongoingRasterizations.get(e);\n    let s;\n    s = b(t) ? this._handleSVG(t, e, i) : this._handleImage(t, e, i), this._ongoingRasterizations.set(e, s);\n\n    try {\n      await s, this._ongoingRasterizations.delete(e);\n    } catch {\n      this._ongoingRasterizations.delete(e);\n    }\n\n    return s;\n  }\n\n  async _handleSVG(e, t, i) {\n    const s = [H, H],\n          r = await this._sdfConverter.draw(e.path, i);\n    return this._addItemToMosaic(t, s, {\n      type: \"static\",\n      data: new Uint32Array(r.buffer)\n    }, !1, !0, !0);\n  }\n\n  async _handleGIFOrPNG(e, t, i) {\n    const r = await Y(e, i);\n\n    if (N(r)) {\n      const o = L(r),\n            a = P(r);\n      if (!o && !a) return new s(\"mapview-invalid-resource\", \"Image data is neither GIF nor PNG!\");\n      let c;\n\n      try {\n        const t = e.animatedSymbolProperties || {},\n              s = e.objectId;\n        o && F(r) ? c = await A.create(r, t, s, this._requestRender, i) : a && q(r) && (c = await C.create(r, t, s, this._requestRender, i));\n      } catch (n) {\n        if (!h(n)) return new s(\"mapview-invalid-resource\", \"Could not fetch requested resource!\");\n      }\n\n      if (c && N(c)) return this._addItemToMosaic(t, [c.width, c.height], {\n        type: \"animated\",\n        data: c\n      }, j(e), !1, !1);\n      const u = new Blob([r], {\n        type: o ? \"image/gif\" : \"image/png\"\n      }),\n            d = await this._imageFromBlob(u);\n\n      if (d && d instanceof HTMLImageElement) {\n        let i = d.width,\n            s = d.height;\n        \"esriPMS\" === e.type && (i = Math.round(D(d.width, x(e))), s = Math.round(d.height * (i / d.width)));\n\n        const r = \"cim\" in e ? e.cim.colorSubstitutions : void 0,\n              {\n          size: n,\n          sdf: o,\n          image: a\n        } = this._rasterizer.rasterizeImageResource(i, s, d, r);\n\n        return this._addItemToMosaic(t, n, {\n          type: \"static\",\n          data: a\n        }, j(e), o, !1);\n      }\n    }\n\n    return new s(\"mapview-invalid-resource\", \"Could not handle resource!\");\n  }\n\n  async _handleImage(e, t, i) {\n    if (S(e) || U(e)) return this._handleGIFOrPNG(e, t, i);\n    const r = B(e);\n\n    try {\n      let s;\n      const n = this.resourceManager.getResource(r);\n      if (o(n)) s = n;else {\n        const {\n          data: e\n        } = await this._imageRequestQueue.push(r, { ...i\n        });\n        s = e;\n      }\n      if (G(r)) if (\"width\" in e && \"height\" in e) s.width = c(e.width), s.height = c(e.height);else if (\"cim\" in e) {\n        const t = e.cim;\n        s.width = c(t.width ?? t.scaleX * t.size), s.height = c(t.size);\n      }\n      if (!s.width || !s.height) return null;\n      let a = s.width,\n          h = s.height;\n      \"esriPMS\" === e.type && (a = Math.round(D(s.width, x(e))), h = Math.round(s.height * (a / s.width)));\n\n      const u = \"cim\" in e ? e.cim.colorSubstitutions : void 0,\n            {\n        size: d,\n        sdf: m,\n        image: l\n      } = this._rasterizer.rasterizeImageResource(a, h, s, u);\n\n      return this._addItemToMosaic(t, d, {\n        type: \"static\",\n        data: l\n      }, j(e), m, !1);\n    } catch (n) {\n      if (!h(n)) return new s(\"mapview-invalid-resource\", `Could not fetch requested resource at ${r}. ${n.message}`);\n    }\n  }\n\n  async _imageFromBlob(e) {\n    const t = window.URL.createObjectURL(e);\n\n    try {\n      const {\n        data: e\n      } = await this._imageRequestQueue.push(t);\n      return window.URL.revokeObjectURL(t), e;\n    } catch (i) {\n      if (window.URL.revokeObjectURL(t), !h(i)) return new s(\"mapview-invalid-resource\", `Could not fetch requested resource at ${t}`);\n      throw i;\n    }\n  }\n\n  _addItemToMosaic(e, t, i, s, r, n) {\n    return this._spriteMosaic.addSpriteItem(e, t, i, s, r, n);\n  }\n\n}\n\nexport { X as default };","map":{"version":3,"names":["e","t","bidiText","i","s","r","isNone","n","isSome","o","throwIfAborted","a","isAbortError","h","pt2px","c","u","d","m","TEXTURE_BINDING_GLYPH_ATLAS","l","TEXTURE_BINDING_SPRITE_ATLAS","g","MosaicType","p","getFullyQualifiedFontName","f","_","w","y","M","is3D","I","charCodes","v","isSimple","R","isSVGResource","b","isImageResource","z","isMarkerPlacementInsidePolygon","T","shouldRepeat","j","getPMSResourceSize","x","isGIF","S","isPNG","U","getUrl","B","isSVGImage","G","P","isAnimatedPNG","q","APNG","C","L","isAnimatedGIF","F","GIF","A","ok","N","keyFromSymbol","$","QueueProcessor","E","TextureSamplingMode","k","O","Q","H","V","getLogger","Y","includes","indexOf","length","substring","atob","Uint8Array","charCodeAt","buffer","data","responseType","D","Math","round","window","devicePixelRatio","min","J","error","W","constructor","mosaicType","page","sdf","fromMosaic","X","_requestRender","resourceManager","_invalidFontsMap","Map","_sdfConverter","_bindingInfos","Array","_hashToBindingIndex","_ongoingRasterizations","_imageRequestQueue","concurrency","process","signal","_spriteMosaic","_glyphSource","fontsUrl","_glyphMosaic","_rasterizer","dispose","clear","sprites","glyphs","rasterizeItem","type","_rasterizeText","forEach","_setTextureBinding","GLYPH","glyphMosaicItems","_rasterizeSpriteSymbol","SPRITE","spriteMosaicItem","bindTextures","textureBinding","LINEAR_MIPMAP_LINEAR","LINEAR","getWidth","getHeight","bind","setUniform1i","setUniform2fv","width","height","_hashMosaic","has","set","push","get","fontName","text","font","getGlyphItems","getSpriteItem","_handleAsyncResource","rasterizeJSONResource","size","image","simplePattern","_addItemToMosaic","_handleSVG","_handleImage","delete","draw","path","Uint32Array","_handleGIFOrPNG","animatedSymbolProperties","objectId","create","Blob","_imageFromBlob","HTMLImageElement","cim","colorSubstitutions","rasterizeImageResource","getResource","scaleX","message","URL","createObjectURL","revokeObjectURL","addSpriteItem","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/TextureManager.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../config.js\";import t from\"../../../../request.js\";import{bidiText as i}from\"../../../../core/BidiText.js\";import s from\"../../../../core/Error.js\";import r from\"../../../../core/Logger.js\";import{isNone as n,isSome as o}from\"../../../../core/maybe.js\";import{throwIfAborted as a,isAbortError as h}from\"../../../../core/promiseUtils.js\";import{pt2px as c}from\"../../../../core/screenUtils.js\";import{a as u}from\"../../../../chunks/vec2.js\";import{c as d}from\"../../../../chunks/vec2f32.js\";import m from\"../../../../symbols/cim/Rasterizer.js\";import{TEXTURE_BINDING_GLYPH_ATLAS as l,TEXTURE_BINDING_SPRITE_ATLAS as g}from\"./definitions.js\";import{MosaicType as p}from\"./enums.js\";import{getFullyQualifiedFontName as f}from\"./fontUtils.js\";import _ from\"./GlyphMosaic.js\";import w from\"./GlyphSource.js\";import y from\"./SDFConverter.js\";import M from\"./SpriteMosaic.js\";import{is3D as I,charCodes as v,isSimple as R,isSVGResource as b,isImageResource as z,isMarkerPlacementInsidePolygon as T,shouldRepeat as j,getPMSResourceSize as x,isGIF as S,isPNG as U,getUrl as B,isSVGImage as G}from\"./Utils.js\";import{isPNG as P,isAnimatedPNG as q,APNG as C}from\"./animatedFormats/apng.js\";import{isGIF as L,isAnimatedGIF as F,GIF as A}from\"./animatedFormats/gif.js\";import{ok as N}from\"./util/Result.js\";import{keyFromSymbol as $}from\"./util/symbolUtils.js\";import{QueueProcessor as E}from\"../../../support/QueueProcessor.js\";import{TextureSamplingMode as k}from\"../../../webgl/enums.js\";const O=d(),Q=\"arial-unicode-ms-regular\",H=126,V=r.getLogger(\"esri.views.2d.engine.webgl.TextureManager\");async function Y(e,i){const r=B(e);let n;const o=\";base64,\";if(r.includes(o)){const e=r.indexOf(o)+o.length,t=r.substring(e),i=atob(t),s=new Uint8Array(i.length);for(let r=0;r<i.length;r++)s[r]=i.charCodeAt(r);n=s.buffer}else try{const{data:e}=await t(r,{responseType:\"array-buffer\",...i});n=e}catch(a){if(!h(a))return new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${r}`)}return n}function D(e,t){const i=Math.round(c(t)*window.devicePixelRatio),s=i>=128?2:4;return Math.min(e,i*s)}const J=(e,t,i)=>V.error(new s(e,t,i));class W{constructor(e,t,i){this.mosaicType=e,this.page=t,this.sdf=i}static fromMosaic(e,t){return new W(e,t.page,t.sdf)}}class X{constructor(i,r){this._requestRender=i,this.resourceManager=r,this._invalidFontsMap=new Map,this._sdfConverter=new y(H),this._bindingInfos=new Array,this._hashToBindingIndex=new Map,this._ongoingRasterizations=new Map,this._imageRequestQueue=new E({concurrency:10,process:async(e,i)=>{a(i);try{return await t(e,{responseType:\"image\",signal:i})}catch(r){if(!h(r))throw new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${e}`,r);throw r}}}),this._spriteMosaic=new M(2048,2048,500),this._glyphSource=new w(`${e.fontsUrl}/{fontstack}/{range}.pbf`),this._glyphMosaic=new _(1024,1024,this._glyphSource),this._rasterizer=new m(r)}dispose(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._rasterizer.dispose(),this._sdfConverter.dispose(),this._spriteMosaic=null,this._glyphMosaic=null,this._sdfConverter=null,this._hashToBindingIndex.clear(),this._hashToBindingIndex=null,this._bindingInfos=null,this._ongoingRasterizations.clear(),this._ongoingRasterizations=null,this._imageRequestQueue.clear(),this._imageRequestQueue=null}get sprites(){return this._spriteMosaic}get glyphs(){return this._glyphMosaic}async rasterizeItem(e,t,i,s){if(n(e))return J(\"mapview-null-resource\",\"Unable to rasterize null resource\"),null;switch(e.type){case\"text\":case\"esriTS\":{const t=await this._rasterizeText(e,i,s);return t.forEach((e=>this._setTextureBinding(p.GLYPH,e))),{glyphMosaicItems:t}}default:{if(I(e))return J(\"mapview-invalid-type\",`MapView does not support symbol type: ${e.type}`,e),null;const i=await this._rasterizeSpriteSymbol(e,t,s);return N(i)&&i&&this._setTextureBinding(p.SPRITE,i),{spriteMosaicItem:i}}}}bindTextures(e,t,i,s=!1){if(0===i.textureBinding)return;const r=this._bindingInfos[i.textureBinding-1],n=r.page,o=s?k.LINEAR_MIPMAP_LINEAR:k.LINEAR;switch(r.mosaicType){case p.SPRITE:{const i=this.sprites.getWidth(n),s=this.sprites.getHeight(n),r=u(O,i,s);return this._spriteMosaic.bind(e,o,n,g),t.setUniform1i(\"u_texture\",g),void t.setUniform2fv(\"u_mosaicSize\",r)}case p.GLYPH:{const i=this.glyphs.width,s=this.glyphs.height,r=u(O,i,s);return this._glyphMosaic.bind(e,o,n,l),t.setUniform1i(\"u_texture\",l),void t.setUniform2fv(\"u_mosaicSize\",r)}default:V.error(\"mapview-texture-manager\",`Cannot handle unknown type ${r.mosaicType}`)}}_hashMosaic(e,t){return 1|e<<1|(t.sdf?1:0)<<2|t.page<<3}_setTextureBinding(e,t){const i=this._hashMosaic(e,t);if(!this._hashToBindingIndex.has(i)){const s=W.fromMosaic(e,t),r=this._bindingInfos.length+1;this._hashToBindingIndex.set(i,r),this._bindingInfos.push(s)}t.textureBinding=this._hashToBindingIndex.get(i)}async _rasterizeText(e,t,s){let r,n;if(\"cim\"in e){const t=e;r=t.fontName,n=t.text}else{const t=e;r=f(t.font),n=t.text}const o=this._invalidFontsMap.has(r),a=t||v(i(n)[0]);try{return await this._glyphMosaic.getGlyphItems(o?Q:r,a,s)}catch(h){return J(\"mapview-invalid-resource\",`Couldn't find font ${r}. Falling back to Arial Unicode MS Regular`),this._invalidFontsMap.set(r,!0),this._glyphMosaic.getGlyphItems(Q,a,s)}}async _rasterizeSpriteSymbol(e,t,i){if(R(e))return null;const r=$(e);if(this._spriteMosaic.has(r))return this._spriteMosaic.getSpriteItem(r);if(b(e)||z(e)&&!T(e))return this._handleAsyncResource(r,e,i);const n=1,o=this._rasterizer.rasterizeJSONResource(e,n);if(o){const{size:t,image:i,sdf:s,simplePattern:n}=o;return this._addItemToMosaic(r,t,{type:\"static\",data:i},j(e),s,n)}return new s(\"TextureManager\",\"unrecognized or null rasterized image\")}async _handleAsyncResource(e,t,i){if(this._ongoingRasterizations.has(e))return this._ongoingRasterizations.get(e);let s;s=b(t)?this._handleSVG(t,e,i):this._handleImage(t,e,i),this._ongoingRasterizations.set(e,s);try{await s,this._ongoingRasterizations.delete(e)}catch{this._ongoingRasterizations.delete(e)}return s}async _handleSVG(e,t,i){const s=[H,H],r=await this._sdfConverter.draw(e.path,i);return this._addItemToMosaic(t,s,{type:\"static\",data:new Uint32Array(r.buffer)},!1,!0,!0)}async _handleGIFOrPNG(e,t,i){const r=await Y(e,i);if(N(r)){const o=L(r),a=P(r);if(!o&&!a)return new s(\"mapview-invalid-resource\",\"Image data is neither GIF nor PNG!\");let c;try{const t=e.animatedSymbolProperties||{},s=e.objectId;o&&F(r)?c=await A.create(r,t,s,this._requestRender,i):a&&q(r)&&(c=await C.create(r,t,s,this._requestRender,i))}catch(n){if(!h(n))return new s(\"mapview-invalid-resource\",\"Could not fetch requested resource!\")}if(c&&N(c))return this._addItemToMosaic(t,[c.width,c.height],{type:\"animated\",data:c},j(e),!1,!1);const u=new Blob([r],{type:o?\"image/gif\":\"image/png\"}),d=await this._imageFromBlob(u);if(d&&d instanceof HTMLImageElement){let i=d.width,s=d.height;\"esriPMS\"===e.type&&(i=Math.round(D(d.width,x(e))),s=Math.round(d.height*(i/d.width)));const r=\"cim\"in e?e.cim.colorSubstitutions:void 0,{size:n,sdf:o,image:a}=this._rasterizer.rasterizeImageResource(i,s,d,r);return this._addItemToMosaic(t,n,{type:\"static\",data:a},j(e),o,!1)}}return new s(\"mapview-invalid-resource\",\"Could not handle resource!\")}async _handleImage(e,t,i){if(S(e)||U(e))return this._handleGIFOrPNG(e,t,i);const r=B(e);try{let s;const n=this.resourceManager.getResource(r);if(o(n))s=n;else{const{data:e}=await this._imageRequestQueue.push(r,{...i});s=e}if(G(r))if(\"width\"in e&&\"height\"in e)s.width=c(e.width),s.height=c(e.height);else if(\"cim\"in e){const t=e.cim;s.width=c(t.width??t.scaleX*t.size),s.height=c(t.size)}if(!s.width||!s.height)return null;let a=s.width,h=s.height;\"esriPMS\"===e.type&&(a=Math.round(D(s.width,x(e))),h=Math.round(s.height*(a/s.width)));const u=\"cim\"in e?e.cim.colorSubstitutions:void 0,{size:d,sdf:m,image:l}=this._rasterizer.rasterizeImageResource(a,h,s,u);return this._addItemToMosaic(t,d,{type:\"static\",data:l},j(e),m,!1)}catch(n){if(!h(n))return new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${r}. ${n.message}`)}}async _imageFromBlob(e){const t=window.URL.createObjectURL(e);try{const{data:e}=await this._imageRequestQueue.push(t);return window.URL.revokeObjectURL(t),e}catch(i){if(window.URL.revokeObjectURL(t),!h(i))return new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${t}`);throw i}}_addItemToMosaic(e,t,i,s,r,n){return this._spriteMosaic.addSpriteItem(e,t,i,s,r,n)}}export{X as default};\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,uBAAb;AAAqC,OAAOC,CAAP,MAAa,wBAAb;AAAsC,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,8BAAzB;AAAwD,OAAOC,CAAP,MAAa,2BAAb;AAAyC,OAAOC,CAAP,MAAa,4BAAb;AAA0C,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,2BAAnC;AAA+D,SAAOC,cAAc,IAAIC,CAAzB,EAA2BC,YAAY,IAAIC,CAA3C,QAAiD,kCAAjD;AAAoF,SAAOC,KAAK,IAAIC,CAAhB,QAAsB,iCAAtB;AAAwD,SAAOJ,CAAC,IAAIK,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOD,CAAC,IAAIE,CAAZ,QAAkB,+BAAlB;AAAkD,OAAOC,CAAP,MAAa,uCAAb;AAAqD,SAAOC,2BAA2B,IAAIC,CAAtC,EAAwCC,4BAA4B,IAAIC,CAAxE,QAA8E,kBAA9E;AAAiG,SAAOC,UAAU,IAAIC,CAArB,QAA2B,YAA3B;AAAwC,SAAOC,yBAAyB,IAAIC,CAApC,QAA0C,gBAA1C;AAA2D,OAAOC,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,mBAAb;AAAiC,OAAOC,CAAP,MAAa,mBAAb;AAAiC,SAAOC,IAAI,IAAIC,CAAf,EAAiBC,SAAS,IAAIC,CAA9B,EAAgCC,QAAQ,IAAIC,CAA5C,EAA8CC,aAAa,IAAIC,CAA/D,EAAiEC,eAAe,IAAIC,CAApF,EAAsFC,8BAA8B,IAAIC,CAAxH,EAA0HC,YAAY,IAAIC,CAA1I,EAA4IC,kBAAkB,IAAIC,CAAlK,EAAoKC,KAAK,IAAIC,CAA7K,EAA+KC,KAAK,IAAIC,CAAxL,EAA0LC,MAAM,IAAIC,CAApM,EAAsMC,UAAU,IAAIC,CAApN,QAA0N,YAA1N;AAAuO,SAAOL,KAAK,IAAIM,CAAhB,EAAkBC,aAAa,IAAIC,CAAnC,EAAqCC,IAAI,IAAIC,CAA7C,QAAmD,2BAAnD;AAA+E,SAAOZ,KAAK,IAAIa,CAAhB,EAAkBC,aAAa,IAAIC,CAAnC,EAAqCC,GAAG,IAAIC,CAA5C,QAAkD,0BAAlD;AAA6E,SAAOC,EAAE,IAAIC,CAAb,QAAmB,kBAAnB;AAAsC,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,uBAA9B;AAAsD,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,oCAA/B;AAAoE,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,yBAApC;AAA8D,MAAMC,CAAC,GAACxD,CAAC,EAAT;AAAA,MAAYyD,CAAC,GAAC,0BAAd;AAAA,MAAyCC,CAAC,GAAC,GAA3C;AAAA,MAA+CC,CAAC,GAACvE,CAAC,CAACwE,SAAF,CAAY,2CAAZ,CAAjD;;AAA0G,eAAeC,CAAf,CAAiB9E,CAAjB,EAAmBG,CAAnB,EAAqB;EAAC,MAAME,CAAC,GAAC+C,CAAC,CAACpD,CAAD,CAAT;EAAa,IAAIO,CAAJ;EAAM,MAAME,CAAC,GAAC,UAAR;;EAAmB,IAAGJ,CAAC,CAAC0E,QAAF,CAAWtE,CAAX,CAAH,EAAiB;IAAC,MAAMT,CAAC,GAACK,CAAC,CAAC2E,OAAF,CAAUvE,CAAV,IAAaA,CAAC,CAACwE,MAAvB;IAAA,MAA8BhF,CAAC,GAACI,CAAC,CAAC6E,SAAF,CAAYlF,CAAZ,CAAhC;IAAA,MAA+CG,CAAC,GAACgF,IAAI,CAAClF,CAAD,CAArD;IAAA,MAAyDG,CAAC,GAAC,IAAIgF,UAAJ,CAAejF,CAAC,CAAC8E,MAAjB,CAA3D;;IAAoF,KAAI,IAAI5E,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACF,CAAC,CAAC8E,MAAhB,EAAuB5E,CAAC,EAAxB,EAA2BD,CAAC,CAACC,CAAD,CAAD,GAAKF,CAAC,CAACkF,UAAF,CAAahF,CAAb,CAAL;;IAAqBE,CAAC,GAACH,CAAC,CAACkF,MAAJ;EAAW,CAAjK,MAAsK,IAAG;IAAC,MAAK;MAACC,IAAI,EAACvF;IAAN,IAAS,MAAMC,CAAC,CAACI,CAAD,EAAG;MAACmF,YAAY,EAAC,cAAd;MAA6B,GAAGrF;IAAhC,CAAH,CAArB;IAA4DI,CAAC,GAACP,CAAF;EAAI,CAApE,CAAoE,OAAMW,CAAN,EAAQ;IAAC,IAAG,CAACE,CAAC,CAACF,CAAD,CAAL,EAAS,OAAO,IAAIP,CAAJ,CAAM,0BAAN,EAAkC,yCAAwCC,CAAE,EAA5E,CAAP;EAAsF;;EAAA,OAAOE,CAAP;AAAS;;AAAA,SAASkF,CAAT,CAAWzF,CAAX,EAAaC,CAAb,EAAe;EAAC,MAAME,CAAC,GAACuF,IAAI,CAACC,KAAL,CAAW5E,CAAC,CAACd,CAAD,CAAD,GAAK2F,MAAM,CAACC,gBAAvB,CAAR;EAAA,MAAiDzF,CAAC,GAACD,CAAC,IAAE,GAAH,GAAO,CAAP,GAAS,CAA5D;EAA8D,OAAOuF,IAAI,CAACI,GAAL,CAAS9F,CAAT,EAAWG,CAAC,GAACC,CAAb,CAAP;AAAuB;;AAAA,MAAM2F,CAAC,GAAC,CAAC/F,CAAD,EAAGC,CAAH,EAAKE,CAAL,KAASyE,CAAC,CAACoB,KAAF,CAAQ,IAAI5F,CAAJ,CAAMJ,CAAN,EAAQC,CAAR,EAAUE,CAAV,CAAR,CAAjB;;AAAuC,MAAM8F,CAAN,CAAO;EAACC,WAAW,CAAClG,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAO;IAAC,KAAKgG,UAAL,GAAgBnG,CAAhB,EAAkB,KAAKoG,IAAL,GAAUnG,CAA5B,EAA8B,KAAKoG,GAAL,GAASlG,CAAvC;EAAyC;;EAAiB,OAAVmG,UAAU,CAACtG,CAAD,EAAGC,CAAH,EAAK;IAAC,OAAO,IAAIgG,CAAJ,CAAMjG,CAAN,EAAQC,CAAC,CAACmG,IAAV,EAAenG,CAAC,CAACoG,GAAjB,CAAP;EAA6B;;AAAjH;;AAAkH,MAAME,CAAN,CAAO;EAACL,WAAW,CAAC/F,CAAD,EAAGE,CAAH,EAAK;IAAC,KAAKmG,cAAL,GAAoBrG,CAApB,EAAsB,KAAKsG,eAAL,GAAqBpG,CAA3C,EAA6C,KAAKqG,gBAAL,GAAsB,IAAIC,GAAJ,EAAnE,EAA2E,KAAKC,aAAL,GAAmB,IAAI/E,CAAJ,CAAM8C,CAAN,CAA9F,EAAuG,KAAKkC,aAAL,GAAmB,IAAIC,KAAJ,EAA1H,EAAoI,KAAKC,mBAAL,GAAyB,IAAIJ,GAAJ,EAA7J,EAAqK,KAAKK,sBAAL,GAA4B,IAAIL,GAAJ,EAAjM,EAAyM,KAAKM,kBAAL,GAAwB,IAAI3C,CAAJ,CAAM;MAAC4C,WAAW,EAAC,EAAb;MAAgBC,OAAO,EAAC,OAAMnH,CAAN,EAAQG,CAAR,KAAY;QAACQ,CAAC,CAACR,CAAD,CAAD;;QAAK,IAAG;UAAC,OAAO,MAAMF,CAAC,CAACD,CAAD,EAAG;YAACwF,YAAY,EAAC,OAAd;YAAsB4B,MAAM,EAACjH;UAA7B,CAAH,CAAd;QAAkD,CAAtD,CAAsD,OAAME,CAAN,EAAQ;UAAC,IAAG,CAACQ,CAAC,CAACR,CAAD,CAAL,EAAS,MAAM,IAAID,CAAJ,CAAM,0BAAN,EAAkC,yCAAwCJ,CAAE,EAA5E,EAA8EK,CAA9E,CAAN;UAAuF,MAAMA,CAAN;QAAQ;MAAC;IAAlN,CAAN,CAAjO,EAA4b,KAAKgH,aAAL,GAAmB,IAAIvF,CAAJ,CAAM,IAAN,EAAW,IAAX,EAAgB,GAAhB,CAA/c,EAAoe,KAAKwF,YAAL,GAAkB,IAAI1F,CAAJ,CAAO,GAAE5B,CAAC,CAACuH,QAAS,0BAApB,CAAtf,EAAqiB,KAAKC,YAAL,GAAkB,IAAI7F,CAAJ,CAAM,IAAN,EAAW,IAAX,EAAgB,KAAK2F,YAArB,CAAvjB,EAA0lB,KAAKG,WAAL,GAAiB,IAAIvG,CAAJ,CAAMb,CAAN,CAA3mB;EAAonB;;EAAAqH,OAAO,GAAE;IAAC,KAAKL,aAAL,CAAmBK,OAAnB,IAA6B,KAAKF,YAAL,CAAkBE,OAAlB,EAA7B,EAAyD,KAAKD,WAAL,CAAiBC,OAAjB,EAAzD,EAAoF,KAAKd,aAAL,CAAmBc,OAAnB,EAApF,EAAiH,KAAKL,aAAL,GAAmB,IAApI,EAAyI,KAAKG,YAAL,GAAkB,IAA3J,EAAgK,KAAKZ,aAAL,GAAmB,IAAnL,EAAwL,KAAKG,mBAAL,CAAyBY,KAAzB,EAAxL,EAAyN,KAAKZ,mBAAL,GAAyB,IAAlP,EAAuP,KAAKF,aAAL,GAAmB,IAA1Q,EAA+Q,KAAKG,sBAAL,CAA4BW,KAA5B,EAA/Q,EAAmT,KAAKX,sBAAL,GAA4B,IAA/U,EAAoV,KAAKC,kBAAL,CAAwBU,KAAxB,EAApV,EAAoX,KAAKV,kBAAL,GAAwB,IAA5Y;EAAiZ;;EAAW,IAAPW,OAAO,GAAE;IAAC,OAAO,KAAKP,aAAZ;EAA0B;;EAAU,IAANQ,MAAM,GAAE;IAAC,OAAO,KAAKL,YAAZ;EAAyB;;EAAmB,MAAbM,aAAa,CAAC9H,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAOC,CAAP,EAAS;IAAC,IAAGG,CAAC,CAACP,CAAD,CAAJ,EAAQ,OAAO+F,CAAC,CAAC,uBAAD,EAAyB,mCAAzB,CAAD,EAA+D,IAAtE;;IAA2E,QAAO/F,CAAC,CAAC+H,IAAT;MAAe,KAAI,MAAJ;MAAW,KAAI,QAAJ;QAAa;UAAC,MAAM9H,CAAC,GAAC,MAAM,KAAK+H,cAAL,CAAoBhI,CAApB,EAAsBG,CAAtB,EAAwBC,CAAxB,CAAd;UAAyC,OAAOH,CAAC,CAACgI,OAAF,CAAWjI,CAAC,IAAE,KAAKkI,kBAAL,CAAwB1G,CAAC,CAAC2G,KAA1B,EAAgCnI,CAAhC,CAAd,GAAmD;YAACoI,gBAAgB,EAACnI;UAAlB,CAA1D;QAA+E;;MAAA;QAAQ;UAAC,IAAG+B,CAAC,CAAChC,CAAD,CAAJ,EAAQ,OAAO+F,CAAC,CAAC,sBAAD,EAAyB,yCAAwC/F,CAAC,CAAC+H,IAAK,EAAxE,EAA0E/H,CAA1E,CAAD,EAA8E,IAArF;UAA0F,MAAMG,CAAC,GAAC,MAAM,KAAKkI,sBAAL,CAA4BrI,CAA5B,EAA8BC,CAA9B,EAAgCG,CAAhC,CAAd;UAAiD,OAAO8D,CAAC,CAAC/D,CAAD,CAAD,IAAMA,CAAN,IAAS,KAAK+H,kBAAL,CAAwB1G,CAAC,CAAC8G,MAA1B,EAAiCnI,CAAjC,CAAT,EAA6C;YAACoI,gBAAgB,EAACpI;UAAlB,CAApD;QAAyE;IAArY;EAAuY;;EAAAqI,YAAY,CAACxI,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAOC,CAAC,GAAC,CAAC,CAAV,EAAY;IAAC,IAAG,MAAID,CAAC,CAACsI,cAAT,EAAwB;IAAO,MAAMpI,CAAC,GAAC,KAAKwG,aAAL,CAAmB1G,CAAC,CAACsI,cAAF,GAAiB,CAApC,CAAR;IAAA,MAA+ClI,CAAC,GAACF,CAAC,CAAC+F,IAAnD;IAAA,MAAwD3F,CAAC,GAACL,CAAC,GAACoE,CAAC,CAACkE,oBAAH,GAAwBlE,CAAC,CAACmE,MAArF;;IAA4F,QAAOtI,CAAC,CAAC8F,UAAT;MAAqB,KAAK3E,CAAC,CAAC8G,MAAP;QAAc;UAAC,MAAMnI,CAAC,GAAC,KAAKyH,OAAL,CAAagB,QAAb,CAAsBrI,CAAtB,CAAR;UAAA,MAAiCH,CAAC,GAAC,KAAKwH,OAAL,CAAaiB,SAAb,CAAuBtI,CAAvB,CAAnC;UAAA,MAA6DF,CAAC,GAACW,CAAC,CAACyD,CAAD,EAAGtE,CAAH,EAAKC,CAAL,CAAhE;UAAwE,OAAO,KAAKiH,aAAL,CAAmByB,IAAnB,CAAwB9I,CAAxB,EAA0BS,CAA1B,EAA4BF,CAA5B,EAA8Be,CAA9B,GAAiCrB,CAAC,CAAC8I,YAAF,CAAe,WAAf,EAA2BzH,CAA3B,CAAjC,EAA+D,KAAKrB,CAAC,CAAC+I,aAAF,CAAgB,cAAhB,EAA+B3I,CAA/B,CAA3E;QAA6G;;MAAA,KAAKmB,CAAC,CAAC2G,KAAP;QAAa;UAAC,MAAMhI,CAAC,GAAC,KAAK0H,MAAL,CAAYoB,KAApB;UAAA,MAA0B7I,CAAC,GAAC,KAAKyH,MAAL,CAAYqB,MAAxC;UAAA,MAA+C7I,CAAC,GAACW,CAAC,CAACyD,CAAD,EAAGtE,CAAH,EAAKC,CAAL,CAAlD;UAA0D,OAAO,KAAKoH,YAAL,CAAkBsB,IAAlB,CAAuB9I,CAAvB,EAAyBS,CAAzB,EAA2BF,CAA3B,EAA6Ba,CAA7B,GAAgCnB,CAAC,CAAC8I,YAAF,CAAe,WAAf,EAA2B3H,CAA3B,CAAhC,EAA8D,KAAKnB,CAAC,CAAC+I,aAAF,CAAgB,cAAhB,EAA+B3I,CAA/B,CAA1E;QAA4G;;MAAA;QAAQuE,CAAC,CAACoB,KAAF,CAAQ,yBAAR,EAAmC,8BAA6B3F,CAAC,CAAC8F,UAAW,EAA7E;IAArZ;EAAse;;EAAAgD,WAAW,CAACnJ,CAAD,EAAGC,CAAH,EAAK;IAAC,OAAO,IAAED,CAAC,IAAE,CAAL,GAAO,CAACC,CAAC,CAACoG,GAAF,GAAM,CAAN,GAAQ,CAAT,KAAa,CAApB,GAAsBpG,CAAC,CAACmG,IAAF,IAAQ,CAArC;EAAuC;;EAAA8B,kBAAkB,CAAClI,CAAD,EAAGC,CAAH,EAAK;IAAC,MAAME,CAAC,GAAC,KAAKgJ,WAAL,CAAiBnJ,CAAjB,EAAmBC,CAAnB,CAAR;;IAA8B,IAAG,CAAC,KAAK8G,mBAAL,CAAyBqC,GAAzB,CAA6BjJ,CAA7B,CAAJ,EAAoC;MAAC,MAAMC,CAAC,GAAC6F,CAAC,CAACK,UAAF,CAAatG,CAAb,EAAeC,CAAf,CAAR;MAAA,MAA0BI,CAAC,GAAC,KAAKwG,aAAL,CAAmB5B,MAAnB,GAA0B,CAAtD;MAAwD,KAAK8B,mBAAL,CAAyBsC,GAAzB,CAA6BlJ,CAA7B,EAA+BE,CAA/B,GAAkC,KAAKwG,aAAL,CAAmByC,IAAnB,CAAwBlJ,CAAxB,CAAlC;IAA6D;;IAAAH,CAAC,CAACwI,cAAF,GAAiB,KAAK1B,mBAAL,CAAyBwC,GAAzB,CAA6BpJ,CAA7B,CAAjB;EAAiD;;EAAoB,MAAd6H,cAAc,CAAChI,CAAD,EAAGC,CAAH,EAAKG,CAAL,EAAO;IAAC,IAAIC,CAAJ,EAAME,CAAN;;IAAQ,IAAG,SAAQP,CAAX,EAAa;MAAC,MAAMC,CAAC,GAACD,CAAR;MAAUK,CAAC,GAACJ,CAAC,CAACuJ,QAAJ,EAAajJ,CAAC,GAACN,CAAC,CAACwJ,IAAjB;IAAsB,CAA9C,MAAkD;MAAC,MAAMxJ,CAAC,GAACD,CAAR;MAAUK,CAAC,GAACqB,CAAC,CAACzB,CAAC,CAACyJ,IAAH,CAAH,EAAYnJ,CAAC,GAACN,CAAC,CAACwJ,IAAhB;IAAqB;;IAAA,MAAMhJ,CAAC,GAAC,KAAKiG,gBAAL,CAAsB0C,GAAtB,CAA0B/I,CAA1B,CAAR;IAAA,MAAqCM,CAAC,GAACV,CAAC,IAAEiC,CAAC,CAAC/B,CAAC,CAACI,CAAD,CAAD,CAAK,CAAL,CAAD,CAA3C;;IAAqD,IAAG;MAAC,OAAO,MAAM,KAAKiH,YAAL,CAAkBmC,aAAlB,CAAgClJ,CAAC,GAACiE,CAAD,GAAGrE,CAApC,EAAsCM,CAAtC,EAAwCP,CAAxC,CAAb;IAAwD,CAA5D,CAA4D,OAAMS,CAAN,EAAQ;MAAC,OAAOkF,CAAC,CAAC,0BAAD,EAA6B,sBAAqB1F,CAAE,4CAApD,CAAD,EAAkG,KAAKqG,gBAAL,CAAsB2C,GAAtB,CAA0BhJ,CAA1B,EAA4B,CAAC,CAA7B,CAAlG,EAAkI,KAAKmH,YAAL,CAAkBmC,aAAlB,CAAgCjF,CAAhC,EAAkC/D,CAAlC,EAAoCP,CAApC,CAAzI;IAAgL;EAAC;;EAA4B,MAAtBiI,sBAAsB,CAACrI,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAO;IAAC,IAAGiC,CAAC,CAACpC,CAAD,CAAJ,EAAQ,OAAO,IAAP;IAAY,MAAMK,CAAC,GAAC+D,CAAC,CAACpE,CAAD,CAAT;IAAa,IAAG,KAAKqH,aAAL,CAAmB+B,GAAnB,CAAuB/I,CAAvB,CAAH,EAA6B,OAAO,KAAKgH,aAAL,CAAmBuC,aAAnB,CAAiCvJ,CAAjC,CAAP;IAA2C,IAAGiC,CAAC,CAACtC,CAAD,CAAD,IAAMwC,CAAC,CAACxC,CAAD,CAAD,IAAM,CAAC0C,CAAC,CAAC1C,CAAD,CAAjB,EAAqB,OAAO,KAAK6J,oBAAL,CAA0BxJ,CAA1B,EAA4BL,CAA5B,EAA8BG,CAA9B,CAAP;;IAAwC,MAAMI,CAAC,GAAC,CAAR;IAAA,MAAUE,CAAC,GAAC,KAAKgH,WAAL,CAAiBqC,qBAAjB,CAAuC9J,CAAvC,EAAyCO,CAAzC,CAAZ;;IAAwD,IAAGE,CAAH,EAAK;MAAC,MAAK;QAACsJ,IAAI,EAAC9J,CAAN;QAAQ+J,KAAK,EAAC7J,CAAd;QAAgBkG,GAAG,EAACjG,CAApB;QAAsB6J,aAAa,EAAC1J;MAApC,IAAuCE,CAA5C;MAA8C,OAAO,KAAKyJ,gBAAL,CAAsB7J,CAAtB,EAAwBJ,CAAxB,EAA0B;QAAC8H,IAAI,EAAC,QAAN;QAAexC,IAAI,EAACpF;MAApB,CAA1B,EAAiDyC,CAAC,CAAC5C,CAAD,CAAlD,EAAsDI,CAAtD,EAAwDG,CAAxD,CAAP;IAAkE;;IAAA,OAAO,IAAIH,CAAJ,CAAM,gBAAN,EAAuB,uCAAvB,CAAP;EAAuE;;EAA0B,MAApByJ,oBAAoB,CAAC7J,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAO;IAAC,IAAG,KAAK6G,sBAAL,CAA4BoC,GAA5B,CAAgCpJ,CAAhC,CAAH,EAAsC,OAAO,KAAKgH,sBAAL,CAA4BuC,GAA5B,CAAgCvJ,CAAhC,CAAP;IAA0C,IAAII,CAAJ;IAAMA,CAAC,GAACkC,CAAC,CAACrC,CAAD,CAAD,GAAK,KAAKkK,UAAL,CAAgBlK,CAAhB,EAAkBD,CAAlB,EAAoBG,CAApB,CAAL,GAA4B,KAAKiK,YAAL,CAAkBnK,CAAlB,EAAoBD,CAApB,EAAsBG,CAAtB,CAA9B,EAAuD,KAAK6G,sBAAL,CAA4BqC,GAA5B,CAAgCrJ,CAAhC,EAAkCI,CAAlC,CAAvD;;IAA4F,IAAG;MAAC,MAAMA,CAAN,EAAQ,KAAK4G,sBAAL,CAA4BqD,MAA5B,CAAmCrK,CAAnC,CAAR;IAA8C,CAAlD,CAAkD,MAAK;MAAC,KAAKgH,sBAAL,CAA4BqD,MAA5B,CAAmCrK,CAAnC;IAAsC;;IAAA,OAAOI,CAAP;EAAS;;EAAgB,MAAV+J,UAAU,CAACnK,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAO;IAAC,MAAMC,CAAC,GAAC,CAACuE,CAAD,EAAGA,CAAH,CAAR;IAAA,MAActE,CAAC,GAAC,MAAM,KAAKuG,aAAL,CAAmB0D,IAAnB,CAAwBtK,CAAC,CAACuK,IAA1B,EAA+BpK,CAA/B,CAAtB;IAAwD,OAAO,KAAK+J,gBAAL,CAAsBjK,CAAtB,EAAwBG,CAAxB,EAA0B;MAAC2H,IAAI,EAAC,QAAN;MAAexC,IAAI,EAAC,IAAIiF,WAAJ,CAAgBnK,CAAC,CAACiF,MAAlB;IAApB,CAA1B,EAAyE,CAAC,CAA1E,EAA4E,CAAC,CAA7E,EAA+E,CAAC,CAAhF,CAAP;EAA0F;;EAAqB,MAAfmF,eAAe,CAACzK,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAO;IAAC,MAAME,CAAC,GAAC,MAAMyE,CAAC,CAAC9E,CAAD,EAAGG,CAAH,CAAf;;IAAqB,IAAG+D,CAAC,CAAC7D,CAAD,CAAJ,EAAQ;MAAC,MAAMI,CAAC,GAACmD,CAAC,CAACvD,CAAD,CAAT;MAAA,MAAaM,CAAC,GAAC4C,CAAC,CAAClD,CAAD,CAAhB;MAAoB,IAAG,CAACI,CAAD,IAAI,CAACE,CAAR,EAAU,OAAO,IAAIP,CAAJ,CAAM,0BAAN,EAAiC,oCAAjC,CAAP;MAA8E,IAAIW,CAAJ;;MAAM,IAAG;QAAC,MAAMd,CAAC,GAACD,CAAC,CAAC0K,wBAAF,IAA4B,EAApC;QAAA,MAAuCtK,CAAC,GAACJ,CAAC,CAAC2K,QAA3C;QAAoDlK,CAAC,IAAEqD,CAAC,CAACzD,CAAD,CAAJ,GAAQU,CAAC,GAAC,MAAMiD,CAAC,CAAC4G,MAAF,CAASvK,CAAT,EAAWJ,CAAX,EAAaG,CAAb,EAAe,KAAKoG,cAApB,EAAmCrG,CAAnC,CAAhB,GAAsDQ,CAAC,IAAE8C,CAAC,CAACpD,CAAD,CAAJ,KAAUU,CAAC,GAAC,MAAM4C,CAAC,CAACiH,MAAF,CAASvK,CAAT,EAAWJ,CAAX,EAAaG,CAAb,EAAe,KAAKoG,cAApB,EAAmCrG,CAAnC,CAAlB,CAAtD;MAA+G,CAAvK,CAAuK,OAAMI,CAAN,EAAQ;QAAC,IAAG,CAACM,CAAC,CAACN,CAAD,CAAL,EAAS,OAAO,IAAIH,CAAJ,CAAM,0BAAN,EAAiC,qCAAjC,CAAP;MAA+E;;MAAA,IAAGW,CAAC,IAAEmD,CAAC,CAACnD,CAAD,CAAP,EAAW,OAAO,KAAKmJ,gBAAL,CAAsBjK,CAAtB,EAAwB,CAACc,CAAC,CAACkI,KAAH,EAASlI,CAAC,CAACmI,MAAX,CAAxB,EAA2C;QAACnB,IAAI,EAAC,UAAN;QAAiBxC,IAAI,EAACxE;MAAtB,CAA3C,EAAoE6B,CAAC,CAAC5C,CAAD,CAArE,EAAyE,CAAC,CAA1E,EAA4E,CAAC,CAA7E,CAAP;MAAuF,MAAMgB,CAAC,GAAC,IAAI6J,IAAJ,CAAS,CAACxK,CAAD,CAAT,EAAa;QAAC0H,IAAI,EAACtH,CAAC,GAAC,WAAD,GAAa;MAApB,CAAb,CAAR;MAAA,MAAuDQ,CAAC,GAAC,MAAM,KAAK6J,cAAL,CAAoB9J,CAApB,CAA/D;;MAAsF,IAAGC,CAAC,IAAEA,CAAC,YAAY8J,gBAAnB,EAAoC;QAAC,IAAI5K,CAAC,GAACc,CAAC,CAACgI,KAAR;QAAA,IAAc7I,CAAC,GAACa,CAAC,CAACiI,MAAlB;QAAyB,cAAYlJ,CAAC,CAAC+H,IAAd,KAAqB5H,CAAC,GAACuF,IAAI,CAACC,KAAL,CAAWF,CAAC,CAACxE,CAAC,CAACgI,KAAH,EAASnG,CAAC,CAAC9C,CAAD,CAAV,CAAZ,CAAF,EAA8BI,CAAC,GAACsF,IAAI,CAACC,KAAL,CAAW1E,CAAC,CAACiI,MAAF,IAAU/I,CAAC,GAACc,CAAC,CAACgI,KAAd,CAAX,CAArD;;QAAuF,MAAM5I,CAAC,GAAC,SAAQL,CAAR,GAAUA,CAAC,CAACgL,GAAF,CAAMC,kBAAhB,GAAmC,KAAK,CAAhD;QAAA,MAAkD;UAAClB,IAAI,EAACxJ,CAAN;UAAQ8F,GAAG,EAAC5F,CAAZ;UAAcuJ,KAAK,EAACrJ;QAApB,IAAuB,KAAK8G,WAAL,CAAiByD,sBAAjB,CAAwC/K,CAAxC,EAA0CC,CAA1C,EAA4Ca,CAA5C,EAA8CZ,CAA9C,CAAzE;;QAA0H,OAAO,KAAK6J,gBAAL,CAAsBjK,CAAtB,EAAwBM,CAAxB,EAA0B;UAACwH,IAAI,EAAC,QAAN;UAAexC,IAAI,EAAC5E;QAApB,CAA1B,EAAiDiC,CAAC,CAAC5C,CAAD,CAAlD,EAAsDS,CAAtD,EAAwD,CAAC,CAAzD,CAAP;MAAmE;IAAC;;IAAA,OAAO,IAAIL,CAAJ,CAAM,0BAAN,EAAiC,4BAAjC,CAAP;EAAsE;;EAAkB,MAAZgK,YAAY,CAACpK,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAO;IAAC,IAAG6C,CAAC,CAAChD,CAAD,CAAD,IAAMkD,CAAC,CAAClD,CAAD,CAAV,EAAc,OAAO,KAAKyK,eAAL,CAAqBzK,CAArB,EAAuBC,CAAvB,EAAyBE,CAAzB,CAAP;IAAmC,MAAME,CAAC,GAAC+C,CAAC,CAACpD,CAAD,CAAT;;IAAa,IAAG;MAAC,IAAII,CAAJ;MAAM,MAAMG,CAAC,GAAC,KAAKkG,eAAL,CAAqB0E,WAArB,CAAiC9K,CAAjC,CAAR;MAA4C,IAAGI,CAAC,CAACF,CAAD,CAAJ,EAAQH,CAAC,GAACG,CAAF,CAAR,KAAgB;QAAC,MAAK;UAACgF,IAAI,EAACvF;QAAN,IAAS,MAAM,KAAKiH,kBAAL,CAAwBqC,IAAxB,CAA6BjJ,CAA7B,EAA+B,EAAC,GAAGF;QAAJ,CAA/B,CAApB;QAA2DC,CAAC,GAACJ,CAAF;MAAI;MAAA,IAAGsD,CAAC,CAACjD,CAAD,CAAJ,EAAQ,IAAG,WAAUL,CAAV,IAAa,YAAWA,CAA3B,EAA6BI,CAAC,CAAC6I,KAAF,GAAQlI,CAAC,CAACf,CAAC,CAACiJ,KAAH,CAAT,EAAmB7I,CAAC,CAAC8I,MAAF,GAASnI,CAAC,CAACf,CAAC,CAACkJ,MAAH,CAA7B,CAA7B,KAA0E,IAAG,SAAQlJ,CAAX,EAAa;QAAC,MAAMC,CAAC,GAACD,CAAC,CAACgL,GAAV;QAAc5K,CAAC,CAAC6I,KAAF,GAAQlI,CAAC,CAACd,CAAC,CAACgJ,KAAF,IAAShJ,CAAC,CAACmL,MAAF,GAASnL,CAAC,CAAC8J,IAArB,CAAT,EAAoC3J,CAAC,CAAC8I,MAAF,GAASnI,CAAC,CAACd,CAAC,CAAC8J,IAAH,CAA9C;MAAuD;MAAA,IAAG,CAAC3J,CAAC,CAAC6I,KAAH,IAAU,CAAC7I,CAAC,CAAC8I,MAAhB,EAAuB,OAAO,IAAP;MAAY,IAAIvI,CAAC,GAACP,CAAC,CAAC6I,KAAR;MAAA,IAAcpI,CAAC,GAACT,CAAC,CAAC8I,MAAlB;MAAyB,cAAYlJ,CAAC,CAAC+H,IAAd,KAAqBpH,CAAC,GAAC+E,IAAI,CAACC,KAAL,CAAWF,CAAC,CAACrF,CAAC,CAAC6I,KAAH,EAASnG,CAAC,CAAC9C,CAAD,CAAV,CAAZ,CAAF,EAA8Ba,CAAC,GAAC6E,IAAI,CAACC,KAAL,CAAWvF,CAAC,CAAC8I,MAAF,IAAUvI,CAAC,GAACP,CAAC,CAAC6I,KAAd,CAAX,CAArD;;MAAuF,MAAMjI,CAAC,GAAC,SAAQhB,CAAR,GAAUA,CAAC,CAACgL,GAAF,CAAMC,kBAAhB,GAAmC,KAAK,CAAhD;MAAA,MAAkD;QAAClB,IAAI,EAAC9I,CAAN;QAAQoF,GAAG,EAACnF,CAAZ;QAAc8I,KAAK,EAAC5I;MAApB,IAAuB,KAAKqG,WAAL,CAAiByD,sBAAjB,CAAwCvK,CAAxC,EAA0CE,CAA1C,EAA4CT,CAA5C,EAA8CY,CAA9C,CAAzE;;MAA0H,OAAO,KAAKkJ,gBAAL,CAAsBjK,CAAtB,EAAwBgB,CAAxB,EAA0B;QAAC8G,IAAI,EAAC,QAAN;QAAexC,IAAI,EAACnE;MAApB,CAA1B,EAAiDwB,CAAC,CAAC5C,CAAD,CAAlD,EAAsDkB,CAAtD,EAAwD,CAAC,CAAzD,CAAP;IAAmE,CAA3nB,CAA2nB,OAAMX,CAAN,EAAQ;MAAC,IAAG,CAACM,CAAC,CAACN,CAAD,CAAL,EAAS,OAAO,IAAIH,CAAJ,CAAM,0BAAN,EAAkC,yCAAwCC,CAAE,KAAIE,CAAC,CAAC8K,OAAQ,EAA1F,CAAP;IAAoG;EAAC;;EAAoB,MAAdP,cAAc,CAAC9K,CAAD,EAAG;IAAC,MAAMC,CAAC,GAAC2F,MAAM,CAAC0F,GAAP,CAAWC,eAAX,CAA2BvL,CAA3B,CAAR;;IAAsC,IAAG;MAAC,MAAK;QAACuF,IAAI,EAACvF;MAAN,IAAS,MAAM,KAAKiH,kBAAL,CAAwBqC,IAAxB,CAA6BrJ,CAA7B,CAApB;MAAoD,OAAO2F,MAAM,CAAC0F,GAAP,CAAWE,eAAX,CAA2BvL,CAA3B,GAA8BD,CAArC;IAAuC,CAA/F,CAA+F,OAAMG,CAAN,EAAQ;MAAC,IAAGyF,MAAM,CAAC0F,GAAP,CAAWE,eAAX,CAA2BvL,CAA3B,GAA8B,CAACY,CAAC,CAACV,CAAD,CAAnC,EAAuC,OAAO,IAAIC,CAAJ,CAAM,0BAAN,EAAkC,yCAAwCH,CAAE,EAA5E,CAAP;MAAsF,MAAME,CAAN;IAAQ;EAAC;;EAAA+J,gBAAgB,CAAClK,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAOC,CAAP,EAASC,CAAT,EAAWE,CAAX,EAAa;IAAC,OAAO,KAAK8G,aAAL,CAAmBoE,aAAnB,CAAiCzL,CAAjC,EAAmCC,CAAnC,EAAqCE,CAArC,EAAuCC,CAAvC,EAAyCC,CAAzC,EAA2CE,CAA3C,CAAP;EAAqD;;AAA7iM;;AAA8iM,SAAOgG,CAAC,IAAImF,OAAZ"},"metadata":{},"sourceType":"module"}