{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../config.js\";\nimport r from \"../Graphic.js\";\nimport o from \"../PopupTemplate.js\";\nimport s from \"../request.js\";\nimport i from \"../core/Collection.js\";\nimport a from \"../core/CollectionFlattener.js\";\nimport { JSONMap as n } from \"../core/jsonMap.js\";\nimport { clone as l } from \"../core/lang.js\";\nimport { isSome as p, isNone as m } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as u } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as c } from \"../core/promiseUtils.js\";\nimport { on as f, watch as y, sync as d } from \"../core/reactiveUtils.js\";\nimport { addQueryParameters as h, addProxy as g, Url as b } from \"../core/urlUtils.js\";\nimport { property as v } from \"../core/accessorSupport/decorators/property.js\";\nimport { Integer as w } from \"../core/accessorSupport/ensureType.js\";\nimport { reader as x } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as j } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as I } from \"../core/accessorSupport/decorators/writer.js\";\nimport { willPropertyWrite as S } from \"../core/accessorSupport/write.js\";\nimport F from \"../geometry/Extent.js\";\nimport E from \"../geometry/SpatialReference.js\";\nimport { getScale as R } from \"../geometry/support/scaleUtils.js\";\nimport { equals as P } from \"../geometry/support/spatialReferenceUtils.js\";\nimport O from \"./Layer.js\";\nimport { BlendLayer as L } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as U } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as M } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as T } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as _ } from \"./mixins/ScaleRangeLayer.js\";\nimport { TemporalLayer as C } from \"./mixins/TemporalLayer.js\";\nimport { isAxesOrderReversedForWkid as W } from \"./ogc/crsUtils.js\";\nimport { isWmsServer as $ } from \"./support/arcgisLayerUrl.js\";\nimport { legendEnabled as q, url as N } from \"./support/commonProperties.js\";\nimport { ExportWMSImageParameters as B } from \"./support/ExportWMSImageParameters.js\";\nimport H from \"./support/WMSSublayer.js\";\nimport { normalizeWKID as k, toISOString as G, getPopupLayers as A, parseCapabilities as D } from \"./support/wmsUtils.js\";\nconst J = new n({\n  bmp: \"image/bmp\",\n  gif: \"image/gif\",\n  jpg: \"image/jpeg\",\n  png: \"image/png\",\n  svg: \"image/svg+xml\"\n}, {\n  ignoreUnknown: !1\n});\n\nfunction V(e) {\n  return \"text/html\" === e;\n}\n\nfunction Q(e) {\n  return \"text/plain\" === e;\n}\n\nlet z = class extends L(C(T(_(U(M(u(O))))))) {\n  constructor(...e) {\n    super(...e), this.allSublayers = new a({\n      getCollections: () => [this.sublayers],\n      getChildrenFunction: e => e.sublayers\n    }), this.customParameters = null, this.customLayerParameters = null, this.copyright = null, this.description = null, this.dimensions = null, this.fullExtent = null, this.fullExtents = null, this.featureInfoFormats = null, this.featureInfoUrl = null, this.fetchFeatureInfoFunction = null, this.imageFormat = null, this.imageMaxHeight = 2048, this.imageMaxWidth = 2048, this.imageTransparency = !0, this.legendEnabled = !0, this.mapUrl = null, this.isReference = null, this.operationalLayerType = \"WMS\", this.spatialReference = null, this.spatialReferences = null, this.sublayers = null, this.type = \"wms\", this.url = null, this.version = null, this.addHandles([f(() => this.sublayers, \"after-add\", ({\n      item: e\n    }) => {\n      e.parent = e.layer = this;\n    }, d), f(() => this.sublayers, \"after-remove\", ({\n      item: e\n    }) => {\n      e.layer = e.parent = null;\n    }, d), y(() => this.sublayers, (e, t) => {\n      if (t) for (const r of t) r.layer = r.parent = null;\n      if (e) for (const r of e) r.parent = r.layer = this;\n    }, d)]);\n  }\n\n  normalizeCtorArgs(e, t) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...t\n    } : e;\n  }\n\n  load(e) {\n    const t = p(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"WMS\"]\n    }, e).catch(c).then(() => this._fetchService(t))), Promise.resolve(this);\n  }\n\n  readFullExtentFromItemOrMap(e, t) {\n    const r = t.extent;\n    return r ? new F({\n      xmin: r[0][0],\n      ymin: r[0][1],\n      xmax: r[1][0],\n      ymax: r[1][1]\n    }) : null;\n  }\n\n  writeFullExtent(e, t) {\n    t.extent = [[e.xmin, e.ymin], [e.xmax, e.ymax]];\n  }\n\n  get featureInfoFormat() {\n    return m(this.featureInfoFormats) ? null : this.featureInfoFormats.find(V) ?? this.featureInfoFormats.find(Q) ?? null;\n  }\n\n  set featureInfoFormat(e) {\n    p(e) ? (V(e) || Q(e)) && this._override(\"featureInfoFormat\", e) : (this.revert(\"featureInfoFormat\", \"service\"), this._clearOverride(\"featureInfoFormat\"));\n  }\n\n  readImageFormat(e, t) {\n    const r = t.supportedImageFormatTypes;\n    return r && r.includes(\"image/png\") ? \"image/png\" : r && r[0];\n  }\n\n  readSpatialReferenceFromItemOrDocument(e, t) {\n    return new E(t.spatialReferences[0]);\n  }\n\n  writeSpatialReferences(e, t) {\n    const r = this.spatialReference?.wkid;\n    e && r ? (t.spatialReferences = e.filter(e => e !== r), t.spatialReferences.unshift(r)) : t.spatialReferences = e;\n  }\n\n  readSublayersFromItemOrMap(e, t, r) {\n    return X(t.layers, r, t.visibleLayers);\n  }\n\n  readSublayers(e, t, r) {\n    return X(t.layers, r);\n  }\n\n  writeSublayers(e, t, r, o) {\n    t.layers = [];\n    const s = new Map(),\n          i = e.flatten(({\n      sublayers: e\n    }) => e);\n\n    for (const a of i) if (\"number\" == typeof a.parent?.id) {\n      const e = s.get(a.parent.id);\n      null != e ? e.push(a.id) : s.set(a.parent.id, [a.id]);\n    }\n\n    for (const a of i) {\n      const e = {\n        sublayer: a,\n        ...o\n      },\n            r = a.write({\n        parentLayerId: \"number\" == typeof a.parent?.id ? a.parent.id : -1\n      }, e);\n\n      if (s.has(a.id) && (r.sublayerIds = s.get(a.id)), !a.sublayers && a.name) {\n        const r = a.write({}, e);\n        delete r.id, t.layers.push(r);\n      }\n    }\n\n    t.visibleLayers = i.filter(({\n      visible: e,\n      sublayers: t\n    }) => e && !t).map(({\n      name: e\n    }) => e).toArray();\n  }\n\n  createExportImageParameters(e, t, r, o) {\n    const s = o?.pixelRatio ?? 1,\n          i = R({\n      extent: e,\n      width: t\n    }) * s,\n          a = new B({\n      layer: this,\n      scale: i\n    }),\n          {\n      xmin: n,\n      ymin: l,\n      xmax: p,\n      ymax: m,\n      spatialReference: u\n    } = e,\n          c = k(u, this.spatialReferences),\n          f = \"1.3.0\" === this.version && W(c) ? `${l},${n},${m},${p}` : `${n},${l},${p},${m}`,\n          y = a.toJSON();\n    return {\n      bbox: f,\n      [\"1.3.0\" === this.version ? \"crs\" : \"srs\"]: isNaN(c) ? void 0 : \"EPSG:\" + c,\n      ...y\n    };\n  }\n\n  async fetchImage(e, t, r, o) {\n    const i = this.mapUrl,\n          a = this.createExportImageParameters(e, t, r, o);\n\n    if (!a.layers) {\n      const e = document.createElement(\"canvas\");\n      return e.width = t, e.height = r, e;\n    }\n\n    const n = o?.timeExtent?.start,\n          l = o?.timeExtent?.end,\n          m = p(n) && p(l) ? n.getTime() === l.getTime() ? G(n) : `${G(n)}/${G(l)}` : void 0,\n          u = {\n      responseType: \"image\",\n      query: this._mixCustomParameters({\n        width: t,\n        height: r,\n        ...a,\n        time: m,\n        ...this.refreshParameters\n      }),\n      signal: o?.signal\n    };\n    return s(i ?? \"\", u).then(e => e.data);\n  }\n\n  async fetchImageBitmap(e, t, r, o) {\n    const i = this.mapUrl,\n          a = this.createExportImageParameters(e, t, r, o);\n\n    if (!a.layers) {\n      const e = document.createElement(\"canvas\");\n      return e.width = t, e.height = r, e;\n    }\n\n    const n = o?.timeExtent?.start,\n          l = o?.timeExtent?.end,\n          m = p(n) && p(l) ? n.getTime() === l.getTime() ? G(n) : `${G(n)}/${G(l)}` : void 0,\n          u = {\n      responseType: \"blob\",\n      query: this._mixCustomParameters({\n        width: t,\n        height: r,\n        ...a,\n        time: m,\n        ...this.refreshParameters\n      }),\n      signal: o?.signal\n    },\n          c = await s(i ?? \"\", u).then(e => e.data);\n    return createImageBitmap(c);\n  }\n\n  fetchFeatureInfo(e, t, r, o, s) {\n    const i = R({\n      extent: e,\n      width: t\n    }),\n          a = new B({\n      layer: this,\n      scale: i\n    }),\n          n = A(a.visibleSublayers);\n    if (m(this.featureInfoUrl) || m(n)) return Promise.resolve([]);\n    if (m(this.fetchFeatureInfoFunction) && m(this.featureInfoFormat)) return Promise.resolve([]);\n\n    const l = \"1.3.0\" === this.version ? {\n      I: o,\n      J: s\n    } : {\n      x: o,\n      y: s\n    },\n          u = {\n      query_layers: n,\n      request: \"GetFeatureInfo\",\n      info_format: this.featureInfoFormat,\n      feature_count: 25,\n      width: t,\n      height: r,\n      ...l\n    },\n          c = { ...this.createExportImageParameters(e, t, r),\n      ...u\n    },\n          f = this._mixCustomParameters(c);\n\n    return p(this.fetchFeatureInfoFunction) ? this.fetchFeatureInfoFunction(f) : this._defaultFetchFeatureInfoFunction(h(this.featureInfoUrl, f));\n  }\n\n  findSublayerById(e) {\n    return this.allSublayers.find(t => t.id === e);\n  }\n\n  findSublayerByName(e) {\n    return this.allSublayers.find(t => t.name === e);\n  }\n\n  serviceSupportsSpatialReference(e) {\n    return $(this.url) || null != this.spatialReferences && this.spatialReferences.some(t => {\n      const r = 900913 === t ? E.WebMercator : new E({\n        wkid: t\n      });\n      return P(r, e);\n    });\n  }\n\n  _defaultFetchFeatureInfoFunction(e) {\n    const t = document.createElement(\"iframe\");\n    t.src = g(e), t.style.border = \"none\", t.style.margin = \"0\", t.style.width = \"100%\", t.setAttribute(\"sandbox\", \"\");\n    const s = new o({\n      title: this.title,\n      content: t\n    }),\n          i = new r({\n      sourceLayer: this,\n      popupTemplate: s\n    });\n    return Promise.resolve([i]);\n  }\n\n  async _fetchService(e) {\n    if (!this.resourceInfo) {\n      const {\n        path: t,\n        query: r\n      } = this.parsedUrl ?? {};\n      r?.service && (r.SERVICE = r.service, delete r.service), r?.request && (r.REQUEST = r.request, delete r.request);\n      const {\n        data: o\n      } = await s(t ?? \"\", {\n        query: {\n          SERVICE: \"WMS\",\n          REQUEST: \"GetCapabilities\",\n          ...r,\n          ...this.customParameters\n        },\n        responseType: \"xml\",\n        signal: e\n      });\n      this.resourceInfo = D(o);\n    }\n\n    if (this.parsedUrl) {\n      const e = new b(this.parsedUrl.path),\n            {\n        httpsDomains: r\n      } = t.request;\n      \"https\" !== e.scheme || e.port && \"443\" !== e.port || !e.host || r.includes(e.host) || r.push(e.host);\n    }\n\n    this.read(this.resourceInfo, {\n      origin: \"service\"\n    });\n  }\n\n  _mixCustomParameters(e) {\n    if (!this.customLayerParameters && !this.customParameters) return e;\n    const t = { ...this.customParameters,\n      ...this.customLayerParameters\n    };\n\n    for (const r in t) e[r.toLowerCase()] = t[r];\n\n    return e;\n  }\n\n};\n\nfunction K(e, t) {\n  return e.some(e => {\n    for (const r in e) if (S(e, r, null, t)) return !0;\n\n    return !1;\n  });\n}\n\nfunction X(e, t, r) {\n  e = e ?? [];\n  const o = new Map();\n  e.every(e => null == e.id) && (e = l(e)).forEach((e, t) => e.id = t);\n\n  for (const i of e) {\n    const e = new H();\n    e.read(i, t), r && !r.includes(e.name) && (e.visible = !1), o.set(e.id, e);\n  }\n\n  const s = [];\n\n  for (const a of e) {\n    const e = null != a.id ? o.get(a.id) : null;\n    if (e) if (null != a.parentLayerId && a.parentLayerId >= 0) {\n      const t = o.get(a.parentLayerId);\n      if (!t) continue;\n      t.sublayers || (t.sublayers = new i()), t.sublayers.push(e);\n    } else s.push(e);\n  }\n\n  return s;\n}\n\ne([v({\n  readOnly: !0\n})], z.prototype, \"allSublayers\", void 0), e([v({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], z.prototype, \"customParameters\", void 0), e([v({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], z.prototype, \"customLayerParameters\", void 0), e([v({\n  type: String,\n  json: {\n    write: !0\n  }\n})], z.prototype, \"copyright\", void 0), e([v()], z.prototype, \"description\", void 0), e([v({\n  readOnly: !0\n})], z.prototype, \"dimensions\", void 0), e([v({\n  json: {\n    type: [[Number]],\n    read: {\n      source: \"extent\"\n    },\n    write: {\n      target: \"extent\"\n    },\n    origins: {\n      \"web-document\": {\n        write: {\n          ignoreOrigin: !0\n        }\n      },\n      \"portal-item\": {\n        write: {\n          ignoreOrigin: !0\n        }\n      }\n    }\n  }\n})], z.prototype, \"fullExtent\", void 0), e([x([\"web-document\", \"portal-item\"], \"fullExtent\", [\"extent\"])], z.prototype, \"readFullExtentFromItemOrMap\", null), e([I([\"web-document\", \"portal-item\"], \"fullExtent\", {\n  extent: {\n    type: [[Number]]\n  }\n})], z.prototype, \"writeFullExtent\", null), e([v()], z.prototype, \"fullExtents\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], z.prototype, \"featureInfoFormat\", null), e([v({\n  type: [String],\n  readOnly: !0\n})], z.prototype, \"featureInfoFormats\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], z.prototype, \"featureInfoUrl\", void 0), e([v()], z.prototype, \"fetchFeatureInfoFunction\", void 0), e([v({\n  type: String,\n  json: {\n    origins: {\n      \"web-document\": {\n        default: \"image/png\",\n        type: J.jsonValues,\n        read: {\n          reader: J.read,\n          source: \"format\"\n        },\n        write: {\n          writer: J.write,\n          target: \"format\"\n        }\n      }\n    }\n  }\n})], z.prototype, \"imageFormat\", void 0), e([x(\"imageFormat\", [\"supportedImageFormatTypes\"])], z.prototype, \"readImageFormat\", null), e([v({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxHeight\"\n    },\n    write: {\n      target: \"maxHeight\"\n    }\n  }\n})], z.prototype, \"imageMaxHeight\", void 0), e([v({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxWidth\"\n    },\n    write: {\n      target: \"maxWidth\"\n    }\n  }\n})], z.prototype, \"imageMaxWidth\", void 0), e([v()], z.prototype, \"imageTransparency\", void 0), e([v(q)], z.prototype, \"legendEnabled\", void 0), e([v({\n  type: [\"show\", \"hide\", \"hide-children\"]\n})], z.prototype, \"listMode\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], z.prototype, \"mapUrl\", void 0), e([v({\n  type: Boolean,\n  json: {\n    read: !1,\n    write: {\n      enabled: !0,\n      overridePolicy: () => ({\n        enabled: !1\n      })\n    }\n  }\n})], z.prototype, \"isReference\", void 0), e([v({\n  type: [\"WMS\"]\n})], z.prototype, \"operationalLayerType\", void 0), e([v()], z.prototype, \"resourceInfo\", void 0), e([v({\n  type: E,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"extent.spatialReference\"\n        }\n      }\n    },\n    write: !1\n  }\n})], z.prototype, \"spatialReference\", void 0), e([x([\"web-document\", \"portal-item\"], \"spatialReference\", [\"spatialReferences\"])], z.prototype, \"readSpatialReferenceFromItemOrDocument\", null), e([v({\n  type: [w],\n  json: {\n    read: !1,\n    origins: {\n      service: {\n        read: !0\n      },\n      \"web-document\": {\n        read: !1,\n        write: {\n          ignoreOrigin: !0\n        }\n      },\n      \"portal-item\": {\n        read: !1,\n        write: {\n          ignoreOrigin: !0\n        }\n      }\n    }\n  }\n})], z.prototype, \"spatialReferences\", void 0), e([I([\"web-document\", \"portal-item\"], \"spatialReferences\")], z.prototype, \"writeSpatialReferences\", null), e([v({\n  type: i.ofType(H),\n  json: {\n    write: {\n      target: \"layers\",\n\n      overridePolicy(e, t, r) {\n        if (K(this.allSublayers, r)) return {\n          ignoreOrigin: !0\n        };\n      }\n\n    }\n  }\n})], z.prototype, \"sublayers\", void 0), e([x([\"web-document\", \"portal-item\"], \"sublayers\", [\"layers\", \"visibleLayers\"])], z.prototype, \"readSublayersFromItemOrMap\", null), e([x(\"service\", \"sublayers\", [\"layers\"])], z.prototype, \"readSublayers\", null), e([I(\"sublayers\", {\n  layers: {\n    type: [H]\n  },\n  visibleLayers: {\n    type: [String]\n  }\n})], z.prototype, \"writeSublayers\", null), e([v({\n  json: {\n    read: !1\n  },\n  readOnly: !0,\n  value: \"wms\"\n})], z.prototype, \"type\", void 0), e([v(N)], z.prototype, \"url\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], z.prototype, \"version\", void 0), z = e([j(\"esri.layers.WMSLayer\")], z);\nconst Y = z;\nexport { Y as default };","map":{"version":3,"names":["_","e","t","r","o","s","i","a","JSONMap","n","clone","l","isSome","p","isNone","m","MultiOriginJSONMixin","u","throwIfAbortError","c","on","f","watch","y","sync","d","addQueryParameters","h","addProxy","g","Url","b","property","v","Integer","w","reader","x","subclass","j","writer","I","willPropertyWrite","S","F","E","getScale","R","equals","P","O","BlendLayer","L","OperationalLayer","U","PortalLayer","M","RefreshableLayer","T","ScaleRangeLayer","TemporalLayer","C","isAxesOrderReversedForWkid","W","isWmsServer","$","legendEnabled","q","url","N","ExportWMSImageParameters","B","H","normalizeWKID","k","toISOString","G","getPopupLayers","A","parseCapabilities","D","J","bmp","gif","jpg","png","svg","ignoreUnknown","V","Q","z","constructor","allSublayers","getCollections","sublayers","getChildrenFunction","customParameters","customLayerParameters","copyright","description","dimensions","fullExtent","fullExtents","featureInfoFormats","featureInfoUrl","fetchFeatureInfoFunction","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","mapUrl","isReference","operationalLayerType","spatialReference","spatialReferences","type","version","addHandles","item","parent","layer","normalizeCtorArgs","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","readFullExtentFromItemOrMap","extent","xmin","ymin","xmax","ymax","writeFullExtent","featureInfoFormat","find","_override","revert","_clearOverride","readImageFormat","supportedImageFormatTypes","includes","readSpatialReferenceFromItemOrDocument","writeSpatialReferences","wkid","filter","unshift","readSublayersFromItemOrMap","X","layers","visibleLayers","readSublayers","writeSublayers","Map","flatten","id","get","push","set","sublayer","write","parentLayerId","has","sublayerIds","name","visible","map","toArray","createExportImageParameters","pixelRatio","width","scale","toJSON","bbox","isNaN","fetchImage","document","createElement","height","timeExtent","start","end","getTime","responseType","query","_mixCustomParameters","time","refreshParameters","data","fetchImageBitmap","createImageBitmap","fetchFeatureInfo","visibleSublayers","query_layers","request","info_format","feature_count","_defaultFetchFeatureInfoFunction","findSublayerById","findSublayerByName","serviceSupportsSpatialReference","some","WebMercator","src","style","border","margin","setAttribute","title","content","sourceLayer","popupTemplate","resourceInfo","path","parsedUrl","service","SERVICE","REQUEST","httpsDomains","scheme","port","host","read","origin","toLowerCase","K","every","forEach","readOnly","prototype","json","Object","String","Number","source","target","origins","ignoreOrigin","default","jsonValues","Boolean","enabled","overridePolicy","ofType","value","Y"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/WMSLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../config.js\";import r from\"../Graphic.js\";import o from\"../PopupTemplate.js\";import s from\"../request.js\";import i from\"../core/Collection.js\";import a from\"../core/CollectionFlattener.js\";import{JSONMap as n}from\"../core/jsonMap.js\";import{clone as l}from\"../core/lang.js\";import{isSome as p,isNone as m}from\"../core/maybe.js\";import{MultiOriginJSONMixin as u}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as c}from\"../core/promiseUtils.js\";import{on as f,watch as y,sync as d}from\"../core/reactiveUtils.js\";import{addQueryParameters as h,addProxy as g,Url as b}from\"../core/urlUtils.js\";import{property as v}from\"../core/accessorSupport/decorators/property.js\";import{Integer as w}from\"../core/accessorSupport/ensureType.js\";import{reader as x}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as j}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as I}from\"../core/accessorSupport/decorators/writer.js\";import{willPropertyWrite as S}from\"../core/accessorSupport/write.js\";import F from\"../geometry/Extent.js\";import E from\"../geometry/SpatialReference.js\";import{getScale as R}from\"../geometry/support/scaleUtils.js\";import{equals as P}from\"../geometry/support/spatialReferenceUtils.js\";import O from\"./Layer.js\";import{BlendLayer as L}from\"./mixins/BlendLayer.js\";import{OperationalLayer as U}from\"./mixins/OperationalLayer.js\";import{PortalLayer as M}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as T}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as _}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as C}from\"./mixins/TemporalLayer.js\";import{isAxesOrderReversedForWkid as W}from\"./ogc/crsUtils.js\";import{isWmsServer as $}from\"./support/arcgisLayerUrl.js\";import{legendEnabled as q,url as N}from\"./support/commonProperties.js\";import{ExportWMSImageParameters as B}from\"./support/ExportWMSImageParameters.js\";import H from\"./support/WMSSublayer.js\";import{normalizeWKID as k,toISOString as G,getPopupLayers as A,parseCapabilities as D}from\"./support/wmsUtils.js\";const J=new n({bmp:\"image/bmp\",gif:\"image/gif\",jpg:\"image/jpeg\",png:\"image/png\",svg:\"image/svg+xml\"},{ignoreUnknown:!1});function V(e){return\"text/html\"===e}function Q(e){return\"text/plain\"===e}let z=class extends(L(C(T(_(U(M(u(O)))))))){constructor(...e){super(...e),this.allSublayers=new a({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormats=null,this.featureInfoUrl=null,this.fetchFeatureInfoFunction=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType=\"WMS\",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type=\"wms\",this.url=null,this.version=null,this.addHandles([f((()=>this.sublayers),\"after-add\",(({item:e})=>{e.parent=e.layer=this}),d),f((()=>this.sublayers),\"after-remove\",(({item:e})=>{e.layer=e.parent=null}),d),y((()=>this.sublayers),((e,t)=>{if(t)for(const r of t)r.layer=r.parent=null;if(e)for(const r of e)r.parent=r.layer=this}),d)])}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}load(e){const t=p(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"WMS\"]},e).catch(c).then((()=>this._fetchService(t)))),Promise.resolve(this)}readFullExtentFromItemOrMap(e,t){const r=t.extent;return r?new F({xmin:r[0][0],ymin:r[0][1],xmax:r[1][0],ymax:r[1][1]}):null}writeFullExtent(e,t){t.extent=[[e.xmin,e.ymin],[e.xmax,e.ymax]]}get featureInfoFormat(){return m(this.featureInfoFormats)?null:this.featureInfoFormats.find(V)??this.featureInfoFormats.find(Q)??null}set featureInfoFormat(e){p(e)?(V(e)||Q(e))&&this._override(\"featureInfoFormat\",e):(this.revert(\"featureInfoFormat\",\"service\"),this._clearOverride(\"featureInfoFormat\"))}readImageFormat(e,t){const r=t.supportedImageFormatTypes;return r&&r.includes(\"image/png\")?\"image/png\":r&&r[0]}readSpatialReferenceFromItemOrDocument(e,t){return new E(t.spatialReferences[0])}writeSpatialReferences(e,t){const r=this.spatialReference?.wkid;e&&r?(t.spatialReferences=e.filter((e=>e!==r)),t.spatialReferences.unshift(r)):t.spatialReferences=e}readSublayersFromItemOrMap(e,t,r){return X(t.layers,r,t.visibleLayers)}readSublayers(e,t,r){return X(t.layers,r)}writeSublayers(e,t,r,o){t.layers=[];const s=new Map,i=e.flatten((({sublayers:e})=>e));for(const a of i)if(\"number\"==typeof a.parent?.id){const e=s.get(a.parent.id);null!=e?e.push(a.id):s.set(a.parent.id,[a.id])}for(const a of i){const e={sublayer:a,...o},r=a.write({parentLayerId:\"number\"==typeof a.parent?.id?a.parent.id:-1},e);if(s.has(a.id)&&(r.sublayerIds=s.get(a.id)),!a.sublayers&&a.name){const r=a.write({},e);delete r.id,t.layers.push(r)}}t.visibleLayers=i.filter((({visible:e,sublayers:t})=>e&&!t)).map((({name:e})=>e)).toArray()}createExportImageParameters(e,t,r,o){const s=o?.pixelRatio??1,i=R({extent:e,width:t})*s,a=new B({layer:this,scale:i}),{xmin:n,ymin:l,xmax:p,ymax:m,spatialReference:u}=e,c=k(u,this.spatialReferences),f=\"1.3.0\"===this.version&&W(c)?`${l},${n},${m},${p}`:`${n},${l},${p},${m}`,y=a.toJSON();return{bbox:f,[\"1.3.0\"===this.version?\"crs\":\"srs\"]:isNaN(c)?void 0:\"EPSG:\"+c,...y}}async fetchImage(e,t,r,o){const i=this.mapUrl,a=this.createExportImageParameters(e,t,r,o);if(!a.layers){const e=document.createElement(\"canvas\");return e.width=t,e.height=r,e}const n=o?.timeExtent?.start,l=o?.timeExtent?.end,m=p(n)&&p(l)?n.getTime()===l.getTime()?G(n):`${G(n)}/${G(l)}`:void 0,u={responseType:\"image\",query:this._mixCustomParameters({width:t,height:r,...a,time:m,...this.refreshParameters}),signal:o?.signal};return s(i??\"\",u).then((e=>e.data))}async fetchImageBitmap(e,t,r,o){const i=this.mapUrl,a=this.createExportImageParameters(e,t,r,o);if(!a.layers){const e=document.createElement(\"canvas\");return e.width=t,e.height=r,e}const n=o?.timeExtent?.start,l=o?.timeExtent?.end,m=p(n)&&p(l)?n.getTime()===l.getTime()?G(n):`${G(n)}/${G(l)}`:void 0,u={responseType:\"blob\",query:this._mixCustomParameters({width:t,height:r,...a,time:m,...this.refreshParameters}),signal:o?.signal},c=await s(i??\"\",u).then((e=>e.data));return createImageBitmap(c)}fetchFeatureInfo(e,t,r,o,s){const i=R({extent:e,width:t}),a=new B({layer:this,scale:i}),n=A(a.visibleSublayers);if(m(this.featureInfoUrl)||m(n))return Promise.resolve([]);if(m(this.fetchFeatureInfoFunction)&&m(this.featureInfoFormat))return Promise.resolve([]);const l=\"1.3.0\"===this.version?{I:o,J:s}:{x:o,y:s},u={query_layers:n,request:\"GetFeatureInfo\",info_format:this.featureInfoFormat,feature_count:25,width:t,height:r,...l},c={...this.createExportImageParameters(e,t,r),...u},f=this._mixCustomParameters(c);return p(this.fetchFeatureInfoFunction)?this.fetchFeatureInfoFunction(f):this._defaultFetchFeatureInfoFunction(h(this.featureInfoUrl,f))}findSublayerById(e){return this.allSublayers.find((t=>t.id===e))}findSublayerByName(e){return this.allSublayers.find((t=>t.name===e))}serviceSupportsSpatialReference(e){return $(this.url)||null!=this.spatialReferences&&this.spatialReferences.some((t=>{const r=900913===t?E.WebMercator:new E({wkid:t});return P(r,e)}))}_defaultFetchFeatureInfoFunction(e){const t=document.createElement(\"iframe\");t.src=g(e),t.style.border=\"none\",t.style.margin=\"0\",t.style.width=\"100%\",t.setAttribute(\"sandbox\",\"\");const s=new o({title:this.title,content:t}),i=new r({sourceLayer:this,popupTemplate:s});return Promise.resolve([i])}async _fetchService(e){if(!this.resourceInfo){const{path:t,query:r}=this.parsedUrl??{};r?.service&&(r.SERVICE=r.service,delete r.service),r?.request&&(r.REQUEST=r.request,delete r.request);const{data:o}=await s(t??\"\",{query:{SERVICE:\"WMS\",REQUEST:\"GetCapabilities\",...r,...this.customParameters},responseType:\"xml\",signal:e});this.resourceInfo=D(o)}if(this.parsedUrl){const e=new b(this.parsedUrl.path),{httpsDomains:r}=t.request;\"https\"!==e.scheme||e.port&&\"443\"!==e.port||!e.host||r.includes(e.host)||r.push(e.host)}this.read(this.resourceInfo,{origin:\"service\"})}_mixCustomParameters(e){if(!this.customLayerParameters&&!this.customParameters)return e;const t={...this.customParameters,...this.customLayerParameters};for(const r in t)e[r.toLowerCase()]=t[r];return e}};function K(e,t){return e.some((e=>{for(const r in e)if(S(e,r,null,t))return!0;return!1}))}function X(e,t,r){e=e??[];const o=new Map;e.every((e=>null==e.id))&&(e=l(e)).forEach(((e,t)=>e.id=t));for(const i of e){const e=new H;e.read(i,t),r&&!r.includes(e.name)&&(e.visible=!1),o.set(e.id,e)}const s=[];for(const a of e){const e=null!=a.id?o.get(a.id):null;if(e)if(null!=a.parentLayerId&&a.parentLayerId>=0){const t=o.get(a.parentLayerId);if(!t)continue;t.sublayers||(t.sublayers=new i),t.sublayers.push(e)}else s.push(e)}return s}e([v({readOnly:!0})],z.prototype,\"allSublayers\",void 0),e([v({json:{type:Object,write:!0}})],z.prototype,\"customParameters\",void 0),e([v({json:{type:Object,write:!0}})],z.prototype,\"customLayerParameters\",void 0),e([v({type:String,json:{write:!0}})],z.prototype,\"copyright\",void 0),e([v()],z.prototype,\"description\",void 0),e([v({readOnly:!0})],z.prototype,\"dimensions\",void 0),e([v({json:{type:[[Number]],read:{source:\"extent\"},write:{target:\"extent\"},origins:{\"web-document\":{write:{ignoreOrigin:!0}},\"portal-item\":{write:{ignoreOrigin:!0}}}}})],z.prototype,\"fullExtent\",void 0),e([x([\"web-document\",\"portal-item\"],\"fullExtent\",[\"extent\"])],z.prototype,\"readFullExtentFromItemOrMap\",null),e([I([\"web-document\",\"portal-item\"],\"fullExtent\",{extent:{type:[[Number]]}})],z.prototype,\"writeFullExtent\",null),e([v()],z.prototype,\"fullExtents\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],z.prototype,\"featureInfoFormat\",null),e([v({type:[String],readOnly:!0})],z.prototype,\"featureInfoFormats\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],z.prototype,\"featureInfoUrl\",void 0),e([v()],z.prototype,\"fetchFeatureInfoFunction\",void 0),e([v({type:String,json:{origins:{\"web-document\":{default:\"image/png\",type:J.jsonValues,read:{reader:J.read,source:\"format\"},write:{writer:J.write,target:\"format\"}}}}})],z.prototype,\"imageFormat\",void 0),e([x(\"imageFormat\",[\"supportedImageFormatTypes\"])],z.prototype,\"readImageFormat\",null),e([v({type:Number,json:{read:{source:\"maxHeight\"},write:{target:\"maxHeight\"}}})],z.prototype,\"imageMaxHeight\",void 0),e([v({type:Number,json:{read:{source:\"maxWidth\"},write:{target:\"maxWidth\"}}})],z.prototype,\"imageMaxWidth\",void 0),e([v()],z.prototype,\"imageTransparency\",void 0),e([v(q)],z.prototype,\"legendEnabled\",void 0),e([v({type:[\"show\",\"hide\",\"hide-children\"]})],z.prototype,\"listMode\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],z.prototype,\"mapUrl\",void 0),e([v({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],z.prototype,\"isReference\",void 0),e([v({type:[\"WMS\"]})],z.prototype,\"operationalLayerType\",void 0),e([v()],z.prototype,\"resourceInfo\",void 0),e([v({type:E,json:{origins:{service:{read:{source:\"extent.spatialReference\"}}},write:!1}})],z.prototype,\"spatialReference\",void 0),e([x([\"web-document\",\"portal-item\"],\"spatialReference\",[\"spatialReferences\"])],z.prototype,\"readSpatialReferenceFromItemOrDocument\",null),e([v({type:[w],json:{read:!1,origins:{service:{read:!0},\"web-document\":{read:!1,write:{ignoreOrigin:!0}},\"portal-item\":{read:!1,write:{ignoreOrigin:!0}}}}})],z.prototype,\"spatialReferences\",void 0),e([I([\"web-document\",\"portal-item\"],\"spatialReferences\")],z.prototype,\"writeSpatialReferences\",null),e([v({type:i.ofType(H),json:{write:{target:\"layers\",overridePolicy(e,t,r){if(K(this.allSublayers,r))return{ignoreOrigin:!0}}}}})],z.prototype,\"sublayers\",void 0),e([x([\"web-document\",\"portal-item\"],\"sublayers\",[\"layers\",\"visibleLayers\"])],z.prototype,\"readSublayersFromItemOrMap\",null),e([x(\"service\",\"sublayers\",[\"layers\"])],z.prototype,\"readSublayers\",null),e([I(\"sublayers\",{layers:{type:[H]},visibleLayers:{type:[String]}})],z.prototype,\"writeSublayers\",null),e([v({json:{read:!1},readOnly:!0,value:\"wms\"})],z.prototype,\"type\",void 0),e([v(N)],z.prototype,\"url\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],z.prototype,\"version\",void 0),z=e([j(\"esri.layers.WMSLayer\")],z);const Y=z;export{Y as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}