{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../core/maybe.js\";\nimport { watch as t } from \"../../core/reactiveUtils.js\";\nimport { addFrameTask as a } from \"../../core/scheduling.js\";\n\nclass s {\n  constructor(t) {\n    this.view = t, this._frameTaskHandle = null, this._updateRequested = !1, this.stationary = !0, this.animationInProgress = !1, this.prepare = () => {\n      this._updateParameters.state = this.view.state, this._updateParameters.stationary = this.view.stationary, this._updateParameters.pixelRatio = window.devicePixelRatio, this._updateParameters.renderingOptions = this.view.renderingOptions;\n    }, this.update = () => {\n      this._updateRequested = !1;\n      const {\n        basemapView: t,\n        graphicsView: a,\n        labelManager: s,\n        layerViews: i,\n        state: {\n          id: r\n        }\n      } = this.view;\n      t.baseLayerViews.forEach(this._updateLayerView, this), i.forEach(this._updateLayerView, this), t.referenceLayerViews.forEach(this._updateLayerView, this), e(s) && (s.lastUpdateId !== r && (s.viewChange(), s.lastUpdateId = r), s.updateRequested && s.processUpdate(this._updateParameters)), e(a) && (a.lastUpdateId !== r && (a.viewChange(), a.lastUpdateId = r), a.updateRequested && a.processUpdate(this._updateParameters)), this.view.graphicsTileStore.setViewState(this._updateParameters.state), this.animationInProgress || this._updateRequested || this._frameTaskHandle.pause();\n    };\n  }\n\n  destroy() {\n    this.stop();\n  }\n\n  start() {\n    if (this._frameTaskHandle) return;\n    const e = this.view;\n    this.stationary = e.stationary, this._updateParameters = {\n      state: e.state,\n      pixelRatio: window.devicePixelRatio,\n      stationary: this.stationary,\n      renderingOptions: e.renderingOptions\n    }, this._stationaryHandle = t(() => e.stationary, e => {\n      this.stationary = e, this.requestFrame();\n    }), this._frameTaskHandle = a(this), this.requestUpdate();\n  }\n\n  stop() {\n    this._frameTaskHandle && (this._updateRequested = !1, this._stationaryHandle.remove(), this._frameTaskHandle.remove(), this._updateParameters = this._stationaryHandle = this._frameTaskHandle = null, this.stationary = !0, this.animationInProgress = !1);\n  }\n\n  requestUpdate() {\n    this._updateRequested || (this._updateRequested = !0, this.requestFrame());\n  }\n\n  requestFrame() {\n    this._frameTaskHandle && this._frameTaskHandle.resume();\n  }\n\n  _updateLayerView(e) {\n    const t = this.view.state,\n          a = e.lastUpdateId;\n    null != a && (this.stationary || e.moving) || (e.moving = !0, e.moveStart()), a !== t.id && e.viewChange(), this.stationary && e.moving && (e.moving = !1, e.moveEnd()), e.lastUpdateId = t.id, e.updateRequested && e.processUpdate(this._updateParameters), \"layerViews\" in e && e.layerViews.forEach(this._updateLayerView, this);\n  }\n\n}\n\nexport { s as default };","map":{"version":3,"names":["isSome","e","watch","t","addFrameTask","a","s","constructor","view","_frameTaskHandle","_updateRequested","stationary","animationInProgress","prepare","_updateParameters","state","pixelRatio","window","devicePixelRatio","renderingOptions","update","basemapView","graphicsView","labelManager","layerViews","i","id","r","baseLayerViews","forEach","_updateLayerView","referenceLayerViews","lastUpdateId","viewChange","updateRequested","processUpdate","graphicsTileStore","setViewState","pause","destroy","stop","start","_stationaryHandle","requestFrame","requestUpdate","remove","resume","moving","moveStart","moveEnd","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/FrameTask.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../core/maybe.js\";import{watch as t}from\"../../core/reactiveUtils.js\";import{addFrameTask as a}from\"../../core/scheduling.js\";class s{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:a,labelManager:s,layerViews:i,state:{id:r}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),i.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),e(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),e(a)&&(a.lastUpdateId!==r&&(a.viewChange(),a.lastUpdateId=r),a.updateRequested&&a.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=t((()=>e.stationary),(e=>{this.stationary=e,this.requestFrame()})),this._frameTaskHandle=a(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,a=e.lastUpdateId;null!=a&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),a!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),\"layerViews\"in e&&e.layerViews.forEach(this._updateLayerView,this)}}export{s as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}