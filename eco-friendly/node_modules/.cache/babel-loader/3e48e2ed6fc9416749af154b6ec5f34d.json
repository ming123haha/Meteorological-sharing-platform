{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../Graphic.js\";\nimport { clone as i } from \"../../../core/lang.js\";\nimport s from \"../../../core/Logger.js\";\nimport { isNone as r } from \"../../../core/maybe.js\";\nimport { isAbortError as a } from \"../../../core/promiseUtils.js\";\nimport { watch as l, initial as n } from \"../../../core/reactiveUtils.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as h } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { diff as u, hasDiff as c } from \"../../../core/accessorSupport/diffUtils.js\";\nimport { create as y } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { equals as p } from \"../../../geometry/support/spatialReferenceUtils.js\";\nimport { StyleUpdateType as d } from \"../engine/vectorTiles/enums.js\";\nimport { TileHandler as _ } from \"../engine/vectorTiles/TileHandler.js\";\nimport { TileManager as f } from \"../engine/vectorTiles/TileManager.js\";\nimport { VectorTile as g } from \"../engine/vectorTiles/VectorTile.js\";\nimport { VectorTileContainer as m } from \"../engine/vectorTiles/VectorTileContainer.js\";\nimport { StyleLayerType as C } from \"../engine/vectorTiles/style/StyleDefinition.js\";\nimport T from \"../engine/vectorTiles/style/StyleRepository.js\";\nimport { LayerView2DMixin as v } from \"./LayerView2D.js\";\nimport R from \"./support/DebugOverlay.js\";\nimport H from \"../tiling/TileInfoViewPOT.js\";\nimport w from \"../tiling/TileQueue.js\";\nimport S from \"../../layers/LayerView.js\";\nlet D = class extends v(S) {\n  constructor() {\n    super(...arguments), this._styleChanges = [], this._fetchQueue = null, this._parseQueue = null, this._isTileHandlerReady = !1, this.fading = !1, this._getCollidersMesh = e => {\n      const {\n        pixelRatio: t\n      } = e.state;\n      let i = 0;\n      const s = [],\n            r = [];\n\n      for (const a of this._vectorTileContainer.children) if (a.symbols) for (const [e, l] of a.symbols) for (const a of l) for (const e of a.colliders) {\n        const l = (e.xScreen + e.dxScreen) * t,\n              n = (e.yScreen + e.dyScreen) * t,\n              o = e.width * t,\n              h = e.height * t,\n              u = a.unique.parts[e.partIndex].targetOpacity > .5;\n        if (!u && \"all\" !== this.layer.showCollisionBoxes) continue;\n        const c = 2,\n              y = 0,\n              p = 3,\n              d = 0,\n              _ = 3,\n              f = 1,\n              g = 3,\n              m = 0,\n              C = u ? c : y,\n              T = u ? p : d,\n              v = R.makeFlags(C, T);\n        s.push(l, n, v, l + o, n, v, l, n + h, v, l + o, n + h, v), r.push(i + 0, i + 1, i + 2, i + 1, i + 3, i + 2), i += 4;\n        const H = u ? _ : f,\n              w = u ? g : m,\n              S = R.makeFlags(H, w);\n        s.push(l, n, S, l + o, n, S, l, n + 1, S, l + o, n + 1, S), r.push(i + 0, i + 1, i + 2, i + 1, i + 3, i + 2), i += 4, s.push(l, n + h - 1, S, l + o, n + h - 1, S, l, n + h, S, l + o, n + h, S), r.push(i + 0, i + 1, i + 2, i + 1, i + 3, i + 2), i += 4, s.push(l, n, S, l + 1, n, S, l, n + h, S, l + 1, n + h, S), r.push(i + 0, i + 1, i + 2, i + 1, i + 3, i + 2), i += 4, s.push(l + o - 1, n, S, l + o, n, S, l + o - 1, n + h, S, l + o, n + h, S), r.push(i + 0, i + 1, i + 2, i + 1, i + 3, i + 2), i += 4;\n      }\n\n      return {\n        vertexData: new Int16Array(s),\n        indexData: new Uint32Array(r)\n      };\n    }, this._getCollidersColors = () => [1, .5, 0, 1, 1, 0, 0, 1, 0, 1, .5, 1, 0, .5, 0, 1], this._getCollidersOpacities = () => [.05, .01, .15, .2];\n  }\n\n  async hitTest(e, i) {\n    if (!this._tileHandlerPromise) return null;\n    await this._tileHandlerPromise;\n    const s = await this._vectorTileContainer.hitTest(i);\n    if (!s || 0 === s.length) return null;\n    const r = s[0] - 1,\n          a = this._styleRepository,\n          l = a.getStyleLayerByUID(r);\n    if (!l) return null;\n    const n = a.getStyleLayerIndex(l.id);\n    return [{\n      type: \"graphic\",\n      mapPoint: e,\n      layer: this.layer,\n      graphic: new t({\n        attributes: {\n          layerId: n,\n          layerName: l.id,\n          layerUID: r\n        },\n        layer: this.layer,\n        sourceLayer: this.layer\n      })\n    }];\n  }\n\n  update(e) {\n    if (this._tileHandlerPromise && this._isTileHandlerReady) return e.pixelRatio !== this._tileHandler.devicePixelRatio ? (this._start(), void (this._tileHandler.devicePixelRatio = e.pixelRatio)) : void (this._styleChanges.length > 0 ? this._tileHandlerPromise = this._applyStyleChanges() : (this._fetchQueue.pause(), this._parseQueue.pause(), this._fetchQueue.state = e.state, this._parseQueue.state = e.state, this._tileManager.update(e) || this.requestUpdate(), this._parseQueue.resume(), this._fetchQueue.resume()));\n  }\n\n  attach() {\n    const {\n      style: e\n    } = this.layer.currentStyleInfo;\n    this._styleRepository = new T(e), this._tileInfoView = new H(this.layer.tileInfo, this.layer.fullExtent), this._vectorTileContainer = new m(this._tileInfoView), this._tileHandler = new _(this.layer, this._styleRepository, window.devicePixelRatio || 1), this.container.addChild(this._vectorTileContainer), this._start(), this.handles.add([this._vectorTileContainer.on(\"fade-start\", () => {\n      this.fading = !0, this.notifyChange(\"updating\"), this.requestUpdate();\n    }), this._vectorTileContainer.on(\"fade-complete\", () => {\n      this._collisionOverlay?.requestRender(), this.fading = !1, this.notifyChange(\"updating\"), this.requestUpdate();\n    }), l(() => this.layer.showCollisionBoxes, e => {\n      \"none\" !== e ? this._collisionOverlay || (this._collisionOverlay = new R({\n        getMesh: this._getCollidersMesh,\n        getColors: this._getCollidersColors,\n        getOpacities: this._getCollidersOpacities\n      }), this.container.addChild(this._collisionOverlay)) : (this.container.removeChild(this._collisionOverlay), this._collisionOverlay = null), this.container.requestRender();\n    }, n), this.layer.on(\"paint-change\", e => {\n      if (e.isDataDriven) this._styleChanges.push({\n        type: d.PAINTER_CHANGED,\n        data: e\n      }), this.notifyChange(\"updating\"), this.requestUpdate();else {\n        const t = this._styleRepository,\n              i = t.getLayerById(e.layer);\n        if (!i) return;\n        const s = i.type === C.SYMBOL;\n        t.setPaintProperties(e.layer, e.paint), s && this._vectorTileContainer.restartDeclutter(), this._vectorTileContainer.requestRender();\n      }\n    }), this.layer.on(\"layout-change\", e => {\n      const t = this._styleRepository,\n            i = t.getLayerById(e.layer);\n      if (!i) return;\n      const s = u(i.layout, e.layout);\n\n      if (!r(s)) {\n        if (c(s, \"visibility\") && 1 === Q(s)) return t.setLayoutProperties(e.layer, e.layout), i.type === C.SYMBOL && this._vectorTileContainer.restartDeclutter(), void this._vectorTileContainer.requestRender();\n        this._styleChanges.push({\n          type: d.LAYOUT_CHANGED,\n          data: e\n        }), this.notifyChange(\"updating\"), this.requestUpdate();\n      }\n    }), this.layer.on(\"style-layer-visibility-change\", e => {\n      const t = this._styleRepository,\n            i = t.getLayerById(e.layer);\n      i && (t.setStyleLayerVisibility(e.layer, e.visibility), i.type === C.SYMBOL && this._vectorTileContainer.restartDeclutter(), this._vectorTileContainer.requestRender());\n    }), this.layer.on(\"style-layer-change\", e => {\n      this._styleChanges.push({\n        type: d.LAYER_CHANGED,\n        data: e\n      }), this.notifyChange(\"updating\"), this.requestUpdate();\n    }), this.layer.on(\"delete-style-layer\", e => {\n      this._styleChanges.push({\n        type: d.LAYER_REMOVED,\n        data: e\n      }), this.notifyChange(\"updating\"), this.requestUpdate();\n    }), this.layer.on(\"load-style\", () => this._loadStyle()), this.layer.on(\"spriteSource-change\", e => {\n      this._newSpriteSource = e.spriteSource, this._styleChanges.push({\n        type: d.SPRITES_CHANGED,\n        data: null\n      });\n      const t = this._styleRepository.layers;\n\n      for (const i of t) switch (i.type) {\n        case C.SYMBOL:\n          i.getLayoutProperty(\"icon-image\") && this._styleChanges.push({\n            type: d.LAYOUT_CHANGED,\n            data: {\n              layer: i.id,\n              layout: i.layout\n            }\n          });\n          break;\n\n        case C.LINE:\n          i.getPaintProperty(\"line-pattern\") && this._styleChanges.push({\n            type: d.PAINTER_CHANGED,\n            data: {\n              layer: i.id,\n              paint: i.paint,\n              isDataDriven: i.isPainterDataDriven()\n            }\n          });\n          break;\n\n        case C.FILL:\n          i.getLayoutProperty(\"fill-pattern\") && this._styleChanges.push({\n            type: d.PAINTER_CHANGED,\n            data: {\n              layer: i.id,\n              paint: i.paint,\n              isDataDriven: i.isPainterDataDriven()\n            }\n          });\n      }\n\n      this.notifyChange(\"updating\"), this.requestUpdate();\n    })], this.declaredClass);\n  }\n\n  detach() {\n    this._stop(), this.container.removeAllChildren(), this._vectorTileContainer?.destroy(), this._vectorTileContainer = null, this._tileHandler?.destroy(), this._tileHandler = null, this.handles.remove(this.declaredClass);\n  }\n\n  moveStart() {\n    this.requestUpdate();\n  }\n\n  viewChange() {\n    this.requestUpdate();\n  }\n\n  moveEnd() {\n    this._collisionOverlay && this._vectorTileContainer.restartDeclutter(), this.requestUpdate();\n  }\n\n  supportsSpatialReference(e) {\n    return p(this.layer.tileInfo?.spatialReference, e);\n  }\n\n  canResume() {\n    let e = super.canResume();\n    const {\n      currentStyleInfo: t\n    } = this.layer;\n\n    if (e && t?.layerDefinition) {\n      const i = this.view.scale,\n            {\n        minScale: s,\n        maxScale: r\n      } = t.layerDefinition;\n      t && t.layerDefinition && (s && s < i && (e = !1), r && r > i && (e = !1));\n    }\n\n    return e;\n  }\n\n  isUpdating() {\n    const e = this._vectorTileContainer.children;\n    return !this._isTileHandlerReady || !this._fetchQueue || !this._parseQueue || this._fetchQueue.updating || this._parseQueue.updating || e.length > 0 && e.some(e => e.invalidating) || this.fading;\n  }\n\n  acquireTile(e) {\n    const t = this._createVectorTile(e);\n\n    return this._tileHandlerPromise.then(() => {\n      this._fetchQueue.push(t.key).then(e => this._parseQueue.push({\n        key: t.key,\n        data: e\n      })).then(e => {\n        t.once(\"attach\", () => this.requestUpdate()), t.setData(e), this.requestUpdate(), this.notifyChange(\"updating\");\n      }).catch(e => {\n        this.notifyChange(\"updating\"), a(e) || s.getLogger(this.declaredClass).error(e);\n      });\n    }), t;\n  }\n\n  releaseTile(e) {\n    const t = e.key.id;\n    this._fetchQueue.abort(t), this._parseQueue.abort(t), this.requestUpdate();\n  }\n\n  _start() {\n    if (this._stop(), this._tileManager = new f({\n      acquireTile: e => this.acquireTile(e),\n      releaseTile: e => this.releaseTile(e),\n      tileInfoView: this._tileInfoView\n    }, this._vectorTileContainer), !this.layer.currentStyleInfo) return;\n\n    const e = new AbortController(),\n          t = this._tileHandler.start({\n      signal: e.signal\n    }).then(() => {\n      this._fetchQueue = new w({\n        tileInfoView: this._tileInfoView,\n        process: (e, t) => this._getTileData(e, t),\n        concurrency: 15\n      }), this._parseQueue = new w({\n        tileInfoView: this._tileInfoView,\n        process: (e, t) => this._parseTileData(e, t),\n        concurrency: 8\n      }), this.requestUpdate(), this._isTileHandlerReady = !0;\n    });\n\n    this._tileHandler.spriteMosaic.then(e => {\n      this._vectorTileContainer.setStyleResources(e, this._tileHandler.glyphMosaic, this._styleRepository), this.requestUpdate();\n    }), this._tileHandlerAbortController = e, this._tileHandlerPromise = t;\n  }\n\n  _stop() {\n    if (!this._tileHandlerAbortController || !this._vectorTileContainer) return;\n    const e = this._tileHandlerAbortController;\n    e && e.abort(), this._tileHandlerPromise = null, this._isTileHandlerReady = !1, this._fetchQueue && (this._fetchQueue.destroy(), this._fetchQueue = null), this._parseQueue && (this._parseQueue.destroy(), this._parseQueue = null), this._tileManager && (this._tileManager.destroy(), this._tileManager = null), this._vectorTileContainer.removeAllChildren();\n  }\n\n  async _getTileData(e, t) {\n    const i = await this._tileHandler.fetchTileData(e, t);\n    return this.notifyChange(\"updating\"), i;\n  }\n\n  async _parseTileData(e, t) {\n    return this._tileHandler.parseTileData(e, t);\n  }\n\n  async _applyStyleChanges() {\n    this._isTileHandlerReady = !1, this._fetchQueue.pause(), this._parseQueue.pause(), this._fetchQueue.clear(), this._parseQueue.clear(), this._tileManager.clearCache();\n    const e = this._styleChanges;\n\n    try {\n      await this._tileHandler.updateStyle(e);\n    } catch (n) {\n      s.getLogger(this.declaredClass).error(\"error applying vector-tiles style update\", n.message), this._fetchQueue.resume(), this._parseQueue.resume(), this._isTileHandlerReady = !0;\n    }\n\n    const t = this._styleRepository,\n          i = [];\n    e.forEach(e => {\n      if (e.type !== d.LAYER_REMOVED) return;\n      const s = e.data,\n            r = t.getLayerById(s.layer);\n      r && i.push(r.uid);\n    });\n    const r = [];\n    let a;\n    e.forEach(e => {\n      const i = e.type,\n            s = e.data;\n\n      switch (i) {\n        case d.PAINTER_CHANGED:\n          t.setPaintProperties(s.layer, s.paint), a = s.layer;\n          break;\n\n        case d.LAYOUT_CHANGED:\n          t.setLayoutProperties(s.layer, s.layout), a = s.layer;\n          break;\n\n        case d.LAYER_REMOVED:\n          return void t.deleteStyleLayer(s.layer);\n\n        case d.LAYER_CHANGED:\n          t.setStyleLayer(s.layer, s.index), a = s.layer.id;\n          break;\n\n        case d.SPRITES_CHANGED:\n          this._vectorTileContainer.setSpriteMosaic(this._tileHandler.setSpriteSource(this._newSpriteSource)), this._newSpriteSource = null, a = null;\n      }\n\n      const l = t.getLayerById(a);\n      l && r.push(l.uid);\n    });\n    const l = this._vectorTileContainer.children;\n\n    if (i.length > 0) {\n      this._vectorTileContainer.deleteStyleLayers(i);\n\n      for (const e of l) e.deleteLayerData(i);\n    }\n\n    if (this._fetchQueue.resume(), this._parseQueue.resume(), r.length > 0) {\n      const e = [];\n\n      for (const t of l) {\n        const i = this._fetchQueue.push(t.key).then(e => this._parseQueue.push({\n          key: t.key,\n          data: e,\n          styleLayerUIDs: r\n        })).then(e => t.setData(e));\n\n        e.push(i);\n      }\n\n      await Promise.all(e);\n    }\n\n    this._styleChanges = [], this._isTileHandlerReady = !0, this.notifyChange(\"updating\"), this.requestUpdate();\n  }\n\n  async _loadStyle() {\n    const {\n      style: e\n    } = this.layer.currentStyleInfo,\n          t = i(e);\n    this._isTileHandlerReady = !1, this._fetchQueue.pause(), this._parseQueue.pause(), this._fetchQueue.clear(), this._parseQueue.clear(), this.notifyChange(\"updating\"), this._styleRepository = new T(t), this._vectorTileContainer.destroy(), this._tileManager.clear(), this._tileHandlerAbortController.abort(), this._tileHandlerAbortController = new AbortController();\n    const {\n      signal: s\n    } = this._tileHandlerAbortController;\n\n    try {\n      this._tileHandlerPromise = this._tileHandler.setStyle(this._styleRepository, t), await this._tileHandlerPromise;\n    } catch (l) {\n      if (!a(l)) throw l;\n    }\n\n    if (s.aborted) return this._fetchQueue.resume(), this._parseQueue.resume(), this._isTileHandlerReady = !0, this.notifyChange(\"updating\"), void this.requestUpdate();\n    const r = await this._tileHandler.spriteMosaic;\n    this._vectorTileContainer.setStyleResources(r, this._tileHandler.glyphMosaic, this._styleRepository), this._fetchQueue.resume(), this._parseQueue.resume(), this._isTileHandlerReady = !0, this.notifyChange(\"updating\"), this.requestUpdate();\n  }\n\n  _createVectorTile(e) {\n    const t = this._tileInfoView.getTileBounds(y(), e),\n          i = this._tileInfoView.getTileResolution(e.level);\n\n    return new g(e, i, t[0], t[3], 512, 512, this._styleRepository);\n  }\n\n};\n\nfunction Q(e) {\n  if (r(e)) return 0;\n\n  switch (e.type) {\n    case \"partial\":\n      return Object.keys(e.diff).length;\n\n    case \"complete\":\n      return Math.max(Object.keys(e.oldValue).length, Object.keys(e.newValue).length);\n\n    case \"collection\":\n      return Object.keys(e.added).length + Object.keys(e.changed).length + Object.keys(e.removed).length;\n  }\n}\n\ne([o()], D.prototype, \"_fetchQueue\", void 0), e([o()], D.prototype, \"_parseQueue\", void 0), e([o()], D.prototype, \"_isTileHandlerReady\", void 0), e([o()], D.prototype, \"fading\", void 0), D = e([h(\"esri.views.2d.layers.VectorTileLayerView2D\")], D);\nconst L = D;\nexport { L as default };","map":{"version":3,"names":["_","e","t","clone","i","s","isNone","r","isAbortError","a","watch","l","initial","n","property","o","subclass","h","diff","u","hasDiff","c","create","y","equals","p","StyleUpdateType","d","TileHandler","TileManager","f","VectorTile","g","VectorTileContainer","m","StyleLayerType","C","T","LayerView2DMixin","v","R","H","w","S","D","constructor","arguments","_styleChanges","_fetchQueue","_parseQueue","_isTileHandlerReady","fading","_getCollidersMesh","pixelRatio","state","_vectorTileContainer","children","symbols","colliders","xScreen","dxScreen","yScreen","dyScreen","width","height","unique","parts","partIndex","targetOpacity","layer","showCollisionBoxes","makeFlags","push","vertexData","Int16Array","indexData","Uint32Array","_getCollidersColors","_getCollidersOpacities","hitTest","_tileHandlerPromise","length","_styleRepository","getStyleLayerByUID","getStyleLayerIndex","id","type","mapPoint","graphic","attributes","layerId","layerName","layerUID","sourceLayer","update","_tileHandler","devicePixelRatio","_start","_applyStyleChanges","pause","_tileManager","requestUpdate","resume","attach","style","currentStyleInfo","_tileInfoView","tileInfo","fullExtent","window","container","addChild","handles","add","on","notifyChange","_collisionOverlay","requestRender","getMesh","getColors","getOpacities","removeChild","isDataDriven","PAINTER_CHANGED","data","getLayerById","SYMBOL","setPaintProperties","paint","restartDeclutter","layout","Q","setLayoutProperties","LAYOUT_CHANGED","setStyleLayerVisibility","visibility","LAYER_CHANGED","LAYER_REMOVED","_loadStyle","_newSpriteSource","spriteSource","SPRITES_CHANGED","layers","getLayoutProperty","LINE","getPaintProperty","isPainterDataDriven","FILL","declaredClass","detach","_stop","removeAllChildren","destroy","remove","moveStart","viewChange","moveEnd","supportsSpatialReference","spatialReference","canResume","layerDefinition","view","scale","minScale","maxScale","isUpdating","updating","some","invalidating","acquireTile","_createVectorTile","then","key","once","setData","catch","getLogger","error","releaseTile","abort","tileInfoView","AbortController","start","signal","process","_getTileData","concurrency","_parseTileData","spriteMosaic","setStyleResources","glyphMosaic","_tileHandlerAbortController","fetchTileData","parseTileData","clear","clearCache","updateStyle","message","forEach","uid","deleteStyleLayer","setStyleLayer","index","setSpriteMosaic","setSpriteSource","deleteStyleLayers","deleteLayerData","styleLayerUIDs","Promise","all","setStyle","aborted","getTileBounds","getTileResolution","level","Object","keys","Math","max","oldValue","newValue","added","changed","removed","prototype","L","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/VectorTileLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Graphic.js\";import{clone as i}from\"../../../core/lang.js\";import s from\"../../../core/Logger.js\";import{isNone as r}from\"../../../core/maybe.js\";import{isAbortError as a}from\"../../../core/promiseUtils.js\";import{watch as l,initial as n}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as h}from\"../../../core/accessorSupport/decorators/subclass.js\";import{diff as u,hasDiff as c}from\"../../../core/accessorSupport/diffUtils.js\";import{create as y}from\"../../../geometry/support/aaBoundingRect.js\";import{equals as p}from\"../../../geometry/support/spatialReferenceUtils.js\";import{StyleUpdateType as d}from\"../engine/vectorTiles/enums.js\";import{TileHandler as _}from\"../engine/vectorTiles/TileHandler.js\";import{TileManager as f}from\"../engine/vectorTiles/TileManager.js\";import{VectorTile as g}from\"../engine/vectorTiles/VectorTile.js\";import{VectorTileContainer as m}from\"../engine/vectorTiles/VectorTileContainer.js\";import{StyleLayerType as C}from\"../engine/vectorTiles/style/StyleDefinition.js\";import T from\"../engine/vectorTiles/style/StyleRepository.js\";import{LayerView2DMixin as v}from\"./LayerView2D.js\";import R from\"./support/DebugOverlay.js\";import H from\"../tiling/TileInfoViewPOT.js\";import w from\"../tiling/TileQueue.js\";import S from\"../../layers/LayerView.js\";let D=class extends(v(S)){constructor(){super(...arguments),this._styleChanges=[],this._fetchQueue=null,this._parseQueue=null,this._isTileHandlerReady=!1,this.fading=!1,this._getCollidersMesh=e=>{const{pixelRatio:t}=e.state;let i=0;const s=[],r=[];for(const a of this._vectorTileContainer.children)if(a.symbols)for(const[e,l]of a.symbols)for(const a of l)for(const e of a.colliders){const l=(e.xScreen+e.dxScreen)*t,n=(e.yScreen+e.dyScreen)*t,o=e.width*t,h=e.height*t,u=a.unique.parts[e.partIndex].targetOpacity>.5;if(!u&&\"all\"!==this.layer.showCollisionBoxes)continue;const c=2,y=0,p=3,d=0,_=3,f=1,g=3,m=0,C=u?c:y,T=u?p:d,v=R.makeFlags(C,T);s.push(l,n,v,l+o,n,v,l,n+h,v,l+o,n+h,v),r.push(i+0,i+1,i+2,i+1,i+3,i+2),i+=4;const H=u?_:f,w=u?g:m,S=R.makeFlags(H,w);s.push(l,n,S,l+o,n,S,l,n+1,S,l+o,n+1,S),r.push(i+0,i+1,i+2,i+1,i+3,i+2),i+=4,s.push(l,n+h-1,S,l+o,n+h-1,S,l,n+h,S,l+o,n+h,S),r.push(i+0,i+1,i+2,i+1,i+3,i+2),i+=4,s.push(l,n,S,l+1,n,S,l,n+h,S,l+1,n+h,S),r.push(i+0,i+1,i+2,i+1,i+3,i+2),i+=4,s.push(l+o-1,n,S,l+o,n,S,l+o-1,n+h,S,l+o,n+h,S),r.push(i+0,i+1,i+2,i+1,i+3,i+2),i+=4}return{vertexData:new Int16Array(s),indexData:new Uint32Array(r)}},this._getCollidersColors=()=>[1,.5,0,1,1,0,0,1,0,1,.5,1,0,.5,0,1],this._getCollidersOpacities=()=>[.05,.01,.15,.2]}async hitTest(e,i){if(!this._tileHandlerPromise)return null;await this._tileHandlerPromise;const s=await this._vectorTileContainer.hitTest(i);if(!s||0===s.length)return null;const r=s[0]-1,a=this._styleRepository,l=a.getStyleLayerByUID(r);if(!l)return null;const n=a.getStyleLayerIndex(l.id);return[{type:\"graphic\",mapPoint:e,layer:this.layer,graphic:new t({attributes:{layerId:n,layerName:l.id,layerUID:r},layer:this.layer,sourceLayer:this.layer})}]}update(e){if(this._tileHandlerPromise&&this._isTileHandlerReady)return e.pixelRatio!==this._tileHandler.devicePixelRatio?(this._start(),void(this._tileHandler.devicePixelRatio=e.pixelRatio)):void(this._styleChanges.length>0?this._tileHandlerPromise=this._applyStyleChanges():(this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.state=e.state,this._parseQueue.state=e.state,this._tileManager.update(e)||this.requestUpdate(),this._parseQueue.resume(),this._fetchQueue.resume()))}attach(){const{style:e}=this.layer.currentStyleInfo;this._styleRepository=new T(e),this._tileInfoView=new H(this.layer.tileInfo,this.layer.fullExtent),this._vectorTileContainer=new m(this._tileInfoView),this._tileHandler=new _(this.layer,this._styleRepository,window.devicePixelRatio||1),this.container.addChild(this._vectorTileContainer),this._start(),this.handles.add([this._vectorTileContainer.on(\"fade-start\",(()=>{this.fading=!0,this.notifyChange(\"updating\"),this.requestUpdate()})),this._vectorTileContainer.on(\"fade-complete\",(()=>{this._collisionOverlay?.requestRender(),this.fading=!1,this.notifyChange(\"updating\"),this.requestUpdate()})),l((()=>this.layer.showCollisionBoxes),(e=>{\"none\"!==e?this._collisionOverlay||(this._collisionOverlay=new R({getMesh:this._getCollidersMesh,getColors:this._getCollidersColors,getOpacities:this._getCollidersOpacities}),this.container.addChild(this._collisionOverlay)):(this.container.removeChild(this._collisionOverlay),this._collisionOverlay=null),this.container.requestRender()}),n),this.layer.on(\"paint-change\",(e=>{if(e.isDataDriven)this._styleChanges.push({type:d.PAINTER_CHANGED,data:e}),this.notifyChange(\"updating\"),this.requestUpdate();else{const t=this._styleRepository,i=t.getLayerById(e.layer);if(!i)return;const s=i.type===C.SYMBOL;t.setPaintProperties(e.layer,e.paint),s&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender()}})),this.layer.on(\"layout-change\",(e=>{const t=this._styleRepository,i=t.getLayerById(e.layer);if(!i)return;const s=u(i.layout,e.layout);if(!r(s)){if(c(s,\"visibility\")&&1===Q(s))return t.setLayoutProperties(e.layer,e.layout),i.type===C.SYMBOL&&this._vectorTileContainer.restartDeclutter(),void this._vectorTileContainer.requestRender();this._styleChanges.push({type:d.LAYOUT_CHANGED,data:e}),this.notifyChange(\"updating\"),this.requestUpdate()}})),this.layer.on(\"style-layer-visibility-change\",(e=>{const t=this._styleRepository,i=t.getLayerById(e.layer);i&&(t.setStyleLayerVisibility(e.layer,e.visibility),i.type===C.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())})),this.layer.on(\"style-layer-change\",(e=>{this._styleChanges.push({type:d.LAYER_CHANGED,data:e}),this.notifyChange(\"updating\"),this.requestUpdate()})),this.layer.on(\"delete-style-layer\",(e=>{this._styleChanges.push({type:d.LAYER_REMOVED,data:e}),this.notifyChange(\"updating\"),this.requestUpdate()})),this.layer.on(\"load-style\",(()=>this._loadStyle())),this.layer.on(\"spriteSource-change\",(e=>{this._newSpriteSource=e.spriteSource,this._styleChanges.push({type:d.SPRITES_CHANGED,data:null});const t=this._styleRepository.layers;for(const i of t)switch(i.type){case C.SYMBOL:i.getLayoutProperty(\"icon-image\")&&this._styleChanges.push({type:d.LAYOUT_CHANGED,data:{layer:i.id,layout:i.layout}});break;case C.LINE:i.getPaintProperty(\"line-pattern\")&&this._styleChanges.push({type:d.PAINTER_CHANGED,data:{layer:i.id,paint:i.paint,isDataDriven:i.isPainterDataDriven()}});break;case C.FILL:i.getLayoutProperty(\"fill-pattern\")&&this._styleChanges.push({type:d.PAINTER_CHANGED,data:{layer:i.id,paint:i.paint,isDataDriven:i.isPainterDataDriven()}})}this.notifyChange(\"updating\"),this.requestUpdate()}))],this.declaredClass)}detach(){this._stop(),this.container.removeAllChildren(),this._vectorTileContainer?.destroy(),this._vectorTileContainer=null,this._tileHandler?.destroy(),this._tileHandler=null,this.handles.remove(this.declaredClass)}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this._collisionOverlay&&this._vectorTileContainer.restartDeclutter(),this.requestUpdate()}supportsSpatialReference(e){return p(this.layer.tileInfo?.spatialReference,e)}canResume(){let e=super.canResume();const{currentStyleInfo:t}=this.layer;if(e&&t?.layerDefinition){const i=this.view.scale,{minScale:s,maxScale:r}=t.layerDefinition;t&&t.layerDefinition&&(s&&s<i&&(e=!1),r&&r>i&&(e=!1))}return e}isUpdating(){const e=this._vectorTileContainer.children;return!this._isTileHandlerReady||!this._fetchQueue||!this._parseQueue||this._fetchQueue.updating||this._parseQueue.updating||e.length>0&&e.some((e=>e.invalidating))||this.fading}acquireTile(e){const t=this._createVectorTile(e);return this._tileHandlerPromise.then((()=>{this._fetchQueue.push(t.key).then((e=>this._parseQueue.push({key:t.key,data:e}))).then((e=>{t.once(\"attach\",(()=>this.requestUpdate())),t.setData(e),this.requestUpdate(),this.notifyChange(\"updating\")})).catch((e=>{this.notifyChange(\"updating\"),a(e)||s.getLogger(this.declaredClass).error(e)}))})),t}releaseTile(e){const t=e.key.id;this._fetchQueue.abort(t),this._parseQueue.abort(t),this.requestUpdate()}_start(){if(this._stop(),this._tileManager=new f({acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView},this._vectorTileContainer),!this.layer.currentStyleInfo)return;const e=new AbortController,t=this._tileHandler.start({signal:e.signal}).then((()=>{this._fetchQueue=new w({tileInfoView:this._tileInfoView,process:(e,t)=>this._getTileData(e,t),concurrency:15}),this._parseQueue=new w({tileInfoView:this._tileInfoView,process:(e,t)=>this._parseTileData(e,t),concurrency:8}),this.requestUpdate(),this._isTileHandlerReady=!0}));this._tileHandler.spriteMosaic.then((e=>{this._vectorTileContainer.setStyleResources(e,this._tileHandler.glyphMosaic,this._styleRepository),this.requestUpdate()})),this._tileHandlerAbortController=e,this._tileHandlerPromise=t}_stop(){if(!this._tileHandlerAbortController||!this._vectorTileContainer)return;const e=this._tileHandlerAbortController;e&&e.abort(),this._tileHandlerPromise=null,this._isTileHandlerReady=!1,this._fetchQueue&&(this._fetchQueue.destroy(),this._fetchQueue=null),this._parseQueue&&(this._parseQueue.destroy(),this._parseQueue=null),this._tileManager&&(this._tileManager.destroy(),this._tileManager=null),this._vectorTileContainer.removeAllChildren()}async _getTileData(e,t){const i=await this._tileHandler.fetchTileData(e,t);return this.notifyChange(\"updating\"),i}async _parseTileData(e,t){return this._tileHandler.parseTileData(e,t)}async _applyStyleChanges(){this._isTileHandlerReady=!1,this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.clear(),this._parseQueue.clear(),this._tileManager.clearCache();const e=this._styleChanges;try{await this._tileHandler.updateStyle(e)}catch(n){s.getLogger(this.declaredClass).error(\"error applying vector-tiles style update\",n.message),this._fetchQueue.resume(),this._parseQueue.resume(),this._isTileHandlerReady=!0}const t=this._styleRepository,i=[];e.forEach((e=>{if(e.type!==d.LAYER_REMOVED)return;const s=e.data,r=t.getLayerById(s.layer);r&&i.push(r.uid)}));const r=[];let a;e.forEach((e=>{const i=e.type,s=e.data;switch(i){case d.PAINTER_CHANGED:t.setPaintProperties(s.layer,s.paint),a=s.layer;break;case d.LAYOUT_CHANGED:t.setLayoutProperties(s.layer,s.layout),a=s.layer;break;case d.LAYER_REMOVED:return void t.deleteStyleLayer(s.layer);case d.LAYER_CHANGED:t.setStyleLayer(s.layer,s.index),a=s.layer.id;break;case d.SPRITES_CHANGED:this._vectorTileContainer.setSpriteMosaic(this._tileHandler.setSpriteSource(this._newSpriteSource)),this._newSpriteSource=null,a=null}const l=t.getLayerById(a);l&&r.push(l.uid)}));const l=this._vectorTileContainer.children;if(i.length>0){this._vectorTileContainer.deleteStyleLayers(i);for(const e of l)e.deleteLayerData(i)}if(this._fetchQueue.resume(),this._parseQueue.resume(),r.length>0){const e=[];for(const t of l){const i=this._fetchQueue.push(t.key).then((e=>this._parseQueue.push({key:t.key,data:e,styleLayerUIDs:r}))).then((e=>t.setData(e)));e.push(i)}await Promise.all(e)}this._styleChanges=[],this._isTileHandlerReady=!0,this.notifyChange(\"updating\"),this.requestUpdate()}async _loadStyle(){const{style:e}=this.layer.currentStyleInfo,t=i(e);this._isTileHandlerReady=!1,this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.clear(),this._parseQueue.clear(),this.notifyChange(\"updating\"),this._styleRepository=new T(t),this._vectorTileContainer.destroy(),this._tileManager.clear(),this._tileHandlerAbortController.abort(),this._tileHandlerAbortController=new AbortController;const{signal:s}=this._tileHandlerAbortController;try{this._tileHandlerPromise=this._tileHandler.setStyle(this._styleRepository,t),await this._tileHandlerPromise}catch(l){if(!a(l))throw l}if(s.aborted)return this._fetchQueue.resume(),this._parseQueue.resume(),this._isTileHandlerReady=!0,this.notifyChange(\"updating\"),void this.requestUpdate();const r=await this._tileHandler.spriteMosaic;this._vectorTileContainer.setStyleResources(r,this._tileHandler.glyphMosaic,this._styleRepository),this._fetchQueue.resume(),this._parseQueue.resume(),this._isTileHandlerReady=!0,this.notifyChange(\"updating\"),this.requestUpdate()}_createVectorTile(e){const t=this._tileInfoView.getTileBounds(y(),e),i=this._tileInfoView.getTileResolution(e.level);return new g(e,i,t[0],t[3],512,512,this._styleRepository)}};function Q(e){if(r(e))return 0;switch(e.type){case\"partial\":return Object.keys(e.diff).length;case\"complete\":return Math.max(Object.keys(e.oldValue).length,Object.keys(e.newValue).length);case\"collection\":return Object.keys(e.added).length+Object.keys(e.changed).length+Object.keys(e.removed).length}}e([o()],D.prototype,\"_fetchQueue\",void 0),e([o()],D.prototype,\"_parseQueue\",void 0),e([o()],D.prototype,\"_isTileHandlerReady\",void 0),e([o()],D.prototype,\"fading\",void 0),D=e([h(\"esri.views.2d.layers.VectorTileLayerView2D\")],D);const L=D;export{L as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}