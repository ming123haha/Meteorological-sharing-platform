{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport \"../../../../geometry.js\";\nimport e from \"../../../../core/Error.js\";\nimport { applySome as t, isNone as r, isSome as i, releaseMaybe as a, unwrapOr as s, get as o, unwrap as n } from \"../../../../core/maybe.js\";\nimport { px2pt as l, pt2px as h } from \"../../../../core/screenUtils.js\";\nimport { I as p } from \"../../../../chunks/mat4f64.js\";\nimport { s as m } from \"../../../../chunks/vec4.js\";\nimport { f as c, d } from \"../../../../chunks/vec4f64.js\";\nimport { create as _, empty as u, expandWithBuffer as y, intersectsClippingArea as g, expandWithAABB as f } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { getDriverAxisSizeValueAny as M } from \"../../../../renderers/support/renderingInfoUtils.js\";\nimport { sharedGeometryElevationAligner as b } from \"./ElevationAligners.js\";\nimport { SymbolUpdateType as v, elevationModeChangeUpdateType as E, needsElevationUpdates2D as w } from \"./elevationAlignmentUtils.js\";\nimport { ElevationContext as C } from \"./ElevationContext.js\";\nimport P from \"./Graphics3DDrapedGraphicLayer.js\";\nimport { Graphics3DObject3DGraphicLayer as L } from \"./Graphics3DObject3DGraphicLayer.js\";\nimport { Graphics3DSymbolLayer as x, getAttributeValue as S } from \"./Graphics3DSymbolLayer.js\";\nimport { ApplyRendererDiffResult as k } from \"./interfaces.js\";\nimport { parseCapType as D, geometryToRenderInfo as R, RemoveDuplicateStartEnd as A, createGeometry as U, geometryToRenderInfoDraped as j } from \"./lineUtils.js\";\nimport { initFastSymbolUpdatesState as z, updateFastSymbolUpdatesState as O } from \"../support/FastSymbolUpdates.js\";\nimport { prepareMarkerResources as G } from \"../support/markerUtils.js\";\nimport V from \"../../support/debugFlags.js\";\nimport { Object3D as T } from \"../../webgl-engine/lib/Object3D.js\";\nimport { RenderGeometry as F } from \"../../webgl-engine/lib/RenderGeometry.js\";\nimport { LineMarkerMaterial as I } from \"../../webgl-engine/materials/LineMarkerMaterial.js\";\nimport { getStipplePatternForLinePattern as W } from \"../../webgl-engine/materials/lineStippleUtils.js\";\nimport { RibbonLineMaterial as B } from \"../../webgl-engine/materials/RibbonLineMaterial.js\";\nimport H from \"../../../../geometry/Extent.js\";\nimport N from \"../../../../geometry/Polygon.js\";\nconst q = [\"polyline\", \"polygon\", \"extent\"];\n\nclass K extends x {\n  constructor(e, t, r, i) {\n    super(e, t, r, i), this._uniformSize = 1;\n  }\n\n  async doLoad() {\n    if (this._vvConvertOptions = {\n      modelSize: [1, 1, 1],\n      symbolSize: [1, 1, 1],\n      unitInMeters: 1,\n      transformation: {\n        anchor: [0, 0, 0],\n        scale: [1, 1, 1],\n        rotation: [0, 0, 0]\n      },\n      supportedTypes: {\n        size: !0,\n        color: !0,\n        opacity: !0,\n        rotation: !1\n      }\n    }, this._context.renderer && this._context.renderer.visualVariables && this._context.renderer.visualVariables.length > 0 ? this._fastUpdates = z(this._context.renderer, this._vvConvertOptions) : this._fastUpdates = {\n      enabled: !1\n    }, !this._drivenProperties.size) {\n      const t = null != this.symbolLayer.size ? this.symbolLayer.size : l(1);\n      if (t < 0) throw new e(\"graphics3dlinesymbollayer:invalid-size\", \"Symbol sizes may not be negative values\");\n      this._uniformSize = t;\n    }\n\n    this._markerTexture = G(this._context.sharedResources.textures, this.symbolLayer.marker);\n  }\n\n  _getMaterialParameters(e, t = !1) {\n    const r = this._getCombinedOpacityAndColor(t && this._markerColor || this._materialColor);\n\n    this._patternHidesLine && !t && (r[3] = 0);\n    const i = {\n      width: this._computeMaterialWidth(this.symbolLayer?.size),\n      color: r,\n      hasPolygonOffset: !0,\n      join: this.symbolLayer.join || \"miter\",\n      cap: D(this.symbolLayer.cap || \"butt\"),\n      hasSlicePlane: this._context.slicePlaneEnabled,\n      isClosed: e,\n      stipplePattern: W(this.symbolLayer.pattern),\n      stippleScaleWithLineWidth: !0\n    };\n    return this._fastUpdates && this._fastUpdates.visualVariables ? { ...i,\n      ...this._fastUpdates.materialParameters\n    } : i;\n  }\n\n  get _materialColor() {\n    return t(this.symbolLayer.material, e => e.color);\n  }\n\n  get _markerColor() {\n    return t(this.symbolLayer.marker, e => e.color);\n  }\n\n  get lineMaterial() {\n    return r(this._lineMaterial) && (this._lineMaterial = new B(this._getMaterialParameters(!1)), this._context.stage.add(this._lineMaterial)), this._lineMaterial;\n  }\n\n  get ringMaterial() {\n    return r(this._ringMaterial) && (this._ringMaterial = new B(this._getMaterialParameters(!0)), this._context.stage.add(this._ringMaterial)), this._ringMaterial;\n  }\n\n  get wireframeLineMaterial() {\n    return r(this._wireframeLineMaterial) && (this._wireframeLineMaterial = new B({ ...this._getMaterialParameters(!1),\n      wireframe: !0\n    }), this._context.stage.add(this._wireframeLineMaterial)), this._wireframeLineMaterial;\n  }\n\n  get wireframeRingMaterial() {\n    return r(this._wireframeRingMaterial) && (this._wireframeRingMaterial = new B({ ...this._getMaterialParameters(!0),\n      wireframe: !0\n    }), this._context.stage.add(this._wireframeRingMaterial)), this._wireframeRingMaterial;\n  }\n\n  get markerMaterial() {\n    return r(this._markerMaterial) && i(this.symbolLayer.marker) && i(this._markerTexture) && (this._markerMaterial = new I({ ...this._getMaterialParameters(!1, !0),\n      placement: this.symbolLayer.marker.placement,\n      textureId: this._markerTexture.texture.id\n    }), this._context.stage.add(this._markerMaterial)), this._markerMaterial;\n  }\n\n  destroy() {\n    super.destroy(), this._forEachMaterial(e => this._context.stage.remove(e)), this._lineMaterial = null, this._ringMaterial = null, this._wireframeLineMaterial = null, this._wireframeRingMaterial = null, this._markerMaterial = null, this._markerTexture = a(this._markerTexture);\n  }\n\n  _getDrivenSize(e) {\n    return this._drivenProperties.size && e.size ? h(M(e.size)) : 1;\n  }\n\n  _getSizeFeatureAttributeData(e) {\n    return this._fastUpdates.enabled && this._fastUpdates.visualVariables.size ? S(this._fastUpdates.visualVariables.size.field, e) : null;\n  }\n\n  _getDrivenColor(e) {\n    const t = c(1, 1, 1, 1);\n    return this._drivenProperties.color && e.color && (t[0] = e.color[0], t[1] = e.color[1], t[2] = e.color[2], e.color.length > 0 && (t[3] = e.color[3])), this._drivenProperties.opacity && e.opacity && (t[3] = e.opacity), t;\n  }\n\n  _getColorFeatureAttributeData(e) {\n    return this._fastUpdates.enabled && this._fastUpdates.visualVariables.color ? S(this._fastUpdates.visualVariables.color.field, e) : null;\n  }\n\n  _getOpacityFeatureAttributeData(e) {\n    return this._fastUpdates.enabled && this._fastUpdates.visualVariables.opacity ? S(this._fastUpdates.visualVariables.opacity.field, e) : null;\n  }\n\n  createGraphics3DGraphic(e) {\n    const t = e.graphic;\n    if (!this._validateGeometry(t.geometry, q, this.symbolLayer.type)) return null;\n    const r = this.setGraphicElevationContext(t, new C());\n    return this.ensureDrapedStatus(\"on-the-ground\" === r.mode), this.draped ? this._createAsOverlay(e, this._context.layer.uid) : this._createAs3DShape(e, r, t.uid);\n  }\n\n  applyRendererDiff(e, t) {\n    for (const r in e.diff) {\n      if (\"visualVariables\" !== r) return k.Recreate_Symbol;\n      if (!O(this._fastUpdates, t, this._vvConvertOptions)) return k.Recreate_Symbol;\n\n      this._forEachMaterial(e => e.setParameters(this._fastUpdates.materialParameters));\n    }\n\n    return k.Fast_Update;\n  }\n\n  prepareSymbolLayerPatch(e) {\n    if (\"partial\" !== e.diff.type) return;\n    const t = e.diff.diff,\n          r = {};\n    \"complete\" === t.size?.type && (r.width = this._computeMaterialWidth(t.size.newValue), delete t.size), \"complete\" === t.cap?.type && (r.cap = D(s(t.cap.newValue, \"butt\")), delete t.cap);\n\n    const i = this._prepareMarkerPatch(e, t);\n\n    this._prepareMaterialPatch(e, t, i), e.symbolLayerStatePatches.push(() => this._forEachMaterial(e => e.setParameters(r)));\n  }\n\n  layerOpacityChanged() {\n    return this._forEachMaterial((e, t) => this._updateMaterialLayerOpacity(e, t)), !0;\n  }\n\n  _forEachMaterial(e) {\n    i(this._lineMaterial) && e(this._lineMaterial), i(this._ringMaterial) && e(this._ringMaterial), i(this._wireframeLineMaterial) && e(this._wireframeLineMaterial), i(this._wireframeRingMaterial) && e(this._wireframeRingMaterial), i(this._markerMaterial) && e(this._markerMaterial, !0);\n  }\n\n  _updateMaterialLayerOpacity(e, t = !1) {\n    const r = e.parameters.color,\n          i = o(this.symbolLayer, \"material\", \"color\"),\n          a = this._patternHidesLine && !t ? 0 : this._getCombinedOpacity(i),\n          s = c(r[0], r[1], r[2], a);\n    e.setParameters({\n      color: s\n    });\n  }\n\n  layerElevationInfoChanged(e, t, r) {\n    const i = this._elevationContext.mode,\n          a = E(K.elevationModeChangeTypes, r, i);\n    if (a !== v.UPDATE) return a;\n    const s = w(i);\n    return this.updateGraphics3DGraphicElevationInfo(e, t, () => s);\n  }\n\n  slicePlaneEnabledChanged() {\n    const e = {\n      hasSlicePlane: this._context.slicePlaneEnabled\n    };\n    return this._forEachMaterial(t => t.setParameters(e)), !0;\n  }\n\n  physicalBasedRenderingChanged() {\n    return !0;\n  }\n\n  pixelRatioChanged() {\n    return !0;\n  }\n\n  _getGeometryAsPolygonOrPolyline(e) {\n    switch (e.type) {\n      case \"extent\":\n        if (e instanceof H) return N.fromExtent(e);\n        break;\n\n      case \"polygon\":\n      case \"polyline\":\n        return e;\n    }\n\n    return null;\n  }\n\n  _createAs3DShape(e, t, r) {\n    const a = e.graphic,\n          s = this._getGeometryAsPolygonOrPolyline(a.geometry),\n          o = \"polygon\" === s.type ? s.rings : s.paths,\n          n = new Array(),\n          l = new Array(),\n          h = new Array(),\n          m = _(),\n          c = R(s, this._context.elevationProvider, this._context.renderCoordsHelper, t),\n          d = \"polygon\" === s.type ? \"rings\" : \"paths\";\n\n    this._logGeometryCreationWarnings(c, o, d, \"LineSymbol3DLayer\");\n\n    for (let _ = 0; _ < c.lines.length; _++) {\n      const {\n        position: t,\n        mapPosition: r\n      } = c.lines[_];\n      if (i(this._context.clippingExtent) && (u(m), y(m, r), !g(m, this._context.clippingExtent))) continue;\n\n      const a = this._createGeometry(e, t, r, s.type, J.ELEVATED);\n\n      n.push(a), l.push(\"polygon\" === s.type ? this.ringMaterial : this.lineMaterial), h.push(p), V.LINE_WIREFRAMES && (n.push(a.cloneShallow()), l.push(\"polygon\" === s.type ? this.wireframeRingMaterial : this.wireframeLineMaterial), h.push(p));\n      const o = this.markerMaterial;\n      i(o) && (n.push(a.cloneShallow()), l.push(o), h.push(p));\n    }\n\n    if (0 === n.length) return null;\n    const f = new T({\n      geometries: n,\n      materials: l,\n      transformations: h,\n      castShadow: !1,\n      metadata: {\n        layerUid: this._context.layer.uid,\n        graphicUid: r\n      }\n    }),\n          M = new L(this, f, n, null, null, b, t);\n    return M.alignedSampledElevation = c.sampledElevation, M.needsElevationUpdates = w(t.mode), M;\n  }\n\n  _createGeometry(e, t, r, i, a) {\n    const s = \"polygon\" === i ? A.REMOVE : A.KEEP,\n          o = this._fastUpdates.enabled && this._fastUpdates.visualVariables.color,\n          n = this._fastUpdates.enabled && this._fastUpdates.visualVariables.size;\n    return U({\n      overlayInfo: a === J.DRAPED ? {\n        spatialReference: this._context.overlaySR,\n        renderCoordsHelper: this._context.renderCoordsHelper\n      } : null,\n      removeDuplicateStartEnd: s,\n      uniformSize: this._uniformSize,\n      attributeData: {\n        position: t,\n        mapPosition: r,\n        size: n ? null : this._getDrivenSize(e.renderingInfo),\n        color: o ? null : this._getDrivenColor(e.renderingInfo),\n        sizeFeature: this._getSizeFeatureAttributeData(e.graphic),\n        colorFeature: this._getColorFeatureAttributeData(e.graphic),\n        opacityFeature: this._getOpacityFeatureAttributeData(e.graphic)\n      }\n    });\n  }\n\n  _createAsOverlay(e, t) {\n    const r = e.graphic,\n          a = this._getGeometryAsPolygonOrPolyline(r.geometry),\n          s = \"polygon\" === a.type ? a.rings : a.paths,\n          o = \"polygon\" === a.type ? this.ringMaterial : this.lineMaterial;\n\n    o.renderPriority = this._renderPriority;\n    const l = V.LINE_WIREFRAMES ? \"polygon\" === a.type ? this.wireframeRingMaterial : this.wireframeLineMaterial : null,\n          h = this.markerMaterial;\n    i(l) && (l.renderPriority = this._renderPriority - .001), i(h) && (h.renderPriority = this._renderPriority - .002);\n\n    const p = new Array(),\n          m = _(),\n          c = u(),\n          d = j(a, this._context.overlaySR),\n          M = \"polygon\" === a.type ? \"rings\" : \"paths\";\n\n    this._logGeometryCreationWarnings(d, s, M, \"LineSymbol3DLayer\");\n\n    for (const _ of d.lines) {\n      if (u(m), y(m, _.position), !g(m, this._context.clippingExtent)) continue;\n      f(c, m);\n\n      const s = this._createGeometry(e, _.position, null, a.type, J.DRAPED),\n            d = e => {\n        const i = new F(s, e, {\n          layerUid: t,\n          graphicUid: r.uid\n        });\n        return p.push(i), i;\n      };\n\n      if (i(h)) {\n        const e = d(h),\n              t = n(this.symbolLayer.marker).placement;\n        \"begin\" !== t && \"begin-end\" !== t || y(m, _.position, 0, 1), \"end\" !== t && \"begin-end\" !== t || y(m, _.position, _.position.length - 3, 1), this._updateBoundingSphere(e, m);\n      }\n\n      const M = d(o);\n\n      if (this._updateBoundingSphere(M, m), V.LINE_WIREFRAMES) {\n        const e = d(l);\n\n        this._updateBoundingSphere(e, m);\n      }\n    }\n\n    return new P(this, p, c, this._context.drapeSourceRenderer);\n  }\n\n  _updateBoundingSphere(e, t) {\n    m(e.boundingSphere, .5 * (t[0] + t[3]), .5 * (t[1] + t[4]), 0, .5 * Math.sqrt((t[3] - t[0]) * (t[3] - t[0]) + (t[4] - t[1]) * (t[4] - t[1])));\n  }\n\n  get _patternHidesLine() {\n    const e = this.symbolLayer.pattern;\n    return i(e) && \"style\" === e.type && \"none\" === e.style;\n  }\n\n  _computeMaterialWidth(e) {\n    return e = s(e, l(1)), this._drivenProperties.size ? this._fastUpdates.enabled && this._fastUpdates.visualVariables.size ? h(1) : 1 : h(e);\n  }\n\n  _prepareMaterialPatch(e, i, a) {\n    const s = i.material;\n    if (r(s)) return void (a.changed && a.useMaterialColor && this._patchMaterialColor(this._getCombinedOpacityAndColor(this._materialColor), this._markerMaterial, e));\n    if (\"collection\" === s.type) return;\n\n    const o = \"complete\" === s.type ? t(s.newValue, e => e.color) : \"complete\" === s.diff.color.type ? s.diff.color.newValue : null,\n          n = this._getCombinedOpacityAndColor(o);\n\n    a.useMaterialColor && this._patchMaterialColor(d(n), this._markerMaterial, e), this._patternHidesLine && (n[3] = 0), this._patchMaterialColor(n, this._lineMaterial, e), delete i.material;\n  }\n\n  _prepareMarkerPatch(e, t) {\n    const a = t.marker;\n    if (r(a) || \"partial\" !== a.type || i(a.diff.style) || i(a.diff.placement) || i(a.diff.color) && \"complete\" !== a.diff.color.type) return {\n      changed: !1,\n      useMaterialColor: r(this._markerColor)\n    };\n    const s = a.diff.color;\n    if (r(s)) return delete t.marker, {\n      changed: !1,\n      useMaterialColor: r(this._markerColor)\n    };\n    const o = n(s.newValue);\n    return r(o) ? (delete t.marker, {\n      changed: !0,\n      useMaterialColor: !0\n    }) : (this._patchMaterialColor(this._getCombinedOpacityAndColor(o), this._markerMaterial, e), delete t.marker, {\n      changed: !0,\n      useMaterialColor: !1\n    });\n  }\n\n  _patchMaterialColor(e, t, i) {\n    r(t) || i.symbolLayerStatePatches.push(() => t.setParameters({\n      color: e\n    }));\n  }\n\n}\n\nvar J;\nK.elevationModeChangeTypes = {\n  definedChanged: v.RECREATE,\n  staysOnTheGround: v.NONE,\n  onTheGroundChanged: v.RECREATE\n}, function (e) {\n  e[e.DRAPED = 0] = \"DRAPED\", e[e.ELEVATED = 1] = \"ELEVATED\";\n}(J || (J = {}));\nexport { K as Graphics3DLineSymbolLayer };","map":{"version":3,"names":["e","applySome","t","isNone","r","isSome","i","releaseMaybe","a","unwrapOr","s","get","o","unwrap","n","px2pt","l","pt2px","h","I","p","m","f","c","d","create","_","empty","u","expandWithBuffer","y","intersectsClippingArea","g","expandWithAABB","getDriverAxisSizeValueAny","M","sharedGeometryElevationAligner","b","SymbolUpdateType","v","elevationModeChangeUpdateType","E","needsElevationUpdates2D","w","ElevationContext","C","P","Graphics3DObject3DGraphicLayer","L","Graphics3DSymbolLayer","x","getAttributeValue","S","ApplyRendererDiffResult","k","parseCapType","D","geometryToRenderInfo","R","RemoveDuplicateStartEnd","A","createGeometry","U","geometryToRenderInfoDraped","j","initFastSymbolUpdatesState","z","updateFastSymbolUpdatesState","O","prepareMarkerResources","G","V","Object3D","T","RenderGeometry","F","LineMarkerMaterial","getStipplePatternForLinePattern","W","RibbonLineMaterial","B","H","N","q","K","constructor","_uniformSize","doLoad","_vvConvertOptions","modelSize","symbolSize","unitInMeters","transformation","anchor","scale","rotation","supportedTypes","size","color","opacity","_context","renderer","visualVariables","length","_fastUpdates","enabled","_drivenProperties","symbolLayer","_markerTexture","sharedResources","textures","marker","_getMaterialParameters","_getCombinedOpacityAndColor","_markerColor","_materialColor","_patternHidesLine","width","_computeMaterialWidth","hasPolygonOffset","join","cap","hasSlicePlane","slicePlaneEnabled","isClosed","stipplePattern","pattern","stippleScaleWithLineWidth","materialParameters","material","lineMaterial","_lineMaterial","stage","add","ringMaterial","_ringMaterial","wireframeLineMaterial","_wireframeLineMaterial","wireframe","wireframeRingMaterial","_wireframeRingMaterial","markerMaterial","_markerMaterial","placement","textureId","texture","id","destroy","_forEachMaterial","remove","_getDrivenSize","_getSizeFeatureAttributeData","field","_getDrivenColor","_getColorFeatureAttributeData","_getOpacityFeatureAttributeData","createGraphics3DGraphic","graphic","_validateGeometry","geometry","type","setGraphicElevationContext","ensureDrapedStatus","mode","draped","_createAsOverlay","layer","uid","_createAs3DShape","applyRendererDiff","diff","Recreate_Symbol","setParameters","Fast_Update","prepareSymbolLayerPatch","newValue","_prepareMarkerPatch","_prepareMaterialPatch","symbolLayerStatePatches","push","layerOpacityChanged","_updateMaterialLayerOpacity","parameters","_getCombinedOpacity","layerElevationInfoChanged","_elevationContext","elevationModeChangeTypes","UPDATE","updateGraphics3DGraphicElevationInfo","slicePlaneEnabledChanged","physicalBasedRenderingChanged","pixelRatioChanged","_getGeometryAsPolygonOrPolyline","fromExtent","rings","paths","Array","elevationProvider","renderCoordsHelper","_logGeometryCreationWarnings","lines","position","mapPosition","clippingExtent","_createGeometry","J","ELEVATED","LINE_WIREFRAMES","cloneShallow","geometries","materials","transformations","castShadow","metadata","layerUid","graphicUid","alignedSampledElevation","sampledElevation","needsElevationUpdates","REMOVE","KEEP","overlayInfo","DRAPED","spatialReference","overlaySR","removeDuplicateStartEnd","uniformSize","attributeData","renderingInfo","sizeFeature","colorFeature","opacityFeature","renderPriority","_renderPriority","_updateBoundingSphere","drapeSourceRenderer","boundingSphere","Math","sqrt","style","changed","useMaterialColor","_patchMaterialColor","definedChanged","RECREATE","staysOnTheGround","NONE","onTheGroundChanged","Graphics3DLineSymbolLayer"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DLineSymbolLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import e from\"../../../../core/Error.js\";import{applySome as t,isNone as r,isSome as i,releaseMaybe as a,unwrapOr as s,get as o,unwrap as n}from\"../../../../core/maybe.js\";import{px2pt as l,pt2px as h}from\"../../../../core/screenUtils.js\";import{I as p}from\"../../../../chunks/mat4f64.js\";import{s as m}from\"../../../../chunks/vec4.js\";import{f as c,d}from\"../../../../chunks/vec4f64.js\";import{create as _,empty as u,expandWithBuffer as y,intersectsClippingArea as g,expandWithAABB as f}from\"../../../../geometry/support/aaBoundingBox.js\";import{getDriverAxisSizeValueAny as M}from\"../../../../renderers/support/renderingInfoUtils.js\";import{sharedGeometryElevationAligner as b}from\"./ElevationAligners.js\";import{SymbolUpdateType as v,elevationModeChangeUpdateType as E,needsElevationUpdates2D as w}from\"./elevationAlignmentUtils.js\";import{ElevationContext as C}from\"./ElevationContext.js\";import P from\"./Graphics3DDrapedGraphicLayer.js\";import{Graphics3DObject3DGraphicLayer as L}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as x,getAttributeValue as S}from\"./Graphics3DSymbolLayer.js\";import{ApplyRendererDiffResult as k}from\"./interfaces.js\";import{parseCapType as D,geometryToRenderInfo as R,RemoveDuplicateStartEnd as A,createGeometry as U,geometryToRenderInfoDraped as j}from\"./lineUtils.js\";import{initFastSymbolUpdatesState as z,updateFastSymbolUpdatesState as O}from\"../support/FastSymbolUpdates.js\";import{prepareMarkerResources as G}from\"../support/markerUtils.js\";import V from\"../../support/debugFlags.js\";import{Object3D as T}from\"../../webgl-engine/lib/Object3D.js\";import{RenderGeometry as F}from\"../../webgl-engine/lib/RenderGeometry.js\";import{LineMarkerMaterial as I}from\"../../webgl-engine/materials/LineMarkerMaterial.js\";import{getStipplePatternForLinePattern as W}from\"../../webgl-engine/materials/lineStippleUtils.js\";import{RibbonLineMaterial as B}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";import H from\"../../../../geometry/Extent.js\";import N from\"../../../../geometry/Polygon.js\";const q=[\"polyline\",\"polygon\",\"extent\"];class K extends x{constructor(e,t,r,i){super(e,t,r,i),this._uniformSize=1}async doLoad(){if(this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[1,1,1],unitInMeters:1,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=z(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1},!this._drivenProperties.size){const t=null!=this.symbolLayer.size?this.symbolLayer.size:l(1);if(t<0)throw new e(\"graphics3dlinesymbollayer:invalid-size\",\"Symbol sizes may not be negative values\");this._uniformSize=t}this._markerTexture=G(this._context.sharedResources.textures,this.symbolLayer.marker)}_getMaterialParameters(e,t=!1){const r=this._getCombinedOpacityAndColor(t&&this._markerColor||this._materialColor);this._patternHidesLine&&!t&&(r[3]=0);const i={width:this._computeMaterialWidth(this.symbolLayer?.size),color:r,hasPolygonOffset:!0,join:this.symbolLayer.join||\"miter\",cap:D(this.symbolLayer.cap||\"butt\"),hasSlicePlane:this._context.slicePlaneEnabled,isClosed:e,stipplePattern:W(this.symbolLayer.pattern),stippleScaleWithLineWidth:!0};return this._fastUpdates&&this._fastUpdates.visualVariables?{...i,...this._fastUpdates.materialParameters}:i}get _materialColor(){return t(this.symbolLayer.material,(e=>e.color))}get _markerColor(){return t(this.symbolLayer.marker,(e=>e.color))}get lineMaterial(){return r(this._lineMaterial)&&(this._lineMaterial=new B(this._getMaterialParameters(!1)),this._context.stage.add(this._lineMaterial)),this._lineMaterial}get ringMaterial(){return r(this._ringMaterial)&&(this._ringMaterial=new B(this._getMaterialParameters(!0)),this._context.stage.add(this._ringMaterial)),this._ringMaterial}get wireframeLineMaterial(){return r(this._wireframeLineMaterial)&&(this._wireframeLineMaterial=new B({...this._getMaterialParameters(!1),wireframe:!0}),this._context.stage.add(this._wireframeLineMaterial)),this._wireframeLineMaterial}get wireframeRingMaterial(){return r(this._wireframeRingMaterial)&&(this._wireframeRingMaterial=new B({...this._getMaterialParameters(!0),wireframe:!0}),this._context.stage.add(this._wireframeRingMaterial)),this._wireframeRingMaterial}get markerMaterial(){return r(this._markerMaterial)&&i(this.symbolLayer.marker)&&i(this._markerTexture)&&(this._markerMaterial=new I({...this._getMaterialParameters(!1,!0),placement:this.symbolLayer.marker.placement,textureId:this._markerTexture.texture.id}),this._context.stage.add(this._markerMaterial)),this._markerMaterial}destroy(){super.destroy(),this._forEachMaterial((e=>this._context.stage.remove(e))),this._lineMaterial=null,this._ringMaterial=null,this._wireframeLineMaterial=null,this._wireframeRingMaterial=null,this._markerMaterial=null,this._markerTexture=a(this._markerTexture)}_getDrivenSize(e){return this._drivenProperties.size&&e.size?h(M(e.size)):1}_getSizeFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?S(this._fastUpdates.visualVariables.size.field,e):null}_getDrivenColor(e){const t=c(1,1,1,1);return this._drivenProperties.color&&e.color&&(t[0]=e.color[0],t[1]=e.color[1],t[2]=e.color[2],e.color.length>0&&(t[3]=e.color[3])),this._drivenProperties.opacity&&e.opacity&&(t[3]=e.opacity),t}_getColorFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color?S(this._fastUpdates.visualVariables.color.field,e):null}_getOpacityFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.opacity?S(this._fastUpdates.visualVariables.opacity.field,e):null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,q,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new C);return this.ensureDrapedStatus(\"on-the-ground\"===r.mode),this.draped?this._createAsOverlay(e,this._context.layer.uid):this._createAs3DShape(e,r,t.uid)}applyRendererDiff(e,t){for(const r in e.diff){if(\"visualVariables\"!==r)return k.Recreate_Symbol;if(!O(this._fastUpdates,t,this._vvConvertOptions))return k.Recreate_Symbol;this._forEachMaterial((e=>e.setParameters(this._fastUpdates.materialParameters)))}return k.Fast_Update}prepareSymbolLayerPatch(e){if(\"partial\"!==e.diff.type)return;const t=e.diff.diff,r={};\"complete\"===t.size?.type&&(r.width=this._computeMaterialWidth(t.size.newValue),delete t.size),\"complete\"===t.cap?.type&&(r.cap=D(s(t.cap.newValue,\"butt\")),delete t.cap);const i=this._prepareMarkerPatch(e,t);this._prepareMaterialPatch(e,t,i),e.symbolLayerStatePatches.push((()=>this._forEachMaterial((e=>e.setParameters(r)))))}layerOpacityChanged(){return this._forEachMaterial(((e,t)=>this._updateMaterialLayerOpacity(e,t))),!0}_forEachMaterial(e){i(this._lineMaterial)&&e(this._lineMaterial),i(this._ringMaterial)&&e(this._ringMaterial),i(this._wireframeLineMaterial)&&e(this._wireframeLineMaterial),i(this._wireframeRingMaterial)&&e(this._wireframeRingMaterial),i(this._markerMaterial)&&e(this._markerMaterial,!0)}_updateMaterialLayerOpacity(e,t=!1){const r=e.parameters.color,i=o(this.symbolLayer,\"material\",\"color\"),a=this._patternHidesLine&&!t?0:this._getCombinedOpacity(i),s=c(r[0],r[1],r[2],a);e.setParameters({color:s})}layerElevationInfoChanged(e,t,r){const i=this._elevationContext.mode,a=E(K.elevationModeChangeTypes,r,i);if(a!==v.UPDATE)return a;const s=w(i);return this.updateGraphics3DGraphicElevationInfo(e,t,(()=>s))}slicePlaneEnabledChanged(){const e={hasSlicePlane:this._context.slicePlaneEnabled};return this._forEachMaterial((t=>t.setParameters(e))),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_getGeometryAsPolygonOrPolyline(e){switch(e.type){case\"extent\":if(e instanceof H)return N.fromExtent(e);break;case\"polygon\":case\"polyline\":return e}return null}_createAs3DShape(e,t,r){const a=e.graphic,s=this._getGeometryAsPolygonOrPolyline(a.geometry),o=\"polygon\"===s.type?s.rings:s.paths,n=new Array,l=new Array,h=new Array,m=_(),c=R(s,this._context.elevationProvider,this._context.renderCoordsHelper,t),d=\"polygon\"===s.type?\"rings\":\"paths\";this._logGeometryCreationWarnings(c,o,d,\"LineSymbol3DLayer\");for(let _=0;_<c.lines.length;_++){const{position:t,mapPosition:r}=c.lines[_];if(i(this._context.clippingExtent)&&(u(m),y(m,r),!g(m,this._context.clippingExtent)))continue;const a=this._createGeometry(e,t,r,s.type,J.ELEVATED);n.push(a),l.push(\"polygon\"===s.type?this.ringMaterial:this.lineMaterial),h.push(p),V.LINE_WIREFRAMES&&(n.push(a.cloneShallow()),l.push(\"polygon\"===s.type?this.wireframeRingMaterial:this.wireframeLineMaterial),h.push(p));const o=this.markerMaterial;i(o)&&(n.push(a.cloneShallow()),l.push(o),h.push(p))}if(0===n.length)return null;const f=new T({geometries:n,materials:l,transformations:h,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),M=new L(this,f,n,null,null,b,t);return M.alignedSampledElevation=c.sampledElevation,M.needsElevationUpdates=w(t.mode),M}_createGeometry(e,t,r,i,a){const s=\"polygon\"===i?A.REMOVE:A.KEEP,o=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color,n=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size;return U({overlayInfo:a===J.DRAPED?{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper}:null,removeDuplicateStartEnd:s,uniformSize:this._uniformSize,attributeData:{position:t,mapPosition:r,size:n?null:this._getDrivenSize(e.renderingInfo),color:o?null:this._getDrivenColor(e.renderingInfo),sizeFeature:this._getSizeFeatureAttributeData(e.graphic),colorFeature:this._getColorFeatureAttributeData(e.graphic),opacityFeature:this._getOpacityFeatureAttributeData(e.graphic)}})}_createAsOverlay(e,t){const r=e.graphic,a=this._getGeometryAsPolygonOrPolyline(r.geometry),s=\"polygon\"===a.type?a.rings:a.paths,o=\"polygon\"===a.type?this.ringMaterial:this.lineMaterial;o.renderPriority=this._renderPriority;const l=V.LINE_WIREFRAMES?\"polygon\"===a.type?this.wireframeRingMaterial:this.wireframeLineMaterial:null,h=this.markerMaterial;i(l)&&(l.renderPriority=this._renderPriority-.001),i(h)&&(h.renderPriority=this._renderPriority-.002);const p=new Array,m=_(),c=u(),d=j(a,this._context.overlaySR),M=\"polygon\"===a.type?\"rings\":\"paths\";this._logGeometryCreationWarnings(d,s,M,\"LineSymbol3DLayer\");for(const _ of d.lines){if(u(m),y(m,_.position),!g(m,this._context.clippingExtent))continue;f(c,m);const s=this._createGeometry(e,_.position,null,a.type,J.DRAPED),d=e=>{const i=new F(s,e,{layerUid:t,graphicUid:r.uid});return p.push(i),i};if(i(h)){const e=d(h),t=n(this.symbolLayer.marker).placement;\"begin\"!==t&&\"begin-end\"!==t||y(m,_.position,0,1),\"end\"!==t&&\"begin-end\"!==t||y(m,_.position,_.position.length-3,1),this._updateBoundingSphere(e,m)}const M=d(o);if(this._updateBoundingSphere(M,m),V.LINE_WIREFRAMES){const e=d(l);this._updateBoundingSphere(e,m)}}return new P(this,p,c,this._context.drapeSourceRenderer)}_updateBoundingSphere(e,t){m(e.boundingSphere,.5*(t[0]+t[3]),.5*(t[1]+t[4]),0,.5*Math.sqrt((t[3]-t[0])*(t[3]-t[0])+(t[4]-t[1])*(t[4]-t[1])))}get _patternHidesLine(){const e=this.symbolLayer.pattern;return i(e)&&\"style\"===e.type&&\"none\"===e.style}_computeMaterialWidth(e){return e=s(e,l(1)),this._drivenProperties.size?this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?h(1):1:h(e)}_prepareMaterialPatch(e,i,a){const s=i.material;if(r(s))return void(a.changed&&a.useMaterialColor&&this._patchMaterialColor(this._getCombinedOpacityAndColor(this._materialColor),this._markerMaterial,e));if(\"collection\"===s.type)return;const o=\"complete\"===s.type?t(s.newValue,(e=>e.color)):\"complete\"===s.diff.color.type?s.diff.color.newValue:null,n=this._getCombinedOpacityAndColor(o);a.useMaterialColor&&this._patchMaterialColor(d(n),this._markerMaterial,e),this._patternHidesLine&&(n[3]=0),this._patchMaterialColor(n,this._lineMaterial,e),delete i.material}_prepareMarkerPatch(e,t){const a=t.marker;if(r(a)||\"partial\"!==a.type||i(a.diff.style)||i(a.diff.placement)||i(a.diff.color)&&\"complete\"!==a.diff.color.type)return{changed:!1,useMaterialColor:r(this._markerColor)};const s=a.diff.color;if(r(s))return delete t.marker,{changed:!1,useMaterialColor:r(this._markerColor)};const o=n(s.newValue);return r(o)?(delete t.marker,{changed:!0,useMaterialColor:!0}):(this._patchMaterialColor(this._getCombinedOpacityAndColor(o),this._markerMaterial,e),delete t.marker,{changed:!0,useMaterialColor:!1})}_patchMaterialColor(e,t,i){r(t)||i.symbolLayerStatePatches.push((()=>t.setParameters({color:e})))}}var J;K.elevationModeChangeTypes={definedChanged:v.RECREATE,staysOnTheGround:v.NONE,onTheGroundChanged:v.RECREATE},function(e){e[e.DRAPED=0]=\"DRAPED\",e[e.ELEVATED=1]=\"ELEVATED\"}(J||(J={}));export{K as Graphics3DLineSymbolLayer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}