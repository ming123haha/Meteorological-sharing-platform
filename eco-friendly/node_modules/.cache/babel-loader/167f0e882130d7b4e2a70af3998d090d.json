{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../chunks/tslib.es6.js\";\nimport e from \"../../core/Accessor.js\";\nimport r from \"../../core/Collection.js\";\nimport { property as o } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { subclass as s } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { WatchUpdatingTracking as i } from \"../../core/support/WatchUpdatingTracking.js\";\nimport \"../../libs/maquette/projection.js\";\nimport { createProjector as n } from \"../../libs/maquette/projector.js\";\nlet a = class extends e {\n  constructor() {\n    super(...arguments), this.items = new r(), this._watchUpdatingTracking = new i(), this._callbacks = new Map(), this._projector = n(), this._hiddenProjector = n();\n  }\n\n  get needsRender() {\n    return this.items.length > 0;\n  }\n\n  get updating() {\n    return this._watchUpdatingTracking?.updating ?? !1;\n  }\n\n  initialize() {\n    const t = document.createElement(\"div\");\n    t.className = \"esri-overlay-surface\", this._set(\"surface\", t), this._hiddenSurface = document.createElement(\"div\"), this._hiddenSurface.setAttribute(\"style\", \"visibility: hidden;\"), t.appendChild(this._hiddenSurface), this._watchUpdatingTracking.addOnCollectionChange(() => this.items, t => {\n      for (const e of t.added) {\n        const t = () => e.render();\n\n        this._callbacks.set(e, t), this._projector.append(this.surface, t);\n      }\n\n      for (const e of t.removed) {\n        const t = this._projector.detach(this._callbacks.get(e));\n\n        this.surface.removeChild(t.domNode), this._callbacks.delete(e);\n      }\n    });\n  }\n\n  addItem(t) {\n    this.items.add(t);\n  }\n\n  removeItem(t) {\n    this.items.remove(t);\n  }\n\n  destroy() {\n    this.items.removeAll(), this._callbacks.forEach(t => this._projector.detach(t)), this._callbacks = null, this._projector = null, this._watchUpdatingTracking.destroy();\n  }\n\n  render() {\n    this._projector.renderNow();\n  }\n\n  computeBoundingRect(t) {\n    const e = this._hiddenSurface,\n          r = this._hiddenProjector;\n    let o = null;\n\n    const s = () => (o = t.render(), o);\n\n    r.append(e, s), r.renderNow();\n    const i = {\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0\n    };\n\n    if (o && o.domNode) {\n      const t = o.domNode.getBoundingClientRect();\n      i.left = t.left, i.top = t.top, i.right = t.right, i.bottom = t.bottom;\n    }\n\n    for (r.detach(s); e.firstChild;) e.removeChild(e.firstChild);\n\n    return i;\n  }\n\n  overlaps(t, e) {\n    const r = this.computeBoundingRect(t),\n          o = this.computeBoundingRect(e);\n    return Math.max(r.left, o.left) <= Math.min(r.right, o.right) && Math.max(r.top, o.top) <= Math.min(r.bottom, o.bottom);\n  }\n\n  get hasVisibleItems() {\n    return this.items.some(t => t.visible);\n  }\n\n  async prepare() {\n    await document.fonts.load(this._fontString()).catch(() => {});\n  }\n\n  renderCanvas(t) {\n    if (!this.items.some(t => t.visible)) return;\n    const e = t.getContext(\"2d\");\n    e.save(), e.font = this._fontString(), this.items.forEach(t => {\n      e.save(), t.renderCanvas(e), e.restore();\n    }), e.restore();\n  }\n\n  _fontString() {\n    return `10px ${getComputedStyle(this.surface).fontFamily}`;\n  }\n\n};\nt([o({\n  readOnly: !0\n})], a.prototype, \"surface\", void 0), t([o({\n  readOnly: !0\n})], a.prototype, \"items\", void 0), t([o({\n  readOnly: !0\n})], a.prototype, \"needsRender\", null), t([o({\n  readOnly: !0\n})], a.prototype, \"_watchUpdatingTracking\", void 0), t([o({\n  readOnly: !0\n})], a.prototype, \"updating\", null), a = t([s(\"esri.views.overlay.ViewOverlay\")], a);\nconst c = a;\nexport { c as default };","map":{"version":3,"names":["_","t","e","r","property","o","subclass","s","WatchUpdatingTracking","i","createProjector","n","a","constructor","arguments","items","_watchUpdatingTracking","_callbacks","Map","_projector","_hiddenProjector","needsRender","length","updating","initialize","document","createElement","className","_set","_hiddenSurface","setAttribute","appendChild","addOnCollectionChange","added","render","set","append","surface","removed","detach","get","removeChild","domNode","delete","addItem","add","removeItem","remove","destroy","removeAll","forEach","renderNow","computeBoundingRect","left","top","right","bottom","getBoundingClientRect","firstChild","overlaps","Math","max","min","hasVisibleItems","some","visible","prepare","fonts","load","_fontString","catch","renderCanvas","getContext","save","font","restore","getComputedStyle","fontFamily","readOnly","prototype","c","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/overlay/ViewOverlay.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Accessor.js\";import r from\"../../core/Collection.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{WatchUpdatingTracking as i}from\"../../core/support/WatchUpdatingTracking.js\";import\"../../libs/maquette/projection.js\";import{createProjector as n}from\"../../libs/maquette/projector.js\";let a=class extends e{constructor(){super(...arguments),this.items=new r,this._watchUpdatingTracking=new i,this._callbacks=new Map,this._projector=n(),this._hiddenProjector=n()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const t=document.createElement(\"div\");t.className=\"esri-overlay-surface\",this._set(\"surface\",t),this._hiddenSurface=document.createElement(\"div\"),this._hiddenSurface.setAttribute(\"style\",\"visibility: hidden;\"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t)}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e)}}))}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext(\"2d\");e.save(),e.font=this._fontString(),this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore()})),e.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};t([o({readOnly:!0})],a.prototype,\"surface\",void 0),t([o({readOnly:!0})],a.prototype,\"items\",void 0),t([o({readOnly:!0})],a.prototype,\"needsRender\",null),t([o({readOnly:!0})],a.prototype,\"_watchUpdatingTracking\",void 0),t([o({readOnly:!0})],a.prototype,\"updating\",null),a=t([s(\"esri.views.overlay.ViewOverlay\")],a);const c=a;export{c as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}