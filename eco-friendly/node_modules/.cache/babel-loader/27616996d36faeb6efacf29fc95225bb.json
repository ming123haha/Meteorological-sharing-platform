{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport \"../../../geometry.js\";\nimport has from \"../../../core/has.js\";\nimport e from \"../../../core/Loadable.js\";\nimport { isSome as o } from \"../../../core/maybe.js\";\nimport { debounce as r } from \"../../../core/promiseUtils.js\";\nimport { open as s } from \"../../../core/workers/workers.js\";\nimport { property as i } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as n } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport a from \"../../../rest/support/FeatureSet.js\";\nimport c from \"../../../geometry/Extent.js\";\nlet u = class extends e {\n  constructor(t) {\n    super(t), this.type = \"csv\", this.refresh = r(async t => {\n      await this.load();\n      const {\n        extent: e,\n        timeExtent: o\n      } = await this._connection.invoke(\"refresh\", t);\n      return this.sourceJSON.extent = e, o && (this.sourceJSON.timeInfo.timeExtent = [o.start, o.end]), {\n        dataChanged: !0,\n        updates: {\n          extent: this.sourceJSON.extent,\n          timeInfo: this.sourceJSON.timeInfo\n        }\n      };\n    });\n  }\n\n  load(t) {\n    const e = o(t) ? t.signal : null;\n    return this.addResolvingPromise(this._startWorker(e)), Promise.resolve(this);\n  }\n\n  destroy() {\n    this._connection?.close(), this._connection = null;\n  }\n\n  async openPorts() {\n    return await this.load(), this._connection.openPorts();\n  }\n\n  async queryFeatures(t, e = {}) {\n    await this.load(e);\n    const o = await this._connection.invoke(\"queryFeatures\", t ? t.toJSON() : null, e);\n    return a.fromJSON(o);\n  }\n\n  async queryFeaturesJSON(t, e = {}) {\n    return await this.load(e), this._connection.invoke(\"queryFeatures\", t ? t.toJSON() : null, e);\n  }\n\n  async queryFeatureCount(t, e = {}) {\n    return await this.load(e), this._connection.invoke(\"queryFeatureCount\", t ? t.toJSON() : null, e);\n  }\n\n  async queryObjectIds(t, e = {}) {\n    return await this.load(e), this._connection.invoke(\"queryObjectIds\", t ? t.toJSON() : null, e);\n  }\n\n  async queryExtent(t, e = {}) {\n    await this.load(e);\n    const o = await this._connection.invoke(\"queryExtent\", t ? t.toJSON() : null, e);\n    return {\n      count: o.count,\n      extent: c.fromJSON(o.extent)\n    };\n  }\n\n  async querySnapping(t, e = {}) {\n    return await this.load(e), this._connection.invoke(\"querySnapping\", t, e);\n  }\n\n  async _startWorker(t) {\n    this._connection = await s(\"CSVSourceWorker\", {\n      strategy: has(\"feature-layers-workers\") ? \"dedicated\" : \"local\",\n      signal: t\n    });\n    const {\n      url: e,\n      delimiter: o,\n      fields: r,\n      latitudeField: i,\n      longitudeField: n,\n      spatialReference: a,\n      timeInfo: c\n    } = this.loadOptions,\n          u = await this._connection.invoke(\"load\", {\n      url: e,\n      customParameters: this.customParameters,\n      parsingOptions: {\n        delimiter: o,\n        fields: r?.map(t => t.toJSON()),\n        latitudeField: i,\n        longitudeField: n,\n        spatialReference: a?.toJSON(),\n        timeInfo: c?.toJSON()\n      }\n    }, {\n      signal: t\n    });\n    this.locationInfo = u.locationInfo, this.sourceJSON = u.layerDefinition, this.delimiter = u.delimiter;\n  }\n\n};\nt([i()], u.prototype, \"type\", void 0), t([i()], u.prototype, \"loadOptions\", void 0), t([i()], u.prototype, \"customParameters\", void 0), t([i()], u.prototype, \"locationInfo\", void 0), t([i()], u.prototype, \"sourceJSON\", void 0), t([i()], u.prototype, \"delimiter\", void 0), u = t([n(\"esri.layers.graphics.sources.CSVSource\")], u);\nexport { u as CSVSource };","map":{"version":3,"names":["_","t","has","e","isSome","o","debounce","r","open","s","property","i","subclass","n","a","c","u","constructor","type","refresh","load","extent","timeExtent","_connection","invoke","sourceJSON","timeInfo","start","end","dataChanged","updates","signal","addResolvingPromise","_startWorker","Promise","resolve","destroy","close","openPorts","queryFeatures","toJSON","fromJSON","queryFeaturesJSON","queryFeatureCount","queryObjectIds","queryExtent","count","querySnapping","strategy","url","delimiter","fields","latitudeField","longitudeField","spatialReference","loadOptions","customParameters","parsingOptions","map","locationInfo","layerDefinition","prototype","CSVSource"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/graphics/sources/CSVSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import has from\"../../../core/has.js\";import e from\"../../../core/Loadable.js\";import{isSome as o}from\"../../../core/maybe.js\";import{debounce as r}from\"../../../core/promiseUtils.js\";import{open as s}from\"../../../core/workers/workers.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../rest/support/FeatureSet.js\";import c from\"../../../geometry/Extent.js\";let u=class extends e{constructor(t){super(t),this.type=\"csv\",this.refresh=r((async t=>{await this.load();const{extent:e,timeExtent:o}=await this._connection.invoke(\"refresh\",t);return this.sourceJSON.extent=e,o&&(this.sourceJSON.timeInfo.timeExtent=[o.start,o.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}}))}load(t){const e=o(t)?t.signal:null;return this.addResolvingPromise(this._startWorker(e)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}async openPorts(){return await this.load(),this._connection.openPorts()}async queryFeatures(t,e={}){await this.load(e);const o=await this._connection.invoke(\"queryFeatures\",t?t.toJSON():null,e);return a.fromJSON(o)}async queryFeaturesJSON(t,e={}){return await this.load(e),this._connection.invoke(\"queryFeatures\",t?t.toJSON():null,e)}async queryFeatureCount(t,e={}){return await this.load(e),this._connection.invoke(\"queryFeatureCount\",t?t.toJSON():null,e)}async queryObjectIds(t,e={}){return await this.load(e),this._connection.invoke(\"queryObjectIds\",t?t.toJSON():null,e)}async queryExtent(t,e={}){await this.load(e);const o=await this._connection.invoke(\"queryExtent\",t?t.toJSON():null,e);return{count:o.count,extent:c.fromJSON(o.extent)}}async querySnapping(t,e={}){return await this.load(e),this._connection.invoke(\"querySnapping\",t,e)}async _startWorker(t){this._connection=await s(\"CSVSourceWorker\",{strategy:has(\"feature-layers-workers\")?\"dedicated\":\"local\",signal:t});const{url:e,delimiter:o,fields:r,latitudeField:i,longitudeField:n,spatialReference:a,timeInfo:c}=this.loadOptions,u=await this._connection.invoke(\"load\",{url:e,customParameters:this.customParameters,parsingOptions:{delimiter:o,fields:r?.map((t=>t.toJSON())),latitudeField:i,longitudeField:n,spatialReference:a?.toJSON(),timeInfo:c?.toJSON()}},{signal:t});this.locationInfo=u.locationInfo,this.sourceJSON=u.layerDefinition,this.delimiter=u.delimiter}};t([i()],u.prototype,\"type\",void 0),t([i()],u.prototype,\"loadOptions\",void 0),t([i()],u.prototype,\"customParameters\",void 0),t([i()],u.prototype,\"locationInfo\",void 0),t([i()],u.prototype,\"sourceJSON\",void 0),t([i()],u.prototype,\"delimiter\",void 0),u=t([n(\"esri.layers.graphics.sources.CSVSource\")],u);export{u as CSVSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}