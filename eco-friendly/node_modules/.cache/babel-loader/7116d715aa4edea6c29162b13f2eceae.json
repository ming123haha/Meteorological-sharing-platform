{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport r from \"../../../core/Accessor.js\";\nimport t from \"../../../core/Evented.js\";\nimport s from \"../../../core/Handles.js\";\nimport { someMap as i } from \"../../../core/MapUtils.js\";\nimport { releaseMaybe as o, disposeMaybe as a, isSome as n, isNone as d, unwrapOr as h } from \"../../../core/maybe.js\";\nimport c from \"../../../core/PooledArray.js\";\nimport { watch as l, syncAndInitial as u, on as p } from \"../../../core/reactiveUtils.js\";\nimport { someSet as _ } from \"../../../core/SetUtils.js\";\nimport { property as g } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as m } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { q as y, f as R } from \"../../../chunks/mat4.js\";\nimport { f as T } from \"../../../chunks/vec3f64.js\";\nimport { ViewingMode as f } from \"../../ViewingMode.js\";\nimport { DrapeTargetType as b, DrapeSourceType as S } from \"../layers/interfaces.js\";\nimport w from \"../support/debugFlags.js\";\nimport { OverlayIndex as v, RenderTargetType as x } from \"./interfaces.js\";\nimport { Overlay as O } from \"./Overlay.js\";\nimport { OverlayFramebufferObject as D } from \"./OverlayFramebufferObject.js\";\nimport { OverlayRenderTarget as j } from \"./OverlayRenderTarget.js\";\nimport { ShaderTechniqueRepository as E } from \"../webgl-engine/core/shaderTechnique/ShaderTechniqueRepository.js\";\nimport { autoDispose as A, AutoDisposableMixin as P } from \"../webgl-engine/lib/AutoDisposable.js\";\nimport { TransparencyPassType as C, UpdatePolicy as F } from \"../webgl-engine/lib/basicInterfaces.js\";\nimport { Camera as M } from \"../webgl-engine/lib/Camera.js\";\nimport { GLMaterialRepository as q } from \"../webgl-engine/lib/GLMaterialRepository.js\";\nimport { createEmptyDepthTexture as I, createQuadVAO as U } from \"../webgl-engine/lib/glUtil3D.js\";\nimport { GridLocalOriginFactory as W } from \"../webgl-engine/lib/GridLocalOriginFactory.js\";\nimport { RenderOccludedFlag as L } from \"../webgl-engine/lib/Material.js\";\nimport { OverlayRenderContext as V } from \"../webgl-engine/lib/RenderContext.js\";\nimport { RenderPass as H } from \"../webgl-engine/lib/RenderPass.js\";\nimport { RenderSlot as B } from \"../webgl-engine/lib/RenderSlot.js\";\nimport { ShadowMap as N } from \"../webgl-engine/lib/ShadowMap.js\";\nimport { SortedRenderGeometryRenderer as k } from \"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";\nimport { SSAOHelper as G } from \"../webgl-engine/lib/SSAOHelper.js\";\nimport { TextureTechnique as z } from \"../webgl-engine/lib/TextureTechnique.js\";\nimport { TextureTechniqueConfiguration as Y } from \"../webgl-engine/lib/TextureTechniqueConfiguration.js\";\nimport { AmbientLight as X } from \"../webgl-engine/lighting/Lightsources.js\";\nimport { StippleTextureRepository as Q } from \"../webgl-engine/materials/StippleTextureRepository.js\";\nimport { AlphaMode as J, CompositingFunction as K } from \"../webgl-engine/shaders/CompositingTechniqueConfiguration.js\";\nimport { ImmediateTask as Z, TaskPriority as $, noBudget as ee } from \"../../support/Scheduler.js\";\nimport { ClearBufferBit as re, PrimitiveType as te, TextureType as se, PixelFormat as ie, PixelType as oe, TextureSamplingMode as ae } from \"../../webgl/enums.js\";\nimport { Texture as ne } from \"../../webgl/Texture.js\";\nimport { vertexCount as de } from \"../../webgl/Util.js\";\nlet he = class extends P(r) {\n  constructor(e) {\n    super(e), this._overlays = null, this._overlayRenderTarget = null, this._hasHighlights = !1, this._rendersOccluded = !1, this._hasWater = !1, this._handles = new s(), this._frameTask = Z, this._drapeSourceRenderers = new Map(), this._sortedDrapeSourceRenderersDirty = !1, this._sortedDrapeSourceRenderers = new c(), this._rctx = null, this._materialRepository = null, this._screenToWorldRatio = 1, this._localOriginFactory = null, this.worldToPCSRatio = 1, this.events = new t(), this.longitudeCyclical = null;\n  }\n\n  get _bindParameters() {\n    return this._renderContext.bindParameters;\n  }\n\n  get rctx() {\n    return this._rctx;\n  }\n\n  get materialRepository() {\n    return this._materialRepository;\n  }\n\n  get screenToWorldRatio() {\n    return this._screenToWorldRatio;\n  }\n\n  get localOriginFactory() {\n    return this._localOriginFactory;\n  }\n\n  initialize() {\n    const e = this.view._stage.renderView;\n    this._rctx = e.renderingContext;\n    const r = e.waterTextureRepository;\n    this._stippleTextureRepository = new Q(e.renderingContext), this._shaderTechniqueRepository = new E({\n      rctx: this._rctx,\n      viewingMode: f.Local,\n      stippleTextureRepository: this._stippleTextureRepository,\n      waterTextureRepository: r\n    }), this._renderContext = new V(this._rctx, new N(this._rctx, this.view.state.viewingMode), new G(this._shaderTechniqueRepository, this._rctx, () => {})), this._handles.add([l(() => r.updating, () => this.events.emit(\"content-changed\"), u), l(() => this.spatialReference, e => this._localOriginFactory = new W(e), u), p(() => this.view.allLayerViews, \"after-changes\", () => this._sortedDrapeSourceRenderersDirty = !0)]), this._materialRepository = new q(e.textureRepository, this._shaderTechniqueRepository, e => {\n      (e.renderOccluded & ge) > 0 !== this._rendersOccluded && this._updateRendersOccluded(), this.events.emit(\"content-changed\"), this.notifyChange(\"updating\");\n    }, () => this.events.emit(\"content-changed\")), this._bindParameters.slot = B.DRAPED_MATERIAL, this._bindParameters.highlightDepthTexture = I(this._rctx), this._bindParameters.camera = pe, this._bindParameters.transparencyPassType = C.NONE, this._bindParameters.lighting.groundLightingFactor = 1, this._bindParameters.lighting.globalFactor = 0, this._bindParameters.lighting.set([new X(T(1, 1, 1))]), this._frameTask = this.view.resourceController.scheduler.registerTask($.STAGE, this), this._handles.add(this._frameTask);\n  }\n\n  dispose() {\n    this._handles.destroy(), this._drapeSourceRenderers.forEach(e => e.destroy()), this._drapeSourceRenderers.clear(), this._debugTextureTechnique = o(this._debugTextureTechnique), this._debugPatternTexture = a(this._debugPatternTexture), this._bindParameters.highlightDepthTexture = a(this._bindParameters.highlightDepthTexture), this._shaderTechniqueRepository = a(this._shaderTechniqueRepository), this._temporaryFBO = a(this._temporaryFBO), this._quadVAO = a(this._quadVAO), this.disposeOverlays();\n  }\n\n  get updating() {\n    return this._sortedDrapeSourceRenderersDirty || this._frameTask.updating || i(this._drapeSourceRenderers, e => e.updating);\n  }\n\n  get hasOverlays() {\n    return n(this._overlays) && n(this._overlayRenderTarget);\n  }\n\n  get gpuMemoryUsage() {\n    return n(this._overlayRenderTarget) ? this._overlayRenderTarget.gpuMemoryUsage : 0;\n  }\n\n  createGeometryDrapeSourceRenderer(e) {\n    return this.createDrapeSourceRenderer(e, k);\n  }\n\n  createDrapeSourceRenderer(e, r, t) {\n    const s = this._drapeSourceRenderers.get(e);\n\n    n(s) && s.destroy();\n    const i = new r({ ...t,\n      rendererContext: this,\n      drapeSource: e\n    });\n    return this._drapeSourceRenderers.set(e, i), this._sortedDrapeSourceRenderersDirty = !0, \"fullOpacity\" in e && this._handles.add(l(() => e.fullOpacity, () => this.events.emit(\"content-changed\")), e), i;\n  }\n\n  removeDrapeSourceRenderer(e) {\n    if (d(e)) return;\n\n    const r = this._drapeSourceRenderers.get(e);\n\n    d(r) || (this._sortedDrapeSourceRenderersDirty = !0, this._drapeSourceRenderers.delete(e), this._handles.remove(e), r.destroy());\n  }\n\n  collectUnusedRenderTargetMemory(e) {\n    let r = !1;\n    if (n(this._overlayRenderTarget)) for (const t of this._overlayRenderTarget.renderTargets) {\n      const s = this.overlays[0].validTargets[t.type] || !this.overlays[1].validTargets[t.type];\n      r = this._overlayRenderTarget.validateUsageForTarget(s, t, e) || r;\n    }\n    return r;\n  }\n\n  get overlays() {\n    return h(this._overlays, []);\n  }\n\n  ensureDrapeTargets(e) {\n    n(this._overlays) && this._overlays.forEach(r => {\n      r.hasTargetWithoutRasterImage = _(e, e => e.drapeTargetType === b.WithoutRasterImage);\n    });\n  }\n\n  ensureDrapeSources(e) {\n    n(this._overlays) && this._overlays.forEach(r => {\n      r.hasDrapedFeatureSource = _(e, e => e.drapeSourceType === S.Features), r.hasDrapedRasterSource = _(e, e => e.drapeSourceType === S.RasterImage);\n    });\n  }\n\n  ensureOverlays(e, r) {\n    d(this._overlays) && (this._overlayRenderTarget = new j(this._rctx), this._overlays = [new O(v.INNER, this._overlayRenderTarget), new O(v.OUTER, this._overlayRenderTarget)]), this.ensureDrapeTargets(e), this.ensureDrapeSources(r);\n  }\n\n  disposeOverlays() {\n    this._overlays = null, this._overlayRenderTarget = a(this._overlayRenderTarget), this.events.emit(\"textures-disposed\");\n  }\n\n  get running() {\n    return this.updating;\n  }\n\n  runTask(e, r = () => !0) {\n    this._frameTask.processQueue(e), e.done || this._processDrapeSources(e, r);\n  }\n\n  _processDrapeSources(e, r) {\n    let t = !1;\n\n    for (const [s, i] of this._drapeSourceRenderers) {\n      if (e.done) break;\n      (s.destroyed || r(s)) && i.commitChanges() && (t = !0, e.madeProgress());\n    }\n\n    this._updateSortedDrapeSourceRenderers(), t && (n(this._overlays) && 0 === this._drapeSourceRenderers.size && this.disposeOverlays(), this.notifyChange(\"updating\"), this.events.emit(\"content-changed\"), this._updateHasHighlights(), this._updateRendersOccluded(), this._updateHasWater());\n  }\n\n  processSyncDrapeSources() {\n    this._processDrapeSources(ee, e => e.updatePolicy === F.SYNC);\n  }\n\n  isEmpty() {\n    if (w.OVERLAY_DRAW_DEBUG_TEXTURE) return !1;\n\n    for (const e of this._drapeSourceRenderers.values()) if (!e.isEmpty) return !1;\n\n    return !0;\n  }\n\n  get hasHighlights() {\n    return this._hasHighlights;\n  }\n\n  get hasWater() {\n    return this._hasWater;\n  }\n\n  get rendersOccluded() {\n    return this._rendersOccluded;\n  }\n\n  updateAnimation(e) {\n    let r = !1;\n    return this._drapeSourceRenderers.forEach(t => r = t.updateAnimation(e) || r), r;\n  }\n\n  updateDrapeSourceOrder() {\n    this._sortedDrapeSourceRenderersDirty = !0;\n  }\n\n  drawTarget(e, r, t) {\n    const s = e.canvasGeometries;\n    if (0 === s.numViews) return !1;\n    this._screenToWorldRatio = t * e.mapUnitsPerPixel;\n    const i = r.renderPass;\n    if (this.isEmpty() || i === H.MATERIAL_HIGHLIGHT && !this.hasHighlights || i === H.MATERIAL_NORMAL && !this.hasWater || !e.hasSomeSizedView()) return !1;\n    const o = r.fbo;\n    if (!o.isValid()) return !1;\n    const a = 2 * e.resolution,\n          d = e.resolution;\n    o.resize(a, d);\n    const h = this._rctx;\n    pe.pixelRatio = e.pixelRatio * t, this._renderContext.pass = i, this._bindParameters.screenToWorldRatio = this._screenToWorldRatio, this._bindParameters.screenToPCSRatio = this._screenToWorldRatio * this.worldToPCSRatio, this._bindParameters.slot = i === H.MATERIAL_NORMAL ? B.DRAPED_WATER : B.DRAPED_MATERIAL, e.applyViewport(this._rctx), o.bind(h), e.index === v.INNER && (h.setClearColor(0, 0, 0, 0), h.clearSafe(re.COLOR_BUFFER_BIT));\n    const c = r.type === x.ColorNoRasterImage ? ce.ExcludeRasterImage : r.type === x.Occluded ? ce.OccludedOnly : ce.Normal;\n    if (c === ce.OccludedOnly && (this._renderContext.renderOccludedMask = ge), w.OVERLAY_DRAW_DEBUG_TEXTURE && c !== ce.OccludedOnly) for (let n = 0; n < s.numViews; n++) this._setViewParameters(s.extents[n], e, pe), this._drawDebugTexture(e.resolution, ue[e.index]);\n    return this._drapeSourceRenderers.size > 0 && this._sortedDrapeSourceRenderers.forAll(({\n      drapeSource: r,\n      renderer: t\n    }) => {\n      if (c === ce.ExcludeRasterImage && r.drapeSourceType === S.RasterImage) return;\n      const {\n        fullOpacity: l\n      } = r,\n            u = n(l) && l < 1 && i === H.MATERIAL;\n      u && (this.bindTemporaryFramebuffer(this._rctx, a, d), h.clearSafe(re.COLOR_BUFFER_BIT));\n\n      for (let i = 0; i < s.numViews; i++) this._setViewParameters(s.extents[i], e, pe), t.render(this._renderContext, this._bindParameters);\n\n      u && n(this._temporaryFBO) && (o.bind(h), this.view._stage.renderView.compositingHelper.composite(this._renderContext.bindParameters, this._temporaryFBO.getTexture(), J.PremultipliedAlpha, l, K.OverlayWithTransparency, e.index));\n    }), h.bindFramebuffer(null), o.generateMipMap(), this._renderContext.resetRenderOccludedMask(), !0;\n  }\n\n  bindTemporaryFramebuffer(e, r, t) {\n    d(this._temporaryFBO) && (this._temporaryFBO = new D(e, !1)), this._temporaryFBO.resize(r, t), this._temporaryFBO.bind(e);\n  }\n\n  async reloadShaders() {\n    await this._shaderTechniqueRepository.reloadAll();\n  }\n\n  notifyContentChanged() {\n    this.events.emit(\"content-changed\");\n  }\n\n  intersect(e, r, t, s) {\n    let i = 0;\n\n    for (const o of this._drapeSourceRenderers.values()) i = o.intersect?.(e, r, t, s, i) ?? i;\n  }\n\n  _updateSortedDrapeSourceRenderers() {\n    if (!this._sortedDrapeSourceRenderersDirty) return;\n    if (this._sortedDrapeSourceRenderersDirty = !1, this._sortedDrapeSourceRenderers.clear(), 0 === this._drapeSourceRenderers.size) return;\n    const e = this.view.map.allLayers;\n    this._drapeSourceRenderers.forEach((r, t) => {\n      const s = e.indexOf(t.layer);\n\n      this._sortedDrapeSourceRenderers.push(new le(t, r, s < 0 ? 1 / 0 : s));\n    }), this._sortedDrapeSourceRenderers.sort((e, r) => e.index - r.index);\n  }\n\n  _setViewParameters(e, r, t) {\n    t.viewport[0] = t.viewport[1] = 0, t.viewport[2] = t.viewport[3] = r.resolution, y(t.projectionMatrix, 0, e[2] - e[0], 0, e[3] - e[1], t.near, t.far), R(t.viewMatrix, [-e[0], -e[1], 0]), this._bindParameters.camera = t;\n  }\n\n  _updateHasWater() {\n    const e = i(this._drapeSourceRenderers, e => e.hasWater);\n    e !== this._hasWater && (this._hasWater = e, this.events.emit(\"has-water\", e));\n  }\n\n  _updateHasHighlights() {\n    const e = i(this._drapeSourceRenderers, e => e.hasHighlights);\n    e !== this._hasHighlights && (this._hasHighlights = e, this.events.emit(\"has-highlights\", e));\n  }\n\n  _updateRendersOccluded() {\n    const e = i(this._drapeSourceRenderers, e => e.rendersOccluded);\n    e !== this._rendersOccluded && (this._rendersOccluded = e, this.events.emit(\"renders-occluded\", e));\n  }\n\n  _drawDebugTexture(e, r) {\n    this._ensureDebugPatternResources(e, e);\n\n    const t = this._rctx,\n          s = t.bindTechnique(this._debugTextureTechnique);\n    s.setUniform4f(\"uColor\", r[0], r[1], r[2], 1), s.bindTexture(\"tex\", this._debugPatternTexture), t.bindVAO(this._quadVAO), t.drawArrays(te.TRIANGLE_STRIP, 0, de(this._quadVAO, \"geometry\"));\n  }\n\n  _ensureDebugPatternResources(e, r) {\n    if (this._debugPatternTexture) return;\n    const t = new Uint8Array(e * r * 4);\n    let s = 0;\n\n    for (let o = 0; o < r; o++) for (let i = 0; i < e; i++) {\n      const a = Math.floor(i / 10),\n            n = Math.floor(o / 10);\n      a < 2 || n < 2 || 10 * a > e - 20 || 10 * n > r - 20 ? (t[s++] = 255, t[s++] = 255, t[s++] = 255, t[s++] = 255) : (t[s++] = 255, t[s++] = 255, t[s++] = 255, t[s++] = 1 & a && 1 & n ? 1 & i ^ 1 & o ? 0 : 255 : 1 & a ^ 1 & n ? 0 : 128);\n    }\n\n    this._debugPatternTexture = new ne(this._rctx, {\n      target: se.TEXTURE_2D,\n      pixelFormat: ie.RGBA,\n      dataType: oe.UNSIGNED_BYTE,\n      samplingMode: ae.NEAREST,\n      width: e,\n      height: r\n    }, t);\n    const i = new Y();\n    i.hasAlpha = !0, this._debugTextureTechnique = this._shaderTechniqueRepository.acquire(z, i), this._quadVAO = U(this._rctx);\n  }\n\n  get test() {\n    return {\n      drapeSourceRenderers: this._drapeSourceRenderers,\n      getDrapeSourceRenderer: e => this._drapeSourceRenderers.get(e)\n    };\n  }\n\n};\nvar ce;\ne([g()], he.prototype, \"_frameTask\", void 0), e([g()], he.prototype, \"_sortedDrapeSourceRenderersDirty\", void 0), e([A()], he.prototype, \"_shaderTechniqueRepository\", void 0), e([A()], he.prototype, \"_stippleTextureRepository\", void 0), e([g({\n  constructOnly: !0\n})], he.prototype, \"view\", void 0), e([g()], he.prototype, \"worldToPCSRatio\", void 0), e([g()], he.prototype, \"spatialReference\", void 0), e([g({\n  type: Boolean,\n  readOnly: !0\n})], he.prototype, \"updating\", null), he = e([m(\"esri.views.3d.terrain.OverlayRenderer\")], he), function (e) {\n  e[e.Normal = 0] = \"Normal\", e[e.OccludedOnly = 1] = \"OccludedOnly\", e[e.ExcludeRasterImage = 2] = \"ExcludeRasterImage\";\n}(ce || (ce = {}));\n\nclass le {\n  constructor(e, r, t) {\n    this.drapeSource = e, this.renderer = r, this.index = t;\n  }\n\n}\n\nconst ue = [[1, .5, .5], [.5, .5, 1]],\n      pe = new M();\npe.near = 1, pe.far = 1e4, pe.relativeElevation = null;\n\nconst _e = -2,\n      ge = L.OccludeAndTransparent;\n\nexport { _e as DRAPED_Z, ce as DrawPassOption, he as OverlayRenderer, ge as overlayRenderOccludedFlag };","map":{"version":3,"names":["_","e","r","t","s","someMap","i","releaseMaybe","o","disposeMaybe","a","isSome","n","isNone","d","unwrapOr","h","c","watch","l","syncAndInitial","u","on","p","someSet","property","g","subclass","m","q","y","f","R","T","ViewingMode","DrapeTargetType","b","DrapeSourceType","S","w","OverlayIndex","v","RenderTargetType","x","Overlay","O","OverlayFramebufferObject","D","OverlayRenderTarget","j","ShaderTechniqueRepository","E","autoDispose","A","AutoDisposableMixin","P","TransparencyPassType","C","UpdatePolicy","F","Camera","M","GLMaterialRepository","createEmptyDepthTexture","I","createQuadVAO","U","GridLocalOriginFactory","W","RenderOccludedFlag","L","OverlayRenderContext","V","RenderPass","H","RenderSlot","B","ShadowMap","N","SortedRenderGeometryRenderer","k","SSAOHelper","G","TextureTechnique","z","TextureTechniqueConfiguration","Y","AmbientLight","X","StippleTextureRepository","Q","AlphaMode","J","CompositingFunction","K","ImmediateTask","Z","TaskPriority","$","noBudget","ee","ClearBufferBit","re","PrimitiveType","te","TextureType","se","PixelFormat","ie","PixelType","oe","TextureSamplingMode","ae","Texture","ne","vertexCount","de","he","constructor","_overlays","_overlayRenderTarget","_hasHighlights","_rendersOccluded","_hasWater","_handles","_frameTask","_drapeSourceRenderers","Map","_sortedDrapeSourceRenderersDirty","_sortedDrapeSourceRenderers","_rctx","_materialRepository","_screenToWorldRatio","_localOriginFactory","worldToPCSRatio","events","longitudeCyclical","_bindParameters","_renderContext","bindParameters","rctx","materialRepository","screenToWorldRatio","localOriginFactory","initialize","view","_stage","renderView","renderingContext","waterTextureRepository","_stippleTextureRepository","_shaderTechniqueRepository","viewingMode","Local","stippleTextureRepository","state","add","updating","emit","spatialReference","allLayerViews","textureRepository","renderOccluded","ge","_updateRendersOccluded","notifyChange","slot","DRAPED_MATERIAL","highlightDepthTexture","camera","pe","transparencyPassType","NONE","lighting","groundLightingFactor","globalFactor","set","resourceController","scheduler","registerTask","STAGE","dispose","destroy","forEach","clear","_debugTextureTechnique","_debugPatternTexture","_temporaryFBO","_quadVAO","disposeOverlays","hasOverlays","gpuMemoryUsage","createGeometryDrapeSourceRenderer","createDrapeSourceRenderer","get","rendererContext","drapeSource","fullOpacity","removeDrapeSourceRenderer","delete","remove","collectUnusedRenderTargetMemory","renderTargets","overlays","validTargets","type","validateUsageForTarget","ensureDrapeTargets","hasTargetWithoutRasterImage","drapeTargetType","WithoutRasterImage","ensureDrapeSources","hasDrapedFeatureSource","drapeSourceType","Features","hasDrapedRasterSource","RasterImage","ensureOverlays","INNER","OUTER","running","runTask","processQueue","done","_processDrapeSources","destroyed","commitChanges","madeProgress","_updateSortedDrapeSourceRenderers","size","_updateHasHighlights","_updateHasWater","processSyncDrapeSources","updatePolicy","SYNC","isEmpty","OVERLAY_DRAW_DEBUG_TEXTURE","values","hasHighlights","hasWater","rendersOccluded","updateAnimation","updateDrapeSourceOrder","drawTarget","canvasGeometries","numViews","mapUnitsPerPixel","renderPass","MATERIAL_HIGHLIGHT","MATERIAL_NORMAL","hasSomeSizedView","fbo","isValid","resolution","resize","pixelRatio","pass","screenToPCSRatio","DRAPED_WATER","applyViewport","bind","index","setClearColor","clearSafe","COLOR_BUFFER_BIT","ColorNoRasterImage","ce","ExcludeRasterImage","Occluded","OccludedOnly","Normal","renderOccludedMask","_setViewParameters","extents","_drawDebugTexture","ue","forAll","renderer","MATERIAL","bindTemporaryFramebuffer","render","compositingHelper","composite","getTexture","PremultipliedAlpha","OverlayWithTransparency","bindFramebuffer","generateMipMap","resetRenderOccludedMask","reloadShaders","reloadAll","notifyContentChanged","intersect","map","allLayers","indexOf","layer","push","le","sort","viewport","projectionMatrix","near","far","viewMatrix","_ensureDebugPatternResources","bindTechnique","setUniform4f","bindTexture","bindVAO","drawArrays","TRIANGLE_STRIP","Uint8Array","Math","floor","target","TEXTURE_2D","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","samplingMode","NEAREST","width","height","hasAlpha","acquire","test","drapeSourceRenderers","getDrapeSourceRenderer","prototype","constructOnly","Boolean","readOnly","relativeElevation","_e","OccludeAndTransparent","DRAPED_Z","DrawPassOption","OverlayRenderer","overlayRenderOccludedFlag"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Accessor.js\";import t from\"../../../core/Evented.js\";import s from\"../../../core/Handles.js\";import{someMap as i}from\"../../../core/MapUtils.js\";import{releaseMaybe as o,disposeMaybe as a,isSome as n,isNone as d,unwrapOr as h}from\"../../../core/maybe.js\";import c from\"../../../core/PooledArray.js\";import{watch as l,syncAndInitial as u,on as p}from\"../../../core/reactiveUtils.js\";import{someSet as _}from\"../../../core/SetUtils.js\";import{property as g}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as m}from\"../../../core/accessorSupport/decorators/subclass.js\";import{q as y,f as R}from\"../../../chunks/mat4.js\";import{f as T}from\"../../../chunks/vec3f64.js\";import{ViewingMode as f}from\"../../ViewingMode.js\";import{DrapeTargetType as b,DrapeSourceType as S}from\"../layers/interfaces.js\";import w from\"../support/debugFlags.js\";import{OverlayIndex as v,RenderTargetType as x}from\"./interfaces.js\";import{Overlay as O}from\"./Overlay.js\";import{OverlayFramebufferObject as D}from\"./OverlayFramebufferObject.js\";import{OverlayRenderTarget as j}from\"./OverlayRenderTarget.js\";import{ShaderTechniqueRepository as E}from\"../webgl-engine/core/shaderTechnique/ShaderTechniqueRepository.js\";import{autoDispose as A,AutoDisposableMixin as P}from\"../webgl-engine/lib/AutoDisposable.js\";import{TransparencyPassType as C,UpdatePolicy as F}from\"../webgl-engine/lib/basicInterfaces.js\";import{Camera as M}from\"../webgl-engine/lib/Camera.js\";import{GLMaterialRepository as q}from\"../webgl-engine/lib/GLMaterialRepository.js\";import{createEmptyDepthTexture as I,createQuadVAO as U}from\"../webgl-engine/lib/glUtil3D.js\";import{GridLocalOriginFactory as W}from\"../webgl-engine/lib/GridLocalOriginFactory.js\";import{RenderOccludedFlag as L}from\"../webgl-engine/lib/Material.js\";import{OverlayRenderContext as V}from\"../webgl-engine/lib/RenderContext.js\";import{RenderPass as H}from\"../webgl-engine/lib/RenderPass.js\";import{RenderSlot as B}from\"../webgl-engine/lib/RenderSlot.js\";import{ShadowMap as N}from\"../webgl-engine/lib/ShadowMap.js\";import{SortedRenderGeometryRenderer as k}from\"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";import{SSAOHelper as G}from\"../webgl-engine/lib/SSAOHelper.js\";import{TextureTechnique as z}from\"../webgl-engine/lib/TextureTechnique.js\";import{TextureTechniqueConfiguration as Y}from\"../webgl-engine/lib/TextureTechniqueConfiguration.js\";import{AmbientLight as X}from\"../webgl-engine/lighting/Lightsources.js\";import{StippleTextureRepository as Q}from\"../webgl-engine/materials/StippleTextureRepository.js\";import{AlphaMode as J,CompositingFunction as K}from\"../webgl-engine/shaders/CompositingTechniqueConfiguration.js\";import{ImmediateTask as Z,TaskPriority as $,noBudget as ee}from\"../../support/Scheduler.js\";import{ClearBufferBit as re,PrimitiveType as te,TextureType as se,PixelFormat as ie,PixelType as oe,TextureSamplingMode as ae}from\"../../webgl/enums.js\";import{Texture as ne}from\"../../webgl/Texture.js\";import{vertexCount as de}from\"../../webgl/Util.js\";let he=class extends(P(r)){constructor(e){super(e),this._overlays=null,this._overlayRenderTarget=null,this._hasHighlights=!1,this._rendersOccluded=!1,this._hasWater=!1,this._handles=new s,this._frameTask=Z,this._drapeSourceRenderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedDrapeSourceRenderers=new c,this._rctx=null,this._materialRepository=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.worldToPCSRatio=1,this.events=new t,this.longitudeCyclical=null}get _bindParameters(){return this._renderContext.bindParameters}get rctx(){return this._rctx}get materialRepository(){return this._materialRepository}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}initialize(){const e=this.view._stage.renderView;this._rctx=e.renderingContext;const r=e.waterTextureRepository;this._stippleTextureRepository=new Q(e.renderingContext),this._shaderTechniqueRepository=new E({rctx:this._rctx,viewingMode:f.Local,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:r}),this._renderContext=new V(this._rctx,new N(this._rctx,this.view.state.viewingMode),new G(this._shaderTechniqueRepository,this._rctx,(()=>{}))),this._handles.add([l((()=>r.updating),(()=>this.events.emit(\"content-changed\")),u),l((()=>this.spatialReference),(e=>this._localOriginFactory=new W(e)),u),p((()=>this.view.allLayerViews),\"after-changes\",(()=>this._sortedDrapeSourceRenderersDirty=!0))]),this._materialRepository=new q(e.textureRepository,this._shaderTechniqueRepository,(e=>{(e.renderOccluded&ge)>0!==this._rendersOccluded&&this._updateRendersOccluded(),this.events.emit(\"content-changed\"),this.notifyChange(\"updating\")}),(()=>this.events.emit(\"content-changed\"))),this._bindParameters.slot=B.DRAPED_MATERIAL,this._bindParameters.highlightDepthTexture=I(this._rctx),this._bindParameters.camera=pe,this._bindParameters.transparencyPassType=C.NONE,this._bindParameters.lighting.groundLightingFactor=1,this._bindParameters.lighting.globalFactor=0,this._bindParameters.lighting.set([new X(T(1,1,1))]),this._frameTask=this.view.resourceController.scheduler.registerTask($.STAGE,this),this._handles.add(this._frameTask)}dispose(){this._handles.destroy(),this._drapeSourceRenderers.forEach((e=>e.destroy())),this._drapeSourceRenderers.clear(),this._debugTextureTechnique=o(this._debugTextureTechnique),this._debugPatternTexture=a(this._debugPatternTexture),this._bindParameters.highlightDepthTexture=a(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=a(this._shaderTechniqueRepository),this._temporaryFBO=a(this._temporaryFBO),this._quadVAO=a(this._quadVAO),this.disposeOverlays()}get updating(){return this._sortedDrapeSourceRenderersDirty||this._frameTask.updating||i(this._drapeSourceRenderers,(e=>e.updating))}get hasOverlays(){return n(this._overlays)&&n(this._overlayRenderTarget)}get gpuMemoryUsage(){return n(this._overlayRenderTarget)?this._overlayRenderTarget.gpuMemoryUsage:0}createGeometryDrapeSourceRenderer(e){return this.createDrapeSourceRenderer(e,k)}createDrapeSourceRenderer(e,r,t){const s=this._drapeSourceRenderers.get(e);n(s)&&s.destroy();const i=new r({...t,rendererContext:this,drapeSource:e});return this._drapeSourceRenderers.set(e,i),this._sortedDrapeSourceRenderersDirty=!0,\"fullOpacity\"in e&&this._handles.add(l((()=>e.fullOpacity),(()=>this.events.emit(\"content-changed\"))),e),i}removeDrapeSourceRenderer(e){if(d(e))return;const r=this._drapeSourceRenderers.get(e);d(r)||(this._sortedDrapeSourceRenderersDirty=!0,this._drapeSourceRenderers.delete(e),this._handles.remove(e),r.destroy())}collectUnusedRenderTargetMemory(e){let r=!1;if(n(this._overlayRenderTarget))for(const t of this._overlayRenderTarget.renderTargets){const s=this.overlays[0].validTargets[t.type]||!this.overlays[1].validTargets[t.type];r=this._overlayRenderTarget.validateUsageForTarget(s,t,e)||r}return r}get overlays(){return h(this._overlays,[])}ensureDrapeTargets(e){n(this._overlays)&&this._overlays.forEach((r=>{r.hasTargetWithoutRasterImage=_(e,(e=>e.drapeTargetType===b.WithoutRasterImage))}))}ensureDrapeSources(e){n(this._overlays)&&this._overlays.forEach((r=>{r.hasDrapedFeatureSource=_(e,(e=>e.drapeSourceType===S.Features)),r.hasDrapedRasterSource=_(e,(e=>e.drapeSourceType===S.RasterImage))}))}ensureOverlays(e,r){d(this._overlays)&&(this._overlayRenderTarget=new j(this._rctx),this._overlays=[new O(v.INNER,this._overlayRenderTarget),new O(v.OUTER,this._overlayRenderTarget)]),this.ensureDrapeTargets(e),this.ensureDrapeSources(r)}disposeOverlays(){this._overlays=null,this._overlayRenderTarget=a(this._overlayRenderTarget),this.events.emit(\"textures-disposed\")}get running(){return this.updating}runTask(e,r=(()=>!0)){this._frameTask.processQueue(e),e.done||this._processDrapeSources(e,r)}_processDrapeSources(e,r){let t=!1;for(const[s,i]of this._drapeSourceRenderers){if(e.done)break;(s.destroyed||r(s))&&(i.commitChanges()&&(t=!0,e.madeProgress()))}this._updateSortedDrapeSourceRenderers(),t&&(n(this._overlays)&&0===this._drapeSourceRenderers.size&&this.disposeOverlays(),this.notifyChange(\"updating\"),this.events.emit(\"content-changed\"),this._updateHasHighlights(),this._updateRendersOccluded(),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources(ee,(e=>e.updatePolicy===F.SYNC))}isEmpty(){if(w.OVERLAY_DRAW_DEBUG_TEXTURE)return!1;for(const e of this._drapeSourceRenderers.values())if(!e.isEmpty)return!1;return!0}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return this._rendersOccluded}updateAnimation(e){let r=!1;return this._drapeSourceRenderers.forEach((t=>r=t.updateAnimation(e)||r)),r}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}drawTarget(e,r,t){const s=e.canvasGeometries;if(0===s.numViews)return!1;this._screenToWorldRatio=t*e.mapUnitsPerPixel;const i=r.renderPass;if(this.isEmpty()||i===H.MATERIAL_HIGHLIGHT&&!this.hasHighlights||i===H.MATERIAL_NORMAL&&!this.hasWater||!e.hasSomeSizedView())return!1;const o=r.fbo;if(!o.isValid())return!1;const a=2*e.resolution,d=e.resolution;o.resize(a,d);const h=this._rctx;pe.pixelRatio=e.pixelRatio*t,this._renderContext.pass=i,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,this._bindParameters.slot=i===H.MATERIAL_NORMAL?B.DRAPED_WATER:B.DRAPED_MATERIAL,e.applyViewport(this._rctx),o.bind(h),e.index===v.INNER&&(h.setClearColor(0,0,0,0),h.clearSafe(re.COLOR_BUFFER_BIT));const c=r.type===x.ColorNoRasterImage?ce.ExcludeRasterImage:r.type===x.Occluded?ce.OccludedOnly:ce.Normal;if(c===ce.OccludedOnly&&(this._renderContext.renderOccludedMask=ge),w.OVERLAY_DRAW_DEBUG_TEXTURE&&c!==ce.OccludedOnly)for(let n=0;n<s.numViews;n++)this._setViewParameters(s.extents[n],e,pe),this._drawDebugTexture(e.resolution,ue[e.index]);return this._drapeSourceRenderers.size>0&&this._sortedDrapeSourceRenderers.forAll((({drapeSource:r,renderer:t})=>{if(c===ce.ExcludeRasterImage&&r.drapeSourceType===S.RasterImage)return;const{fullOpacity:l}=r,u=n(l)&&l<1&&i===H.MATERIAL;u&&(this.bindTemporaryFramebuffer(this._rctx,a,d),h.clearSafe(re.COLOR_BUFFER_BIT));for(let i=0;i<s.numViews;i++)this._setViewParameters(s.extents[i],e,pe),t.render(this._renderContext,this._bindParameters);u&&n(this._temporaryFBO)&&(o.bind(h),this.view._stage.renderView.compositingHelper.composite(this._renderContext.bindParameters,this._temporaryFBO.getTexture(),J.PremultipliedAlpha,l,K.OverlayWithTransparency,e.index))})),h.bindFramebuffer(null),o.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}bindTemporaryFramebuffer(e,r,t){d(this._temporaryFBO)&&(this._temporaryFBO=new D(e,!1)),this._temporaryFBO.resize(r,t),this._temporaryFBO.bind(e)}async reloadShaders(){await this._shaderTechniqueRepository.reloadAll()}notifyContentChanged(){this.events.emit(\"content-changed\")}intersect(e,r,t,s){let i=0;for(const o of this._drapeSourceRenderers.values())i=o.intersect?.(e,r,t,s,i)??i}_updateSortedDrapeSourceRenderers(){if(!this._sortedDrapeSourceRenderersDirty)return;if(this._sortedDrapeSourceRenderersDirty=!1,this._sortedDrapeSourceRenderers.clear(),0===this._drapeSourceRenderers.size)return;const e=this.view.map.allLayers;this._drapeSourceRenderers.forEach(((r,t)=>{const s=e.indexOf(t.layer);this._sortedDrapeSourceRenderers.push(new le(t,r,s<0?1/0:s))})),this._sortedDrapeSourceRenderers.sort(((e,r)=>e.index-r.index))}_setViewParameters(e,r,t){t.viewport[0]=t.viewport[1]=0,t.viewport[2]=t.viewport[3]=r.resolution,y(t.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],t.near,t.far),R(t.viewMatrix,[-e[0],-e[1],0]),this._bindParameters.camera=t}_updateHasWater(){const e=i(this._drapeSourceRenderers,(e=>e.hasWater));e!==this._hasWater&&(this._hasWater=e,this.events.emit(\"has-water\",e))}_updateHasHighlights(){const e=i(this._drapeSourceRenderers,(e=>e.hasHighlights));e!==this._hasHighlights&&(this._hasHighlights=e,this.events.emit(\"has-highlights\",e))}_updateRendersOccluded(){const e=i(this._drapeSourceRenderers,(e=>e.rendersOccluded));e!==this._rendersOccluded&&(this._rendersOccluded=e,this.events.emit(\"renders-occluded\",e))}_drawDebugTexture(e,r){this._ensureDebugPatternResources(e,e);const t=this._rctx,s=t.bindTechnique(this._debugTextureTechnique);s.setUniform4f(\"uColor\",r[0],r[1],r[2],1),s.bindTexture(\"tex\",this._debugPatternTexture),t.bindVAO(this._quadVAO),t.drawArrays(te.TRIANGLE_STRIP,0,de(this._quadVAO,\"geometry\"))}_ensureDebugPatternResources(e,r){if(this._debugPatternTexture)return;const t=new Uint8Array(e*r*4);let s=0;for(let o=0;o<r;o++)for(let i=0;i<e;i++){const a=Math.floor(i/10),n=Math.floor(o/10);a<2||n<2||10*a>e-20||10*n>r-20?(t[s++]=255,t[s++]=255,t[s++]=255,t[s++]=255):(t[s++]=255,t[s++]=255,t[s++]=255,t[s++]=1&a&&1&n?1&i^1&o?0:255:1&a^1&n?0:128)}this._debugPatternTexture=new ne(this._rctx,{target:se.TEXTURE_2D,pixelFormat:ie.RGBA,dataType:oe.UNSIGNED_BYTE,samplingMode:ae.NEAREST,width:e,height:r},t);const i=new Y;i.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquire(z,i),this._quadVAO=U(this._rctx)}get test(){return{drapeSourceRenderers:this._drapeSourceRenderers,getDrapeSourceRenderer:e=>this._drapeSourceRenderers.get(e)}}};var ce;e([g()],he.prototype,\"_frameTask\",void 0),e([g()],he.prototype,\"_sortedDrapeSourceRenderersDirty\",void 0),e([A()],he.prototype,\"_shaderTechniqueRepository\",void 0),e([A()],he.prototype,\"_stippleTextureRepository\",void 0),e([g({constructOnly:!0})],he.prototype,\"view\",void 0),e([g()],he.prototype,\"worldToPCSRatio\",void 0),e([g()],he.prototype,\"spatialReference\",void 0),e([g({type:Boolean,readOnly:!0})],he.prototype,\"updating\",null),he=e([m(\"esri.views.3d.terrain.OverlayRenderer\")],he),function(e){e[e.Normal=0]=\"Normal\",e[e.OccludedOnly=1]=\"OccludedOnly\",e[e.ExcludeRasterImage=2]=\"ExcludeRasterImage\"}(ce||(ce={}));class le{constructor(e,r,t){this.drapeSource=e,this.renderer=r,this.index=t}}const ue=[[1,.5,.5],[.5,.5,1]],pe=new M;pe.near=1,pe.far=1e4,pe.relativeElevation=null;const _e=-2,ge=L.OccludeAndTransparent;export{_e as DRAPED_Z,ce as DrawPassOption,he as OverlayRenderer,ge as overlayRenderOccludedFlag};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}