{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { result as t, forEach as i } from \"../../../core/asyncUtils.js\";\nimport r from \"../../../core/Collection.js\";\nimport s from \"../../../core/Logger.js\";\nimport { unwrapOr as o, isSome as n, isNone as a, mapSome as d } from \"../../../core/maybe.js\";\nimport { eachAlways as l, isAbortError as h, eachAlwaysValues as u, throwIfAborted as p } from \"../../../core/promiseUtils.js\";\nimport { initial as c, watch as _, sync as m } from \"../../../core/reactiveUtils.js\";\nimport { pt2px as g } from \"../../../core/screenUtils.js\";\nimport { estimateSize as f, isArrayBuffer as y } from \"../../../core/typedArrayUtil.js\";\nimport { getMetersPerVerticalUnitForSR as b } from \"../../../core/unitUtils.js\";\nimport { property as w } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as N } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { e as P } from \"../../../chunks/vec3.js\";\nimport { a as x } from \"../../../chunks/vec3f32.js\";\nimport { projectBoundingRect as v } from \"../../../geometry/projection.js\";\nimport { create as C } from \"../../../geometry/support/aaBoundingBox.js\";\nimport { containsPoint as S, create as A } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { create as I, fromNormalAndOffset as k } from \"../../../geometry/support/plane.js\";\nimport { makeDehydratedPoint as V } from \"../../../layers/graphics/dehydratedFeatures.js\";\nimport { CodedValue as R } from \"../../../layers/support/CodedValue.js\";\nimport L from \"../../../layers/support/CodedValueDomain.js\";\nimport \"../../../layers/support/Domain.js\";\nimport \"../../../layers/support/InheritedDomain.js\";\nimport \"../../../layers/support/RangeDomain.js\";\nimport { unpackFieldNames as j } from \"../../../layers/support/fieldUtils.js\";\nimport { PromiseQueue as U } from \"../../../layers/support/PromiseQueue.js\";\nimport { getMetersPerUnit as D } from \"../../../symbols/support/unitConversionUtils.js\";\nimport { LayerView3D as Q } from \"./LayerView3D.js\";\nimport { PointCloudWorkerHandle as F } from \"./PointCloudWorkerHandle.js\";\nimport { checkPointCloudLayerValid as z, checkPointCloudLayerCompatibleWithView as M } from \"./i3s/I3SUtil.js\";\nimport { nodeDiff as W, sortFrontToBack as E, splitWorkEntries as O } from \"./i3s/LoDUtil.js\";\nimport B from \"./i3s/PagedNodeIndex.js\";\nimport { getSplatSizeAlgorithm as G, getFixedSizeAlgorithm as H, getRendererInfo as q, getFilterInfo as T, rendererUsesFixedSizes as $, getAttributeInfo as J } from \"./i3s/PointCloudRendererUtil.js\";\nimport { getAttributeValues as K, readGeometry as X, elevationFromPositions as Y } from \"./i3s/PointCloudWorkerUtil.js\";\nimport { PointGraphic as Z } from \"./i3s/PointGraphic.js\";\nimport { PointRenderer as ee, isInstanceOfNode as te } from \"./i3s/PointRenderer.js\";\nimport { PopupSceneLayerView as ie } from \"./support/PopupSceneLayerView.js\";\nimport { projectToBoundingBox as re } from \"../support/extentUtils.js\";\nimport { ClientType as se } from \"../support/index.js\";\nimport { minimumDistancePlane as oe } from \"../support/orientedBoundingBox.js\";\nimport { updatingProgress as ne } from \"../support/updatingProperties.js\";\nimport { RenderSlot as ae } from \"../webgl-engine/lib/RenderSlot.js\";\nimport de from \"../../layers/LayerView.js\";\nimport { isScaleRangeActive as le, extractSafeScaleBounds as he, scaleBoundsPredicate as ue } from \"../../support/layerViewUtils.js\";\nimport { TaskPriority as pe } from \"../../support/Scheduler.js\";\nconst ce = s.getLogger(\"esri.views.3d.layers.PointCloudLayerView3D\"),\n      _e = 8,\n      me = I();\nlet ge = class extends ie(Q(de)) {\n  constructor() {\n    super(...arguments), this.type = \"point-cloud-3d\", this.maximumPointCount = 4e6, this.slicePlaneEnabled = !1, this._renderer = null, this._rendererAdded = !1, this._renderedNodes = new Set(), this._nodeScales = new Map(), this._updateViewNeeded = !0, this._lodFactor = 1, this._maxLoggedBoxWarnings = 5, this._pageMultiplier = 1, this._nodeLoadEpoch = 0, this._indexQueue = [], this._workQueue = new Array(), this._idleQueue = new U(), this._indexPagesLoading = new Map(), this._loadingNodes = new Map(), this._recalcWork = !0, this._layerIsVisible = !1, this._codedDomainPopulationPromise = null, this._codedDomainPopulationAbortController = null, this._totalWork = 0, this._index = null, this._loadingInitNodePage = !1, this._nodeIdArray = [];\n  }\n\n  get pointScale() {\n    const e = G(this.layer && this.layer.renderer),\n          t = 1;\n    return e && null != e.scaleFactor ? e.scaleFactor : t;\n  }\n\n  get useRealWorldSymbolSizes() {\n    const e = H(this.layer && this.layer.renderer),\n          t = !1;\n    return e && null != e.useRealWorldSymbolSizes ? e.useRealWorldSymbolSizes : t;\n  }\n\n  get pointSize() {\n    const e = H(this.layer && this.layer.renderer),\n          t = 0;\n    return e && null != e.size ? e.size : t;\n  }\n\n  get inverseDensity() {\n    const e = 96;\n    return this.layer && this.layer.renderer ? 1 * e / this.layer.renderer.pointsPerInch : 5;\n  }\n\n  get availableFields() {\n    const e = q(this.layer),\n          t = new Set();\n    e.primaryAttribute && t.add(e.primaryAttribute.name), e.modulationAttribute && t.add(e.primaryAttribute.name);\n    const i = T(this.layer);\n    if (i) for (const r of i) t.add(r.attributeInfo.name);\n    if (this.layer.outFields) for (const r of j(this.layer.fieldsIndex, this.layer.outFields)) t.add(r);\n    return Array.from(t);\n  }\n\n  get _clippingBox() {\n    if (!this.view || !this.view.clippingArea) return null;\n    const e = C(),\n          t = this.view.renderSpatialReference;\n    return re(this.view.clippingArea, e, t) ? e : null;\n  }\n\n  get _elevationOffset() {\n    const e = this.layer && this.layer.elevationInfo;\n\n    if (e && \"absolute-height\" === e.mode) {\n      const t = b(this.layer.spatialReference),\n            i = D(e.unit);\n      return o(e.offset, 0) * i / t;\n    }\n\n    return 0;\n  }\n\n  initialize() {\n    const e = this.view.resourceController;\n    this._worker = new F(t => e.schedule(t)), this.addResolvingPromise(this._worker.promise), this._tmpPoint = V(0, 0, 0, this.layer.spatialReference), z(this.layer), M(this.layer, this.view), this._indexRequester = e.createStreamDataRequester(se.I3S_INDEX), this._dataRequester = e.createStreamDataRequester(se.I3S_DATA), this._initRenderer();\n\n    const t = this._initNodePages(),\n          i = this.view.resourceController.memoryController;\n\n    this._memCache = i.newCache(this.layer.uid), this.updatingHandles.add(() => this._clippingBox, () => this._setUpdateViewNeeded(), c), this.updatingHandles.add(() => this._elevationOffset, () => this._elevationOffsetChanged(), c), this.updatingHandles.add(() => this.layer.renderer, () => this._rendererChanged(), c), this.updatingHandles.add(() => this.layer.filters, () => this._reload(), c), this.updatingHandles.add(() => this.layer.outFields, () => this._reload(), c), this.updatingHandles.add(() => this.layer.effectiveScaleRange, () => this._setUpdateViewNeeded()), this.updatingHandles.add(() => this.view.state.contentCamera, () => this._setUpdateViewNeeded()), this.handles.add([this.view.basemapTerrain.on(\"scale-change\", e => this._scaleUpdateHandler(e)), _(() => i.memoryFactor, () => this._setUpdateViewNeeded(), m)]), this.addResolvingPromise(t), this.when(() => {\n      this.handles.add([e.scheduler.registerTask(pe.POINT_CLOUD_LAYER, this), e.scheduler.registerIdleStateCallbacks(() => this._idleBegin(), () => this._idleEnd()), this.updatingHandles.add(() => this.suspended, e => {\n        e ? this._clearNodeState() : this._setUpdateViewNeeded();\n      }, c)]);\n    }, () => {\n      this.updatingHandles.removeAll(), this.handles.removeAll();\n    });\n  }\n\n  _setUpdateViewNeeded() {\n    this._updateViewNeeded = !0, this._updateLoading();\n  }\n\n  destroy() {\n    this.cancelLoading(), this._worker && (this._worker.destroy(), this._worker = null), this._destroyRenderer(), this._memCache.destroy(), this._memCache = null, this._codedDomainPopulationAbortController && (this._codedDomainPopulationAbortController.abort(), this._codedDomainPopulationAbortController = null), this._codedDomainPopulationPromise = null;\n  }\n\n  _initRenderer() {\n    this._renderer = new ee({\n      createGraphic: (e, t, i) => this._createGraphic(e, t, i)\n    }), this._renderer.layerUid = this.layer.uid, this.updatingHandles.add(() => this._clippingBox, e => this._renderer.clippingBox = e, c), this.updatingHandles.add(() => this.suspended, e => this._setPointsVisible(!e), c), this.updatingHandles.add(() => this.pointScale, e => this._renderer.scaleFactor = e, c), this._renderer.minSizePx = Math.sqrt(2), this.updatingHandles.add(() => this.useRealWorldSymbolSizes, e => this._renderer.useRealWorldSymbolSizes = e, c), this.updatingHandles.add(() => this.pointSize, e => {\n      const t = g(e);\n      this._renderer.size = e, this._renderer.sizePx = t;\n    }, c), this.updatingHandles.add(() => this.slicePlaneEnabled, e => this._renderer.slicePlaneEnabled = e, c), this.updatingHandles.add(() => this.inverseDensity, () => this._setUpdateViewNeeded(), c), this.updatingHandles.add(() => this.maximumPointCount, () => this._setUpdateViewNeeded(), c), this.updatingHandles.add(() => this.view.qualitySettings.sceneService.pointCloud.lodFactor, e => {\n      this._lodFactor = e, this._setUpdateViewNeeded();\n    }, c);\n  }\n\n  _destroyRenderer() {\n    this._renderer.removeAll(), this._setPointsVisible(!1);\n  }\n\n  _createGraphic(e, t, i) {\n    const r = n(e.pointIdFilterMap) ? e.pointIdFilterMap[t] : t,\n          s = this.view.computeMapPointFromVec3d(i),\n          o = this._createGraphicAttributes(e, r);\n\n    return new Z({\n      pointCloudMetadata: {\n        nodeId: e.id,\n        pointIndexInNode: t,\n        attributePointIndexInNode: r,\n        epoch: this._nodeLoadEpoch\n      },\n      geometry: s,\n      attributes: o,\n      layer: this.layer,\n      sourceLayer: this.layer\n    });\n  }\n\n  _createGraphicAttributes(e, t) {\n    const i = {};\n\n    for (const r of e.attributes) this._encodeGraphicAttribute(r.attributeInfo, r.values, t, i);\n\n    return i;\n  }\n\n  _encodeGraphicAttribute(e, t, i, r) {\n    const s = e.storageInfo && e.storageInfo.attributeValues,\n          o = s ? s.valuesPerElement : 1;\n    if (1 === o) r[e.name] = t[i];else if (\"UInt8\" === s.valueType && o <= 4) {\n      let s = 0;\n      const n = i * o;\n\n      for (let e = n; e < n + o; e++) s = (s << 8) + t[e];\n\n      r[e.name] = s;\n    } else r[e.name] = void 0;\n  }\n\n  _setPointsVisible(e) {\n    e && !this._rendererAdded ? (this.view._stage.addRenderPlugin([ae.OPAQUE_MATERIAL], this._renderer), this._rendererAdded = !0) : !e && this._rendererAdded && (this.view._stage.removeRenderPlugin(this._renderer), this._rendererAdded = !1);\n  }\n\n  _rendererChanged() {\n    this._renderer.useFixedSizes = $(this.layer.renderer), this._reload();\n  }\n\n  _reload() {\n    this._clearNodeState(), this._memCache.clear(), this._setUpdateViewNeeded();\n  }\n\n  _elevationOffsetChanged() {\n    this._clearNodeState(), this._memCache.clear(), this._initNodePages();\n  }\n\n  _scaleUpdateHandler(e) {\n    const t = this.layer.effectiveScaleRange;\n    le(t.minScale, t.maxScale) ? v(e.extent, e.spatialReference, be, this.layer.spatialReference) && (this._nodeScales.forEach((t, i) => {\n      if (!this._renderedNodes.has(i)) return void this._nodeScales.delete(i);\n\n      const r = this._index.getNode(i);\n\n      S(be, r.obb.center) && this._nodeScales.set(i, e.scale);\n    }), this._setUpdateViewNeeded()) : this._nodeScales.clear();\n  }\n\n  _displayNodes(e) {\n    this._workQueue = W([...this._renderedNodes], e, this._index), E(this._workQueue, this.view.state.contentCamera.viewForward, this._index), O(this._workQueue, _e, this._index), this._updateQueues(), this._totalWork = this._computeWork(), this._updateLoading(), this._layerIsVisible = e.length > 0 || this._loadingInitNodePage, this.notifyChange(\"suspended\");\n  }\n\n  cancelLoading() {\n    this._cancelNodeLoading(), this._cancelIndexLoading();\n  }\n\n  _cancelNodeLoading() {\n    const e = new Array();\n    this._loadingNodes.forEach(({\n      abortController: t\n    }) => e.push(t)), this._loadingNodes.clear();\n\n    for (const t of e) t.abort();\n\n    this._workQueue = [], this._idleQueue.cancelAll(), this._totalWork = this._computeWork(), this._updateLoading();\n  }\n\n  _updateQueues() {\n    const e = new Set();\n\n    this._workQueue.forEach(t => t.load.forEach(t => e.add(t)));\n\n    const t = new Array(),\n          i = new Map();\n    this._loadingNodes.forEach((r, s) => {\n      e.has(s) ? i.set(s, r) : t.push(r);\n    }), this._loadingNodes = i;\n\n    for (const {\n      abortController: r\n    } of t) r.abort();\n\n    this._workQueue = this._workQueue.filter(e => {\n      for (const t of e.load) if (this._loadingNodes.has(t)) return this._recalcWork = !0, !1;\n\n      return !0;\n    }), this._totalWork = this._computeWork(), this._updateLoading();\n  }\n\n  _cancelIndexLoading() {\n    this._indexQueue = [], this._indexPagesLoading.forEach(({\n      abortController: e\n    }) => e.abort()), this._indexPagesLoading.clear(), this._totalWork = this._computeWork(), this._updateLoading();\n  }\n\n  _clearNodeState() {\n    this._nodeLoadEpoch++, this._renderedNodes.forEach(e => this._removeFromRenderer(e)), this._cancelNodeLoading();\n  }\n\n  _idleBegin() {\n    this._setUpdateViewNeeded();\n  }\n\n  _idleEnd() {\n    this._setUpdateViewNeeded();\n  }\n\n  get running() {\n    return this.suspended ? this._updateViewNeeded : this._updateViewNeeded || this._indexQueue.length > 0 || this._workQueue.length > 0 || this._idleQueue.running;\n  }\n\n  runTask(e) {\n    if (this.suspended) {\n      if (this._updateViewNeeded) {\n        this._updateViewNeeded = !1;\n\n        const e = this._isRootNodeVisible();\n\n        e !== this._layerIsVisible && (this._layerIsVisible = e, this.notifyChange(\"suspended\")), this._updateLoading();\n      }\n    } else {\n      for (e.run(() => this._updateWorkQueues()); this._indexQueue.length > 0 && e.run(() => this._processIndexQueue()););\n\n      this._processWorkQueue(e), this._idleQueue.runTask(e);\n    }\n  }\n\n  _processIndexQueue() {\n    const e = this._indexQueue.shift(),\n          t = this._loadNodePage(e);\n\n    return this._indexPagesLoading.set(e, t), t.promise.then(t => {\n      this._index.addPage(e, t, this._elevationOffset), this._setUpdateViewNeeded();\n    }).then(() => {\n      this._indexPagesLoading.delete(e);\n    }, () => {\n      this._indexPagesLoading.delete(e);\n    }), !0;\n  }\n\n  _processWorkQueue(e) {\n    for (; !e.done;) {\n      const t = this._scheduleWorkEntry();\n\n      if (a(t)) return;\n      this._processWorkEntry(t), e.madeProgress();\n    }\n  }\n\n  _scheduleWorkEntry() {\n    let e = this._workQueue.length;\n\n    for (; e--;) {\n      const e = this._workQueue.shift();\n\n      if (!e.remove.find(e => !this._renderedNodes.has(e))) return e;\n\n      this._workQueue.push(e);\n    }\n\n    return null;\n  }\n\n  _processWorkEntry(e) {\n    if (0 !== e.load.length) Promise.all(e.load.map(e => {\n      const t = new AbortController(),\n            i = this._memCache.pop(e.toString());\n\n      return n(i) ? this._loadingNodes.set(e, {\n        abortController: t,\n        promise: Promise.resolve(i)\n      }) : this._loadingNodes.has(e) || this._loadingNodes.set(e, {\n        abortController: t,\n        promise: this._loadNode(e, t.signal)\n      }), this._loadingNodes.get(e).promise;\n    })).then(t => {\n      for (let i = 0; i < e.load.length; i++) if (t[i]) {\n        const r = this._setupRendererData(e.load[i], t[i]);\n\n        this._addToRenderer(r);\n      }\n\n      for (const i of e.remove) this._removeFromRenderer(i);\n    }).catch(() => {}).then(() => {\n      for (const t of e.load) this._loadingNodes.delete(t);\n\n      this._updateLoading(), this._recalcWork && !this._idleQueue.running && 0 === this._indexQueue.length && 0 === this._loadingNodes.size && (this._recalcWork = !1, this._setUpdateViewNeeded());\n    }), this._updateLoading();else for (const t of e.remove) this._removeFromRenderer(t);\n  }\n\n  async _populateClassCodeCodedDomain(e, i) {\n    const r = \"CLASS_CODE\",\n          s = this.layer.fieldsIndex.get(r);\n    if (!s || s.domain) return;\n    if (!e.includes(s.name)) return;\n    const o = await t(this.layer.queryCachedStatistics(r, {\n      signal: i\n    }));\n    if (!1 === o.ok) return;\n    const n = o.value,\n          a = n && n.labels && n.labels.labels;\n    a && Array.isArray(a) && (s.domain = new L({\n      name: \"CLASS_CODE\",\n      codedValues: a.map(e => new R({\n        code: e.value,\n        name: e.label\n      }))\n    }));\n  }\n\n  async prepareFetchPopupFeatures(e) {\n    return this._codedDomainPopulationPromise || (this._codedDomainPopulationAbortController = new AbortController(), this._codedDomainPopulationPromise = this._populateClassCodeCodedDomain(e, this._codedDomainPopulationAbortController.signal).then(() => {\n      this._codedDomainPopulationAbortController = null;\n    })), this._codedDomainPopulationPromise;\n  }\n\n  async whenGraphicAttributes(e, t) {\n    const r = this._splitGraphicsPerNode(e),\n          s = this.layer.attributeStorageInfo,\n          o = t.map(e => J(s, e)),\n          n = async (e, t) => {\n      const r = this._index.getNode(t);\n\n      await i(o, async t => {\n        const i = t.useElevation ? await this._loadElevationAttributeFromGeometry(r.resourceId) : await this._loadAndParseAttribute(r, t);\n        if (i) for (const r of e) if (this._isValidPointGraphic(r)) {\n          const e = r.pointCloudMetadata.attributePointIndexInNode;\n\n          this._encodeGraphicAttribute(t, i, e, r.attributes);\n        }\n      });\n    },\n          a = [];\n\n    return r.forEach((e, t) => {\n      a.push(n(e, t));\n    }), await l(a), e;\n  }\n\n  _isValidPointGraphic(e) {\n    return e instanceof Z && e.pointCloudMetadata && e.pointCloudMetadata.epoch === this._nodeLoadEpoch;\n  }\n\n  _splitGraphicsPerNode(e) {\n    const t = new Map();\n\n    for (const i of e) {\n      if (!this._isValidPointGraphic(i)) continue;\n      const e = i.pointCloudMetadata,\n            r = t.get(e.nodeId);\n      r ? r.push(i) : t.set(e.nodeId, [i]);\n    }\n\n    return t;\n  }\n\n  async _loadAndParseAttribute(e, t) {\n    const i = await this._loadAttribute(e.resourceId, t, null);\n    return n(i) ? K({\n      attributeInfo: t,\n      buffer: i\n    }, null, e.vertexCount) : null;\n  }\n\n  async _loadElevationAttributeFromGeometry(e) {\n    const t = this.layer.store.defaultGeometrySchema,\n          i = X(t, await this._loadGeometry(e, null));\n    return Y(i, i.length / 3);\n  }\n\n  highlight(e) {\n    if (!e) return {\n      remove() {}\n\n    };\n    const t = r.isCollection(e) ? e.toArray() : Array.isArray(e) ? e : [e];\n    return this._renderer.highlight(t.map(e => this._graphicToPointDefinition(e)));\n  }\n\n  _graphicToPointDefinition(e) {\n    if (!this._isValidPointGraphic(e)) return null;\n    const {\n      nodeId: t,\n      pointIndexInNode: i\n    } = e.pointCloudMetadata;\n    return null != t && null != i ? {\n      nodeId: t,\n      pointId: i\n    } : null;\n  }\n\n  _computeWork() {\n    let e = 0;\n\n    for (const t of this._workQueue) e += t.load.length + t.remove.length;\n\n    return e += this._loadingNodes.size, e += (this._indexQueue.length + this._indexPagesLoading.size) * this._index.pageSize, e += this._loadingInitNodePage ? 100 : 0, e += this._updateViewNeeded ? 100 : 0, e;\n  }\n\n  get updatingProgressValue() {\n    if (this.suspended) return this._updateViewNeeded ? 0 : 1;\n\n    const e = this._computeWork();\n\n    return 1 - Math.min(this._totalWork, e) / this._totalWork;\n  }\n\n  _updateLoading() {\n    this.notifyChange(\"updating\"), this.notifyChange(\"updatingProgressValue\");\n  }\n\n  canResume() {\n    return super.canResume() && this._layerIsVisible;\n  }\n\n  isUpdating() {\n    return this.suspended ? this._updateViewNeeded : this._computeWork() > 0;\n  }\n\n  _initNodePages() {\n    const e = this.layer.store.index,\n          t = e.nodesPerPage || e.nodePerIndexBlock;\n    return this._index = new B(this.layer.spatialReference, this.view.renderCoordsHelper.spatialReference, t), this._cancelIndexLoading(), this._traverseVisible = this._index.createVisibilityTraverse(), this._loadingInitNodePage = !0, this._layerIsVisible = !0, this.notifyChange(\"suspended\"), this._updateLoading(), this._pageMultiplier = null != e.nodesPerPage ? 1 : e.nodePerIndexBlock, this._loadNodePage(0).promise.then(e => {\n      this._index.addPage(0, e, this._elevationOffset), this._loadingInitNodePage = !1, this._setUpdateViewNeeded();\n    });\n  }\n\n  _loadNodePage(e) {\n    const t = new AbortController(),\n          i = `${this.baseUrl}/nodepages/${e * this._pageMultiplier}`;\n    return {\n      promise: this._requestNodePage(i, t.signal).then(t => t.nodes.map((t, i) => ({\n        resourceId: null != t.resourceId ? t.resourceId : e * this._index.pageSize + i,\n        obb: t.obb,\n        firstChild: t.firstChild,\n        childCount: t.childCount,\n        vertexCount: null != t.vertexCount ? t.vertexCount : t.pointCount,\n        lodThreshold: null != t.lodThreshold ? t.lodThreshold : t.effectiveArea\n      }))),\n      abortController: t\n    };\n  }\n\n  _updateWorkQueues() {\n    if (!this._updateViewNeeded) return !1;\n\n    let e = this.inverseDensity / this._lodFactor * this._getLodMemoryFactor();\n\n    const t = this.maximumPointCount * this._lodFactor * this._getLodMemoryFactor();\n\n    let i = this._computeNodesForMinimumDensity(e),\n        r = this._computePointCount(i),\n        s = Math.sqrt(r / (.75 * t));\n\n    for (; r > t;) e *= s, i = this._computeNodesForMinimumDensity(e), r = this._computePointCount(i), s = Math.sqrt(2);\n\n    return this._displayNodes(i), this._updateViewNeeded = !1, this._updateLoading(), !0;\n  }\n\n  _computePointCount(e) {\n    let t = 0;\n\n    for (let i = 0; i < e.length; i++) {\n      const r = this._index.getNode(e[i]);\n\n      r && (t += r.vertexCount);\n    }\n\n    return t;\n  }\n\n  _getLodMemoryFactor() {\n    return this.view.resourceController.memoryController.memoryFactor;\n  }\n\n  _isRootNodeVisible() {\n    let e = !1;\n    return this._traverseVisible({\n      frustum: this.view.state.contentCamera.frustum,\n      clippingBox: this._clippingBox\n    }, {\n      predicate: (t, i, r) => (e = r, !1),\n      pageMiss: () => {}\n    }), e;\n  }\n\n  _computeNodesForMinimumDensity(e) {\n    const t = this.view.state.contentCamera,\n          i = t.frustum,\n          r = this._clippingBox,\n          s = t.viewForward,\n          o = P(s, t.eye),\n          n = k(s, -o, me),\n          a = t.perScreenPixelRatio / 2,\n          d = e * e,\n          l = this._nodeIdArray;\n    l.length = 0;\n    const {\n      minScale: h,\n      maxScale: u\n    } = he(this.layer),\n          p = 0 === h && 0 === u ? e => l.push(e) : e => {\n      const t = this._getScale(e);\n\n      ue(t, h, u) && l.push(e);\n    };\n    return this._traverseVisible({\n      frustum: i,\n      clippingBox: r\n    }, {\n      predicate: (e, t, i) => {\n        if (!i) return !1;\n        if (0 === t.childCount) return p(e), !1;\n\n        const r = this._index.getRenderObb(e);\n\n        return !(this._computeAveragePixelArea(r, t.lodThreshold, t.vertexCount, n, a) <= d) || (p(e), !1);\n      },\n      pageMiss: (e, t) => {\n        p(e), this._indexQueue.includes(t) || this._indexQueue.push(t);\n      }\n    }), l;\n  }\n\n  _getScale(e) {\n    let t = this._nodeScales.get(e);\n\n    if (null == t) {\n      const i = this._index.getNode(e).obb.center;\n\n      this._tmpPoint.x = i[0], this._tmpPoint.y = i[1], this._tmpPoint.z = i[2], t = this.view.basemapTerrain.getScale(this._tmpPoint), this._nodeScales.set(e, t);\n    }\n\n    return t;\n  }\n\n  _computeAveragePixelArea(e, t, i, r, s) {\n    const o = 1e-7,\n          n = Math.max(o, oe(e, r));\n    return t / (n * n) / (4 * s * s) / i;\n  }\n\n  _loadNode(e, t) {\n    try {\n      return this._loadNodeAsync(e, t);\n    } catch (i) {\n      throw h(i) || ce.error(i), i;\n    }\n  }\n\n  async _loadAdditionalUserAttributes(e, t, i) {\n    const r = this.layer.outFields;\n    if (!r) return [];\n    const s = j(this.layer.fieldsIndex, r),\n          o = new Set(e.map(e => n(e) ? e.name : null)),\n          a = this.layer.attributeStorageInfo,\n          l = [];\n\n    for (const n of s) {\n      if (o.has(n)) continue;\n      const e = J(a, n);\n      e && l.push(t(e));\n    }\n\n    const h = await u(l);\n    return p(i), d(h, e => e);\n  }\n\n  async _loadNodeAsync(e, t) {\n    const i = this._index.getNode(e),\n          r = q(this.layer),\n          s = T(this.layer),\n          o = i.resourceId,\n          d = async e => {\n      if (a(e)) return null;\n      if (e.useElevation) return {\n        attributeInfo: e,\n        buffer: null\n      };\n      const i = await this._loadAttribute(o, e, t);\n      return n(i) ? {\n        attributeInfo: e,\n        buffer: i\n      } : null;\n    };\n\n    return this._idleQueue.push(async () => {\n      const i = this._loadGeometry(o, t),\n            {\n        primaryAttribute: n,\n        modulationAttribute: a\n      } = r,\n            l = d(n),\n            h = d(a),\n            u = s.map(e => e.attributeInfo),\n            c = u.map(e => d(e)),\n            _ = this._loadAdditionalUserAttributes([n, a, ...u], d, t),\n            [m, g, f, y, b] = await Promise.all([i, l, h, Promise.all(c), _]);\n\n      p(t);\n      const w = {\n        geometryBuffer: m,\n        primaryAttributeData: g,\n        modulationAttributeData: f,\n        filterAttributesData: y,\n        userAttributesData: b,\n        schema: this.layer.store.defaultGeometrySchema,\n        rendererInfo: r,\n        filterInfo: s,\n        obb: this._index.getRenderObb(e),\n        elevationOffset: this._elevationOffset,\n        inSR: this.layer.spatialReference.toJSON(),\n        outSR: this.view.renderCoordsHelper.spatialReference.toJSON()\n      };\n      return this._worker.invoke(w, t);\n    }, t);\n  }\n\n  async _loadGeometry(e, t) {\n    return this._requestData(`${this.baseUrl}/nodes/${e}/geometries/0`, t);\n  }\n\n  async _loadAttribute(e, t, i) {\n    if (a(t) || !t.storageInfo) return null;\n    const r = t.storageInfo.key;\n    return this._requestData(`${this.baseUrl}/nodes/${e}/attributes/${r}`, i);\n  }\n\n  _requestNodePage(e, t) {\n    const i = {\n      f: \"json\",\n      token: this.layer.apiKey\n    };\n    return this._indexRequester.request(e, \"json\", {\n      query: i,\n      signal: t\n    });\n  }\n\n  _requestData(e, t) {\n    return this._dataRequester.request(e, \"binary\", {\n      query: {\n        token: this.layer.apiKey\n      },\n      signal: t\n    });\n  }\n\n  _removeFromRenderer(e) {\n    if (this._renderedNodes.has(e)) {\n      const t = this._renderer.removeNode(e);\n\n      this._renderedNodes.delete(e), this._nodeScales.delete(e), this._memCache.put(t.id.toString(), t, ye(t));\n    }\n  }\n\n  _addToRenderer(e) {\n    this._renderedNodes.has(e.id) || (this._renderedNodes.add(e.id), this._renderer.addNode(e));\n  }\n\n  _setupRendererData(e, t) {\n    const i = this._index.getNode(e),\n          r = Math.sqrt(i.lodThreshold / i.vertexCount),\n          s = this._index.getRenderObb(e);\n\n    if (te(t)) return t.splatSize = r, t.obb = s, t.origin = x(t.obb.center), t;\n    const o = .01 * Math.max(s.halfSize[0], s.halfSize[1], s.halfSize[2]);\n\n    if (t.obb.halfSize[0] > s.halfSize[0] + o || t.obb.halfSize[1] > s.halfSize[1] + o || t.obb.halfSize[2] > s.halfSize[2] + o) {\n      if (this._maxLoggedBoxWarnings > 0) {\n        const i = e => `[${e.halfSize[0]}, ${e.halfSize[1]}, ${e.halfSize[2]}]`;\n\n        ce.warn(`Node ${e} reported bounding box too small. got ${i(s)} but points cover ${i(t.obb)}`), 0 == --this._maxLoggedBoxWarnings && ce.warn(\"  Too many bounding box errors, stopping reporting for this layer.\");\n      }\n\n      this._index.setRenderObb(e, t.obb);\n    }\n\n    return {\n      id: e,\n      coordinates: t.points,\n      origin: x(s.center),\n      rgb: t.rgb,\n      attributes: t.attributes,\n      pointIdFilterMap: t.pointIdFilterMap,\n      highlights: null,\n      splatSize: r,\n      obb: s,\n      isLeaf: 0 === i.childCount\n    };\n  }\n\n  getUsedMemory() {\n    let e = 0;\n    return this._renderer.forEachNode(t => {\n      e += we, e += f(t.coordinates);\n\n      for (const i of t.attributes) {\n        const t = i.values;\n        y(t.buffer) && (e += f(t));\n      }\n    }), e;\n  }\n\n  getUnloadedMemory() {\n    const e = this._renderedNodes.size;\n    if (e < 4) return 0;\n    const t = [...this._renderedNodes].reduce((e, t) => e + this._index.getNode(t).vertexCount);\n    let i = this._loadingNodes.size;\n\n    for (let r = 0; r < this._workQueue.length; r++) i += this._workQueue[r].load.length, i -= this._workQueue[r].remove.length;\n\n    if (i < 0) return 0;\n    return i * t / e * ((this.getUsedMemory() - e * we) / t) + i * we;\n  }\n\n  ignoresMemoryFactor() {\n    return !1;\n  }\n\n  get performanceInfo() {\n    return {\n      nodes: this._renderedNodes.size,\n      displayedNumberOfFeatures: [...this._renderedNodes].reduce((e, t) => e + this._index.getNode(t).vertexCount, 0),\n      maximumNumberOfFeatures: this.maximumPointCount,\n      totalNumberOfFeatures: -1,\n      core: null,\n      \"Loading Nodes\": this._loadingNodes.size,\n      \"Index Queue\": this._indexQueue.length,\n      \"Work Queue\": this._workQueue.length,\n      \"Idle Queue\": this._idleQueue.length\n    };\n  }\n\n  get test() {\n    return {\n      index: this._index,\n      visibleNodes: this._renderedNodes\n    };\n  }\n\n};\ne([w()], ge.prototype, \"layer\", void 0), e([w({\n  readOnly: !0,\n  aliasOf: \"layer.parsedUrl.path\"\n})], ge.prototype, \"baseUrl\", void 0), e([w({\n  readOnly: !0\n})], ge.prototype, \"pointScale\", null), e([w({\n  readOnly: !0\n})], ge.prototype, \"useRealWorldSymbolSizes\", null), e([w({\n  readOnly: !0\n})], ge.prototype, \"pointSize\", null), e([w({\n  readOnly: !0\n})], ge.prototype, \"inverseDensity\", null), e([w()], ge.prototype, \"maximumPointCount\", void 0), e([w({\n  readOnly: !0\n})], ge.prototype, \"availableFields\", null), e([w({\n  readOnly: !0\n})], ge.prototype, \"_clippingBox\", null), e([w({\n  readOnly: !0\n})], ge.prototype, \"_elevationOffset\", null), e([w({\n  type: Boolean\n})], ge.prototype, \"slicePlaneEnabled\", void 0), e([w()], ge.prototype, \"updating\", void 0), e([w(ne)], ge.prototype, \"updatingProgress\", void 0), e([w({\n  readOnly: !0\n})], ge.prototype, \"updatingProgressValue\", null), ge = e([N(\"esri.views.3d.layers.PointCloudLayerView3D\")], ge);\nconst fe = ge;\n\nfunction ye(e) {\n  return 5 * e.coordinates.length + 128;\n}\n\nconst be = A(),\n      we = 160;\nexport { fe as default };","map":{"version":3,"names":["_","e","result","t","forEach","i","r","s","unwrapOr","o","isSome","n","isNone","a","mapSome","d","eachAlways","l","isAbortError","h","eachAlwaysValues","u","throwIfAborted","p","initial","c","watch","sync","m","pt2px","g","estimateSize","f","isArrayBuffer","y","getMetersPerVerticalUnitForSR","b","property","w","subclass","N","P","x","projectBoundingRect","v","create","C","containsPoint","S","A","I","fromNormalAndOffset","k","makeDehydratedPoint","V","CodedValue","R","L","unpackFieldNames","j","PromiseQueue","U","getMetersPerUnit","D","LayerView3D","Q","PointCloudWorkerHandle","F","checkPointCloudLayerValid","z","checkPointCloudLayerCompatibleWithView","M","nodeDiff","W","sortFrontToBack","E","splitWorkEntries","O","B","getSplatSizeAlgorithm","G","getFixedSizeAlgorithm","H","getRendererInfo","q","getFilterInfo","T","rendererUsesFixedSizes","$","getAttributeInfo","J","getAttributeValues","K","readGeometry","X","elevationFromPositions","Y","PointGraphic","Z","PointRenderer","ee","isInstanceOfNode","te","PopupSceneLayerView","ie","projectToBoundingBox","re","ClientType","se","minimumDistancePlane","oe","updatingProgress","ne","RenderSlot","ae","de","isScaleRangeActive","le","extractSafeScaleBounds","he","scaleBoundsPredicate","ue","TaskPriority","pe","ce","getLogger","_e","me","ge","constructor","arguments","type","maximumPointCount","slicePlaneEnabled","_renderer","_rendererAdded","_renderedNodes","Set","_nodeScales","Map","_updateViewNeeded","_lodFactor","_maxLoggedBoxWarnings","_pageMultiplier","_nodeLoadEpoch","_indexQueue","_workQueue","Array","_idleQueue","_indexPagesLoading","_loadingNodes","_recalcWork","_layerIsVisible","_codedDomainPopulationPromise","_codedDomainPopulationAbortController","_totalWork","_index","_loadingInitNodePage","_nodeIdArray","pointScale","layer","renderer","scaleFactor","useRealWorldSymbolSizes","pointSize","size","inverseDensity","pointsPerInch","availableFields","primaryAttribute","add","name","modulationAttribute","attributeInfo","outFields","fieldsIndex","from","_clippingBox","view","clippingArea","renderSpatialReference","_elevationOffset","elevationInfo","mode","spatialReference","unit","offset","initialize","resourceController","_worker","schedule","addResolvingPromise","promise","_tmpPoint","_indexRequester","createStreamDataRequester","I3S_INDEX","_dataRequester","I3S_DATA","_initRenderer","_initNodePages","memoryController","_memCache","newCache","uid","updatingHandles","_setUpdateViewNeeded","_elevationOffsetChanged","_rendererChanged","filters","_reload","effectiveScaleRange","state","contentCamera","handles","basemapTerrain","on","_scaleUpdateHandler","memoryFactor","when","scheduler","registerTask","POINT_CLOUD_LAYER","registerIdleStateCallbacks","_idleBegin","_idleEnd","suspended","_clearNodeState","removeAll","_updateLoading","destroy","cancelLoading","_destroyRenderer","abort","createGraphic","_createGraphic","layerUid","clippingBox","_setPointsVisible","minSizePx","Math","sqrt","sizePx","qualitySettings","sceneService","pointCloud","lodFactor","pointIdFilterMap","computeMapPointFromVec3d","_createGraphicAttributes","pointCloudMetadata","nodeId","id","pointIndexInNode","attributePointIndexInNode","epoch","geometry","attributes","sourceLayer","_encodeGraphicAttribute","values","storageInfo","attributeValues","valuesPerElement","valueType","_stage","addRenderPlugin","OPAQUE_MATERIAL","removeRenderPlugin","useFixedSizes","clear","minScale","maxScale","extent","be","has","delete","getNode","obb","center","set","scale","_displayNodes","viewForward","_updateQueues","_computeWork","length","notifyChange","_cancelNodeLoading","_cancelIndexLoading","abortController","push","cancelAll","load","filter","_removeFromRenderer","running","runTask","_isRootNodeVisible","run","_updateWorkQueues","_processIndexQueue","_processWorkQueue","shift","_loadNodePage","then","addPage","done","_scheduleWorkEntry","_processWorkEntry","madeProgress","remove","find","Promise","all","map","AbortController","pop","toString","resolve","_loadNode","signal","get","_setupRendererData","_addToRenderer","catch","_populateClassCodeCodedDomain","domain","includes","queryCachedStatistics","ok","value","labels","isArray","codedValues","code","label","prepareFetchPopupFeatures","whenGraphicAttributes","_splitGraphicsPerNode","attributeStorageInfo","useElevation","_loadElevationAttributeFromGeometry","resourceId","_loadAndParseAttribute","_isValidPointGraphic","_loadAttribute","buffer","vertexCount","store","defaultGeometrySchema","_loadGeometry","highlight","isCollection","toArray","_graphicToPointDefinition","pointId","pageSize","updatingProgressValue","min","canResume","isUpdating","index","nodesPerPage","nodePerIndexBlock","renderCoordsHelper","_traverseVisible","createVisibilityTraverse","baseUrl","_requestNodePage","nodes","firstChild","childCount","pointCount","lodThreshold","effectiveArea","_getLodMemoryFactor","_computeNodesForMinimumDensity","_computePointCount","frustum","predicate","pageMiss","eye","perScreenPixelRatio","_getScale","getRenderObb","_computeAveragePixelArea","getScale","max","_loadNodeAsync","error","_loadAdditionalUserAttributes","geometryBuffer","primaryAttributeData","modulationAttributeData","filterAttributesData","userAttributesData","schema","rendererInfo","filterInfo","elevationOffset","inSR","toJSON","outSR","invoke","_requestData","key","token","apiKey","request","query","removeNode","put","ye","addNode","splatSize","origin","halfSize","warn","setRenderObb","coordinates","points","rgb","highlights","isLeaf","getUsedMemory","forEachNode","we","getUnloadedMemory","reduce","ignoresMemoryFactor","performanceInfo","displayedNumberOfFeatures","maximumNumberOfFeatures","totalNumberOfFeatures","core","test","visibleNodes","prototype","readOnly","aliasOf","Boolean","fe","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/PointCloudLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{result as t,forEach as i}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Collection.js\";import s from\"../../../core/Logger.js\";import{unwrapOr as o,isSome as n,isNone as a,mapSome as d}from\"../../../core/maybe.js\";import{eachAlways as l,isAbortError as h,eachAlwaysValues as u,throwIfAborted as p}from\"../../../core/promiseUtils.js\";import{initial as c,watch as _,sync as m}from\"../../../core/reactiveUtils.js\";import{pt2px as g}from\"../../../core/screenUtils.js\";import{estimateSize as f,isArrayBuffer as y}from\"../../../core/typedArrayUtil.js\";import{getMetersPerVerticalUnitForSR as b}from\"../../../core/unitUtils.js\";import{property as w}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as N}from\"../../../core/accessorSupport/decorators/subclass.js\";import{e as P}from\"../../../chunks/vec3.js\";import{a as x}from\"../../../chunks/vec3f32.js\";import{projectBoundingRect as v}from\"../../../geometry/projection.js\";import{create as C}from\"../../../geometry/support/aaBoundingBox.js\";import{containsPoint as S,create as A}from\"../../../geometry/support/aaBoundingRect.js\";import{create as I,fromNormalAndOffset as k}from\"../../../geometry/support/plane.js\";import{makeDehydratedPoint as V}from\"../../../layers/graphics/dehydratedFeatures.js\";import{CodedValue as R}from\"../../../layers/support/CodedValue.js\";import L from\"../../../layers/support/CodedValueDomain.js\";import\"../../../layers/support/Domain.js\";import\"../../../layers/support/InheritedDomain.js\";import\"../../../layers/support/RangeDomain.js\";import{unpackFieldNames as j}from\"../../../layers/support/fieldUtils.js\";import{PromiseQueue as U}from\"../../../layers/support/PromiseQueue.js\";import{getMetersPerUnit as D}from\"../../../symbols/support/unitConversionUtils.js\";import{LayerView3D as Q}from\"./LayerView3D.js\";import{PointCloudWorkerHandle as F}from\"./PointCloudWorkerHandle.js\";import{checkPointCloudLayerValid as z,checkPointCloudLayerCompatibleWithView as M}from\"./i3s/I3SUtil.js\";import{nodeDiff as W,sortFrontToBack as E,splitWorkEntries as O}from\"./i3s/LoDUtil.js\";import B from\"./i3s/PagedNodeIndex.js\";import{getSplatSizeAlgorithm as G,getFixedSizeAlgorithm as H,getRendererInfo as q,getFilterInfo as T,rendererUsesFixedSizes as $,getAttributeInfo as J}from\"./i3s/PointCloudRendererUtil.js\";import{getAttributeValues as K,readGeometry as X,elevationFromPositions as Y}from\"./i3s/PointCloudWorkerUtil.js\";import{PointGraphic as Z}from\"./i3s/PointGraphic.js\";import{PointRenderer as ee,isInstanceOfNode as te}from\"./i3s/PointRenderer.js\";import{PopupSceneLayerView as ie}from\"./support/PopupSceneLayerView.js\";import{projectToBoundingBox as re}from\"../support/extentUtils.js\";import{ClientType as se}from\"../support/index.js\";import{minimumDistancePlane as oe}from\"../support/orientedBoundingBox.js\";import{updatingProgress as ne}from\"../support/updatingProperties.js\";import{RenderSlot as ae}from\"../webgl-engine/lib/RenderSlot.js\";import de from\"../../layers/LayerView.js\";import{isScaleRangeActive as le,extractSafeScaleBounds as he,scaleBoundsPredicate as ue}from\"../../support/layerViewUtils.js\";import{TaskPriority as pe}from\"../../support/Scheduler.js\";const ce=s.getLogger(\"esri.views.3d.layers.PointCloudLayerView3D\"),_e=8,me=I();let ge=class extends(ie(Q(de))){constructor(){super(...arguments),this.type=\"point-cloud-3d\",this.maximumPointCount=4e6,this.slicePlaneEnabled=!1,this._renderer=null,this._rendererAdded=!1,this._renderedNodes=new Set,this._nodeScales=new Map,this._updateViewNeeded=!0,this._lodFactor=1,this._maxLoggedBoxWarnings=5,this._pageMultiplier=1,this._nodeLoadEpoch=0,this._indexQueue=[],this._workQueue=new Array,this._idleQueue=new U,this._indexPagesLoading=new Map,this._loadingNodes=new Map,this._recalcWork=!0,this._layerIsVisible=!1,this._codedDomainPopulationPromise=null,this._codedDomainPopulationAbortController=null,this._totalWork=0,this._index=null,this._loadingInitNodePage=!1,this._nodeIdArray=[]}get pointScale(){const e=G(this.layer&&this.layer.renderer),t=1;return e&&null!=e.scaleFactor?e.scaleFactor:t}get useRealWorldSymbolSizes(){const e=H(this.layer&&this.layer.renderer),t=!1;return e&&null!=e.useRealWorldSymbolSizes?e.useRealWorldSymbolSizes:t}get pointSize(){const e=H(this.layer&&this.layer.renderer),t=0;return e&&null!=e.size?e.size:t}get inverseDensity(){const e=96;return this.layer&&this.layer.renderer?1*e/this.layer.renderer.pointsPerInch:5}get availableFields(){const e=q(this.layer),t=new Set;e.primaryAttribute&&t.add(e.primaryAttribute.name),e.modulationAttribute&&t.add(e.primaryAttribute.name);const i=T(this.layer);if(i)for(const r of i)t.add(r.attributeInfo.name);if(this.layer.outFields)for(const r of j(this.layer.fieldsIndex,this.layer.outFields))t.add(r);return Array.from(t)}get _clippingBox(){if(!this.view||!this.view.clippingArea)return null;const e=C(),t=this.view.renderSpatialReference;return re(this.view.clippingArea,e,t)?e:null}get _elevationOffset(){const e=this.layer&&this.layer.elevationInfo;if(e&&\"absolute-height\"===e.mode){const t=b(this.layer.spatialReference),i=D(e.unit);return o(e.offset,0)*i/t}return 0}initialize(){const e=this.view.resourceController;this._worker=new F((t=>e.schedule(t))),this.addResolvingPromise(this._worker.promise),this._tmpPoint=V(0,0,0,this.layer.spatialReference),z(this.layer),M(this.layer,this.view),this._indexRequester=e.createStreamDataRequester(se.I3S_INDEX),this._dataRequester=e.createStreamDataRequester(se.I3S_DATA),this._initRenderer();const t=this._initNodePages(),i=this.view.resourceController.memoryController;this._memCache=i.newCache(this.layer.uid),this.updatingHandles.add((()=>this._clippingBox),(()=>this._setUpdateViewNeeded()),c),this.updatingHandles.add((()=>this._elevationOffset),(()=>this._elevationOffsetChanged()),c),this.updatingHandles.add((()=>this.layer.renderer),(()=>this._rendererChanged()),c),this.updatingHandles.add((()=>this.layer.filters),(()=>this._reload()),c),this.updatingHandles.add((()=>this.layer.outFields),(()=>this._reload()),c),this.updatingHandles.add((()=>this.layer.effectiveScaleRange),(()=>this._setUpdateViewNeeded())),this.updatingHandles.add((()=>this.view.state.contentCamera),(()=>this._setUpdateViewNeeded())),this.handles.add([this.view.basemapTerrain.on(\"scale-change\",(e=>this._scaleUpdateHandler(e))),_((()=>i.memoryFactor),(()=>this._setUpdateViewNeeded()),m)]),this.addResolvingPromise(t),this.when((()=>{this.handles.add([e.scheduler.registerTask(pe.POINT_CLOUD_LAYER,this),e.scheduler.registerIdleStateCallbacks((()=>this._idleBegin()),(()=>this._idleEnd())),this.updatingHandles.add((()=>this.suspended),(e=>{e?this._clearNodeState():this._setUpdateViewNeeded()}),c)])}),(()=>{this.updatingHandles.removeAll(),this.handles.removeAll()}))}_setUpdateViewNeeded(){this._updateViewNeeded=!0,this._updateLoading()}destroy(){this.cancelLoading(),this._worker&&(this._worker.destroy(),this._worker=null),this._destroyRenderer(),this._memCache.destroy(),this._memCache=null,this._codedDomainPopulationAbortController&&(this._codedDomainPopulationAbortController.abort(),this._codedDomainPopulationAbortController=null),this._codedDomainPopulationPromise=null}_initRenderer(){this._renderer=new ee({createGraphic:(e,t,i)=>this._createGraphic(e,t,i)}),this._renderer.layerUid=this.layer.uid,this.updatingHandles.add((()=>this._clippingBox),(e=>this._renderer.clippingBox=e),c),this.updatingHandles.add((()=>this.suspended),(e=>this._setPointsVisible(!e)),c),this.updatingHandles.add((()=>this.pointScale),(e=>this._renderer.scaleFactor=e),c),this._renderer.minSizePx=Math.sqrt(2),this.updatingHandles.add((()=>this.useRealWorldSymbolSizes),(e=>this._renderer.useRealWorldSymbolSizes=e),c),this.updatingHandles.add((()=>this.pointSize),(e=>{const t=g(e);this._renderer.size=e,this._renderer.sizePx=t}),c),this.updatingHandles.add((()=>this.slicePlaneEnabled),(e=>this._renderer.slicePlaneEnabled=e),c),this.updatingHandles.add((()=>this.inverseDensity),(()=>this._setUpdateViewNeeded()),c),this.updatingHandles.add((()=>this.maximumPointCount),(()=>this._setUpdateViewNeeded()),c),this.updatingHandles.add((()=>this.view.qualitySettings.sceneService.pointCloud.lodFactor),(e=>{this._lodFactor=e,this._setUpdateViewNeeded()}),c)}_destroyRenderer(){this._renderer.removeAll(),this._setPointsVisible(!1)}_createGraphic(e,t,i){const r=n(e.pointIdFilterMap)?e.pointIdFilterMap[t]:t,s=this.view.computeMapPointFromVec3d(i),o=this._createGraphicAttributes(e,r);return new Z({pointCloudMetadata:{nodeId:e.id,pointIndexInNode:t,attributePointIndexInNode:r,epoch:this._nodeLoadEpoch},geometry:s,attributes:o,layer:this.layer,sourceLayer:this.layer})}_createGraphicAttributes(e,t){const i={};for(const r of e.attributes)this._encodeGraphicAttribute(r.attributeInfo,r.values,t,i);return i}_encodeGraphicAttribute(e,t,i,r){const s=e.storageInfo&&e.storageInfo.attributeValues,o=s?s.valuesPerElement:1;if(1===o)r[e.name]=t[i];else if(\"UInt8\"===s.valueType&&o<=4){let s=0;const n=i*o;for(let e=n;e<n+o;e++)s=(s<<8)+t[e];r[e.name]=s}else r[e.name]=void 0}_setPointsVisible(e){e&&!this._rendererAdded?(this.view._stage.addRenderPlugin([ae.OPAQUE_MATERIAL],this._renderer),this._rendererAdded=!0):!e&&this._rendererAdded&&(this.view._stage.removeRenderPlugin(this._renderer),this._rendererAdded=!1)}_rendererChanged(){this._renderer.useFixedSizes=$(this.layer.renderer),this._reload()}_reload(){this._clearNodeState(),this._memCache.clear(),this._setUpdateViewNeeded()}_elevationOffsetChanged(){this._clearNodeState(),this._memCache.clear(),this._initNodePages()}_scaleUpdateHandler(e){const t=this.layer.effectiveScaleRange;le(t.minScale,t.maxScale)?v(e.extent,e.spatialReference,be,this.layer.spatialReference)&&(this._nodeScales.forEach(((t,i)=>{if(!this._renderedNodes.has(i))return void this._nodeScales.delete(i);const r=this._index.getNode(i);S(be,r.obb.center)&&this._nodeScales.set(i,e.scale)})),this._setUpdateViewNeeded()):this._nodeScales.clear()}_displayNodes(e){this._workQueue=W([...this._renderedNodes],e,this._index),E(this._workQueue,this.view.state.contentCamera.viewForward,this._index),O(this._workQueue,_e,this._index),this._updateQueues(),this._totalWork=this._computeWork(),this._updateLoading(),this._layerIsVisible=e.length>0||this._loadingInitNodePage,this.notifyChange(\"suspended\")}cancelLoading(){this._cancelNodeLoading(),this._cancelIndexLoading()}_cancelNodeLoading(){const e=new Array;this._loadingNodes.forEach((({abortController:t})=>e.push(t))),this._loadingNodes.clear();for(const t of e)t.abort();this._workQueue=[],this._idleQueue.cancelAll(),this._totalWork=this._computeWork(),this._updateLoading()}_updateQueues(){const e=new Set;this._workQueue.forEach((t=>t.load.forEach((t=>e.add(t)))));const t=new Array,i=new Map;this._loadingNodes.forEach(((r,s)=>{e.has(s)?i.set(s,r):t.push(r)})),this._loadingNodes=i;for(const{abortController:r}of t)r.abort();this._workQueue=this._workQueue.filter((e=>{for(const t of e.load)if(this._loadingNodes.has(t))return this._recalcWork=!0,!1;return!0})),this._totalWork=this._computeWork(),this._updateLoading()}_cancelIndexLoading(){this._indexQueue=[],this._indexPagesLoading.forEach((({abortController:e})=>e.abort())),this._indexPagesLoading.clear(),this._totalWork=this._computeWork(),this._updateLoading()}_clearNodeState(){this._nodeLoadEpoch++,this._renderedNodes.forEach((e=>this._removeFromRenderer(e))),this._cancelNodeLoading()}_idleBegin(){this._setUpdateViewNeeded()}_idleEnd(){this._setUpdateViewNeeded()}get running(){return this.suspended?this._updateViewNeeded:this._updateViewNeeded||this._indexQueue.length>0||this._workQueue.length>0||this._idleQueue.running}runTask(e){if(this.suspended){if(this._updateViewNeeded){this._updateViewNeeded=!1;const e=this._isRootNodeVisible();e!==this._layerIsVisible&&(this._layerIsVisible=e,this.notifyChange(\"suspended\")),this._updateLoading()}}else{for(e.run((()=>this._updateWorkQueues()));this._indexQueue.length>0&&e.run((()=>this._processIndexQueue())););this._processWorkQueue(e),this._idleQueue.runTask(e)}}_processIndexQueue(){const e=this._indexQueue.shift(),t=this._loadNodePage(e);return this._indexPagesLoading.set(e,t),t.promise.then((t=>{this._index.addPage(e,t,this._elevationOffset),this._setUpdateViewNeeded()})).then((()=>{this._indexPagesLoading.delete(e)}),(()=>{this._indexPagesLoading.delete(e)})),!0}_processWorkQueue(e){for(;!e.done;){const t=this._scheduleWorkEntry();if(a(t))return;this._processWorkEntry(t),e.madeProgress()}}_scheduleWorkEntry(){let e=this._workQueue.length;for(;e--;){const e=this._workQueue.shift();if(!e.remove.find((e=>!this._renderedNodes.has(e))))return e;this._workQueue.push(e)}return null}_processWorkEntry(e){if(0!==e.load.length)Promise.all(e.load.map((e=>{const t=new AbortController,i=this._memCache.pop(e.toString());return n(i)?this._loadingNodes.set(e,{abortController:t,promise:Promise.resolve(i)}):this._loadingNodes.has(e)||this._loadingNodes.set(e,{abortController:t,promise:this._loadNode(e,t.signal)}),this._loadingNodes.get(e).promise}))).then((t=>{for(let i=0;i<e.load.length;i++)if(t[i]){const r=this._setupRendererData(e.load[i],t[i]);this._addToRenderer(r)}for(const i of e.remove)this._removeFromRenderer(i)})).catch((()=>{})).then((()=>{for(const t of e.load)this._loadingNodes.delete(t);this._updateLoading(),this._recalcWork&&!this._idleQueue.running&&0===this._indexQueue.length&&0===this._loadingNodes.size&&(this._recalcWork=!1,this._setUpdateViewNeeded())})),this._updateLoading();else for(const t of e.remove)this._removeFromRenderer(t)}async _populateClassCodeCodedDomain(e,i){const r=\"CLASS_CODE\",s=this.layer.fieldsIndex.get(r);if(!s||s.domain)return;if(!e.includes(s.name))return;const o=await t(this.layer.queryCachedStatistics(r,{signal:i}));if(!1===o.ok)return;const n=o.value,a=n&&n.labels&&n.labels.labels;a&&Array.isArray(a)&&(s.domain=new L({name:\"CLASS_CODE\",codedValues:a.map((e=>new R({code:e.value,name:e.label})))}))}async prepareFetchPopupFeatures(e){return this._codedDomainPopulationPromise||(this._codedDomainPopulationAbortController=new AbortController,this._codedDomainPopulationPromise=this._populateClassCodeCodedDomain(e,this._codedDomainPopulationAbortController.signal).then((()=>{this._codedDomainPopulationAbortController=null}))),this._codedDomainPopulationPromise}async whenGraphicAttributes(e,t){const r=this._splitGraphicsPerNode(e),s=this.layer.attributeStorageInfo,o=t.map((e=>J(s,e))),n=async(e,t)=>{const r=this._index.getNode(t);await i(o,(async t=>{const i=t.useElevation?await this._loadElevationAttributeFromGeometry(r.resourceId):await this._loadAndParseAttribute(r,t);if(i)for(const r of e)if(this._isValidPointGraphic(r)){const e=r.pointCloudMetadata.attributePointIndexInNode;this._encodeGraphicAttribute(t,i,e,r.attributes)}}))},a=[];return r.forEach(((e,t)=>{a.push(n(e,t))})),await l(a),e}_isValidPointGraphic(e){return e instanceof Z&&e.pointCloudMetadata&&e.pointCloudMetadata.epoch===this._nodeLoadEpoch}_splitGraphicsPerNode(e){const t=new Map;for(const i of e){if(!this._isValidPointGraphic(i))continue;const e=i.pointCloudMetadata,r=t.get(e.nodeId);r?r.push(i):t.set(e.nodeId,[i])}return t}async _loadAndParseAttribute(e,t){const i=await this._loadAttribute(e.resourceId,t,null);return n(i)?K({attributeInfo:t,buffer:i},null,e.vertexCount):null}async _loadElevationAttributeFromGeometry(e){const t=this.layer.store.defaultGeometrySchema,i=X(t,await this._loadGeometry(e,null));return Y(i,i.length/3)}highlight(e){if(!e)return{remove(){}};const t=r.isCollection(e)?e.toArray():Array.isArray(e)?e:[e];return this._renderer.highlight(t.map((e=>this._graphicToPointDefinition(e))))}_graphicToPointDefinition(e){if(!this._isValidPointGraphic(e))return null;const{nodeId:t,pointIndexInNode:i}=e.pointCloudMetadata;return null!=t&&null!=i?{nodeId:t,pointId:i}:null}_computeWork(){let e=0;for(const t of this._workQueue)e+=t.load.length+t.remove.length;return e+=this._loadingNodes.size,e+=(this._indexQueue.length+this._indexPagesLoading.size)*this._index.pageSize,e+=this._loadingInitNodePage?100:0,e+=this._updateViewNeeded?100:0,e}get updatingProgressValue(){if(this.suspended)return this._updateViewNeeded?0:1;const e=this._computeWork();return 1-Math.min(this._totalWork,e)/this._totalWork}_updateLoading(){this.notifyChange(\"updating\"),this.notifyChange(\"updatingProgressValue\")}canResume(){return super.canResume()&&this._layerIsVisible}isUpdating(){return this.suspended?this._updateViewNeeded:this._computeWork()>0}_initNodePages(){const e=this.layer.store.index,t=e.nodesPerPage||e.nodePerIndexBlock;return this._index=new B(this.layer.spatialReference,this.view.renderCoordsHelper.spatialReference,t),this._cancelIndexLoading(),this._traverseVisible=this._index.createVisibilityTraverse(),this._loadingInitNodePage=!0,this._layerIsVisible=!0,this.notifyChange(\"suspended\"),this._updateLoading(),this._pageMultiplier=null!=e.nodesPerPage?1:e.nodePerIndexBlock,this._loadNodePage(0).promise.then((e=>{this._index.addPage(0,e,this._elevationOffset),this._loadingInitNodePage=!1,this._setUpdateViewNeeded()}))}_loadNodePage(e){const t=new AbortController,i=`${this.baseUrl}/nodepages/${e*this._pageMultiplier}`;return{promise:this._requestNodePage(i,t.signal).then((t=>t.nodes.map(((t,i)=>({resourceId:null!=t.resourceId?t.resourceId:e*this._index.pageSize+i,obb:t.obb,firstChild:t.firstChild,childCount:t.childCount,vertexCount:null!=t.vertexCount?t.vertexCount:t.pointCount,lodThreshold:null!=t.lodThreshold?t.lodThreshold:t.effectiveArea}))))),abortController:t}}_updateWorkQueues(){if(!this._updateViewNeeded)return!1;let e=this.inverseDensity/this._lodFactor*this._getLodMemoryFactor();const t=this.maximumPointCount*this._lodFactor*this._getLodMemoryFactor();let i=this._computeNodesForMinimumDensity(e),r=this._computePointCount(i),s=Math.sqrt(r/(.75*t));for(;r>t;)e*=s,i=this._computeNodesForMinimumDensity(e),r=this._computePointCount(i),s=Math.sqrt(2);return this._displayNodes(i),this._updateViewNeeded=!1,this._updateLoading(),!0}_computePointCount(e){let t=0;for(let i=0;i<e.length;i++){const r=this._index.getNode(e[i]);r&&(t+=r.vertexCount)}return t}_getLodMemoryFactor(){return this.view.resourceController.memoryController.memoryFactor}_isRootNodeVisible(){let e=!1;return this._traverseVisible({frustum:this.view.state.contentCamera.frustum,clippingBox:this._clippingBox},{predicate:(t,i,r)=>(e=r,!1),pageMiss:()=>{}}),e}_computeNodesForMinimumDensity(e){const t=this.view.state.contentCamera,i=t.frustum,r=this._clippingBox,s=t.viewForward,o=P(s,t.eye),n=k(s,-o,me),a=t.perScreenPixelRatio/2,d=e*e,l=this._nodeIdArray;l.length=0;const{minScale:h,maxScale:u}=he(this.layer),p=0===h&&0===u?e=>l.push(e):e=>{const t=this._getScale(e);ue(t,h,u)&&l.push(e)};return this._traverseVisible({frustum:i,clippingBox:r},{predicate:(e,t,i)=>{if(!i)return!1;if(0===t.childCount)return p(e),!1;const r=this._index.getRenderObb(e);return!(this._computeAveragePixelArea(r,t.lodThreshold,t.vertexCount,n,a)<=d)||(p(e),!1)},pageMiss:(e,t)=>{p(e),this._indexQueue.includes(t)||this._indexQueue.push(t)}}),l}_getScale(e){let t=this._nodeScales.get(e);if(null==t){const i=this._index.getNode(e).obb.center;this._tmpPoint.x=i[0],this._tmpPoint.y=i[1],this._tmpPoint.z=i[2],t=this.view.basemapTerrain.getScale(this._tmpPoint),this._nodeScales.set(e,t)}return t}_computeAveragePixelArea(e,t,i,r,s){const o=1e-7,n=Math.max(o,oe(e,r));return t/(n*n)/(4*s*s)/i}_loadNode(e,t){try{return this._loadNodeAsync(e,t)}catch(i){throw h(i)||ce.error(i),i}}async _loadAdditionalUserAttributes(e,t,i){const r=this.layer.outFields;if(!r)return[];const s=j(this.layer.fieldsIndex,r),o=new Set(e.map((e=>n(e)?e.name:null))),a=this.layer.attributeStorageInfo,l=[];for(const n of s){if(o.has(n))continue;const e=J(a,n);e&&l.push(t(e))}const h=await u(l);return p(i),d(h,(e=>e))}async _loadNodeAsync(e,t){const i=this._index.getNode(e),r=q(this.layer),s=T(this.layer),o=i.resourceId,d=async e=>{if(a(e))return null;if(e.useElevation)return{attributeInfo:e,buffer:null};const i=await this._loadAttribute(o,e,t);return n(i)?{attributeInfo:e,buffer:i}:null};return this._idleQueue.push((async()=>{const i=this._loadGeometry(o,t),{primaryAttribute:n,modulationAttribute:a}=r,l=d(n),h=d(a),u=s.map((e=>e.attributeInfo)),c=u.map((e=>d(e))),_=this._loadAdditionalUserAttributes([n,a,...u],d,t),[m,g,f,y,b]=await Promise.all([i,l,h,Promise.all(c),_]);p(t);const w={geometryBuffer:m,primaryAttributeData:g,modulationAttributeData:f,filterAttributesData:y,userAttributesData:b,schema:this.layer.store.defaultGeometrySchema,rendererInfo:r,filterInfo:s,obb:this._index.getRenderObb(e),elevationOffset:this._elevationOffset,inSR:this.layer.spatialReference.toJSON(),outSR:this.view.renderCoordsHelper.spatialReference.toJSON()};return this._worker.invoke(w,t)}),t)}async _loadGeometry(e,t){return this._requestData(`${this.baseUrl}/nodes/${e}/geometries/0`,t)}async _loadAttribute(e,t,i){if(a(t)||!t.storageInfo)return null;const r=t.storageInfo.key;return this._requestData(`${this.baseUrl}/nodes/${e}/attributes/${r}`,i)}_requestNodePage(e,t){const i={f:\"json\",token:this.layer.apiKey};return this._indexRequester.request(e,\"json\",{query:i,signal:t})}_requestData(e,t){return this._dataRequester.request(e,\"binary\",{query:{token:this.layer.apiKey},signal:t})}_removeFromRenderer(e){if(this._renderedNodes.has(e)){const t=this._renderer.removeNode(e);this._renderedNodes.delete(e),this._nodeScales.delete(e),this._memCache.put(t.id.toString(),t,ye(t))}}_addToRenderer(e){this._renderedNodes.has(e.id)||(this._renderedNodes.add(e.id),this._renderer.addNode(e))}_setupRendererData(e,t){const i=this._index.getNode(e),r=Math.sqrt(i.lodThreshold/i.vertexCount),s=this._index.getRenderObb(e);if(te(t))return t.splatSize=r,t.obb=s,t.origin=x(t.obb.center),t;const o=.01*Math.max(s.halfSize[0],s.halfSize[1],s.halfSize[2]);if(t.obb.halfSize[0]>s.halfSize[0]+o||t.obb.halfSize[1]>s.halfSize[1]+o||t.obb.halfSize[2]>s.halfSize[2]+o){if(this._maxLoggedBoxWarnings>0){const i=e=>`[${e.halfSize[0]}, ${e.halfSize[1]}, ${e.halfSize[2]}]`;ce.warn(`Node ${e} reported bounding box too small. got ${i(s)} but points cover ${i(t.obb)}`),0==--this._maxLoggedBoxWarnings&&ce.warn(\"  Too many bounding box errors, stopping reporting for this layer.\")}this._index.setRenderObb(e,t.obb)}return{id:e,coordinates:t.points,origin:x(s.center),rgb:t.rgb,attributes:t.attributes,pointIdFilterMap:t.pointIdFilterMap,highlights:null,splatSize:r,obb:s,isLeaf:0===i.childCount}}getUsedMemory(){let e=0;return this._renderer.forEachNode((t=>{e+=we,e+=f(t.coordinates);for(const i of t.attributes){const t=i.values;y(t.buffer)&&(e+=f(t))}})),e}getUnloadedMemory(){const e=this._renderedNodes.size;if(e<4)return 0;const t=[...this._renderedNodes].reduce(((e,t)=>e+this._index.getNode(t).vertexCount));let i=this._loadingNodes.size;for(let r=0;r<this._workQueue.length;r++)i+=this._workQueue[r].load.length,i-=this._workQueue[r].remove.length;if(i<0)return 0;return i*t/e*((this.getUsedMemory()-e*we)/t)+i*we}ignoresMemoryFactor(){return!1}get performanceInfo(){return{nodes:this._renderedNodes.size,displayedNumberOfFeatures:[...this._renderedNodes].reduce(((e,t)=>e+this._index.getNode(t).vertexCount),0),maximumNumberOfFeatures:this.maximumPointCount,totalNumberOfFeatures:-1,core:null,\"Loading Nodes\":this._loadingNodes.size,\"Index Queue\":this._indexQueue.length,\"Work Queue\":this._workQueue.length,\"Idle Queue\":this._idleQueue.length}}get test(){return{index:this._index,visibleNodes:this._renderedNodes}}};e([w()],ge.prototype,\"layer\",void 0),e([w({readOnly:!0,aliasOf:\"layer.parsedUrl.path\"})],ge.prototype,\"baseUrl\",void 0),e([w({readOnly:!0})],ge.prototype,\"pointScale\",null),e([w({readOnly:!0})],ge.prototype,\"useRealWorldSymbolSizes\",null),e([w({readOnly:!0})],ge.prototype,\"pointSize\",null),e([w({readOnly:!0})],ge.prototype,\"inverseDensity\",null),e([w()],ge.prototype,\"maximumPointCount\",void 0),e([w({readOnly:!0})],ge.prototype,\"availableFields\",null),e([w({readOnly:!0})],ge.prototype,\"_clippingBox\",null),e([w({readOnly:!0})],ge.prototype,\"_elevationOffset\",null),e([w({type:Boolean})],ge.prototype,\"slicePlaneEnabled\",void 0),e([w()],ge.prototype,\"updating\",void 0),e([w(ne)],ge.prototype,\"updatingProgress\",void 0),e([w({readOnly:!0})],ge.prototype,\"updatingProgressValue\",null),ge=e([N(\"esri.views.3d.layers.PointCloudLayerView3D\")],ge);const fe=ge;function ye(e){return 5*e.coordinates.length+128}const be=A(),we=160;export{fe as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}