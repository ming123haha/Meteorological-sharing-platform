{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isArrayLike as e } from \"../../../../../core/arrayUtils.js\";\nimport { isNone as t, isSome as r } from \"../../../../../core/maybe.js\";\nimport { WGLDrawPhase as s } from \"../enums.js\";\n\nclass a {\n  constructor(e, t) {\n    this.brushes = e, this.name = t.name, this.drawPhase = t.drawPhase || s.MAP, this._targetFn = t.target, this.effects = t.effects || [], this.enableDefaultDraw = t.enableDefaultDraw ?? (() => !0);\n  }\n\n  render(e) {\n    const {\n      context: t,\n      profiler: r\n    } = e,\n          s = this._targetFn(),\n          a = this.drawPhase & e.drawPhase;\n\n    if (r.recordPassStart(this.name), a) {\n      this.enableDefaultDraw() && this._doRender(e, s), r.recordPassEnd();\n\n      for (const r of this.effects) {\n        if (!r.enable()) continue;\n        const a = r.apply,\n              n = r.args && r.args(),\n              i = t.getViewport(),\n              o = t.getBoundFramebufferObject(),\n              f = e.passOptions;\n        this._bindEffect(e, a, n), this._doRender(e, s, a.defines), this._drawAndUnbindEffect(e, a, i, o, f, n);\n      }\n    }\n  }\n\n  _doRender(e, s, a) {\n    if (t(s)) return;\n    const {\n      profiler: n,\n      context: i\n    } = e;\n\n    for (const t of this.brushes) {\n      if (n.recordBrushStart(t.name), r(t.brushEffect)) {\n        const r = i.getViewport(),\n              n = i.getBoundFramebufferObject(),\n              o = e.passOptions;\n        this._bindEffect(e, t.brushEffect), this._drawWithBrush(t, e, s, a), this._drawAndUnbindEffect(e, t.brushEffect, r, n, o);\n      } else this._drawWithBrush(t, e, s, a);\n\n      n.recordBrushEnd();\n    }\n  }\n\n  _drawWithBrush(t, r, s, a) {\n    e(s) ? (t.prepareState(r, a), t.drawMany(r, s, a)) : s.visible && (t.prepareState(r, a), t.draw(r, s, a));\n  }\n\n  _bindEffect(e, t, r) {\n    const {\n      profiler: s\n    } = e;\n    s.recordPassStart(this.name + \".\" + t.name), t.bind(e, r);\n    const a = t.createOptions(e, r);\n    e.passOptions = a;\n  }\n\n  _drawAndUnbindEffect(e, t, r, s, a, n) {\n    const {\n      profiler: i,\n      context: o\n    } = e;\n    e.passOptions = a, i.recordBrushStart(t.name), t.draw(e, n), t.unbind(e, n), o.bindFramebuffer(s);\n    const {\n      x: f,\n      y: d,\n      width: h,\n      height: c\n    } = r;\n    o.setViewport(f, d, h, c), i.recordBrushEnd(), i.recordPassEnd();\n  }\n\n}\n\nexport { a as default };","map":{"version":3,"names":["isArrayLike","e","isNone","t","isSome","r","WGLDrawPhase","s","a","constructor","brushes","name","drawPhase","MAP","_targetFn","target","effects","enableDefaultDraw","render","context","profiler","recordPassStart","_doRender","recordPassEnd","enable","apply","n","args","i","getViewport","o","getBoundFramebufferObject","f","passOptions","_bindEffect","defines","_drawAndUnbindEffect","recordBrushStart","brushEffect","_drawWithBrush","recordBrushEnd","prepareState","drawMany","visible","draw","bind","createOptions","unbind","bindFramebuffer","x","y","d","width","h","height","c","setViewport","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/painter/RenderPass.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isArrayLike as e}from\"../../../../../core/arrayUtils.js\";import{isNone as t,isSome as r}from\"../../../../../core/maybe.js\";import{WGLDrawPhase as s}from\"../enums.js\";class a{constructor(e,t){this.brushes=e,this.name=t.name,this.drawPhase=t.drawPhase||s.MAP,this._targetFn=t.target,this.effects=t.effects||[],this.enableDefaultDraw=t.enableDefaultDraw??(()=>!0)}render(e){const{context:t,profiler:r}=e,s=this._targetFn(),a=this.drawPhase&e.drawPhase;if(r.recordPassStart(this.name),a){this.enableDefaultDraw()&&this._doRender(e,s),r.recordPassEnd();for(const r of this.effects){if(!r.enable())continue;const a=r.apply,n=r.args&&r.args(),i=t.getViewport(),o=t.getBoundFramebufferObject(),f=e.passOptions;this._bindEffect(e,a,n),this._doRender(e,s,a.defines),this._drawAndUnbindEffect(e,a,i,o,f,n)}}}_doRender(e,s,a){if(t(s))return;const{profiler:n,context:i}=e;for(const t of this.brushes){if(n.recordBrushStart(t.name),r(t.brushEffect)){const r=i.getViewport(),n=i.getBoundFramebufferObject(),o=e.passOptions;this._bindEffect(e,t.brushEffect),this._drawWithBrush(t,e,s,a),this._drawAndUnbindEffect(e,t.brushEffect,r,n,o)}else this._drawWithBrush(t,e,s,a);n.recordBrushEnd()}}_drawWithBrush(t,r,s,a){e(s)?(t.prepareState(r,a),t.drawMany(r,s,a)):s.visible&&(t.prepareState(r,a),t.draw(r,s,a))}_bindEffect(e,t,r){const{profiler:s}=e;s.recordPassStart(this.name+\".\"+t.name),t.bind(e,r);const a=t.createOptions(e,r);e.passOptions=a}_drawAndUnbindEffect(e,t,r,s,a,n){const{profiler:i,context:o}=e;e.passOptions=a,i.recordBrushStart(t.name),t.draw(e,n),t.unbind(e,n),o.bindFramebuffer(s);const{x:f,y:d,width:h,height:c}=r;o.setViewport(f,d,h,c),i.recordBrushEnd(),i.recordPassEnd()}}export{a as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}