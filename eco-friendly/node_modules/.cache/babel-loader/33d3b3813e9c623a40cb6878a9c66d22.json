{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from \"../../../../core/Handles.js\";\nimport { watch as i, initial as e } from \"../../../../core/reactiveUtils.js\";\nimport { addFrameTask as a } from \"../../../../core/scheduling.js\";\nimport { translateBy as s, scaleAndRotateBy as n } from \"../../viewpointUtils.js\";\nimport { InputHandler as r } from \"../../../input/InputHandler.js\";\nimport { resetTransformation as o, extractTransformation as h, isZeroTransformation as l } from \"../../../navigation/gamepadAndKeyboardUtils.js\";\n\nclass d extends r {\n  constructor(i) {\n    super(!0), this._view = i, this._frameTask = null, this._watchHandles = new t(), this._currentDevice = null, this._transformation = {\n      translation: [0, 0, 0],\n      heading: 0,\n      tilt: 0,\n      zoom: 0\n    }, this._handle = this.registerIncoming(\"gamepad\", t => this._handleGamePadEvent(t)), this._handle.pause();\n  }\n\n  onInstall(t) {\n    super.onInstall(t), this._watchHandles.add([i(() => this._view.navigation.gamepad?.enabled, t => {\n      t ? (this._handle.resume(), this._frameTask || (this._frameTask = a({\n        update: t => this._frameUpdate(t.deltaTime)\n      }))) : (this._handle.pause(), this._frameTask && (this._frameTask.remove(), this._frameTask = null));\n    }, e)]);\n  }\n\n  onUninstall() {\n    this._watchHandles.removeAll(), this._frameTask && (this._frameTask.remove(), this._frameTask = null), super.onUninstall();\n  }\n\n  _handleGamePadEvent(t) {\n    const i = this._view.navigation.gamepad.device;\n    i && t.data.device !== i || this._currentDevice && this._currentDevice !== t.data.device || (\"end\" === t.data.action ? (this._currentDevice = null, o(this._transformation)) : (this._currentDevice = t.data.device, h(t.data, this._view.navigation.gamepad, this._transformation)));\n  }\n\n  _frameUpdate(t) {\n    const i = this._transformation;\n    if (l(i)) return;\n\n    const e = this._view.viewpoint.clone(),\n          a = this._view.navigation.gamepad.velocityFactor,\n          r = _ * a * t;\n\n    s(e, e, [i.translation[0] * r, -i.translation[1] * r]);\n    const o = 1 + i.translation[2] * c * t,\n          h = this._view.constraints.rotationEnabled ? -i.heading * m * t : 0,\n          d = this._view.size,\n          v = [d[0] / 2, d[1]];\n    n(e, e, o, h, v, d);\n\n    const p = this._view.constraints.constrain(e, this._view.viewpoint);\n\n    this._view.viewpoint = p;\n  }\n\n}\n\nconst m = .06,\n      _ = .7,\n      c = 6e-4;\nexport { d as GamepadNavigation };","map":{"version":3,"names":["t","watch","i","initial","e","addFrameTask","a","translateBy","s","scaleAndRotateBy","n","InputHandler","r","resetTransformation","o","extractTransformation","h","isZeroTransformation","l","d","constructor","_view","_frameTask","_watchHandles","_currentDevice","_transformation","translation","heading","tilt","zoom","_handle","registerIncoming","_handleGamePadEvent","pause","onInstall","add","navigation","gamepad","enabled","resume","update","_frameUpdate","deltaTime","remove","onUninstall","removeAll","device","data","action","viewpoint","clone","velocityFactor","_","c","constraints","rotationEnabled","m","size","v","p","constrain","GamepadNavigation"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/input/handlers/GamepadNavigation.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Handles.js\";import{watch as i,initial as e}from\"../../../../core/reactiveUtils.js\";import{addFrameTask as a}from\"../../../../core/scheduling.js\";import{translateBy as s,scaleAndRotateBy as n}from\"../../viewpointUtils.js\";import{InputHandler as r}from\"../../../input/InputHandler.js\";import{resetTransformation as o,extractTransformation as h,isZeroTransformation as l}from\"../../../navigation/gamepadAndKeyboardUtils.js\";class d extends r{constructor(i){super(!0),this._view=i,this._frameTask=null,this._watchHandles=new t,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming(\"gamepad\",(t=>this._handleGamePadEvent(t))),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([i((()=>this._view.navigation.gamepad?.enabled),(t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=a({update:t=>this._frameUpdate(t.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),e)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const i=this._view.navigation.gamepad.device;i&&t.data.device!==i||this._currentDevice&&this._currentDevice!==t.data.device||(\"end\"===t.data.action?(this._currentDevice=null,o(this._transformation)):(this._currentDevice=t.data.device,h(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){const i=this._transformation;if(l(i))return;const e=this._view.viewpoint.clone(),a=this._view.navigation.gamepad.velocityFactor,r=_*a*t;s(e,e,[i.translation[0]*r,-i.translation[1]*r]);const o=1+i.translation[2]*c*t,h=this._view.constraints.rotationEnabled?-i.heading*m*t:0,d=this._view.size,v=[d[0]/2,d[1]];n(e,e,o,h,v,d);const p=this._view.constraints.constrain(e,this._view.viewpoint);this._view.viewpoint=p}}const m=.06,_=.7,c=6e-4;export{d as GamepadNavigation};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}