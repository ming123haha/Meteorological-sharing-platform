{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/has.js\";\nimport { throwIfAborted as t, isAbortError as r } from \"../../../../../core/promiseUtils.js\";\nimport { BaseFeatureSource as s } from \"./BaseFeatureSource.js\";\nconst i = e(\"esri-mobile\"),\n      a = {\n  maxDrillLevel: i ? 1 : 4,\n  maxRecordCountFactor: i ? 1 : 3\n};\n\nclass o extends s {\n  constructor(e) {\n    super(e);\n  }\n\n  async _fetchDataTile(e) {\n    const s = this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,\n          i = this._subscriptions.get(e.key.id),\n          o = i.signal,\n          n = e.getQuantizationParameters();\n\n    let c = 0;\n\n    const d = async (u, l) => {\n      const p = this._queryInfo,\n            m = this.createTileQuery(u, {\n        maxRecordCountFactor: s ? a.maxRecordCountFactor : void 0,\n        returnExceededLimitFeatures: !1,\n        quantizationParameters: n\n      });\n      c++;\n\n      try {\n        const r = await this._queue.push({\n          tile: e,\n          query: m,\n          signal: o,\n          depth: l\n        });\n        if (c--, t(o), !r) return;\n        if (p !== this._queryInfo) return void d(u, l);\n\n        if (r.exceededTransferLimit && l < a.maxDrillLevel) {\n          for (const e of u.createChildTiles()) d(e, l + 1);\n\n          return;\n        }\n\n        const s = {\n          id: e.id,\n          addOrUpdate: r,\n          end: 0 === c,\n          type: \"append\"\n        };\n        i.add({\n          query: m,\n          message: s\n        }), this._onMessage(s);\n      } catch (h) {\n        r(h) || this._onMessage({\n          id: e.id,\n          addOrUpdate: null,\n          end: !0,\n          type: \"append\"\n        });\n      }\n    };\n\n    d(e, 0);\n  }\n\n}\n\nexport { o as DrillDownFeatureSource };","map":{"version":3,"names":["e","throwIfAborted","t","isAbortError","r","BaseFeatureSource","s","i","a","maxDrillLevel","maxRecordCountFactor","o","constructor","_fetchDataTile","_serviceInfo","capabilities","query","supportsMaxRecordCountFactor","_subscriptions","get","key","id","signal","n","getQuantizationParameters","c","d","u","l","p","_queryInfo","m","createTileQuery","returnExceededLimitFeatures","quantizationParameters","_queue","push","tile","depth","exceededTransferLimit","createChildTiles","addOrUpdate","end","type","add","message","_onMessage","h","DrillDownFeatureSource"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/features/sources/DrillDownFeatureSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/has.js\";import{throwIfAborted as t,isAbortError as r}from\"../../../../../core/promiseUtils.js\";import{BaseFeatureSource as s}from\"./BaseFeatureSource.js\";const i=e(\"esri-mobile\"),a={maxDrillLevel:i?1:4,maxRecordCountFactor:i?1:3};class o extends s{constructor(e){super(e)}async _fetchDataTile(e){const s=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,i=this._subscriptions.get(e.key.id),o=i.signal,n=e.getQuantizationParameters();let c=0;const d=async(u,l)=>{const p=this._queryInfo,m=this.createTileQuery(u,{maxRecordCountFactor:s?a.maxRecordCountFactor:void 0,returnExceededLimitFeatures:!1,quantizationParameters:n});c++;try{const r=await this._queue.push({tile:e,query:m,signal:o,depth:l});if(c--,t(o),!r)return;if(p!==this._queryInfo)return void d(u,l);if(r.exceededTransferLimit&&l<a.maxDrillLevel){for(const e of u.createChildTiles())d(e,l+1);return}const s={id:e.id,addOrUpdate:r,end:0===c,type:\"append\"};i.add({query:m,message:s}),this._onMessage(s)}catch(h){r(h)||this._onMessage({id:e.id,addOrUpdate:null,end:!0,type:\"append\"})}};d(e,0)}}export{o as DrillDownFeatureSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}