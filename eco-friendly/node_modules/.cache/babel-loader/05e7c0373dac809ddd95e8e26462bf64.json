{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from \"../../core/Logger.js\";\nimport { isSome as e, disposeMaybe as i, nullifyNonNullableForDispose as r } from \"../../core/maybe.js\";\nimport { ResourceType as s } from \"./enums.js\";\nimport { bindVertexBufferLayout as n, unbindVertexBufferLayout as o } from \"./Util.js\";\nconst f = t.getLogger(\"esri.views.webgl.VertexArrayObject\");\n\nclass a {\n  constructor(t, e, i, r, n = null) {\n    this._context = t, this._locations = e, this._layout = i, this._buffers = r, this._indexBuffer = n, this._glName = null, this._initialized = !1, t.instanceCounter.increment(s.VertexArrayObject, this);\n  }\n\n  get glName() {\n    return this._glName;\n  }\n\n  get context() {\n    return this._context;\n  }\n\n  get vertexBuffers() {\n    return this._buffers;\n  }\n\n  get indexBuffer() {\n    return this._indexBuffer;\n  }\n\n  get size() {\n    return Object.keys(this._buffers).reduce((t, e) => t + this._buffers[e].size, e(this._indexBuffer) ? this._indexBuffer.size : 0);\n  }\n\n  get layout() {\n    return this._layout;\n  }\n\n  get locations() {\n    return this._locations;\n  }\n\n  dispose(t = !0) {\n    if (!this._context) return void ((this._glName || t && Object.getOwnPropertyNames(this._buffers).length > 0) && f.warn(\"Leaked WebGL VAO\"));\n\n    if (this._glName) {\n      const t = this._context?.capabilities?.vao;\n      t ? (t.deleteVertexArray(this._glName), this._glName = null) : f.warn(\"Leaked WebGL VAO\");\n    }\n\n    if (this._context.getBoundVAO() === this && this._context.bindVAO(null), t) {\n      for (const t in this._buffers) this._buffers[t]?.dispose(), delete this._buffers[t];\n\n      this._indexBuffer = i(this._indexBuffer);\n    }\n\n    this._context.instanceCounter.decrement(s.VertexArrayObject, this), this._context = r(this._context);\n  }\n\n  initialize() {\n    if (this._initialized) return;\n    const t = this._context.capabilities.vao;\n\n    if (t) {\n      const e = t.createVertexArray();\n      t.bindVertexArray(e), this._bindLayout(), t.bindVertexArray(null), this._glName = e;\n    }\n\n    this._initialized = !0;\n  }\n\n  bind() {\n    this.initialize();\n    const t = this._context.capabilities.vao;\n    t ? t.bindVertexArray(this.glName) : (this._context.bindVAO(null), this._bindLayout());\n  }\n\n  _bindLayout() {\n    const {\n      _buffers: t,\n      _layout: i,\n      _indexBuffer: r\n    } = this;\n    t || f.error(\"Vertex buffer dictionary is empty!\");\n    const s = this._context.gl;\n\n    for (const e in t) {\n      const r = t[e];\n      r || f.error(\"Vertex buffer is uninitialized!\");\n      const s = i[e];\n      s || f.error(\"Vertex element descriptor is empty!\"), n(this._context, this._locations, r, s);\n    }\n\n    if (e(r)) {\n      !!this._context.capabilities.vao ? s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, r.glName) : this._context.bindBuffer(r);\n    }\n  }\n\n  unbind() {\n    this.initialize();\n    const t = this._context.capabilities.vao;\n    t ? t.bindVertexArray(null) : this._unbindLayout();\n  }\n\n  _unbindLayout() {\n    const {\n      _buffers: t,\n      _layout: i\n    } = this;\n    t || f.error(\"Vertex buffer dictionary is empty!\");\n\n    for (const e in t) {\n      const r = t[e];\n      r || f.error(\"Vertex buffer is uninitialized!\");\n      const s = i[e];\n      o(this._context, this._locations, r, s);\n    }\n\n    e(this._indexBuffer) && this._context.unbindBuffer(this._indexBuffer.bufferType);\n  }\n\n}\n\nexport { a as VertexArrayObject };","map":{"version":3,"names":["t","isSome","e","disposeMaybe","i","nullifyNonNullableForDispose","r","ResourceType","s","bindVertexBufferLayout","n","unbindVertexBufferLayout","o","f","getLogger","a","constructor","_context","_locations","_layout","_buffers","_indexBuffer","_glName","_initialized","instanceCounter","increment","VertexArrayObject","glName","context","vertexBuffers","indexBuffer","size","Object","keys","reduce","layout","locations","dispose","getOwnPropertyNames","length","warn","capabilities","vao","deleteVertexArray","getBoundVAO","bindVAO","decrement","initialize","createVertexArray","bindVertexArray","_bindLayout","bind","error","gl","bindBuffer","ELEMENT_ARRAY_BUFFER","unbind","_unbindLayout","unbindBuffer","bufferType"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/webgl/VertexArrayObject.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from\"../../core/Logger.js\";import{isSome as e,disposeMaybe as i,nullifyNonNullableForDispose as r}from\"../../core/maybe.js\";import{ResourceType as s}from\"./enums.js\";import{bindVertexBufferLayout as n,unbindVertexBufferLayout as o}from\"./Util.js\";const f=t.getLogger(\"esri.views.webgl.VertexArrayObject\");class a{constructor(t,e,i,r,n=null){this._context=t,this._locations=e,this._layout=i,this._buffers=r,this._indexBuffer=n,this._glName=null,this._initialized=!1,t.instanceCounter.increment(s.VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce(((t,e)=>t+this._buffers[e].size),e(this._indexBuffer)?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(t=!0){if(!this._context)return void((this._glName||t&&Object.getOwnPropertyNames(this._buffers).length>0)&&f.warn(\"Leaked WebGL VAO\"));if(this._glName){const t=this._context?.capabilities?.vao;t?(t.deleteVertexArray(this._glName),this._glName=null):f.warn(\"Leaked WebGL VAO\")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),t){for(const t in this._buffers)this._buffers[t]?.dispose(),delete this._buffers[t];this._indexBuffer=i(this._indexBuffer)}this._context.instanceCounter.decrement(s.VertexArrayObject,this),this._context=r(this._context)}initialize(){if(this._initialized)return;const t=this._context.capabilities.vao;if(t){const e=t.createVertexArray();t.bindVertexArray(e),this._bindLayout(),t.bindVertexArray(null),this._glName=e}this._initialized=!0}bind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:t,_layout:i,_indexBuffer:r}=this;t||f.error(\"Vertex buffer dictionary is empty!\");const s=this._context.gl;for(const e in t){const r=t[e];r||f.error(\"Vertex buffer is uninitialized!\");const s=i[e];s||f.error(\"Vertex element descriptor is empty!\"),n(this._context,this._locations,r,s)}if(e(r)){!!this._context.capabilities.vao?s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r.glName):this._context.bindBuffer(r)}}unbind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:t,_layout:i}=this;t||f.error(\"Vertex buffer dictionary is empty!\");for(const e in t){const r=t[e];r||f.error(\"Vertex buffer is uninitialized!\");const s=i[e];o(this._context,this._locations,r,s)}e(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}export{a as VertexArrayObject};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,sBAAb;AAAoC,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,YAAY,IAAIC,CAAnC,EAAqCC,4BAA4B,IAAIC,CAArE,QAA2E,qBAA3E;AAAiG,SAAOC,YAAY,IAAIC,CAAvB,QAA6B,YAA7B;AAA0C,SAAOC,sBAAsB,IAAIC,CAAjC,EAAmCC,wBAAwB,IAAIC,CAA/D,QAAqE,WAArE;AAAiF,MAAMC,CAAC,GAACb,CAAC,CAACc,SAAF,CAAY,oCAAZ,CAAR;;AAA0D,MAAMC,CAAN,CAAO;EAACC,WAAW,CAAChB,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAASI,CAAC,GAAC,IAAX,EAAgB;IAAC,KAAKO,QAAL,GAAcjB,CAAd,EAAgB,KAAKkB,UAAL,GAAgBhB,CAAhC,EAAkC,KAAKiB,OAAL,GAAaf,CAA/C,EAAiD,KAAKgB,QAAL,GAAcd,CAA/D,EAAiE,KAAKe,YAAL,GAAkBX,CAAnF,EAAqF,KAAKY,OAAL,GAAa,IAAlG,EAAuG,KAAKC,YAAL,GAAkB,CAAC,CAA1H,EAA4HvB,CAAC,CAACwB,eAAF,CAAkBC,SAAlB,CAA4BjB,CAAC,CAACkB,iBAA9B,EAAgD,IAAhD,CAA5H;EAAkL;;EAAU,IAANC,MAAM,GAAE;IAAC,OAAO,KAAKL,OAAZ;EAAoB;;EAAW,IAAPM,OAAO,GAAE;IAAC,OAAO,KAAKX,QAAZ;EAAqB;;EAAiB,IAAbY,aAAa,GAAE;IAAC,OAAO,KAAKT,QAAZ;EAAqB;;EAAe,IAAXU,WAAW,GAAE;IAAC,OAAO,KAAKT,YAAZ;EAAyB;;EAAQ,IAAJU,IAAI,GAAE;IAAC,OAAOC,MAAM,CAACC,IAAP,CAAY,KAAKb,QAAjB,EAA2Bc,MAA3B,CAAmC,CAAClC,CAAD,EAAGE,CAAH,KAAOF,CAAC,GAAC,KAAKoB,QAAL,CAAclB,CAAd,EAAiB6B,IAA7D,EAAmE7B,CAAC,CAAC,KAAKmB,YAAN,CAAD,GAAqB,KAAKA,YAAL,CAAkBU,IAAvC,GAA4C,CAA/G,CAAP;EAAyH;;EAAU,IAANI,MAAM,GAAE;IAAC,OAAO,KAAKhB,OAAZ;EAAoB;;EAAa,IAATiB,SAAS,GAAE;IAAC,OAAO,KAAKlB,UAAZ;EAAuB;;EAAAmB,OAAO,CAACrC,CAAC,GAAC,CAAC,CAAJ,EAAM;IAAC,IAAG,CAAC,KAAKiB,QAAT,EAAkB,OAAO,MAAK,CAAC,KAAKK,OAAL,IAActB,CAAC,IAAEgC,MAAM,CAACM,mBAAP,CAA2B,KAAKlB,QAAhC,EAA0CmB,MAA1C,GAAiD,CAAnE,KAAuE1B,CAAC,CAAC2B,IAAF,CAAO,kBAAP,CAA5E,CAAP;;IAA+G,IAAG,KAAKlB,OAAR,EAAgB;MAAC,MAAMtB,CAAC,GAAC,KAAKiB,QAAL,EAAewB,YAAf,EAA6BC,GAArC;MAAyC1C,CAAC,IAAEA,CAAC,CAAC2C,iBAAF,CAAoB,KAAKrB,OAAzB,GAAkC,KAAKA,OAAL,GAAa,IAAjD,IAAuDT,CAAC,CAAC2B,IAAF,CAAO,kBAAP,CAAxD;IAAmF;;IAAA,IAAG,KAAKvB,QAAL,CAAc2B,WAAd,OAA8B,IAA9B,IAAoC,KAAK3B,QAAL,CAAc4B,OAAd,CAAsB,IAAtB,CAApC,EAAgE7C,CAAnE,EAAqE;MAAC,KAAI,MAAMA,CAAV,IAAe,KAAKoB,QAApB,EAA6B,KAAKA,QAAL,CAAcpB,CAAd,GAAkBqC,OAAlB,IAA4B,OAAO,KAAKjB,QAAL,CAAcpB,CAAd,CAAnC;;MAAoD,KAAKqB,YAAL,GAAkBjB,CAAC,CAAC,KAAKiB,YAAN,CAAnB;IAAuC;;IAAA,KAAKJ,QAAL,CAAcO,eAAd,CAA8BsB,SAA9B,CAAwCtC,CAAC,CAACkB,iBAA1C,EAA4D,IAA5D,GAAkE,KAAKT,QAAL,GAAcX,CAAC,CAAC,KAAKW,QAAN,CAAjF;EAAiG;;EAAA8B,UAAU,GAAE;IAAC,IAAG,KAAKxB,YAAR,EAAqB;IAAO,MAAMvB,CAAC,GAAC,KAAKiB,QAAL,CAAcwB,YAAd,CAA2BC,GAAnC;;IAAuC,IAAG1C,CAAH,EAAK;MAAC,MAAME,CAAC,GAACF,CAAC,CAACgD,iBAAF,EAAR;MAA8BhD,CAAC,CAACiD,eAAF,CAAkB/C,CAAlB,GAAqB,KAAKgD,WAAL,EAArB,EAAwClD,CAAC,CAACiD,eAAF,CAAkB,IAAlB,CAAxC,EAAgE,KAAK3B,OAAL,GAAapB,CAA7E;IAA+E;;IAAA,KAAKqB,YAAL,GAAkB,CAAC,CAAnB;EAAqB;;EAAA4B,IAAI,GAAE;IAAC,KAAKJ,UAAL;IAAkB,MAAM/C,CAAC,GAAC,KAAKiB,QAAL,CAAcwB,YAAd,CAA2BC,GAAnC;IAAuC1C,CAAC,GAACA,CAAC,CAACiD,eAAF,CAAkB,KAAKtB,MAAvB,CAAD,IAAiC,KAAKV,QAAL,CAAc4B,OAAd,CAAsB,IAAtB,GAA4B,KAAKK,WAAL,EAA7D,CAAD;EAAkF;;EAAAA,WAAW,GAAE;IAAC,MAAK;MAAC9B,QAAQ,EAACpB,CAAV;MAAYmB,OAAO,EAACf,CAApB;MAAsBiB,YAAY,EAACf;IAAnC,IAAsC,IAA3C;IAAgDN,CAAC,IAAEa,CAAC,CAACuC,KAAF,CAAQ,oCAAR,CAAH;IAAiD,MAAM5C,CAAC,GAAC,KAAKS,QAAL,CAAcoC,EAAtB;;IAAyB,KAAI,MAAMnD,CAAV,IAAeF,CAAf,EAAiB;MAAC,MAAMM,CAAC,GAACN,CAAC,CAACE,CAAD,CAAT;MAAaI,CAAC,IAAEO,CAAC,CAACuC,KAAF,CAAQ,iCAAR,CAAH;MAA8C,MAAM5C,CAAC,GAACJ,CAAC,CAACF,CAAD,CAAT;MAAaM,CAAC,IAAEK,CAAC,CAACuC,KAAF,CAAQ,qCAAR,CAAH,EAAkD1C,CAAC,CAAC,KAAKO,QAAN,EAAe,KAAKC,UAApB,EAA+BZ,CAA/B,EAAiCE,CAAjC,CAAnD;IAAuF;;IAAA,IAAGN,CAAC,CAACI,CAAD,CAAJ,EAAQ;MAAC,CAAC,CAAC,KAAKW,QAAL,CAAcwB,YAAd,CAA2BC,GAA7B,GAAiClC,CAAC,CAAC8C,UAAF,CAAa9C,CAAC,CAAC+C,oBAAf,EAAoCjD,CAAC,CAACqB,MAAtC,CAAjC,GAA+E,KAAKV,QAAL,CAAcqC,UAAd,CAAyBhD,CAAzB,CAA/E;IAA2G;EAAC;;EAAAkD,MAAM,GAAE;IAAC,KAAKT,UAAL;IAAkB,MAAM/C,CAAC,GAAC,KAAKiB,QAAL,CAAcwB,YAAd,CAA2BC,GAAnC;IAAuC1C,CAAC,GAACA,CAAC,CAACiD,eAAF,CAAkB,IAAlB,CAAD,GAAyB,KAAKQ,aAAL,EAA1B;EAA+C;;EAAAA,aAAa,GAAE;IAAC,MAAK;MAACrC,QAAQ,EAACpB,CAAV;MAAYmB,OAAO,EAACf;IAApB,IAAuB,IAA5B;IAAiCJ,CAAC,IAAEa,CAAC,CAACuC,KAAF,CAAQ,oCAAR,CAAH;;IAAiD,KAAI,MAAMlD,CAAV,IAAeF,CAAf,EAAiB;MAAC,MAAMM,CAAC,GAACN,CAAC,CAACE,CAAD,CAAT;MAAaI,CAAC,IAAEO,CAAC,CAACuC,KAAF,CAAQ,iCAAR,CAAH;MAA8C,MAAM5C,CAAC,GAACJ,CAAC,CAACF,CAAD,CAAT;MAAaU,CAAC,CAAC,KAAKK,QAAN,EAAe,KAAKC,UAApB,EAA+BZ,CAA/B,EAAiCE,CAAjC,CAAD;IAAqC;;IAAAN,CAAC,CAAC,KAAKmB,YAAN,CAAD,IAAsB,KAAKJ,QAAL,CAAcyC,YAAd,CAA2B,KAAKrC,YAAL,CAAkBsC,UAA7C,CAAtB;EAA+E;;AAAvyE;;AAAwyE,SAAO5C,CAAC,IAAIW,iBAAZ"},"metadata":{},"sourceType":"module"}