{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport { throwIfAborted as t, onAbort as r, createAbortError as s } from \"../../../core/promiseUtils.js\";\nimport { isSVG as i } from \"../../../core/urlUtils.js\";\nimport { TextureCollection as o } from \"./TextureCollection.js\";\nimport { PowerOfTwoResizeMode as n } from \"../webgl-engine/lib/basicInterfaces.js\";\nimport { Texture as a } from \"../webgl-engine/lib/Texture.js\";\n\nclass h extends o {\n  constructor(e, t, r, s) {\n    super(t, s), this._streamDataRequester = e, this._parameters = r;\n  }\n\n  async fromUrl(i, o, n) {\n    t(n);\n    const a = e(n) && n.signal,\n          h = this.makeUid(i, o);\n\n    let l = this._textureRequests.get(h);\n\n    if (!l) {\n      const e = new AbortController(),\n            t = this._streamDataRequester.request(i, \"image\", {\n        uid: h,\n        signal: e.signal\n      });\n\n      l = {\n        referenceCount: 0,\n        texture: null,\n        textureAsync: null,\n        abortController: e\n      }, this._textureRequests.set(h, l), l.textureAsync = t.then(async e => {\n        const t = this._createTexture(i, e, o);\n\n        return l.texture = t, l.abortController = null, this._stage.add(t), await this._stage.load(t), {\n          uid: h,\n          texture: t,\n          release: () => this._release(h)\n        };\n      }, e => {\n        throw l.abortController = null, e;\n      });\n    }\n\n    return l.referenceCount++, new Promise((e, t) => {\n      r(a, () => {\n        t(s());\n      }), l.textureAsync.then(e, t);\n    }).catch(e => {\n      throw this._release(h), e;\n    });\n  }\n\n  _createTexture(e, t, r) {\n    const s = { ...this._parameters,\n      powerOfTwoResizeMode: n.PAD\n    };\n\n    if (i(e)) {\n      if (r || 0 === t.width && 0 === t.height) {\n        const e = t.width ? t.height / t.width : 1;\n        r = r || 64, e > 1 ? (t.width = Math.round(r / e), t.height = r) : (t.width = r, t.height = Math.round(r * e));\n      }\n\n      this._stage.renderView && this._stage.renderView.renderingContext.driverTest.svgAlwaysPremultipliesAlpha && (s.preMultiplyAlpha = !1);\n    }\n\n    return s.width = t.width, s.height = t.height, new a(t, s);\n  }\n\n}\n\nexport { h as StreamTextureCollection };","map":{"version":3,"names":["isSome","e","throwIfAborted","t","onAbort","r","createAbortError","s","isSVG","i","TextureCollection","o","PowerOfTwoResizeMode","n","Texture","a","h","constructor","_streamDataRequester","_parameters","fromUrl","signal","makeUid","l","_textureRequests","get","AbortController","request","uid","referenceCount","texture","textureAsync","abortController","set","then","_createTexture","_stage","add","load","release","_release","Promise","catch","powerOfTwoResizeMode","PAD","width","height","Math","round","renderView","renderingContext","driverTest","svgAlwaysPremultipliesAlpha","preMultiplyAlpha","StreamTextureCollection"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/support/StreamTextureCollection.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{throwIfAborted as t,onAbort as r,createAbortError as s}from\"../../../core/promiseUtils.js\";import{isSVG as i}from\"../../../core/urlUtils.js\";import{TextureCollection as o}from\"./TextureCollection.js\";import{PowerOfTwoResizeMode as n}from\"../webgl-engine/lib/basicInterfaces.js\";import{Texture as a}from\"../webgl-engine/lib/Texture.js\";class h extends o{constructor(e,t,r,s){super(t,s),this._streamDataRequester=e,this._parameters=r}async fromUrl(i,o,n){t(n);const a=e(n)&&n.signal,h=this.makeUid(i,o);let l=this._textureRequests.get(h);if(!l){const e=new AbortController,t=this._streamDataRequester.request(i,\"image\",{uid:h,signal:e.signal});l={referenceCount:0,texture:null,textureAsync:null,abortController:e},this._textureRequests.set(h,l),l.textureAsync=t.then((async e=>{const t=this._createTexture(i,e,o);return l.texture=t,l.abortController=null,this._stage.add(t),await this._stage.load(t),{uid:h,texture:t,release:()=>this._release(h)}}),(e=>{throw l.abortController=null,e}))}return l.referenceCount++,new Promise(((e,t)=>{r(a,(()=>{t(s())})),l.textureAsync.then(e,t)})).catch((e=>{throw this._release(h),e}))}_createTexture(e,t,r){const s={...this._parameters,powerOfTwoResizeMode:n.PAD};if(i(e)){if(r||0===t.width&&0===t.height){const e=t.width?t.height/t.width:1;r=r||64,e>1?(t.width=Math.round(r/e),t.height=r):(t.width=r,t.height=Math.round(r*e))}this._stage.renderView&&this._stage.renderView.renderingContext.driverTest.svgAlwaysPremultipliesAlpha&&(s.preMultiplyAlpha=!1)}return s.width=t.width,s.height=t.height,new a(t,s)}}export{h as StreamTextureCollection};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}