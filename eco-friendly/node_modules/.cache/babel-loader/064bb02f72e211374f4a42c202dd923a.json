{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isNone as e } from \"../../../../core/maybe.js\";\nimport { getBasisTranscoder as t } from \"../../../../libs/basisu/BasisU.js\";\nimport { TextureFormat as n } from \"../../../../libs/basisu/TextureFormat.js\";\nimport { CompressedTextureFormat as r, PixelFormat as s, TextureSamplingMode as i } from \"../../../webgl/enums.js\";\nimport { Texture as a } from \"../../../webgl/Texture.js\";\nimport { getBytesPerElementFormat as o } from \"../../../webgl/Util.js\";\nlet g = null,\n    l = null;\n\nasync function c() {\n  return e(l) && (l = t(), g = await l), l;\n}\n\nfunction u(t, n) {\n  if (e(g)) return t.byteLength;\n  const r = new g.BasisFile(new Uint8Array(t)),\n        s = T(r) ? E(r.getNumLevels(0), r.getHasAlpha(), r.getImageWidth(0, 0), r.getImageHeight(0, 0), n) : 0;\n  return r.close(), r.delete(), s;\n}\n\nfunction m(t, n) {\n  if (e(g)) return t.byteLength;\n  const r = new g.KTX2File(new Uint8Array(t)),\n        s = _(r) ? E(r.getLevels(), r.getHasAlpha(), r.getWidth(), r.getHeight(), n) : 0;\n  return r.close(), r.delete(), s;\n}\n\nfunction E(e, t, n, s, i) {\n  const a = o(t ? r.COMPRESSED_RGBA8_ETC2_EAC : r.COMPRESSED_RGB8_ETC2),\n        g = i && e > 1 ? (4 ** e - 1) / (3 * 4 ** (e - 1)) : 1;\n  return Math.ceil(n * s * a * g);\n}\n\nfunction T(e) {\n  return e.getNumImages() >= 1 && !e.isUASTC();\n}\n\nfunction _(e) {\n  return e.getFaces() >= 1 && e.isETC1S();\n}\n\nasync function h(t, n, r) {\n  e(g) && (g = await c());\n  const s = new g.BasisFile(new Uint8Array(r));\n  if (!T(s)) return null;\n  s.startTranscoding();\n  const i = p(t, n, s.getNumLevels(0), s.getHasAlpha(), s.getImageWidth(0, 0), s.getImageHeight(0, 0), (e, t) => s.getImageTranscodedSizeInBytes(0, e, t), (e, t, n) => s.transcodeImage(n, 0, e, t, 0, 0));\n  return s.close(), s.delete(), i;\n}\n\nasync function A(t, n, r) {\n  e(g) && (g = await c());\n  const s = new g.KTX2File(new Uint8Array(r));\n  if (!_(s)) return null;\n  s.startTranscoding();\n  const i = p(t, n, s.getLevels(), s.getHasAlpha(), s.getWidth(), s.getHeight(), (e, t) => s.getImageTranscodedSizeInBytes(e, 0, 0, t), (e, t, n) => s.transcodeImage(n, e, 0, 0, t, 0, -1, -1));\n  return s.close(), s.delete(), i;\n}\n\nfunction p(e, t, o, g, l, c, u, m) {\n  const {\n    compressedTextureETC: E,\n    compressedTextureS3TC: T\n  } = e.capabilities,\n        [_, h] = E ? g ? [n.ETC2_RGBA, r.COMPRESSED_RGBA8_ETC2_EAC] : [n.ETC1_RGB, r.COMPRESSED_RGB8_ETC2] : T ? g ? [n.BC3_RGBA, r.COMPRESSED_RGBA_S3TC_DXT5_EXT] : [n.BC1_RGB, r.COMPRESSED_RGB_S3TC_DXT1_EXT] : [n.RGBA32, s.RGBA],\n        A = t.hasMipmap ? o : Math.min(1, o),\n        p = [];\n\n  for (let n = 0; n < A; n++) p.push(new Uint8Array(u(n, _))), m(n, _, p[n]);\n\n  const C = p.length > 1,\n        d = C ? i.LINEAR_MIPMAP_LINEAR : i.LINEAR,\n        R = { ...t,\n    samplingMode: d,\n    hasMipmap: C,\n    internalFormat: h,\n    width: l,\n    height: c\n  };\n  return new a(e, R, {\n    type: \"compressed\",\n    levels: p\n  });\n}\n\nexport { h as createTextureBasis, A as createTextureKTX2, u as estimateMemoryBasis, m as estimateMemoryKTX2, c as loadBasis };","map":{"version":3,"names":["isNone","e","getBasisTranscoder","t","TextureFormat","n","CompressedTextureFormat","r","PixelFormat","s","TextureSamplingMode","i","Texture","a","getBytesPerElementFormat","o","g","l","c","u","byteLength","BasisFile","Uint8Array","T","E","getNumLevels","getHasAlpha","getImageWidth","getImageHeight","close","delete","m","KTX2File","_","getLevels","getWidth","getHeight","COMPRESSED_RGBA8_ETC2_EAC","COMPRESSED_RGB8_ETC2","Math","ceil","getNumImages","isUASTC","getFaces","isETC1S","h","startTranscoding","p","getImageTranscodedSizeInBytes","transcodeImage","A","compressedTextureETC","compressedTextureS3TC","capabilities","ETC2_RGBA","ETC1_RGB","BC3_RGBA","COMPRESSED_RGBA_S3TC_DXT5_EXT","BC1_RGB","COMPRESSED_RGB_S3TC_DXT1_EXT","RGBA32","RGBA","hasMipmap","min","push","C","length","d","LINEAR_MIPMAP_LINEAR","LINEAR","R","samplingMode","internalFormat","width","height","type","levels","createTextureBasis","createTextureKTX2","estimateMemoryBasis","estimateMemoryKTX2","loadBasis"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/webgl-engine/lib/BasisUtil.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../core/maybe.js\";import{getBasisTranscoder as t}from\"../../../../libs/basisu/BasisU.js\";import{TextureFormat as n}from\"../../../../libs/basisu/TextureFormat.js\";import{CompressedTextureFormat as r,PixelFormat as s,TextureSamplingMode as i}from\"../../../webgl/enums.js\";import{Texture as a}from\"../../../webgl/Texture.js\";import{getBytesPerElementFormat as o}from\"../../../webgl/Util.js\";let g=null,l=null;async function c(){return e(l)&&(l=t(),g=await l),l}function u(t,n){if(e(g))return t.byteLength;const r=new g.BasisFile(new Uint8Array(t)),s=T(r)?E(r.getNumLevels(0),r.getHasAlpha(),r.getImageWidth(0,0),r.getImageHeight(0,0),n):0;return r.close(),r.delete(),s}function m(t,n){if(e(g))return t.byteLength;const r=new g.KTX2File(new Uint8Array(t)),s=_(r)?E(r.getLevels(),r.getHasAlpha(),r.getWidth(),r.getHeight(),n):0;return r.close(),r.delete(),s}function E(e,t,n,s,i){const a=o(t?r.COMPRESSED_RGBA8_ETC2_EAC:r.COMPRESSED_RGB8_ETC2),g=i&&e>1?(4**e-1)/(3*4**(e-1)):1;return Math.ceil(n*s*a*g)}function T(e){return e.getNumImages()>=1&&!e.isUASTC()}function _(e){return e.getFaces()>=1&&e.isETC1S()}async function h(t,n,r){e(g)&&(g=await c());const s=new g.BasisFile(new Uint8Array(r));if(!T(s))return null;s.startTranscoding();const i=p(t,n,s.getNumLevels(0),s.getHasAlpha(),s.getImageWidth(0,0),s.getImageHeight(0,0),((e,t)=>s.getImageTranscodedSizeInBytes(0,e,t)),((e,t,n)=>s.transcodeImage(n,0,e,t,0,0)));return s.close(),s.delete(),i}async function A(t,n,r){e(g)&&(g=await c());const s=new g.KTX2File(new Uint8Array(r));if(!_(s))return null;s.startTranscoding();const i=p(t,n,s.getLevels(),s.getHasAlpha(),s.getWidth(),s.getHeight(),((e,t)=>s.getImageTranscodedSizeInBytes(e,0,0,t)),((e,t,n)=>s.transcodeImage(n,e,0,0,t,0,-1,-1)));return s.close(),s.delete(),i}function p(e,t,o,g,l,c,u,m){const{compressedTextureETC:E,compressedTextureS3TC:T}=e.capabilities,[_,h]=E?g?[n.ETC2_RGBA,r.COMPRESSED_RGBA8_ETC2_EAC]:[n.ETC1_RGB,r.COMPRESSED_RGB8_ETC2]:T?g?[n.BC3_RGBA,r.COMPRESSED_RGBA_S3TC_DXT5_EXT]:[n.BC1_RGB,r.COMPRESSED_RGB_S3TC_DXT1_EXT]:[n.RGBA32,s.RGBA],A=t.hasMipmap?o:Math.min(1,o),p=[];for(let n=0;n<A;n++)p.push(new Uint8Array(u(n,_))),m(n,_,p[n]);const C=p.length>1,d=C?i.LINEAR_MIPMAP_LINEAR:i.LINEAR,R={...t,samplingMode:d,hasMipmap:C,internalFormat:h,width:l,height:c};return new a(e,R,{type:\"compressed\",levels:p})}export{h as createTextureBasis,A as createTextureKTX2,u as estimateMemoryBasis,m as estimateMemoryKTX2,c as loadBasis};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}