{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { removeMaybe as e, isSome as s, isNone as o } from \"../../../../core/maybe.js\";\nimport { addFrameTask as d } from \"../../../../core/scheduling.js\";\nimport { FadeDirection as i } from \"../support/I3SLayerView.js\";\n\nclass t {\n  constructor() {\n    this.lodCrossfadeSignedDuration = 0;\n  }\n\n}\n\nclass a {\n  constructor(e) {\n    this.view = e, this._preRenderFrameTaskHandle = null, this._currentFrameStartTime = null, this._numFadingNodes = 0;\n  }\n\n  get updating() {\n    return this._numFadingNodes > 0;\n  }\n\n  stopNodeFading(s) {\n    null != s.lodCrossfadeProgress && (this._numFadingNodes--, s.lodCrossfadeProgress = null, 0 === this._numFadingNodes && (null != this._preRenderFrameTaskHandle && (this._preRenderFrameTaskHandle = e(this._preRenderFrameTaskHandle)), this.view.notifyLODUpdate(), this.view.notifyUpdate()));\n  }\n\n  _startNodeFading(e, s, o) {\n    0 === this._numFadingNodes && (this._preRenderFrameTaskHandle = d({\n      preRender: e => this._updateAllNodeFading(e)\n    }), this.view.notifyLODUpdate()), null == e.lodCrossfadeProgress && (this._numFadingNodes++, this.view.notifyUpdate()), e.lodCrossfadeSignedDuration = o, e.lodCrossfadeProgress = s;\n  }\n\n  _updateAllNodeFading(e) {\n    const o = this.view.nodeCrossfadingEnabled;\n    this.view.foreachCrossfadeNode((d, i) => {\n      if (s(i) && s(i.lodCrossfadeProgress)) {\n        const s = i.lodCrossfadeSignedDuration,\n              t = s > 0 ? this.view.fullOpacity : 0,\n              a = e.deltaTime / s,\n              r = i.lodCrossfadeProgress + Math.abs(a),\n              n = !o || r >= 1 || 0 === s,\n              l = t - (n ? 0 : s > 0 ? 1 : -1) * (1 - r);\n        n ? (this.stopNodeFading(i), s < 0 && this.view.markNodeToRemove(d)) : i.lodCrossfadeProgress = r, this.view.setNodeOpacityByIndex(d, l);\n      }\n    }), this.view.removeMarkedNodes();\n  }\n\n  stopAllNodeFading() {\n    this.view.foreachCrossfadeNode((e, o) => {\n      if (s(o) && s(o.lodCrossfadeProgress)) {\n        this.stopNodeFading(o);\n        const s = o.lodCrossfadeSignedDuration;\n        s < 0 && this.view.markNodeToRemove(e);\n        const d = s > 0 ? this.view.fullOpacity : 0;\n        this.view.setNodeOpacityByIndex(e, d);\n      }\n    }), this.view.removeMarkedNodes();\n  }\n\n  fadeNode(e, s, o, d) {\n    null == this._currentFrameStartTime && (this._currentFrameStartTime = Date.now());\n    const t = this.view,\n          a = t.nodeCrossfadingEnabled,\n          n = o === i.FadeIn ? t.fullOpacity : 0,\n          l = a ? d ? o === i.FadeIn ? t.lodCrossfadeinDuration : t.lodCrossfadeoutDuration : t.lodCrossfadeUncoveredDuration : 0,\n          h = this.view.getNodeOpacityByIndex(e);\n\n    if (a && h !== n && l > 0) {\n      const e = 1 - Math.abs(n - h);\n\n      this._startNodeFading(s, e, r(o) * l);\n    } else this.stopNodeFading(s), this.view.setNodeOpacityByIndex(e, n), o === i.FadeOut && this.view.removeNode(e);\n  }\n\n  isNodeFullyFadedIn(e) {\n    const s = this.view.getNodeCrossfadeMetaData(e);\n    return o(s) || null == s.lodCrossfadeProgress && this.view.getNodeOpacityByIndex(e) === this.view.fullOpacity;\n  }\n\n}\n\nfunction r(e) {\n  return e === i.FadeIn ? 1 : -1;\n}\n\nexport { a as I3SCrossfadeHelper, t as NodeCrossfadeMetaData };","map":{"version":3,"names":["removeMaybe","e","isSome","s","isNone","o","addFrameTask","d","FadeDirection","i","t","constructor","lodCrossfadeSignedDuration","a","view","_preRenderFrameTaskHandle","_currentFrameStartTime","_numFadingNodes","updating","stopNodeFading","lodCrossfadeProgress","notifyLODUpdate","notifyUpdate","_startNodeFading","preRender","_updateAllNodeFading","nodeCrossfadingEnabled","foreachCrossfadeNode","fullOpacity","deltaTime","r","Math","abs","n","l","markNodeToRemove","setNodeOpacityByIndex","removeMarkedNodes","stopAllNodeFading","fadeNode","Date","now","FadeIn","lodCrossfadeinDuration","lodCrossfadeoutDuration","lodCrossfadeUncoveredDuration","h","getNodeOpacityByIndex","FadeOut","removeNode","isNodeFullyFadedIn","getNodeCrossfadeMetaData","I3SCrossfadeHelper","NodeCrossfadeMetaData"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/i3s/I3SCrossfadeHelper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{removeMaybe as e,isSome as s,isNone as o}from\"../../../../core/maybe.js\";import{addFrameTask as d}from\"../../../../core/scheduling.js\";import{FadeDirection as i}from\"../support/I3SLayerView.js\";class t{constructor(){this.lodCrossfadeSignedDuration=0}}class a{constructor(e){this.view=e,this._preRenderFrameTaskHandle=null,this._currentFrameStartTime=null,this._numFadingNodes=0}get updating(){return this._numFadingNodes>0}stopNodeFading(s){null!=s.lodCrossfadeProgress&&(this._numFadingNodes--,s.lodCrossfadeProgress=null,0===this._numFadingNodes&&(null!=this._preRenderFrameTaskHandle&&(this._preRenderFrameTaskHandle=e(this._preRenderFrameTaskHandle)),this.view.notifyLODUpdate(),this.view.notifyUpdate()))}_startNodeFading(e,s,o){0===this._numFadingNodes&&(this._preRenderFrameTaskHandle=d({preRender:e=>this._updateAllNodeFading(e)}),this.view.notifyLODUpdate()),null==e.lodCrossfadeProgress&&(this._numFadingNodes++,this.view.notifyUpdate()),e.lodCrossfadeSignedDuration=o,e.lodCrossfadeProgress=s}_updateAllNodeFading(e){const o=this.view.nodeCrossfadingEnabled;this.view.foreachCrossfadeNode(((d,i)=>{if(s(i)&&s(i.lodCrossfadeProgress)){const s=i.lodCrossfadeSignedDuration,t=s>0?this.view.fullOpacity:0,a=e.deltaTime/s,r=i.lodCrossfadeProgress+Math.abs(a),n=!o||r>=1||0===s,l=t-(n?0:s>0?1:-1)*(1-r);n?(this.stopNodeFading(i),s<0&&this.view.markNodeToRemove(d)):i.lodCrossfadeProgress=r,this.view.setNodeOpacityByIndex(d,l)}})),this.view.removeMarkedNodes()}stopAllNodeFading(){this.view.foreachCrossfadeNode(((e,o)=>{if(s(o)&&s(o.lodCrossfadeProgress)){this.stopNodeFading(o);const s=o.lodCrossfadeSignedDuration;s<0&&this.view.markNodeToRemove(e);const d=s>0?this.view.fullOpacity:0;this.view.setNodeOpacityByIndex(e,d)}})),this.view.removeMarkedNodes()}fadeNode(e,s,o,d){null==this._currentFrameStartTime&&(this._currentFrameStartTime=Date.now());const t=this.view,a=t.nodeCrossfadingEnabled,n=o===i.FadeIn?t.fullOpacity:0,l=a?d?o===i.FadeIn?t.lodCrossfadeinDuration:t.lodCrossfadeoutDuration:t.lodCrossfadeUncoveredDuration:0,h=this.view.getNodeOpacityByIndex(e);if(a&&h!==n&&l>0){const e=1-Math.abs(n-h);this._startNodeFading(s,e,r(o)*l)}else this.stopNodeFading(s),this.view.setNodeOpacityByIndex(e,n),o===i.FadeOut&&this.view.removeNode(e)}isNodeFullyFadedIn(e){const s=this.view.getNodeCrossfadeMetaData(e);return o(s)||null==s.lodCrossfadeProgress&&this.view.getNodeOpacityByIndex(e)===this.view.fullOpacity}}function r(e){return e===i.FadeIn?1:-1}export{a as I3SCrossfadeHelper,t as NodeCrossfadeMetaData};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}