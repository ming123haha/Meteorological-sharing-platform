{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../Color.js\";\nimport i from \"../../../core/Accessor.js\";\nimport { isSome as r, disposeMaybe as s, isNone as n } from \"../../../core/maybe.js\";\nimport a from \"../../../core/ObjectPool.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as l } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { I as d } from \"../../../chunks/mat4f64.js\";\nimport { b as h, s as c, e as u } from \"../../../chunks/vec3.js\";\nimport { Z as p, f, c as g } from \"../../../chunks/vec3f64.js\";\nimport { Z as m, c as _ } from \"../../../chunks/vec4f64.js\";\nimport { create as T, set as b } from \"../../../geometry/support/aaBoundingBox.js\";\nimport { BufferViewVec3f as R } from \"../../../geometry/support/buffer/BufferView.js\";\nimport { ViewingMode as y } from \"../../ViewingMode.js\";\nimport { TextureUpdate as A } from \"./interfaces.js\";\nimport { LayerClass as O } from \"./LayerClass.js\";\nimport { OverlaySource as v } from \"./Overlay.js\";\nimport { overlayRenderOccludedFlag as x } from \"./OverlayRenderer.js\";\nimport { clearCaches as P } from \"./PatchGeometry.js\";\nimport { PatchRenderData as C } from \"./PatchRenderData.js\";\nimport { RenderOrder as E } from \"./RenderOrder.js\";\nimport { ScaleRangeQueries as D } from \"./ScaleRangeQueries.js\";\nimport \"./terrainUtils.js\";\nimport { TileRenderer as q } from \"./TileRenderer.js\";\nimport { TileUpdate as S } from \"./TileUpdate.js\";\nimport { IteratorPreorder as N, sortTiles as I, compareTiles as w } from \"./tileUtils.js\";\nimport { componentMinimalSizeForIntersectionData as L, ComponentIntersectionData as G } from \"../webgl-engine/collections/Component/ComponentIntersectionData.js\";\nimport { ShaderOutput as j } from \"../webgl-engine/core/shaderLibrary/ShaderOutputOptions.js\";\nimport { OverlayMode as F } from \"../webgl-engine/core/shaderLibrary/terrain/Overlay.glsl.js\";\nimport { T as M } from \"../../../chunks/Terrain.glsl.js\";\nimport { TileBlendInput as U } from \"../webgl-engine/core/shaderLibrary/terrain/TileBlendInput.js\";\nimport { RenderRequestType as k } from \"../webgl-engine/lib/basicInterfaces.js\";\nimport { createEmptyTexture as H } from \"../webgl-engine/lib/glUtil3D.js\";\nimport { newIntersectorResult as B } from \"../webgl-engine/lib/Intersector.js\";\nimport { IntersectorType as V, StoreResults as z } from \"../webgl-engine/lib/IntersectorInterfaces.js\";\nimport { RenderOccludedFlag as Q } from \"../webgl-engine/lib/Material.js\";\nimport { RenderPass as W } from \"../webgl-engine/lib/RenderPass.js\";\nimport { RenderSlot as Y } from \"../webgl-engine/lib/RenderSlot.js\";\nimport { getSettings as X } from \"../webgl-engine/lib/screenSizePerspectiveUtils.js\";\nimport { VertexAttribute as Z } from \"../webgl-engine/lib/VertexAttribute.js\";\nimport { TERRAIN_ID as K, getVerticalOffsetTerrain as J } from \"../webgl-engine/lib/verticalOffsetUtils.js\";\nimport { DrawParameters as $ } from \"../webgl-engine/materials/DrawParameters.js\";\nimport { intersectAabbInvDirBefore as ee, intersectTriangles as te } from \"../webgl-engine/materials/internal/MaterialUtil.js\";\nimport { TerrainTechnique as ie } from \"../webgl-engine/shaders/TerrainTechnique.js\";\nimport { TerrainTechniqueConfiguration as re } from \"../webgl-engine/shaders/TerrainTechniqueConfiguration.js\";\nimport { ClearBufferBit as se, PrimitiveType as ne } from \"../../webgl/enums.js\";\n\nconst ae = 7,\n      oe = 10,\n      le = T(),\n      de = _();\n\nlet he = class extends i {\n  constructor(e) {\n    super(e), this.type = V.TERRAIN, this.isGround = !0, this.tileSize = 256, this._techniqueConfiguration = new re(), this._passParameters = new M(), this.rctx = null, this._isTransparent = !1, this._scaleRangeQueries = new D(), this.renderDataPool = new a(C), this._patchGroups = new Map(), this.patchGroupsDirty = !0, this.tileIterator = new N(), this.highestVisibleLODTile = null, this.visible = !0, this._opaque = !0, this._velvetOverground = !0, this._castShadows = !0, this.emptyTex = null, this.tileRenderer = null, this.stencilEnabledLayerExtents = [], this.numTilesRendered = 0, this.numTilesCulled = 0, this.numOriginsRendered = 0, this.needsHighlight = !1, this.renderOccludedFlags = Q.Occlude;\n  }\n\n  get isGlobal() {\n    return this.stage.viewingMode === y.Global;\n  }\n\n  get shadingEnabled() {\n    return this._techniqueConfiguration?.shading;\n  }\n\n  initialize() {\n    const e = [Y.OPAQUE_TERRAIN, Y.TRANSPARENT_TERRAIN, Y.OCCLUDED_TERRAIN];\n    this.stage.addRenderPlugin(e, this);\n  }\n\n  destroy() {\n    this.stage.removeRenderPlugin(this), P();\n  }\n\n  get canRender() {\n    return this.visible && !!this._rootTiles && !this.renderingDisabled;\n  }\n\n  set renderingDisabled(e) {\n    this._set(\"renderingDisabled\", !!e), this.setNeedsRender();\n  }\n\n  set opaque(e) {\n    this._opaque !== e && (this._opaque = e, this.setNeedsRender());\n  }\n\n  get opaque() {\n    return this._opaque && !this._techniqueConfiguration.hasSlicePlane;\n  }\n\n  get needsLinearDepth() {\n    return this.overlayRenderer.hasWater;\n  }\n\n  set isTransparent(e) {\n    this._isTransparent !== e && (this._isTransparent = e, this.setNeedsRender());\n  }\n\n  get isTransparent() {\n    return this._isTransparent;\n  }\n\n  get renderPatchBorders() {\n    return !!this._techniqueConfiguration.tileBorders;\n  }\n\n  set renderPatchBorders(e) {\n    this._techniqueConfiguration.tileBorders !== e && (this._techniqueConfiguration.tileBorders = e, this.setNeedsRender(), this.notifyChange(\"renderPatchBorders\"));\n  }\n\n  get cullBackFaces() {\n    return this._techniqueConfiguration.backfaceCullingEnabled;\n  }\n\n  set cullBackFaces(e) {\n    this._techniqueConfiguration.backfaceCullingEnabled !== e && (this._techniqueConfiguration.backfaceCullingEnabled = e, this.notifyChange(\"cullBackFaces\"), this.setNeedsRender());\n  }\n\n  set renderOrder(e) {\n    this._set(\"renderOrder\", e), this.setNeedsRender();\n  }\n\n  set velvetOverground(e) {\n    this._velvetOverground !== e && (this._velvetOverground = e, this.setNeedsRender());\n  }\n\n  get layerUid() {\n    return K;\n  }\n\n  get slicePlaneEnabled() {\n    return this._techniqueConfiguration.hasSlicePlane;\n  }\n\n  set slicePlaneEnabled(e) {\n    this._techniqueConfiguration.hasSlicePlane !== e && (this._techniqueConfiguration.hasSlicePlane = e, this.setNeedsRender());\n  }\n\n  set textureFadingEnabled(e) {\n    this._techniqueConfiguration.textureFadingEnabled !== e && (this._techniqueConfiguration.textureFadingEnabled = e, this.setNeedsRender());\n  }\n\n  setDebugScreenSizePerspective(e) {\n    this._techniqueConfiguration.screenSizePerspective !== e && (this._techniqueConfiguration.screenSizePerspective = e, this.setNeedsRender());\n  }\n\n  toggleShading() {\n    this._techniqueConfiguration.shading = !this._techniqueConfiguration.shading, this.setNeedsRender();\n  }\n\n  setRootTiles(e) {\n    this._rootTiles = e, this.setNeedsRender();\n  }\n\n  setNeedsHighlight(e) {\n    this.needsHighlight = e, this.setNeedsRender();\n  }\n\n  setRenderOccludedOverlay(e) {\n    this.renderOccludedFlags = e ? x : Q.Occlude, this.setNeedsRender();\n  }\n\n  setStencilEnabledLayerExtents(e) {\n    this.stencilEnabledLayerExtents = e, this.setNeedsRender();\n  }\n\n  setTileSize(e) {\n    this.tileSize = e, r(this.tileRenderer) && (this.tileRenderer.tileSize = e), this.setNeedsRender();\n  }\n\n  _prepareTileForLoading(e) {\n    e.renderData || (e.renderData = this.renderDataPool.acquire(), e.renderData.init(e), e.renderData.localOrigin = this._getLocalOriginOfTile(e));\n  }\n\n  loadTile(e) {\n    this._prepareTileForLoading(e), this.updateTileGeometry(e), this.updateTileTexture(e, S.TEXTURE_FADING);\n  }\n\n  queryVisibleLevelRange(e, t, i, r) {\n    this._scaleRangeQueries.queryVisibleLevelRange(e, t, i, r), this.setNeedsRender();\n  }\n\n  updateTileTexture(e, t) {\n    r(this.tileRenderer) && (this.tileRenderer.updateTileTexture(e, t === S.TEXTURE_FADING ? A.FADING : A.UNFADED), this.setNeedsRender(), e.resetPendingUpdate(t));\n  }\n\n  updateTileGeometryState(e) {\n    this._prepareTileForLoading(e), e.renderData.updateGeometryStateAndPrepareForGeometryGeneration(this.wireframe);\n  }\n\n  updateTileGeometry(e) {\n    for (const t of e.layerInfo[O.ELEVATION]) t.pendingUpdates &= ~S.GEOMETRY;\n\n    e.resetPendingUpdate(S.GEOMETRY);\n    e.renderData.updateGeometryIfChanged(this.rctx, this.wireframe) && this.setNeedsRender();\n  }\n\n  unloadTile(e) {\n    const t = e.renderData;\n    t && (t.releaseGeometry(), this.renderDataPool.release(t), t.clear(), e.renderData = null, e.setMemoryDirty(), this.setNeedsRender());\n  }\n\n  _getLocalOriginOfTile(e) {\n    const t = oe - ae,\n          i = Math.max(0, Math.floor((e.level - t) / ae) * ae);\n    if (this.isGlobal && 0 === i) return p;\n\n    for (; e.parent && e.level > i;) e = e.parent;\n\n    return e.centerAtSeaLevel;\n  }\n\n  setVisibility(e) {\n    this.visible = e, this.setNeedsRender();\n  }\n\n  getStats() {\n    return {\n      numTilesRendered: this.numTilesRendered,\n      numTilesCulled: this.numTilesCulled,\n      numOriginsRendered: this.numOriginsRendered\n    };\n  }\n\n  set wireframe(e) {\n    this._get(\"wireframe\") !== e && (this._set(\"wireframe\", e), this.allTiles.forAll(e => {\n      e.isLoaded && (this.updateTileGeometry(e), e.updateNeighborsAfterGeometryChange());\n    }), this.setNeedsRender());\n  }\n\n  setNeedsRender(e = k.UPDATE) {\n    this.patchGroupsDirty = !0, this._context.requestRender(e);\n  }\n\n  initializeRenderContext(e) {\n    this._context = e, this.rctx = e.renderContext.rctx, this._techniqueRepository = e.shaderTechniqueRepository, this.tileRenderer = new q(this.rctx, this.tileSize, this._techniqueRepository), this.updateTileBackground(), this.emptyTex = H(this.rctx);\n  }\n\n  uninitializeRenderContext() {\n    this.emptyTex = s(this.emptyTex), this.tileRenderer = s(this.tileRenderer);\n  }\n\n  intersect(e, t, i, s) {\n    if (!this._rootTiles || e.options.selectOpaqueTerrainOnly && e.options.selectionMode && !this._opaque) return;\n    const a = pe,\n          o = fe;\n    h(a, s, i), c(o, 1 / a[0], 1 / a[1], 1 / a[2]);\n\n    const l = e.results.min,\n          p = e.results.max,\n          f = e.results.ground,\n          g = e.options.store === z.MIN,\n          m = !!e.results.ground.target,\n          _ = J(e.verticalOffset),\n          T = e.tolerance;\n\n    let y,\n        A = g && r(l.dist) ? l.dist : 1 / 0;\n\n    const O = c => {\n      const m = c.renderData;\n      if (!m?.vao) return;\n      const O = m.geometryInfo;\n      b(le, O.boundingBox);\n      const v = m.localOrigin;\n      r(_) && (_.localOrigin = v, _.applyToAabb(le));\n      const x = le;\n      if (ge[0] = i[0] - v[0], ge[1] = i[1] - v[1], ge[2] = i[2] - v[2], !ee(x, ge, o, T, A)) return;\n\n      const P = (e, t, i) => {\n        e.set(this.type, c, t, i, d), A = g && r(l.dist) ? l.dist : 1 / 0;\n      },\n            C = (o, d) => {\n        if (r(d) && o >= 0 && (e.options.backfacesTerrain || u(d, a) < 0) && (e.options.invisibleTerrain || !e.options.selectionMode || null == t || t(i, s, o))) {\n          if ((null == f.dist || o < f.dist) && P(f, o, d), e.options.isFiltered) return;\n          e.options.store === z.ALL && (n(y) ? (y = B(e.ray), P(y, o, d), e.results.all.push(y)) : o < y.dist && P(y, o, d)), (null == l.dist || o < l.dist) && P(l, o, d), e.options.store !== z.MIN && (null == p.dist || o > p.dist) && P(p, o, d);\n        }\n      },\n            E = me;\n\n      h(E, s, v);\n      const D = O.indices,\n            q = O.vertexAttributes,\n            S = {\n        data: q.getField(Z.POSITION, R).typedBuffer,\n        size: 3,\n        stride: q.stride / 4\n      },\n            N = O.indexCount / 3;\n\n      if (n(_) && N > L) {\n        const e = c.renderData;\n        n(e.intersectionData) && (e.intersectionData = new G(D, 0, N, S)), e.intersectionData.intersectRay({\n          r0: ge,\n          r1: E\n        }, C);\n      } else te(ge, E, 0, N, D, S, null, _, C);\n    },\n          v = this._rootTiles;\n\n    if (r(v)) {\n      (() => {\n        const t = this.tileIterator;\n        t.reset(v);\n        const s = e.options.invisibleTerrain;\n\n        for (; !t.done;) {\n          const e = t.next();\n          !(e.visible || s && e.intersectsClippingArea) || !r(_) && !e.intersectsRay(i, a, T, A) || m && this._useStencilForTile(e) ? t.skipSubtree() : O(e);\n        }\n      })();\n    }\n  }\n\n  prepareTechnique(e) {\n    if (e.bindParameters.slot === Y.OCCLUDED_TERRAIN) {\n      if (0 == (e.renderOccludedMask & x)) return null;\n    } else {\n      const t = this.opaque ? Y.OPAQUE_TERRAIN : Y.TRANSPARENT_TERRAIN;\n      if (e.bindParameters.slot !== t) return null;\n    }\n\n    switch (e.pass) {\n      case W.MATERIAL:\n        {\n          this._techniqueConfiguration.hasScreenSpaceReflections = e.bindParameters.ssr.enabled, this._techniqueConfiguration.hasCloudsReflections = r(e.bindParameters.clouds.data), this._techniqueConfiguration.receiveShadows = e.bindParameters.shadowMap.ready, this._techniqueConfiguration.receiveAmbientOcclusion = e.bindParameters.ssaoHelper.ready, this._techniqueConfiguration.overlayMode = this.overlayRenderer.isEmpty() ? F.Disabled : this.overlayRenderer.hasWater ? F.EnabledWithWater : F.Enabled;\n          const t = e.bindParameters.slot === Y.OCCLUDED_TERRAIN ? v.Occluded : v.ColorAndWater;\n          return this._updateTechnique(j.Color, t === v.Occluded);\n        }\n\n      case W.MATERIAL_DEPTH_SHADOWMAP_ALL:\n      case W.MATERIAL_DEPTH_SHADOWMAP_DEFAULT:\n        return this._castShadows && 1 === e.bindParameters.lighting.globalFactor ? (this._techniqueConfiguration.receiveShadows = this._techniqueConfiguration.receiveAmbientOcclusion = !1, this._updateTechnique(j.Shadow, !1)) : null;\n\n      case W.MATERIAL_DEPTH:\n        return this.isTransparent && this.overlayRenderer.isEmpty() ? null : (this._techniqueConfiguration.receiveShadows = this._techniqueConfiguration.receiveAmbientOcclusion = !1, this._updateTechnique(j.Depth, !1));\n\n      case W.MATERIAL_NORMAL:\n        return this._techniqueConfiguration.receiveShadows = this._techniqueConfiguration.receiveAmbientOcclusion = !1, this._updateTechnique(j.Normal, !1);\n\n      case W.MATERIAL_HIGHLIGHT:\n        return this.needsHighlight ? (this._techniqueConfiguration.receiveShadows = this._techniqueConfiguration.receiveAmbientOcclusion = !1, this._updateTechnique(j.Highlight, !1)) : null;\n    }\n\n    return null;\n  }\n\n  render(e, t) {\n    const i = e.pass,\n          r = 1 === e.bindParameters.lighting.globalFactor;\n\n    switch (this._updatePatchGroups(), t.useStencil = !1, i) {\n      case W.MATERIAL:\n        {\n          const i = e.bindParameters.slot === Y.OCCLUDED_TERRAIN ? v.Occluded : v.ColorAndWater;\n\n          this._renderMaterialPass(e, t, i);\n\n          break;\n        }\n\n      case W.MATERIAL_DEPTH_SHADOWMAP_ALL:\n      case W.MATERIAL_DEPTH_SHADOWMAP_DEFAULT:\n        this._castShadows && r && this._renderAuxiliaryPass(e, t, v.None);\n        break;\n\n      case W.MATERIAL_DEPTH:\n        this.isTransparent && this.overlayRenderer.isEmpty() || this._renderAuxiliaryPass(e, t, v.None);\n        break;\n\n      case W.MATERIAL_NORMAL:\n        this._renderAuxiliaryPass(e, t, v.None);\n\n        break;\n\n      case W.MATERIAL_HIGHLIGHT:\n        this.needsHighlight && (this._renderAuxiliaryPass(e, t, v.Highlight), e.rctx.clearSafe(se.DEPTH_BUFFER_BIT));\n    }\n\n    this._scaleRangeQueries.hasPendingQueries() && this.setNeedsRender();\n  }\n\n  _renderMaterialPass(e, t, i) {\n    const {\n      rctx: r\n    } = e;\n    this._passParameters.overlaySource = i, r.bindTechnique(t, this._passParameters, e.bindParameters), this.numTilesRendered = 0, this.numTilesCulled = 0, this.numOriginsRendered = 0, this._scaleRangeQueries.prepareQueries(), this.opaque ? this._renderPatchGroups(e, t, i) : e.offscreenRenderingHelper.renderToTargets(() => this._renderPatchGroups(e, t, i), e.offscreenRenderingHelper.tmpColor, e.offscreenRenderingHelper.mainDepth, [0, 0, 0, 0]), this._scaleRangeQueries.processQueries();\n  }\n\n  _renderAuxiliaryPass(e, t, i) {\n    const r = e.rctx;\n    this._passParameters.overlaySource = i, r.bindTechnique(t, this._passParameters, e.bindParameters), this._renderPatchGroupsAuxiliary(e, t, i);\n  }\n\n  updateTileBackground(e = null) {\n    if (n(this.tileRenderer)) return;\n    const i = this.tileRenderer;\n    let s = null;\n\n    if (r(e)) {\n      const i = t.toUnitRGBA(e);\n      s = f(i[0] || 0, i[1] || 0, i[2] || 0);\n    }\n\n    i.setBackground(s), this.allTiles.forAll(e => i.updateTileTexture(e, A.FADING)), this._techniqueConfiguration.tileBlendInput = i.backgroundIsGrid ? U.GridComposite : r(i.backgroundColor) ? U.ColorComposite : U.LayerOnly, this.setNeedsRender();\n  }\n\n  _updatePatchGroups() {\n    if (this.patchGroupsDirty) {\n      if (this.highestVisibleLODTile = null, this._rebuildPatchGroups(), this.renderOrder !== E.NONE) {\n        const e = Array.from(this._patchGroups.values());\n        e.forEach(e => I(this.renderOrder, e)), e.sort((e, t) => w(e[0], t[0], this.renderOrder)), this._patchGroups = new Map(e.map(e => [e[0].renderData.localOrigin, e]));\n      }\n\n      this.patchGroupsDirty = !1;\n    }\n  }\n\n  _rebuildPatchGroups() {\n    const e = this._rootTiles;\n\n    if (!n(e)) {\n      e[0]?.surface.checkAllTileWaterproofness(), this._patchGroups.clear();\n\n      for (const t of e) this._rebuildPatchGroupsForRootTile(t);\n    }\n  }\n\n  _rebuildPatchGroupsForRootTile(e) {\n    const t = this.tileIterator;\n\n    for (t.resetOne(e); !t.done;) {\n      const e = t.next(),\n            i = e.renderData;\n      if (!i || e.visible) {\n        if (e.rendered) {\n          if (i) {\n            const r = this._patchGroups.get(i.localOrigin) || new Array();\n            this._patchGroups.set(i.localOrigin, r), r.push(e), (!this.highestVisibleLODTile || e.vlevel > this.highestVisibleLODTile.vlevel) && (this.highestVisibleLODTile = e), t.skipSubtree();\n          }\n        } else this.numTilesCulled++;\n      } else this.numTilesCulled++, t.skipSubtree();\n    }\n  }\n\n  _useStencilForTile(e) {\n    for (const t of this.stencilEnabledLayerExtents) if (e.intersectsExtent(t)) return !0;\n\n    return !1;\n  }\n\n  _renderPatchGroupsAuxiliary(e, t, i) {\n    const r = this.stencilEnabledLayerExtents.length > 0;\n    this._patchGroups.forEach(s => {\n      const n = s[0].renderData.localOrigin;\n      t.program.bindDraw(new $(n), e.bindParameters);\n\n      for (let a = 0; a < s.length; a++) this._renderPatch(e, t, s[a], ne.TRIANGLES, r, i);\n    }), e.rctx.bindVAO(null);\n  }\n\n  _renderPatchGroups(e, t, i) {\n    const s = e.rctx,\n          a = e.bindParameters.camera,\n          o = t.program;\n\n    if (this._techniqueConfiguration.screenSizePerspective && this.pointsOfInterest) {\n      const e = X(this.stage.viewingMode, this.ellipsoidRadius),\n            t = this.pointsOfInterest.centerOnSurfaceFrequent.distance;\n      e.update({\n        distance: t,\n        fovY: a.fovY\n      });\n    }\n\n    const l = this.stencilEnabledLayerExtents.length > 0,\n          d = i === v.Occluded;\n    d && (o.bindTexture(\"tex\", this.emptyTex), o.setUniform1f(\"blend\", 1), o.setUniform4fv(\"texOffsetAndScale\", m));\n    const h = r(this.tileRenderer) && r(this.tileRenderer.backgroundColor) ? this.tileRenderer.backgroundColor : p;\n    this._techniqueConfiguration.tileBlendInput === U.ColorComposite && o.setUniform3fv(\"backgroundColor\", h);\n    const c = this.wireframe ? ne.LINES : ne.TRIANGLES;\n    this._techniqueConfiguration.textureFadingEnabled && o.bindTexture(\"texNext\", this.emptyTex), this._patchGroups.forEach(s => {\n      const a = s[0].renderData.localOrigin;\n      t.program.bindDraw(new $(a), e.bindParameters), this.numOriginsRendered++;\n\n      for (let h = 0; h < s.length; h++) {\n        const a = s[h],\n              u = a.renderData.textureReference;\n\n        if (!n(u)) {\n          if (!d) {\n            this._scaleRangeQueries.scaleQueriesForTile(a), ue(a.renderData.geometryInfo.uvOffsetAndScale, u.offsetAndScale, de), o.setUniform4fv(\"texOffsetAndScale\", de), o.bindTexture(\"tex\", u.texture.texture);\n            const e = a.renderData.textureFadeFactor,\n                  t = e < 1 ? a.renderData.nextTextureReference : null;\n            this._techniqueConfiguration.textureFadingEnabled && r(t) && e < 1 ? (ue(a.renderData.geometryInfo.uvOffsetAndScale, t.offsetAndScale, de), o.setUniform1f(\"fadeFactor\", e), o.setUniform4fv(\"nextTexOffsetAndScale\", de), o.setUniform3fv(\"nextTexOpacities\", t.opacities), o.bindTexture(\"texNext\", t.texture.texture)) : o.setUniform1f(\"fadeFactor\", 1), a.renderData.textureIsFading && this.setNeedsRender(), o.setUniform3fv(\"textureOpacities\", u.opacities);\n          }\n\n          this._renderPatch(e, t, a, c, l, i), a.renderOrder = this.numTilesRendered, this.numTilesRendered++;\n        }\n      }\n    }), s.bindVAO(null);\n  }\n\n  _renderPatch(e, t, i, r, s, a) {\n    const o = i.renderData,\n          l = o.vao,\n          d = l.indexBuffer;\n    if (n(d)) return;\n    const h = t.program;\n    a !== v.None && this._bindOverlayPatchData(h, o.overlay), s && (t.useStencil = this._useStencilForTile(i), t.bindPipelineState(e.rctx, e.bindParameters.slot));\n    const c = o.geometryInfo.indexCount;\n    e.rctx.bindVAO(l), h.assertCompatibleVertexAttributeLocations(l), e.rctx.drawElements(r, c, d.indexType, 0);\n  }\n\n  _bindOverlayPatchData(e, t) {\n    e.setUniform4fv(\"overlayTexOffset\", t.offsets), e.setUniform4fv(\"overlayTexScale\", t.scales);\n  }\n\n  _updateTechnique(e, t) {\n    return this._techniqueConfiguration.output = e, e === j.Color && (this._techniqueConfiguration.atmosphere = this.isGlobal && this._velvetOverground), this._techniqueConfiguration.renderOccluded = t, this._techniqueConfiguration.stencilEnabled = !1, this._shaderTechnique = this._techniqueRepository.releaseAndAcquire(ie, this._techniqueConfiguration, this._shaderTechnique), this._shaderTechnique;\n  }\n\n  get test() {\n    return {\n      tileRenderer: this.tileRenderer\n    };\n  }\n\n};\ne([o({\n  constructOnly: !0\n})], he.prototype, \"overlayRenderer\", void 0), e([o({\n  constructOnly: !0\n})], he.prototype, \"stage\", void 0), e([o({\n  readOnly: !0\n})], he.prototype, \"isGlobal\", null), e([o({\n  constructOnly: !0\n})], he.prototype, \"allTiles\", void 0), e([o({\n  constructOnly: !0\n})], he.prototype, \"ellipsoidRadius\", void 0), e([o({\n  value: !1\n})], he.prototype, \"renderingDisabled\", null), e([o()], he.prototype, \"renderPatchBorders\", null), e([o()], he.prototype, \"cullBackFaces\", null), e([o({\n  value: E.FRONT_TO_BACK\n})], he.prototype, \"renderOrder\", null), e([o()], he.prototype, \"wireframe\", null), he = e([l(\"esri.views.3d.terrain.TerrainRenderer\")], he);\nconst ce = he;\n\nfunction ue(e, t, i) {\n  i[0] = e[0] * t[2] + t[0], i[1] = e[1] * t[3] + t[1], i[2] = e[2] * t[2], i[3] = e[3] * t[3];\n}\n\nconst pe = g(),\n      fe = g(),\n      ge = g(),\n      me = g();\nexport { ce as default };","map":{"version":3,"names":["_","e","t","i","isSome","r","disposeMaybe","s","isNone","n","a","property","o","subclass","l","I","d","b","h","c","u","Z","p","f","g","m","create","T","set","BufferViewVec3f","R","ViewingMode","y","TextureUpdate","A","LayerClass","O","OverlaySource","v","overlayRenderOccludedFlag","x","clearCaches","P","PatchRenderData","C","RenderOrder","E","ScaleRangeQueries","D","TileRenderer","q","TileUpdate","S","IteratorPreorder","N","sortTiles","compareTiles","w","componentMinimalSizeForIntersectionData","L","ComponentIntersectionData","G","ShaderOutput","j","OverlayMode","F","M","TileBlendInput","U","RenderRequestType","k","createEmptyTexture","H","newIntersectorResult","B","IntersectorType","V","StoreResults","z","RenderOccludedFlag","Q","RenderPass","W","RenderSlot","Y","getSettings","X","VertexAttribute","TERRAIN_ID","K","getVerticalOffsetTerrain","J","DrawParameters","$","intersectAabbInvDirBefore","ee","intersectTriangles","te","TerrainTechnique","ie","TerrainTechniqueConfiguration","re","ClearBufferBit","se","PrimitiveType","ne","ae","oe","le","de","he","constructor","type","TERRAIN","isGround","tileSize","_techniqueConfiguration","_passParameters","rctx","_isTransparent","_scaleRangeQueries","renderDataPool","_patchGroups","Map","patchGroupsDirty","tileIterator","highestVisibleLODTile","visible","_opaque","_velvetOverground","_castShadows","emptyTex","tileRenderer","stencilEnabledLayerExtents","numTilesRendered","numTilesCulled","numOriginsRendered","needsHighlight","renderOccludedFlags","Occlude","isGlobal","stage","viewingMode","Global","shadingEnabled","shading","initialize","OPAQUE_TERRAIN","TRANSPARENT_TERRAIN","OCCLUDED_TERRAIN","addRenderPlugin","destroy","removeRenderPlugin","canRender","_rootTiles","renderingDisabled","_set","setNeedsRender","opaque","hasSlicePlane","needsLinearDepth","overlayRenderer","hasWater","isTransparent","renderPatchBorders","tileBorders","notifyChange","cullBackFaces","backfaceCullingEnabled","renderOrder","velvetOverground","layerUid","slicePlaneEnabled","textureFadingEnabled","setDebugScreenSizePerspective","screenSizePerspective","toggleShading","setRootTiles","setNeedsHighlight","setRenderOccludedOverlay","setStencilEnabledLayerExtents","setTileSize","_prepareTileForLoading","renderData","acquire","init","localOrigin","_getLocalOriginOfTile","loadTile","updateTileGeometry","updateTileTexture","TEXTURE_FADING","queryVisibleLevelRange","FADING","UNFADED","resetPendingUpdate","updateTileGeometryState","updateGeometryStateAndPrepareForGeometryGeneration","wireframe","layerInfo","ELEVATION","pendingUpdates","GEOMETRY","updateGeometryIfChanged","unloadTile","releaseGeometry","release","clear","setMemoryDirty","Math","max","floor","level","parent","centerAtSeaLevel","setVisibility","getStats","_get","allTiles","forAll","isLoaded","updateNeighborsAfterGeometryChange","UPDATE","_context","requestRender","initializeRenderContext","renderContext","_techniqueRepository","shaderTechniqueRepository","updateTileBackground","uninitializeRenderContext","intersect","options","selectOpaqueTerrainOnly","selectionMode","pe","fe","results","min","ground","store","MIN","target","verticalOffset","tolerance","dist","vao","geometryInfo","boundingBox","applyToAabb","ge","backfacesTerrain","invisibleTerrain","isFiltered","ALL","ray","all","push","me","indices","vertexAttributes","data","getField","POSITION","typedBuffer","size","stride","indexCount","intersectionData","intersectRay","r0","r1","reset","done","next","intersectsClippingArea","intersectsRay","_useStencilForTile","skipSubtree","prepareTechnique","bindParameters","slot","renderOccludedMask","pass","MATERIAL","hasScreenSpaceReflections","ssr","enabled","hasCloudsReflections","clouds","receiveShadows","shadowMap","ready","receiveAmbientOcclusion","ssaoHelper","overlayMode","isEmpty","Disabled","EnabledWithWater","Enabled","Occluded","ColorAndWater","_updateTechnique","Color","MATERIAL_DEPTH_SHADOWMAP_ALL","MATERIAL_DEPTH_SHADOWMAP_DEFAULT","lighting","globalFactor","Shadow","MATERIAL_DEPTH","Depth","MATERIAL_NORMAL","Normal","MATERIAL_HIGHLIGHT","Highlight","render","_updatePatchGroups","useStencil","_renderMaterialPass","_renderAuxiliaryPass","None","clearSafe","DEPTH_BUFFER_BIT","hasPendingQueries","overlaySource","bindTechnique","prepareQueries","_renderPatchGroups","offscreenRenderingHelper","renderToTargets","tmpColor","mainDepth","processQueries","_renderPatchGroupsAuxiliary","toUnitRGBA","setBackground","tileBlendInput","backgroundIsGrid","GridComposite","backgroundColor","ColorComposite","LayerOnly","_rebuildPatchGroups","NONE","Array","from","values","forEach","sort","map","surface","checkAllTileWaterproofness","_rebuildPatchGroupsForRootTile","resetOne","rendered","get","vlevel","intersectsExtent","length","program","bindDraw","_renderPatch","TRIANGLES","bindVAO","camera","pointsOfInterest","ellipsoidRadius","centerOnSurfaceFrequent","distance","update","fovY","bindTexture","setUniform1f","setUniform4fv","setUniform3fv","LINES","textureReference","scaleQueriesForTile","ue","uvOffsetAndScale","offsetAndScale","texture","textureFadeFactor","nextTextureReference","opacities","textureIsFading","indexBuffer","_bindOverlayPatchData","overlay","bindPipelineState","assertCompatibleVertexAttributeLocations","drawElements","indexType","offsets","scales","output","atmosphere","renderOccluded","stencilEnabled","_shaderTechnique","releaseAndAcquire","test","constructOnly","prototype","readOnly","value","FRONT_TO_BACK","ce","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/terrain/TerrainRenderer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Color.js\";import i from\"../../../core/Accessor.js\";import{isSome as r,disposeMaybe as s,isNone as n}from\"../../../core/maybe.js\";import a from\"../../../core/ObjectPool.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{I as d}from\"../../../chunks/mat4f64.js\";import{b as h,s as c,e as u}from\"../../../chunks/vec3.js\";import{Z as p,f,c as g}from\"../../../chunks/vec3f64.js\";import{Z as m,c as _}from\"../../../chunks/vec4f64.js\";import{create as T,set as b}from\"../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f as R}from\"../../../geometry/support/buffer/BufferView.js\";import{ViewingMode as y}from\"../../ViewingMode.js\";import{TextureUpdate as A}from\"./interfaces.js\";import{LayerClass as O}from\"./LayerClass.js\";import{OverlaySource as v}from\"./Overlay.js\";import{overlayRenderOccludedFlag as x}from\"./OverlayRenderer.js\";import{clearCaches as P}from\"./PatchGeometry.js\";import{PatchRenderData as C}from\"./PatchRenderData.js\";import{RenderOrder as E}from\"./RenderOrder.js\";import{ScaleRangeQueries as D}from\"./ScaleRangeQueries.js\";import\"./terrainUtils.js\";import{TileRenderer as q}from\"./TileRenderer.js\";import{TileUpdate as S}from\"./TileUpdate.js\";import{IteratorPreorder as N,sortTiles as I,compareTiles as w}from\"./tileUtils.js\";import{componentMinimalSizeForIntersectionData as L,ComponentIntersectionData as G}from\"../webgl-engine/collections/Component/ComponentIntersectionData.js\";import{ShaderOutput as j}from\"../webgl-engine/core/shaderLibrary/ShaderOutputOptions.js\";import{OverlayMode as F}from\"../webgl-engine/core/shaderLibrary/terrain/Overlay.glsl.js\";import{T as M}from\"../../../chunks/Terrain.glsl.js\";import{TileBlendInput as U}from\"../webgl-engine/core/shaderLibrary/terrain/TileBlendInput.js\";import{RenderRequestType as k}from\"../webgl-engine/lib/basicInterfaces.js\";import{createEmptyTexture as H}from\"../webgl-engine/lib/glUtil3D.js\";import{newIntersectorResult as B}from\"../webgl-engine/lib/Intersector.js\";import{IntersectorType as V,StoreResults as z}from\"../webgl-engine/lib/IntersectorInterfaces.js\";import{RenderOccludedFlag as Q}from\"../webgl-engine/lib/Material.js\";import{RenderPass as W}from\"../webgl-engine/lib/RenderPass.js\";import{RenderSlot as Y}from\"../webgl-engine/lib/RenderSlot.js\";import{getSettings as X}from\"../webgl-engine/lib/screenSizePerspectiveUtils.js\";import{VertexAttribute as Z}from\"../webgl-engine/lib/VertexAttribute.js\";import{TERRAIN_ID as K,getVerticalOffsetTerrain as J}from\"../webgl-engine/lib/verticalOffsetUtils.js\";import{DrawParameters as $}from\"../webgl-engine/materials/DrawParameters.js\";import{intersectAabbInvDirBefore as ee,intersectTriangles as te}from\"../webgl-engine/materials/internal/MaterialUtil.js\";import{TerrainTechnique as ie}from\"../webgl-engine/shaders/TerrainTechnique.js\";import{TerrainTechniqueConfiguration as re}from\"../webgl-engine/shaders/TerrainTechniqueConfiguration.js\";import{ClearBufferBit as se,PrimitiveType as ne}from\"../../webgl/enums.js\";const ae=7,oe=10,le=T(),de=_();let he=class extends i{constructor(e){super(e),this.type=V.TERRAIN,this.isGround=!0,this.tileSize=256,this._techniqueConfiguration=new re,this._passParameters=new M,this.rctx=null,this._isTransparent=!1,this._scaleRangeQueries=new D,this.renderDataPool=new a(C),this._patchGroups=new Map,this.patchGroupsDirty=!0,this.tileIterator=new N,this.highestVisibleLODTile=null,this.visible=!0,this._opaque=!0,this._velvetOverground=!0,this._castShadows=!0,this.emptyTex=null,this.tileRenderer=null,this.stencilEnabledLayerExtents=[],this.numTilesRendered=0,this.numTilesCulled=0,this.numOriginsRendered=0,this.needsHighlight=!1,this.renderOccludedFlags=Q.Occlude}get isGlobal(){return this.stage.viewingMode===y.Global}get shadingEnabled(){return this._techniqueConfiguration?.shading}initialize(){const e=[Y.OPAQUE_TERRAIN,Y.TRANSPARENT_TERRAIN,Y.OCCLUDED_TERRAIN];this.stage.addRenderPlugin(e,this)}destroy(){this.stage.removeRenderPlugin(this),P()}get canRender(){return this.visible&&!!this._rootTiles&&!this.renderingDisabled}set renderingDisabled(e){this._set(\"renderingDisabled\",!!e),this.setNeedsRender()}set opaque(e){this._opaque!==e&&(this._opaque=e,this.setNeedsRender())}get opaque(){return this._opaque&&!this._techniqueConfiguration.hasSlicePlane}get needsLinearDepth(){return this.overlayRenderer.hasWater}set isTransparent(e){this._isTransparent!==e&&(this._isTransparent=e,this.setNeedsRender())}get isTransparent(){return this._isTransparent}get renderPatchBorders(){return!!this._techniqueConfiguration.tileBorders}set renderPatchBorders(e){this._techniqueConfiguration.tileBorders!==e&&(this._techniqueConfiguration.tileBorders=e,this.setNeedsRender(),this.notifyChange(\"renderPatchBorders\"))}get cullBackFaces(){return this._techniqueConfiguration.backfaceCullingEnabled}set cullBackFaces(e){this._techniqueConfiguration.backfaceCullingEnabled!==e&&(this._techniqueConfiguration.backfaceCullingEnabled=e,this.notifyChange(\"cullBackFaces\"),this.setNeedsRender())}set renderOrder(e){this._set(\"renderOrder\",e),this.setNeedsRender()}set velvetOverground(e){this._velvetOverground!==e&&(this._velvetOverground=e,this.setNeedsRender())}get layerUid(){return K}get slicePlaneEnabled(){return this._techniqueConfiguration.hasSlicePlane}set slicePlaneEnabled(e){this._techniqueConfiguration.hasSlicePlane!==e&&(this._techniqueConfiguration.hasSlicePlane=e,this.setNeedsRender())}set textureFadingEnabled(e){this._techniqueConfiguration.textureFadingEnabled!==e&&(this._techniqueConfiguration.textureFadingEnabled=e,this.setNeedsRender())}setDebugScreenSizePerspective(e){this._techniqueConfiguration.screenSizePerspective!==e&&(this._techniqueConfiguration.screenSizePerspective=e,this.setNeedsRender())}toggleShading(){this._techniqueConfiguration.shading=!this._techniqueConfiguration.shading,this.setNeedsRender()}setRootTiles(e){this._rootTiles=e,this.setNeedsRender()}setNeedsHighlight(e){this.needsHighlight=e,this.setNeedsRender()}setRenderOccludedOverlay(e){this.renderOccludedFlags=e?x:Q.Occlude,this.setNeedsRender()}setStencilEnabledLayerExtents(e){this.stencilEnabledLayerExtents=e,this.setNeedsRender()}setTileSize(e){this.tileSize=e,r(this.tileRenderer)&&(this.tileRenderer.tileSize=e),this.setNeedsRender()}_prepareTileForLoading(e){e.renderData||(e.renderData=this.renderDataPool.acquire(),e.renderData.init(e),e.renderData.localOrigin=this._getLocalOriginOfTile(e))}loadTile(e){this._prepareTileForLoading(e),this.updateTileGeometry(e),this.updateTileTexture(e,S.TEXTURE_FADING)}queryVisibleLevelRange(e,t,i,r){this._scaleRangeQueries.queryVisibleLevelRange(e,t,i,r),this.setNeedsRender()}updateTileTexture(e,t){r(this.tileRenderer)&&(this.tileRenderer.updateTileTexture(e,t===S.TEXTURE_FADING?A.FADING:A.UNFADED),this.setNeedsRender(),e.resetPendingUpdate(t))}updateTileGeometryState(e){this._prepareTileForLoading(e),e.renderData.updateGeometryStateAndPrepareForGeometryGeneration(this.wireframe)}updateTileGeometry(e){for(const t of e.layerInfo[O.ELEVATION])t.pendingUpdates&=~S.GEOMETRY;e.resetPendingUpdate(S.GEOMETRY);e.renderData.updateGeometryIfChanged(this.rctx,this.wireframe)&&this.setNeedsRender()}unloadTile(e){const t=e.renderData;t&&(t.releaseGeometry(),this.renderDataPool.release(t),t.clear(),e.renderData=null,e.setMemoryDirty(),this.setNeedsRender())}_getLocalOriginOfTile(e){const t=oe-ae,i=Math.max(0,Math.floor((e.level-t)/ae)*ae);if(this.isGlobal&&0===i)return p;for(;e.parent&&e.level>i;)e=e.parent;return e.centerAtSeaLevel}setVisibility(e){this.visible=e,this.setNeedsRender()}getStats(){return{numTilesRendered:this.numTilesRendered,numTilesCulled:this.numTilesCulled,numOriginsRendered:this.numOriginsRendered}}set wireframe(e){this._get(\"wireframe\")!==e&&(this._set(\"wireframe\",e),this.allTiles.forAll((e=>{e.isLoaded&&(this.updateTileGeometry(e),e.updateNeighborsAfterGeometryChange())})),this.setNeedsRender())}setNeedsRender(e=k.UPDATE){this.patchGroupsDirty=!0,this._context.requestRender(e)}initializeRenderContext(e){this._context=e,this.rctx=e.renderContext.rctx,this._techniqueRepository=e.shaderTechniqueRepository,this.tileRenderer=new q(this.rctx,this.tileSize,this._techniqueRepository),this.updateTileBackground(),this.emptyTex=H(this.rctx)}uninitializeRenderContext(){this.emptyTex=s(this.emptyTex),this.tileRenderer=s(this.tileRenderer)}intersect(e,t,i,s){if(!this._rootTiles||e.options.selectOpaqueTerrainOnly&&e.options.selectionMode&&!this._opaque)return;const a=pe,o=fe;h(a,s,i),c(o,1/a[0],1/a[1],1/a[2]);const l=e.results.min,p=e.results.max,f=e.results.ground,g=e.options.store===z.MIN,m=!!e.results.ground.target,_=J(e.verticalOffset),T=e.tolerance;let y,A=g&&r(l.dist)?l.dist:1/0;const O=c=>{const m=c.renderData;if(!m?.vao)return;const O=m.geometryInfo;b(le,O.boundingBox);const v=m.localOrigin;r(_)&&(_.localOrigin=v,_.applyToAabb(le));const x=le;if(ge[0]=i[0]-v[0],ge[1]=i[1]-v[1],ge[2]=i[2]-v[2],!ee(x,ge,o,T,A))return;const P=(e,t,i)=>{e.set(this.type,c,t,i,d),A=g&&r(l.dist)?l.dist:1/0},C=(o,d)=>{if(r(d)&&o>=0&&(e.options.backfacesTerrain||u(d,a)<0)&&(e.options.invisibleTerrain||!e.options.selectionMode||null==t||t(i,s,o))){if((null==f.dist||o<f.dist)&&P(f,o,d),e.options.isFiltered)return;e.options.store===z.ALL&&(n(y)?(y=B(e.ray),P(y,o,d),e.results.all.push(y)):o<y.dist&&P(y,o,d)),(null==l.dist||o<l.dist)&&P(l,o,d),e.options.store!==z.MIN&&(null==p.dist||o>p.dist)&&P(p,o,d)}},E=me;h(E,s,v);const D=O.indices,q=O.vertexAttributes,S={data:q.getField(Z.POSITION,R).typedBuffer,size:3,stride:q.stride/4},N=O.indexCount/3;if(n(_)&&N>L){const e=c.renderData;n(e.intersectionData)&&(e.intersectionData=new G(D,0,N,S)),e.intersectionData.intersectRay({r0:ge,r1:E},C)}else te(ge,E,0,N,D,S,null,_,C)},v=this._rootTiles;if(r(v)){(()=>{const t=this.tileIterator;t.reset(v);const s=e.options.invisibleTerrain;for(;!t.done;){const e=t.next();!(e.visible||s&&e.intersectsClippingArea)||!r(_)&&!e.intersectsRay(i,a,T,A)||m&&this._useStencilForTile(e)?t.skipSubtree():O(e)}})()}}prepareTechnique(e){if(e.bindParameters.slot===Y.OCCLUDED_TERRAIN){if(0==(e.renderOccludedMask&x))return null}else{const t=this.opaque?Y.OPAQUE_TERRAIN:Y.TRANSPARENT_TERRAIN;if(e.bindParameters.slot!==t)return null}switch(e.pass){case W.MATERIAL:{this._techniqueConfiguration.hasScreenSpaceReflections=e.bindParameters.ssr.enabled,this._techniqueConfiguration.hasCloudsReflections=r(e.bindParameters.clouds.data),this._techniqueConfiguration.receiveShadows=e.bindParameters.shadowMap.ready,this._techniqueConfiguration.receiveAmbientOcclusion=e.bindParameters.ssaoHelper.ready,this._techniqueConfiguration.overlayMode=this.overlayRenderer.isEmpty()?F.Disabled:this.overlayRenderer.hasWater?F.EnabledWithWater:F.Enabled;const t=e.bindParameters.slot===Y.OCCLUDED_TERRAIN?v.Occluded:v.ColorAndWater;return this._updateTechnique(j.Color,t===v.Occluded)}case W.MATERIAL_DEPTH_SHADOWMAP_ALL:case W.MATERIAL_DEPTH_SHADOWMAP_DEFAULT:return this._castShadows&&1===e.bindParameters.lighting.globalFactor?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(j.Shadow,!1)):null;case W.MATERIAL_DEPTH:return this.isTransparent&&this.overlayRenderer.isEmpty()?null:(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(j.Depth,!1));case W.MATERIAL_NORMAL:return this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(j.Normal,!1);case W.MATERIAL_HIGHLIGHT:return this.needsHighlight?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(j.Highlight,!1)):null}return null}render(e,t){const i=e.pass,r=1===e.bindParameters.lighting.globalFactor;switch(this._updatePatchGroups(),t.useStencil=!1,i){case W.MATERIAL:{const i=e.bindParameters.slot===Y.OCCLUDED_TERRAIN?v.Occluded:v.ColorAndWater;this._renderMaterialPass(e,t,i);break}case W.MATERIAL_DEPTH_SHADOWMAP_ALL:case W.MATERIAL_DEPTH_SHADOWMAP_DEFAULT:this._castShadows&&r&&this._renderAuxiliaryPass(e,t,v.None);break;case W.MATERIAL_DEPTH:this.isTransparent&&this.overlayRenderer.isEmpty()||this._renderAuxiliaryPass(e,t,v.None);break;case W.MATERIAL_NORMAL:this._renderAuxiliaryPass(e,t,v.None);break;case W.MATERIAL_HIGHLIGHT:this.needsHighlight&&(this._renderAuxiliaryPass(e,t,v.Highlight),e.rctx.clearSafe(se.DEPTH_BUFFER_BIT))}this._scaleRangeQueries.hasPendingQueries()&&this.setNeedsRender()}_renderMaterialPass(e,t,i){const{rctx:r}=e;this._passParameters.overlaySource=i,r.bindTechnique(t,this._passParameters,e.bindParameters),this.numTilesRendered=0,this.numTilesCulled=0,this.numOriginsRendered=0,this._scaleRangeQueries.prepareQueries(),this.opaque?this._renderPatchGroups(e,t,i):e.offscreenRenderingHelper.renderToTargets((()=>this._renderPatchGroups(e,t,i)),e.offscreenRenderingHelper.tmpColor,e.offscreenRenderingHelper.mainDepth,[0,0,0,0]),this._scaleRangeQueries.processQueries()}_renderAuxiliaryPass(e,t,i){const r=e.rctx;this._passParameters.overlaySource=i,r.bindTechnique(t,this._passParameters,e.bindParameters),this._renderPatchGroupsAuxiliary(e,t,i)}updateTileBackground(e=null){if(n(this.tileRenderer))return;const i=this.tileRenderer;let s=null;if(r(e)){const i=t.toUnitRGBA(e);s=f(i[0]||0,i[1]||0,i[2]||0)}i.setBackground(s),this.allTiles.forAll((e=>i.updateTileTexture(e,A.FADING))),this._techniqueConfiguration.tileBlendInput=i.backgroundIsGrid?U.GridComposite:r(i.backgroundColor)?U.ColorComposite:U.LayerOnly,this.setNeedsRender()}_updatePatchGroups(){if(this.patchGroupsDirty){if(this.highestVisibleLODTile=null,this._rebuildPatchGroups(),this.renderOrder!==E.NONE){const e=Array.from(this._patchGroups.values());e.forEach((e=>I(this.renderOrder,e))),e.sort(((e,t)=>w(e[0],t[0],this.renderOrder))),this._patchGroups=new Map(e.map((e=>[e[0].renderData.localOrigin,e])))}this.patchGroupsDirty=!1}}_rebuildPatchGroups(){const e=this._rootTiles;if(!n(e)){e[0]?.surface.checkAllTileWaterproofness(),this._patchGroups.clear();for(const t of e)this._rebuildPatchGroupsForRootTile(t)}}_rebuildPatchGroupsForRootTile(e){const t=this.tileIterator;for(t.resetOne(e);!t.done;){const e=t.next(),i=e.renderData;if(!i||e.visible)if(e.rendered){if(i){const r=this._patchGroups.get(i.localOrigin)||new Array;this._patchGroups.set(i.localOrigin,r),r.push(e),(!this.highestVisibleLODTile||e.vlevel>this.highestVisibleLODTile.vlevel)&&(this.highestVisibleLODTile=e),t.skipSubtree()}}else this.numTilesCulled++;else this.numTilesCulled++,t.skipSubtree()}}_useStencilForTile(e){for(const t of this.stencilEnabledLayerExtents)if(e.intersectsExtent(t))return!0;return!1}_renderPatchGroupsAuxiliary(e,t,i){const r=this.stencilEnabledLayerExtents.length>0;this._patchGroups.forEach((s=>{const n=s[0].renderData.localOrigin;t.program.bindDraw(new $(n),e.bindParameters);for(let a=0;a<s.length;a++)this._renderPatch(e,t,s[a],ne.TRIANGLES,r,i)})),e.rctx.bindVAO(null)}_renderPatchGroups(e,t,i){const s=e.rctx,a=e.bindParameters.camera,o=t.program;if(this._techniqueConfiguration.screenSizePerspective&&this.pointsOfInterest){const e=X(this.stage.viewingMode,this.ellipsoidRadius),t=this.pointsOfInterest.centerOnSurfaceFrequent.distance;e.update({distance:t,fovY:a.fovY})}const l=this.stencilEnabledLayerExtents.length>0,d=i===v.Occluded;d&&(o.bindTexture(\"tex\",this.emptyTex),o.setUniform1f(\"blend\",1),o.setUniform4fv(\"texOffsetAndScale\",m));const h=r(this.tileRenderer)&&r(this.tileRenderer.backgroundColor)?this.tileRenderer.backgroundColor:p;this._techniqueConfiguration.tileBlendInput===U.ColorComposite&&o.setUniform3fv(\"backgroundColor\",h);const c=this.wireframe?ne.LINES:ne.TRIANGLES;this._techniqueConfiguration.textureFadingEnabled&&o.bindTexture(\"texNext\",this.emptyTex),this._patchGroups.forEach((s=>{const a=s[0].renderData.localOrigin;t.program.bindDraw(new $(a),e.bindParameters),this.numOriginsRendered++;for(let h=0;h<s.length;h++){const a=s[h],u=a.renderData.textureReference;if(!n(u)){if(!d){this._scaleRangeQueries.scaleQueriesForTile(a),ue(a.renderData.geometryInfo.uvOffsetAndScale,u.offsetAndScale,de),o.setUniform4fv(\"texOffsetAndScale\",de),o.bindTexture(\"tex\",u.texture.texture);const e=a.renderData.textureFadeFactor,t=e<1?a.renderData.nextTextureReference:null;this._techniqueConfiguration.textureFadingEnabled&&r(t)&&e<1?(ue(a.renderData.geometryInfo.uvOffsetAndScale,t.offsetAndScale,de),o.setUniform1f(\"fadeFactor\",e),o.setUniform4fv(\"nextTexOffsetAndScale\",de),o.setUniform3fv(\"nextTexOpacities\",t.opacities),o.bindTexture(\"texNext\",t.texture.texture)):o.setUniform1f(\"fadeFactor\",1),a.renderData.textureIsFading&&this.setNeedsRender(),o.setUniform3fv(\"textureOpacities\",u.opacities)}this._renderPatch(e,t,a,c,l,i),a.renderOrder=this.numTilesRendered,this.numTilesRendered++}}})),s.bindVAO(null)}_renderPatch(e,t,i,r,s,a){const o=i.renderData,l=o.vao,d=l.indexBuffer;if(n(d))return;const h=t.program;a!==v.None&&this._bindOverlayPatchData(h,o.overlay),s&&(t.useStencil=this._useStencilForTile(i),t.bindPipelineState(e.rctx,e.bindParameters.slot));const c=o.geometryInfo.indexCount;e.rctx.bindVAO(l),h.assertCompatibleVertexAttributeLocations(l),e.rctx.drawElements(r,c,d.indexType,0)}_bindOverlayPatchData(e,t){e.setUniform4fv(\"overlayTexOffset\",t.offsets),e.setUniform4fv(\"overlayTexScale\",t.scales)}_updateTechnique(e,t){return this._techniqueConfiguration.output=e,e===j.Color&&(this._techniqueConfiguration.atmosphere=this.isGlobal&&this._velvetOverground),this._techniqueConfiguration.renderOccluded=t,this._techniqueConfiguration.stencilEnabled=!1,this._shaderTechnique=this._techniqueRepository.releaseAndAcquire(ie,this._techniqueConfiguration,this._shaderTechnique),this._shaderTechnique}get test(){return{tileRenderer:this.tileRenderer}}};e([o({constructOnly:!0})],he.prototype,\"overlayRenderer\",void 0),e([o({constructOnly:!0})],he.prototype,\"stage\",void 0),e([o({readOnly:!0})],he.prototype,\"isGlobal\",null),e([o({constructOnly:!0})],he.prototype,\"allTiles\",void 0),e([o({constructOnly:!0})],he.prototype,\"ellipsoidRadius\",void 0),e([o({value:!1})],he.prototype,\"renderingDisabled\",null),e([o()],he.prototype,\"renderPatchBorders\",null),e([o()],he.prototype,\"cullBackFaces\",null),e([o({value:E.FRONT_TO_BACK})],he.prototype,\"renderOrder\",null),e([o()],he.prototype,\"wireframe\",null),he=e([l(\"esri.views.3d.terrain.TerrainRenderer\")],he);const ce=he;function ue(e,t,i){i[0]=e[0]*t[2]+t[0],i[1]=e[1]*t[3]+t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3]}const pe=g(),fe=g(),ge=g(),me=g();export{ce as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}