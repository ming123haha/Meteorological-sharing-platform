{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nclass t {\n  constructor(t = 15e3, e = 5e3) {\n    this._timer = null, this._cachedBlocks = new Map(), this._size = -1, this._duration = t, this._interval = Math.min(t, e);\n  }\n\n  decreaseRefCount(t, e) {\n    const s = t + \"/\" + e,\n          r = this._cachedBlocks;\n\n    if (r.has(s)) {\n      const t = r.get(s);\n      return t.refCount--, t.refCount <= 0 && (r.delete(s), t.controller && t.controller.abort()), t.refCount;\n    }\n\n    return 0;\n  }\n\n  getBlock(t, e) {\n    const s = t + \"/\" + e,\n          r = this._cachedBlocks;\n\n    if (r.has(s)) {\n      const t = r.get(s);\n      return t.ts = Date.now(), t.refCount++, r.delete(s), r.set(s, t), t.block;\n    }\n\n    return null;\n  }\n\n  putBlock(t, e, s, r) {\n    const i = this._cachedBlocks,\n          c = t + \"/\" + e;\n\n    if (i.has(c)) {\n      const t = i.get(c);\n      t.ts = Date.now(), t.refCount++;\n    } else i.set(c, {\n      block: s,\n      ts: Date.now(),\n      refCount: 1,\n      controller: r\n    });\n\n    this._trim(), this._updateTimer();\n  }\n\n  deleteBlock(t, e) {\n    const s = this._cachedBlocks,\n          r = t + \"/\" + e;\n    s.has(r) && s.delete(r);\n  }\n\n  updateMaxSize(t) {\n    this._size = t, this._trim();\n  }\n\n  empty() {\n    this._cachedBlocks.clear(), this._clearTimer();\n  }\n\n  getCurrentSize() {\n    return this._cachedBlocks.size;\n  }\n\n  _updateTimer() {\n    if (null != this._timer) return;\n    const t = this._cachedBlocks;\n    this._timer = setInterval(() => {\n      const e = Array.from(t),\n            s = Date.now();\n\n      for (let r = 0; r < e.length && e[r][1].ts <= s - this._duration; r++) t.delete(e[r][0]);\n\n      0 === t.size && this._clearTimer();\n    }, this._interval);\n  }\n\n  _trim() {\n    const t = this._cachedBlocks;\n    if (-1 === this._size || this._size >= t.size) return;\n    const e = Array.from(t);\n\n    for (let s = 0; s < e.length - this._size; s++) t.delete(e[s][0]);\n  }\n\n  _clearTimer() {\n    null != this._timer && (clearInterval(this._timer), this._timer = null);\n  }\n\n}\n\nexport { t as default };","map":{"version":3,"names":["t","constructor","e","_timer","_cachedBlocks","Map","_size","_duration","_interval","Math","min","decreaseRefCount","s","r","has","get","refCount","delete","controller","abort","getBlock","ts","Date","now","set","block","putBlock","i","c","_trim","_updateTimer","deleteBlock","updateMaxSize","empty","clear","_clearTimer","getCurrentSize","size","setInterval","Array","from","length","clearInterval","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/support/rasterDatasets/EphemeralBlockCache.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nclass t{constructor(t=15e3,e=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=t,this._interval=Math.min(t,e)}decreaseRefCount(t,e){const s=t+\"/\"+e,r=this._cachedBlocks;if(r.has(s)){const t=r.get(s);return t.refCount--,t.refCount<=0&&(r.delete(s),t.controller&&t.controller.abort()),t.refCount}return 0}getBlock(t,e){const s=t+\"/\"+e,r=this._cachedBlocks;if(r.has(s)){const t=r.get(s);return t.ts=Date.now(),t.refCount++,r.delete(s),r.set(s,t),t.block}return null}putBlock(t,e,s,r){const i=this._cachedBlocks,c=t+\"/\"+e;if(i.has(c)){const t=i.get(c);t.ts=Date.now(),t.refCount++}else i.set(c,{block:s,ts:Date.now(),refCount:1,controller:r});this._trim(),this._updateTimer()}deleteBlock(t,e){const s=this._cachedBlocks,r=t+\"/\"+e;s.has(r)&&s.delete(r)}updateMaxSize(t){this._size=t,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null!=this._timer)return;const t=this._cachedBlocks;this._timer=setInterval((()=>{const e=Array.from(t),s=Date.now();for(let r=0;r<e.length&&e[r][1].ts<=s-this._duration;r++)t.delete(e[r][0]);0===t.size&&this._clearTimer()}),this._interval)}_trim(){const t=this._cachedBlocks;if(-1===this._size||this._size>=t.size)return;const e=Array.from(t);for(let s=0;s<e.length-this._size;s++)t.delete(e[s][0])}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}export{t as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}