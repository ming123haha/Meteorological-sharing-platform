{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { disposeMaybe as t, abortMaybe as s, isSome as e, isNone as i } from \"../../../core/maybe.js\";\nimport a from \"../../../core/ObjectPool.js\";\nimport n from \"../../../core/PooledArray.js\";\nimport { releaseTileData as o } from \"./terrainUtils.js\";\nimport { computeUpsampleInfo as l } from \"./tileUtils.js\";\n\nclass p {\n  constructor() {\n    this.waitingAgents = new n(), this._upsampleInfo = null, this.loadingAgent = null, this.requestPromise = null, this.requestAbort = null, this.pendingUpdates = 0;\n  }\n\n  static acquire(t) {\n    const s = r.acquire();\n    return s._init(t), s;\n  }\n\n  release() {\n    this.dispose(), h.delete(this), r.release(this);\n  }\n\n  dispose() {\n    this.loadingAgent = t(this.loadingAgent), this.abortRequest(), this._unsetUpsampleInfo(), this.pendingUpdates = 0, this._data = o(this._data);\n  }\n\n  static prune() {\n    r.prune(0);\n  }\n\n  _init(t) {\n    this.waitingAgents.clear(), this._data = o(this._data), this.dataMissing = !1, this.dataInvalidated = !1, this._unsetUpsampleInfo(), this.abortRequest(), this.loadingAgent = null, this.pendingUpdates = 0, this._pool = t, this.elevationBounds = null;\n  }\n\n  invalidateSourceData() {\n    this.dataInvalidated = !0, this.dataMissing = !1, this._unsetUpsampleInfo();\n  }\n\n  abortRequest() {\n    this.requestAbort = s(this.requestAbort), this.requestPromise = null;\n  }\n\n  get upsampleInfo() {\n    return this._upsampleInfo;\n  }\n\n  _unsetUpsampleInfo() {\n    e(this._upsampleInfo) && (this._upsampleInfo.tile.unrefMapData(), this._pool.release(this._upsampleInfo), this._upsampleInfo = null);\n  }\n\n  setUpsampleInfo(t, s) {\n    if (t === s || i(s)) this._unsetUpsampleInfo();else {\n      if (i(this._upsampleInfo)) this._upsampleInfo = this._pool.acquire();else {\n        if (this._upsampleInfo.tile === s) return;\n\n        this._upsampleInfo.tile.unrefMapData();\n      }\n      s.refMapData(), l(t, s, this._upsampleInfo);\n    }\n  }\n\n  get data() {\n    return this._data;\n  }\n\n  set data(t) {\n    o(this._data), this._data = t;\n  }\n\n}\n\nconst r = new a(p, null, () => {}),\n      h = new Map();\n\nfunction u() {\n  h.size > 0 && (console.log(`${h.size} live TilePerLayerInfo allocations:`), h.forEach(t => console.log(t, \"\\n\")));\n}\n\nexport { p as TilePerLayerInfo, u as printAllocations };","map":{"version":3,"names":["disposeMaybe","t","abortMaybe","s","isSome","e","isNone","i","a","n","releaseTileData","o","computeUpsampleInfo","l","p","constructor","waitingAgents","_upsampleInfo","loadingAgent","requestPromise","requestAbort","pendingUpdates","acquire","r","_init","release","dispose","h","delete","abortRequest","_unsetUpsampleInfo","_data","prune","clear","dataMissing","dataInvalidated","_pool","elevationBounds","invalidateSourceData","upsampleInfo","tile","unrefMapData","setUpsampleInfo","refMapData","data","Map","u","size","console","log","forEach","TilePerLayerInfo","printAllocations"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/terrain/TilePerLayerInfo.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t,abortMaybe as s,isSome as e,isNone as i}from\"../../../core/maybe.js\";import a from\"../../../core/ObjectPool.js\";import n from\"../../../core/PooledArray.js\";import{releaseTileData as o}from\"./terrainUtils.js\";import{computeUpsampleInfo as l}from\"./tileUtils.js\";class p{constructor(){this.waitingAgents=new n,this._upsampleInfo=null,this.loadingAgent=null,this.requestPromise=null,this.requestAbort=null,this.pendingUpdates=0}static acquire(t){const s=r.acquire();return s._init(t),s}release(){this.dispose(),h.delete(this),r.release(this)}dispose(){this.loadingAgent=t(this.loadingAgent),this.abortRequest(),this._unsetUpsampleInfo(),this.pendingUpdates=0,this._data=o(this._data)}static prune(){r.prune(0)}_init(t){this.waitingAgents.clear(),this._data=o(this._data),this.dataMissing=!1,this.dataInvalidated=!1,this._unsetUpsampleInfo(),this.abortRequest(),this.loadingAgent=null,this.pendingUpdates=0,this._pool=t,this.elevationBounds=null}invalidateSourceData(){this.dataInvalidated=!0,this.dataMissing=!1,this._unsetUpsampleInfo()}abortRequest(){this.requestAbort=s(this.requestAbort),this.requestPromise=null}get upsampleInfo(){return this._upsampleInfo}_unsetUpsampleInfo(){e(this._upsampleInfo)&&(this._upsampleInfo.tile.unrefMapData(),this._pool.release(this._upsampleInfo),this._upsampleInfo=null)}setUpsampleInfo(t,s){if(t===s||i(s))this._unsetUpsampleInfo();else{if(i(this._upsampleInfo))this._upsampleInfo=this._pool.acquire();else{if(this._upsampleInfo.tile===s)return;this._upsampleInfo.tile.unrefMapData()}s.refMapData(),l(t,s,this._upsampleInfo)}}get data(){return this._data}set data(t){o(this._data),this._data=t}}const r=new a(p,null,(()=>{})),h=new Map;function u(){h.size>0&&(console.log(`${h.size} live TilePerLayerInfo allocations:`),h.forEach((t=>console.log(t,\"\\n\"))))}export{p as TilePerLayerInfo,u as printAllocations};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}