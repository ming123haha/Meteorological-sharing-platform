{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../../core/maybe.js\";\nimport { WGLGeometryType as t } from \"../enums.js\";\nimport { createProgramDescriptor as o } from \"../Utils.js\";\nimport a from \"./WGLGeometryBrush.js\";\nimport { LabelMaterialKey as n } from \"../materialKey/MaterialKey.js\";\nimport { CompareFunction as r, PrimitiveType as i, DataType as s } from \"../../../../webgl/enums.js\";\n\nconst m = e => o(e.data, {\n  geometry: [{\n    location: 0,\n    name: \"a_pos\",\n    count: 2,\n    type: s.SHORT\n  }, {\n    location: 1,\n    name: \"a_id\",\n    count: 4,\n    type: s.UNSIGNED_BYTE\n  }, {\n    location: 2,\n    name: \"a_color\",\n    count: 4,\n    type: s.UNSIGNED_BYTE,\n    normalized: !0\n  }, {\n    location: 3,\n    name: \"a_haloColor\",\n    count: 4,\n    type: s.UNSIGNED_BYTE,\n    normalized: !0\n  }, {\n    location: 4,\n    name: \"a_texAndSize\",\n    count: 4,\n    type: s.UNSIGNED_BYTE\n  }, {\n    location: 5,\n    name: \"a_refSymbolAndPlacementOffset\",\n    count: 4,\n    type: s.UNSIGNED_BYTE\n  }, {\n    location: 6,\n    name: \"a_glyphData\",\n    count: 4,\n    type: s.UNSIGNED_BYTE\n  }, {\n    location: 7,\n    name: \"a_vertexOffset\",\n    count: 2,\n    type: s.SHORT\n  }, {\n    location: 8,\n    name: \"a_texCoords\",\n    count: 2,\n    type: s.UNSIGNED_SHORT\n  }]\n});\n\nclass l extends a {\n  dispose() {}\n\n  getGeometryType() {\n    return t.LABEL;\n  }\n\n  supportsSymbology(e) {\n    return !0;\n  }\n\n  drawGeometry(t, o, a, l) {\n    const {\n      context: d,\n      painter: u,\n      state: c,\n      rendererInfo: f,\n      requestRender: p,\n      allowDelayedRender: y\n    } = t,\n          _ = n.load(a.materialKey),\n          E = _.mapAligned ? 1 : 0;\n\n    if (!E && Math.abs(o.key.level - Math.round(100 * t.displayLevel) / 100) >= 1) return;\n    const {\n      bufferLayouts: N,\n      attributes: S\n    } = m(_),\n          U = u.materialManager.getMaterialProgram(t, _, \"materials/label\", S, l);\n    if (y && e(p) && !U.isCompiled) return void p();\n    t.context.setStencilFunction(r.EQUAL, 0, 255), d.useProgram(U), this._setSharedUniforms(U, t, o), u.textureManager.bindTextures(d, U, _);\n    const T = 1 === E ? c.displayViewMat3 : c.displayMat3;\n    this._setSizeVVUniforms(_, U, f, o), U.setUniform1f(\"u_mapRotation\", Math.floor(c.rotation / 360 * 254)), U.setUniform1f(\"u_mapAligned\", E), U.setUniformMatrix3fv(\"u_displayMat3\", T), U.setUniform1f(\"u_opacity\", 1), U.setUniform2fv(\"u_screenSize\", t.state.size), U.setUniform1f(\"u_isHalo\", 1);\n    const g = a.target.getVAO(d, N, S),\n          G = a.indexFrom * Uint32Array.BYTES_PER_ELEMENT;\n    d.bindVAO(g), d.drawElements(i.TRIANGLES, a.indexCount, s.UNSIGNED_INT, G), U.setUniform1f(\"u_isHalo\", 0), d.drawElements(i.TRIANGLES, a.indexCount, s.UNSIGNED_INT, G), d.setStencilTestEnabled(!0), d.setBlendingEnabled(!0);\n  }\n\n}\n\nexport { l as default };","map":{"version":3,"names":["isSome","e","WGLGeometryType","t","createProgramDescriptor","o","a","LabelMaterialKey","n","CompareFunction","r","PrimitiveType","i","DataType","s","m","data","geometry","location","name","count","type","SHORT","UNSIGNED_BYTE","normalized","UNSIGNED_SHORT","l","dispose","getGeometryType","LABEL","supportsSymbology","drawGeometry","context","d","painter","u","state","c","rendererInfo","f","requestRender","p","allowDelayedRender","y","_","load","materialKey","E","mapAligned","Math","abs","key","level","round","displayLevel","bufferLayouts","N","attributes","S","U","materialManager","getMaterialProgram","isCompiled","setStencilFunction","EQUAL","useProgram","_setSharedUniforms","textureManager","bindTextures","T","displayViewMat3","displayMat3","_setSizeVVUniforms","setUniform1f","floor","rotation","setUniformMatrix3fv","setUniform2fv","size","g","target","getVAO","G","indexFrom","Uint32Array","BYTES_PER_ELEMENT","bindVAO","drawElements","TRIANGLES","indexCount","UNSIGNED_INT","setStencilTestEnabled","setBlendingEnabled","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../../core/maybe.js\";import{WGLGeometryType as t}from\"../enums.js\";import{createProgramDescriptor as o}from\"../Utils.js\";import a from\"./WGLGeometryBrush.js\";import{LabelMaterialKey as n}from\"../materialKey/MaterialKey.js\";import{CompareFunction as r,PrimitiveType as i,DataType as s}from\"../../../../webgl/enums.js\";const m=e=>o(e.data,{geometry:[{location:0,name:\"a_pos\",count:2,type:s.SHORT},{location:1,name:\"a_id\",count:4,type:s.UNSIGNED_BYTE},{location:2,name:\"a_color\",count:4,type:s.UNSIGNED_BYTE,normalized:!0},{location:3,name:\"a_haloColor\",count:4,type:s.UNSIGNED_BYTE,normalized:!0},{location:4,name:\"a_texAndSize\",count:4,type:s.UNSIGNED_BYTE},{location:5,name:\"a_refSymbolAndPlacementOffset\",count:4,type:s.UNSIGNED_BYTE},{location:6,name:\"a_glyphData\",count:4,type:s.UNSIGNED_BYTE},{location:7,name:\"a_vertexOffset\",count:2,type:s.SHORT},{location:8,name:\"a_texCoords\",count:2,type:s.UNSIGNED_SHORT}]});class l extends a{dispose(){}getGeometryType(){return t.LABEL}supportsSymbology(e){return!0}drawGeometry(t,o,a,l){const{context:d,painter:u,state:c,rendererInfo:f,requestRender:p,allowDelayedRender:y}=t,_=n.load(a.materialKey),E=_.mapAligned?1:0;if(!E&&Math.abs(o.key.level-Math.round(100*t.displayLevel)/100)>=1)return;const{bufferLayouts:N,attributes:S}=m(_),U=u.materialManager.getMaterialProgram(t,_,\"materials/label\",S,l);if(y&&e(p)&&!U.isCompiled)return void p();t.context.setStencilFunction(r.EQUAL,0,255),d.useProgram(U),this._setSharedUniforms(U,t,o),u.textureManager.bindTextures(d,U,_);const T=1===E?c.displayViewMat3:c.displayMat3;this._setSizeVVUniforms(_,U,f,o),U.setUniform1f(\"u_mapRotation\",Math.floor(c.rotation/360*254)),U.setUniform1f(\"u_mapAligned\",E),U.setUniformMatrix3fv(\"u_displayMat3\",T),U.setUniform1f(\"u_opacity\",1),U.setUniform2fv(\"u_screenSize\",t.state.size),U.setUniform1f(\"u_isHalo\",1);const g=a.target.getVAO(d,N,S),G=a.indexFrom*Uint32Array.BYTES_PER_ELEMENT;d.bindVAO(g),d.drawElements(i.TRIANGLES,a.indexCount,s.UNSIGNED_INT,G),U.setUniform1f(\"u_isHalo\",0),d.drawElements(i.TRIANGLES,a.indexCount,s.UNSIGNED_INT,G),d.setStencilTestEnabled(!0),d.setBlendingEnabled(!0)}}export{l as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}