{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Error.js\";\nimport { isSome as t, isNone as s } from \"../../../core/maybe.js\";\nimport { whenOrAbort as r, eachAlwaysValues as o, isAborted as n, throwIfAborted as a } from \"../../../core/promiseUtils.js\";\nimport { makeRelative as i, removeFile as l } from \"../../../core/urlUtils.js\";\nimport c from \"../../Point.js\";\n\nasync function f(e, s, o) {\n  const {\n    loadGLTFMesh: n\n  } = await r(import(\"./loadGLTFMesh.js\"), o),\n        a = await m(s, o),\n        i = n(new c({\n    x: 0,\n    y: 0,\n    z: 0,\n    spatialReference: e.spatialReference\n  }), a.url, {\n    resolveFile: u(a),\n    useTransform: !0,\n    signal: t(o) ? o.signal : null\n  });\n  i.then(() => a.dispose(), () => a.dispose());\n  const {\n    vertexAttributes: l,\n    components: f\n  } = await i;\n  e.vertexAttributes = l, e.components = f;\n}\n\nfunction u(e) {\n  const t = l(e.url);\n  return s => {\n    const r = i(s, t, t),\n          o = r ? r.replace(/^ *\\.\\//, \"\") : null;\n    return e.files.get(o) ?? s;\n  };\n}\n\nasync function m(e, t) {\n  return e instanceof Blob ? y.fromBlob(e) : \"string\" == typeof e ? new y(e) : Array.isArray(e) ? p(e, t) : w(e, t);\n}\n\nasync function p(t, r) {\n  const i = new Map();\n  let l = null;\n  const c = await o(t.map(async e => ({\n    name: e.name,\n    source: await m(e instanceof Blob ? e : e.source, r)\n  }))),\n        f = [];\n\n  for (const e of c) e && (n(r) ? e.source.dispose() : f.push(e));\n\n  a(r);\n\n  for (const {\n    name: e,\n    source: o\n  } of f) (s(l) || /\\.(gltf|glb)/i.test(e)) && (l = o.url), i.set(e, o.url), o.files && o.files.forEach((e, t) => i.set(t, e));\n\n  if (s(l)) throw new e(\"mesh-load-external:missing-files\", \"Missing files to load external mesh source\");\n  return new y(l, () => f.forEach(({\n    source: e\n  }) => e.dispose()), i);\n}\n\nasync function w(e, t) {\n  const {\n    default: s\n  } = await r(import(\"../../../request.js\"), t),\n        o = \"string\" == typeof e.multipart[0] ? await Promise.all(e.multipart.map(async e => (await s(e, {\n    responseType: \"array-buffer\"\n  })).data)) : e.multipart;\n  return y.fromBlob(new Blob(o));\n}\n\nclass y {\n  constructor(e, t = () => {}, s = new Map()) {\n    this.url = e, this.dispose = t, this.files = s;\n  }\n\n  static fromBlob(e) {\n    const t = URL.createObjectURL(e);\n    return new y(t, () => URL.revokeObjectURL(t));\n  }\n\n}\n\nexport { f as loadExternal };","map":{"version":3,"names":["e","isSome","t","isNone","s","whenOrAbort","r","eachAlwaysValues","o","isAborted","n","throwIfAborted","a","makeRelative","i","removeFile","l","c","f","loadGLTFMesh","m","x","y","z","spatialReference","url","resolveFile","u","useTransform","signal","then","dispose","vertexAttributes","components","replace","files","get","Blob","fromBlob","Array","isArray","p","w","Map","map","name","source","push","test","set","forEach","default","multipart","Promise","all","responseType","data","constructor","URL","createObjectURL","revokeObjectURL","loadExternal"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/geometry/support/meshUtils/loadExternal.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{isSome as t,isNone as s}from\"../../../core/maybe.js\";import{whenOrAbort as r,eachAlwaysValues as o,isAborted as n,throwIfAborted as a}from\"../../../core/promiseUtils.js\";import{makeRelative as i,removeFile as l}from\"../../../core/urlUtils.js\";import c from\"../../Point.js\";async function f(e,s,o){const{loadGLTFMesh:n}=await r(import(\"./loadGLTFMesh.js\"),o),a=await m(s,o),i=n(new c({x:0,y:0,z:0,spatialReference:e.spatialReference}),a.url,{resolveFile:u(a),useTransform:!0,signal:t(o)?o.signal:null});i.then((()=>a.dispose()),(()=>a.dispose()));const{vertexAttributes:l,components:f}=await i;e.vertexAttributes=l,e.components=f}function u(e){const t=l(e.url);return s=>{const r=i(s,t,t),o=r?r.replace(/^ *\\.\\//,\"\"):null;return e.files.get(o)??s}}async function m(e,t){return e instanceof Blob?y.fromBlob(e):\"string\"==typeof e?new y(e):Array.isArray(e)?p(e,t):w(e,t)}async function p(t,r){const i=new Map;let l=null;const c=await o(t.map((async e=>({name:e.name,source:await m(e instanceof Blob?e:e.source,r)})))),f=[];for(const e of c)e&&(n(r)?e.source.dispose():f.push(e));a(r);for(const{name:e,source:o}of f)(s(l)||/\\.(gltf|glb)/i.test(e))&&(l=o.url),i.set(e,o.url),o.files&&o.files.forEach(((e,t)=>i.set(t,e)));if(s(l))throw new e(\"mesh-load-external:missing-files\",\"Missing files to load external mesh source\");return new y(l,(()=>f.forEach((({source:e})=>e.dispose()))),i)}async function w(e,t){const{default:s}=await r(import(\"../../../request.js\"),t),o=\"string\"==typeof e.multipart[0]?await Promise.all(e.multipart.map((async e=>(await s(e,{responseType:\"array-buffer\"})).data))):e.multipart;return y.fromBlob(new Blob(o))}class y{constructor(e,t=(()=>{}),s=new Map){this.url=e,this.dispose=t,this.files=s}static fromBlob(e){const t=URL.createObjectURL(e);return new y(t,(()=>URL.revokeObjectURL(t)))}}export{f as loadExternal};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,wBAAb;AAAsC,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,wBAAnC;AAA4D,SAAOC,WAAW,IAAIC,CAAtB,EAAwBC,gBAAgB,IAAIC,CAA5C,EAA8CC,SAAS,IAAIC,CAA3D,EAA6DC,cAAc,IAAIC,CAA/E,QAAqF,+BAArF;AAAqH,SAAOC,YAAY,IAAIC,CAAvB,EAAyBC,UAAU,IAAIC,CAAvC,QAA6C,2BAA7C;AAAyE,OAAOC,CAAP,MAAa,gBAAb;;AAA8B,eAAeC,CAAf,CAAiBlB,CAAjB,EAAmBI,CAAnB,EAAqBI,CAArB,EAAuB;EAAC,MAAK;IAACW,YAAY,EAACT;EAAd,IAAiB,MAAMJ,CAAC,CAAC,OAAO,mBAAP,CAAD,EAA6BE,CAA7B,CAA7B;EAAA,MAA6DI,CAAC,GAAC,MAAMQ,CAAC,CAAChB,CAAD,EAAGI,CAAH,CAAtE;EAAA,MAA4EM,CAAC,GAACJ,CAAC,CAAC,IAAIO,CAAJ,CAAM;IAACI,CAAC,EAAC,CAAH;IAAKC,CAAC,EAAC,CAAP;IAASC,CAAC,EAAC,CAAX;IAAaC,gBAAgB,EAACxB,CAAC,CAACwB;EAAhC,CAAN,CAAD,EAA0DZ,CAAC,CAACa,GAA5D,EAAgE;IAACC,WAAW,EAACC,CAAC,CAACf,CAAD,CAAd;IAAkBgB,YAAY,EAAC,CAAC,CAAhC;IAAkCC,MAAM,EAAC3B,CAAC,CAACM,CAAD,CAAD,GAAKA,CAAC,CAACqB,MAAP,GAAc;EAAvD,CAAhE,CAA/E;EAA6Mf,CAAC,CAACgB,IAAF,CAAQ,MAAIlB,CAAC,CAACmB,OAAF,EAAZ,EAA0B,MAAInB,CAAC,CAACmB,OAAF,EAA9B;EAA4C,MAAK;IAACC,gBAAgB,EAAChB,CAAlB;IAAoBiB,UAAU,EAACf;EAA/B,IAAkC,MAAMJ,CAA7C;EAA+Cd,CAAC,CAACgC,gBAAF,GAAmBhB,CAAnB,EAAqBhB,CAAC,CAACiC,UAAF,GAAaf,CAAlC;AAAoC;;AAAA,SAASS,CAAT,CAAW3B,CAAX,EAAa;EAAC,MAAME,CAAC,GAACc,CAAC,CAAChB,CAAC,CAACyB,GAAH,CAAT;EAAiB,OAAOrB,CAAC,IAAE;IAAC,MAAME,CAAC,GAACQ,CAAC,CAACV,CAAD,EAAGF,CAAH,EAAKA,CAAL,CAAT;IAAA,MAAiBM,CAAC,GAACF,CAAC,GAACA,CAAC,CAAC4B,OAAF,CAAU,SAAV,EAAoB,EAApB,CAAD,GAAyB,IAA7C;IAAkD,OAAOlC,CAAC,CAACmC,KAAF,CAAQC,GAAR,CAAY5B,CAAZ,KAAgBJ,CAAvB;EAAyB,CAAtF;AAAuF;;AAAA,eAAegB,CAAf,CAAiBpB,CAAjB,EAAmBE,CAAnB,EAAqB;EAAC,OAAOF,CAAC,YAAYqC,IAAb,GAAkBf,CAAC,CAACgB,QAAF,CAAWtC,CAAX,CAAlB,GAAgC,YAAU,OAAOA,CAAjB,GAAmB,IAAIsB,CAAJ,CAAMtB,CAAN,CAAnB,GAA4BuC,KAAK,CAACC,OAAN,CAAcxC,CAAd,IAAiByC,CAAC,CAACzC,CAAD,EAAGE,CAAH,CAAlB,GAAwBwC,CAAC,CAAC1C,CAAD,EAAGE,CAAH,CAA5F;AAAkG;;AAAA,eAAeuC,CAAf,CAAiBvC,CAAjB,EAAmBI,CAAnB,EAAqB;EAAC,MAAMQ,CAAC,GAAC,IAAI6B,GAAJ,EAAR;EAAgB,IAAI3B,CAAC,GAAC,IAAN;EAAW,MAAMC,CAAC,GAAC,MAAMT,CAAC,CAACN,CAAC,CAAC0C,GAAF,CAAO,MAAM5C,CAAN,KAAU;IAAC6C,IAAI,EAAC7C,CAAC,CAAC6C,IAAR;IAAaC,MAAM,EAAC,MAAM1B,CAAC,CAACpB,CAAC,YAAYqC,IAAb,GAAkBrC,CAAlB,GAAoBA,CAAC,CAAC8C,MAAvB,EAA8BxC,CAA9B;EAA3B,CAAV,CAAP,CAAD,CAAf;EAAA,MAAkGY,CAAC,GAAC,EAApG;;EAAuG,KAAI,MAAMlB,CAAV,IAAeiB,CAAf,EAAiBjB,CAAC,KAAGU,CAAC,CAACJ,CAAD,CAAD,GAAKN,CAAC,CAAC8C,MAAF,CAASf,OAAT,EAAL,GAAwBb,CAAC,CAAC6B,IAAF,CAAO/C,CAAP,CAA3B,CAAD;;EAAuCY,CAAC,CAACN,CAAD,CAAD;;EAAK,KAAI,MAAK;IAACuC,IAAI,EAAC7C,CAAN;IAAQ8C,MAAM,EAACtC;EAAf,CAAT,IAA6BU,CAA7B,EAA+B,CAACd,CAAC,CAACY,CAAD,CAAD,IAAM,gBAAgBgC,IAAhB,CAAqBhD,CAArB,CAAP,MAAkCgB,CAAC,GAACR,CAAC,CAACiB,GAAtC,GAA2CX,CAAC,CAACmC,GAAF,CAAMjD,CAAN,EAAQQ,CAAC,CAACiB,GAAV,CAA3C,EAA0DjB,CAAC,CAAC2B,KAAF,IAAS3B,CAAC,CAAC2B,KAAF,CAAQe,OAAR,CAAiB,CAAClD,CAAD,EAAGE,CAAH,KAAOY,CAAC,CAACmC,GAAF,CAAM/C,CAAN,EAAQF,CAAR,CAAxB,CAAnE;;EAAwG,IAAGI,CAAC,CAACY,CAAD,CAAJ,EAAQ,MAAM,IAAIhB,CAAJ,CAAM,kCAAN,EAAyC,4CAAzC,CAAN;EAA6F,OAAO,IAAIsB,CAAJ,CAAMN,CAAN,EAAS,MAAIE,CAAC,CAACgC,OAAF,CAAW,CAAC;IAACJ,MAAM,EAAC9C;EAAR,CAAD,KAAcA,CAAC,CAAC+B,OAAF,EAAzB,CAAb,EAAqDjB,CAArD,CAAP;AAA+D;;AAAA,eAAe4B,CAAf,CAAiB1C,CAAjB,EAAmBE,CAAnB,EAAqB;EAAC,MAAK;IAACiD,OAAO,EAAC/C;EAAT,IAAY,MAAME,CAAC,CAAC,OAAO,qBAAP,CAAD,EAA+BJ,CAA/B,CAAxB;EAAA,MAA0DM,CAAC,GAAC,YAAU,OAAOR,CAAC,CAACoD,SAAF,CAAY,CAAZ,CAAjB,GAAgC,MAAMC,OAAO,CAACC,GAAR,CAAYtD,CAAC,CAACoD,SAAF,CAAYR,GAAZ,CAAiB,MAAM5C,CAAN,IAAS,CAAC,MAAMI,CAAC,CAACJ,CAAD,EAAG;IAACuD,YAAY,EAAC;EAAd,CAAH,CAAR,EAA2CC,IAArE,CAAZ,CAAtC,GAA+HxD,CAAC,CAACoD,SAA7L;EAAuM,OAAO9B,CAAC,CAACgB,QAAF,CAAW,IAAID,IAAJ,CAAS7B,CAAT,CAAX,CAAP;AAA+B;;AAAA,MAAMc,CAAN,CAAO;EAACmC,WAAW,CAACzD,CAAD,EAAGE,CAAC,GAAE,MAAI,CAAE,CAAZ,EAAcE,CAAC,GAAC,IAAIuC,GAAJ,EAAhB,EAAwB;IAAC,KAAKlB,GAAL,GAASzB,CAAT,EAAW,KAAK+B,OAAL,GAAa7B,CAAxB,EAA0B,KAAKiC,KAAL,GAAW/B,CAArC;EAAuC;;EAAe,OAARkC,QAAQ,CAACtC,CAAD,EAAG;IAAC,MAAME,CAAC,GAACwD,GAAG,CAACC,eAAJ,CAAoB3D,CAApB,CAAR;IAA+B,OAAO,IAAIsB,CAAJ,CAAMpB,CAAN,EAAS,MAAIwD,GAAG,CAACE,eAAJ,CAAoB1D,CAApB,CAAb,CAAP;EAA6C;;AAA3K;;AAA4K,SAAOgB,CAAC,IAAI2C,YAAZ"},"metadata":{},"sourceType":"module"}