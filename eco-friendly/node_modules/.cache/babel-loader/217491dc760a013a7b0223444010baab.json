{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport \"../../../geometry.js\";\nimport s from \"../../../core/Error.js\";\nimport e from \"../../../core/has.js\";\nimport { unwrap as r } from \"../../../core/maybe.js\";\nimport { eachAlways as a, createAbortError as o } from \"../../../core/promiseUtils.js\";\nimport { property as i } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as n } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport m from \"./BaseRaster.js\";\nimport l from \"./InMemoryRaster.js\";\nimport { parsePAMInfo as p } from \"./pamParser.js\";\nimport { getFormat as c } from \"../rasterFormats/RasterCodec.js\";\nimport { estimateStatisticsFromHistograms as f } from \"../rasterFunctions/stretchUtils.js\";\nimport u from \"../rasterTransforms/PolynomialTransform.js\";\nimport h from \"../../../geometry/SpatialReference.js\";\nimport d from \"../../../geometry/Extent.js\";\nlet y = class extends m {\n  async open(t) {\n    await this.init();\n    const s = await this._fetchData(t);\n    let {\n      spatialReference: e,\n      statistics: r,\n      histograms: a,\n      transform: o\n    } = await this._fetchAuxiliaryData(t);\n    const i = !e;\n    i && (e = new h({\n      wkid: 3857\n    })), a?.length && null == r && (r = f(a));\n    const {\n      width: n,\n      height: m\n    } = s;\n    let p = new d({\n      xmin: -.5,\n      ymin: .5 - m,\n      xmax: n - .5,\n      ymax: .5,\n      spatialReference: e\n    });\n    const c = o ? o.forwardTransform(p) : p;\n    let u = !0;\n\n    if (o) {\n      const t = o.forwardCoefficients;\n      u = t && 0 === t[1] && 0 === t[2], u && (o = null, p = c);\n    }\n\n    const y = new l({\n      data: {\n        extent: c,\n        nativeExtent: p,\n        transform: o,\n        pixelBlock: s,\n        statistics: r,\n        histograms: a,\n        keyProperties: {\n          DateType: \"Processed\"\n        },\n        isPseudoSpatialReference: i\n      }\n    });\n    await y.open(), y.data = null, this._set(\"rasterInfo\", y.rasterInfo), this._inMemoryRaster = y;\n  }\n\n  fetchRawTile(t, s, e, r = {}) {\n    return this._inMemoryRaster.fetchRawTile(t, s, e, r);\n  }\n\n  async _fetchData(t) {\n    const {\n      data: r\n    } = await this.request(this.url, {\n      responseType: \"array-buffer\",\n      signal: t?.signal\n    }),\n          a = c(r).toUpperCase();\n    if (\"JPG\" !== a && \"PNG\" !== a && \"GIF\" !== a && \"BMP\" !== a) throw new s(\"image-aux-raster:open\", \"the data is not a supported format\");\n\n    this._set(\"datasetFormat\", a);\n\n    const o = a.toLowerCase(),\n          i = \"gif\" === o || \"bmp\" === o || !e(\"ios\");\n    return await this.decodePixelBlock(r, {\n      format: o,\n      useCanvas: i,\n      hasNoZlibMask: !0\n    });\n  }\n\n  async _fetchAuxiliaryData(t) {\n    const s = r(t?.signal),\n          e = this.ioConfig.skipExtensions ?? [],\n          i = e.includes(\"aux.xml\") ? null : this.request(this.url + \".aux.xml\", {\n      responseType: \"xml\",\n      signal: s\n    }),\n          n = this.datasetFormat,\n          m = \"JPG\" === n ? \"jgw\" : \"PNG\" === n ? \"pgw\" : \"BMP\" === n ? \"bpw\" : null,\n          l = e.includes(m) ? null : this.request(this.url.slice(0, this.url.lastIndexOf(\".\")) + \".\" + m, {\n      responseType: \"text\",\n      signal: s\n    }),\n          c = await a([i, l]);\n    if (s?.aborted) throw o();\n    const f = p(c[0].value?.data);\n\n    if (!f.transform) {\n      const t = c[1].value ? c[1].value.data.split(\"\\n\").slice(0, 6).map(t => Number(t)) : null;\n      f.transform = 6 === t?.length ? new u({\n        forwardCoefficients: [t[4], t[5], t[0], -t[1], t[2], -t[3]]\n      }) : null;\n    }\n\n    return f;\n  }\n\n};\nt([i({\n  type: String,\n  json: {\n    write: !0\n  }\n})], y.prototype, \"datasetFormat\", void 0), y = t([n(\"esri.layers.support.rasterDatasets.ImageAuxRaster\")], y);\nconst w = y;\nexport { w as default };","map":{"version":3,"names":["_","t","s","e","unwrap","r","eachAlways","a","createAbortError","o","property","i","subclass","n","m","l","parsePAMInfo","p","getFormat","c","estimateStatisticsFromHistograms","f","u","h","d","y","open","init","_fetchData","spatialReference","statistics","histograms","transform","_fetchAuxiliaryData","wkid","length","width","height","xmin","ymin","xmax","ymax","forwardTransform","forwardCoefficients","data","extent","nativeExtent","pixelBlock","keyProperties","DateType","isPseudoSpatialReference","_set","rasterInfo","_inMemoryRaster","fetchRawTile","request","url","responseType","signal","toUpperCase","toLowerCase","decodePixelBlock","format","useCanvas","hasNoZlibMask","ioConfig","skipExtensions","includes","datasetFormat","slice","lastIndexOf","aborted","value","split","map","Number","type","String","json","write","prototype","w","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/support/rasterDatasets/ImageAuxRaster.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import s from\"../../../core/Error.js\";import e from\"../../../core/has.js\";import{unwrap as r}from\"../../../core/maybe.js\";import{eachAlways as a,createAbortError as o}from\"../../../core/promiseUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../../../core/accessorSupport/decorators/subclass.js\";import m from\"./BaseRaster.js\";import l from\"./InMemoryRaster.js\";import{parsePAMInfo as p}from\"./pamParser.js\";import{getFormat as c}from\"../rasterFormats/RasterCodec.js\";import{estimateStatisticsFromHistograms as f}from\"../rasterFunctions/stretchUtils.js\";import u from\"../rasterTransforms/PolynomialTransform.js\";import h from\"../../../geometry/SpatialReference.js\";import d from\"../../../geometry/Extent.js\";let y=class extends m{async open(t){await this.init();const s=await this._fetchData(t);let{spatialReference:e,statistics:r,histograms:a,transform:o}=await this._fetchAuxiliaryData(t);const i=!e;i&&(e=new h({wkid:3857})),a?.length&&null==r&&(r=f(a));const{width:n,height:m}=s;let p=new d({xmin:-.5,ymin:.5-m,xmax:n-.5,ymax:.5,spatialReference:e});const c=o?o.forwardTransform(p):p;let u=!0;if(o){const t=o.forwardCoefficients;u=t&&0===t[1]&&0===t[2],u&&(o=null,p=c)}const y=new l({data:{extent:c,nativeExtent:p,transform:o,pixelBlock:s,statistics:r,histograms:a,keyProperties:{DateType:\"Processed\"},isPseudoSpatialReference:i}});await y.open(),y.data=null,this._set(\"rasterInfo\",y.rasterInfo),this._inMemoryRaster=y}fetchRawTile(t,s,e,r={}){return this._inMemoryRaster.fetchRawTile(t,s,e,r)}async _fetchData(t){const{data:r}=await this.request(this.url,{responseType:\"array-buffer\",signal:t?.signal}),a=c(r).toUpperCase();if(\"JPG\"!==a&&\"PNG\"!==a&&\"GIF\"!==a&&\"BMP\"!==a)throw new s(\"image-aux-raster:open\",\"the data is not a supported format\");this._set(\"datasetFormat\",a);const o=a.toLowerCase(),i=\"gif\"===o||\"bmp\"===o||!e(\"ios\");return await this.decodePixelBlock(r,{format:o,useCanvas:i,hasNoZlibMask:!0})}async _fetchAuxiliaryData(t){const s=r(t?.signal),e=this.ioConfig.skipExtensions??[],i=e.includes(\"aux.xml\")?null:this.request(this.url+\".aux.xml\",{responseType:\"xml\",signal:s}),n=this.datasetFormat,m=\"JPG\"===n?\"jgw\":\"PNG\"===n?\"pgw\":\"BMP\"===n?\"bpw\":null,l=e.includes(m)?null:this.request(this.url.slice(0,this.url.lastIndexOf(\".\"))+\".\"+m,{responseType:\"text\",signal:s}),c=await a([i,l]);if(s?.aborted)throw o();const f=p(c[0].value?.data);if(!f.transform){const t=c[1].value?c[1].value.data.split(\"\\n\").slice(0,6).map((t=>Number(t))):null;f.transform=6===t?.length?new u({forwardCoefficients:[t[4],t[5],t[0],-t[1],t[2],-t[3]]}):null}return f}};t([i({type:String,json:{write:!0}})],y.prototype,\"datasetFormat\",void 0),y=t([n(\"esri.layers.support.rasterDatasets.ImageAuxRaster\")],y);const w=y;export{w as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}