{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as i } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Accessor.js\";\nimport { lerp as s } from \"../../../../core/mathUtils.js\";\nimport { isNone as e, isSome as r } from \"../../../../core/maybe.js\";\nimport a from \"../../../../core/PooledArray.js\";\nimport { property as o } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as c } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { a as n } from \"../../../../chunks/mat4.js\";\nimport { c as h } from \"../../../../chunks/mat4f64.js\";\nimport { a as l } from \"../../../../chunks/vec2f64.js\";\nimport { m as p, g as u, s as d, c as f } from \"../../../../chunks/vec3.js\";\nimport { Z as m, c as g } from \"../../../../chunks/vec3f64.js\";\nimport { s as b, t as v, b as y } from \"../../../../chunks/vec4.js\";\nimport { c as _ } from \"../../../../chunks/vec4f64.js\";\nimport { getReferenceEllipsoid as G } from \"../../../../geometry/projectionEllipsoid.js\";\nimport { create as S, empty as B, offset as w, width as D, height as N, expand as j, intersects as V } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { c as I, a as P, e as C } from \"../../../../chunks/boundedPlane.js\";\nimport { create as A } from \"../../../../geometry/support/ray.js\";\nimport { e as x, g as O, h as M, c as T } from \"../../../../chunks/sphere.js\";\nimport { drawAccelerationStruct as z, prepare as E, drawPoly as F } from \"./deconflictorDebug.js\";\nimport { VisibilityGroup as X, VisibilityFlag as R } from \"./enums.js\";\nimport L from \"../../support/debugFlags.js\";\nimport { Camera as Y } from \"../../webgl-engine/lib/Camera.js\";\nimport { applyPrecomputedScaleFactor as k } from \"../../webgl-engine/lib/screenSizePerspectiveUtils.js\";\nimport { VertexAttribute as W } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { HUDMaterial as U } from \"../../webgl-engine/materials/HUDMaterial.js\";\n\nconst H = g(),\n      Z = _(),\n      q = _(),\n      J = g(),\n      K = h(),\n      Q = T(),\n      $ = A(),\n      ii = g(),\n      ti = S();\n\nclass si {\n  constructor() {\n    this.aabr = S(), this.distance = 0, this.culled = !1, this.visible = !1;\n  }\n\n}\n\nclass ei {\n  constructor(i, t, s = {}) {\n    this.graphics3DGraphic = i, this.slicePlaneEnabled = t, this.info = s;\n  }\n\n}\n\nclass ri {\n  constructor() {\n    this.active = new Map(), this.visible = new Map();\n  }\n\n  clear() {\n    this.active.clear(), this.visible.clear();\n  }\n\n}\n\nclass ai {}\n\nclass oi {\n  constructor() {\n    this.sortArray = new a({\n      allocator: i => i || new ai()\n    });\n  }\n\n}\n\nvar ci;\n!function (i) {\n  i[i.Idle = 0] = \"Idle\", i[i.Process = 1] = \"Process\", i[i.Sort = 2] = \"Sort\", i[i.Deconflict = 3] = \"Deconflict\", i[i.NumStates = 4] = \"NumStates\";\n}(ci || (ci = {}));\n\nclass ni {\n  constructor() {\n    this.camera = new Y(), this.slicePlane = I(), this.slicePlaneEnabled = !1;\n  }\n\n  copyFrom(i) {\n    this.camera.copyFrom(i.camera), P(i.slicePlane, this.slicePlane), this.slicePlaneEnabled = i.slicePlaneEnabled;\n  }\n\n}\n\nlet hi = class extends t {\n  constructor() {\n    super(...arguments), this._dirty = !1, this._runningViewState = new ni(), this._state = ci.Idle, this.graphics = new ri(), this.iterators = new oi(), this.accBinsNumX = 15, this.accBinsNumY = 20, this.accBinsSizeX = 0, this.accBinsSizeY = 0, this.accBins = null, this.accNumTests = 0;\n  }\n\n  get dirty() {\n    return this._dirty;\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  destroy() {\n    this.graphics.clear(), this.iterators = null;\n  }\n\n  setDirty() {\n    !this._dirty && this.graphics.active.size > 0 && (this._dirty = !0, this.notifyChange(\"updating\"));\n  }\n\n  get updating() {\n    return this._state !== ci.Idle || this._dirty;\n  }\n\n  get updatingProgress() {\n    if (!this.updating) return 1;\n    const i = this._state / ci.NumStates;\n    return this._dirty ? .5 * i : i;\n  }\n\n  get running() {\n    return this.view.ready && null != this.view.state && this.updating;\n  }\n\n  runTask(i) {\n    switch (this._state) {\n      case ci.Idle:\n        this._startUpdate(), i.madeProgress();\n\n      case ci.Process:\n        if (this._state = ci.Process, !this._processActiveGraphics(i)) return;\n\n      case ci.Sort:\n        if (this._state = ci.Sort, !this._sortVisibleGraphics(i)) return;\n\n      case ci.Deconflict:\n        if (this._state = ci.Deconflict, !this._deconflictVisibleGraphics(i)) return;\n\n      default:\n        z(this, this.graphics.visible), this._state = ci.Idle, this.notifyChange(\"updating\");\n    }\n  }\n\n  modifyGraphics(i, t) {\n    t ? i.forEach(i => this.addToActiveGraphics(i)) : i.forEach(i => this.removeFromActiveGraphics(i)), this.setDirty();\n  }\n\n  layerSupportsDeconfliction(i) {\n    if (e(i) || \"object3d\" !== i.type) return !1;\n    const t = i.stageObject;\n    if (1 !== (t ? t.geometryRecords.length : 0)) return !1;\n    return t.geometryRecords[0].material instanceof U;\n  }\n\n  _startUpdate() {\n    E(this.view), this._dirty = !1, this._runningViewState.copyFrom(this.viewState);\n    const {\n      fullWidth: i,\n      fullHeight: t\n    } = this._runningViewState.camera;\n    this._initBins(i, t), this._resetIterators();\n  }\n\n  addToActiveGraphics(i) {\n    i.info[this.visibilityGroup] = new si(), this.graphics.active.set(i.graphics3DGraphic.graphic.uid, i), this.setDirty();\n  }\n\n  removeFromActiveGraphics(i) {\n    this._removeFromVisibleGraphics(i), li(i, this.visibilityGroup), delete i.info[this.visibilityGroup], this.graphics.active.delete(i.graphics3DGraphic.graphic.uid), this.setDirty();\n  }\n\n  _addToVisibleGraphics(i) {\n    this.graphics.visible.set(i.graphics3DGraphic.graphic.uid, i);\n  }\n\n  _removeFromVisibleGraphics(i) {\n    this.graphics.visible.delete(i.graphics3DGraphic.graphic.uid);\n  }\n\n  _processActiveGraphics(i) {\n    const t = this._ensureActiveGraphicsIterator(),\n          s = n(K, this._runningViewState.camera.projectionMatrix),\n          e = \"global\" === this.view.viewingMode && 1 === this.view.map.ground.opacity && this._runningViewState.camera.relativeElevation > 0 ? Q : null;\n\n    let a = 0;\n\n    for (r(e) && (p(e, m, this._runningViewState.camera.viewMatrix), e[3] = G(this.view.spatialReference).radius, a = x(e, m)); !i.done;) {\n      i.madeProgress();\n      const r = t.next();\n      if (!0 === r.done) return this._resetActiveGraphicsIterator(), !0;\n      const o = r.value,\n            c = o && o.info[this.visibilityGroup];\n      c && (this._collectGraphics3DGraphics(o, s, e, a), c.culled ? this._removeFromVisibleGraphics(o) : this._addToVisibleGraphics(o));\n    }\n\n    return !1;\n  }\n\n  _sortVisibleGraphics(i) {\n    const t = this._ensureSortGraphicsIterator();\n\n    for (; !i.done;) {\n      const s = t.next();\n      if (i.madeProgress(), !0 === s.done) return this._resetSortGraphicsIterator(), !0;\n    }\n\n    return !1;\n  }\n\n  _deconflictVisibleGraphics(i) {\n    const t = this._ensureVisibleGraphicsIterator(),\n          s = this.visibilityGroup === X.LABEL;\n\n    for (; !i.done;) {\n      i.madeProgress();\n      const e = t.next();\n      if (!0 === e.done) return this._resetVisibleGraphicsIterator(), !0;\n      const r = e.value,\n            a = r.info[this.visibilityGroup];\n      if (!a || a.culled) continue;\n      const o = r.graphics3DGraphic,\n            c = (!s || o.isVisible()) && !this._isConflicted(r);\n      c && this._addToBins(r), a.visible = c, this._setGraphicVisibility(r, c), F(a, c);\n    }\n\n    return !1;\n  }\n\n  _resetIterators() {\n    this.iterators.active = null, this.iterators.visible = null, this.iterators.sort = null;\n  }\n\n  _ensureActiveGraphicsIterator() {\n    return this.iterators.active || (this.iterators.active = pi(this.graphics.active)), this.iterators.active;\n  }\n\n  _resetActiveGraphicsIterator() {\n    this.iterators.active = null;\n  }\n\n  _ensureVisibleGraphicsIterator() {\n    return this.iterators.visible || (this.iterators.visible = pi(this.graphics.visible)), this.iterators.visible;\n  }\n\n  _resetVisibleGraphicsIterator() {\n    this.iterators.visible = null;\n  }\n\n  _ensureSortGraphicsIterator() {\n    return this.iterators.sort || (this.iterators.sort = ui(this.graphics.visible, this.iterators.sortArray, this.visibilityGroup)), this.iterators.sort;\n  }\n\n  _resetSortGraphicsIterator() {\n    this.iterators.sort = null;\n  }\n\n  _collectGraphics3DGraphics(i, t, s, a) {\n    const o = i.graphics3DGraphic;\n    if (o.destroyed) return;\n    const c = i.info[this.visibilityGroup];\n    if (!o.isVisible(X.GRAPHIC, R.DECONFLICTION)) return void (c.culled = !0);\n    const n = this.getGraphicsLayers(o);\n    B(c.aabr);\n    let h = null;\n\n    for (const l of n) {\n      if (!this.layerSupportsDeconfliction(l)) continue;\n      const o = l.stageObject.geometryRecords[0].material;\n\n      if (e(h)) {\n        if (h = this._getProjectionInfo(l, t, mi), h.isOutsideScreen || this._isCulledBySlice(i, H) || r(s) && this._isCulledByHorizon(h, s, a)) return void (c.culled = !0);\n        !L.TESTS_DISABLE_OPTIMIZATIONS && c.visible && (h.distance *= .7);\n      }\n\n      this._expandBoundingRect(c, l, o, h);\n    }\n\n    e(h) ? c.culled = !0 : (c.distance = h.distance, c.culled = !1);\n  }\n\n  _getProjectionInfo(i, t, s) {\n    const e = this._runningViewState.camera,\n          r = i.stageObject,\n          a = r.geometryRecords[0],\n          o = a.material,\n          c = O(r.boundingVolumeWorldSpace.bounds);\n    p(H, c, e.viewMatrix);\n    const n = a.geometry.vertexAttributes,\n          h = n.get(W.NORMAL).data,\n          l = n.get(W.AUXPOS1).data;\n    return o.applyShaderOffsetsView(H, h, r.transformation, l, e, s.scaleInfo, H), b(Z, H[0], H[1], H[2], 1), v(q, Z, e.projectionMatrix), u(s.positionNDC, q, 1 / q[3]), o.applyShaderOffsetsNDC(s.positionNDC, l, e, s.positionNDC, J), s.distanceWithoutPolygonOffset = e.depthNDCToWorld(J[2]), s.distance = J[2] === s.positionNDC[2] ? s.distanceWithoutPolygonOffset : e.depthNDCToWorld(s.positionNDC[2]), b(q, s.positionNDC[0], s.positionNDC[1], s.positionNDC[2], 1), v(Z, q, t), y(Z, Z, 1 / Z[3]), d(s.positionView, H[0], H[1], H[2]), s;\n  }\n\n  _isCulledByHorizon(i, t, s) {\n    return f($.direction, i.positionView), d($.origin, 0, 0, 0), !!M(t, $, ii) && i.distanceWithoutPolygonOffset > s;\n  }\n\n  _isCulledBySlice(i, t) {\n    return i.slicePlaneEnabled && this._runningViewState.slicePlaneEnabled && C(this._runningViewState.slicePlane, t);\n  }\n\n  _expandBoundingRect(i, t, e, {\n    positionNDC: r,\n    scaleInfo: a\n  }) {\n    const o = this._runningViewState.camera,\n          c = t.getScreenSize(di);\n    k(c, a.factor, c), c[0] *= o.pixelRatio, c[1] *= o.pixelRatio;\n    const n = w(e.calculateRelativeScreenBounds(c, a.factorAlignment.scale, ti), s(0, o.fullWidth, .5 + .5 * r[0]), s(0, o.fullHeight, .5 + .5 * r[1])),\n          h = this.iconMarginFactor;\n\n    if (0 !== h) {\n      const i = h * Math.min(D(n), N(n));\n      n[0] -= i, n[1] -= i, n[2] += i, n[3] += i;\n    }\n\n    j(i.aabr, n, i.aabr);\n  }\n\n  _isConflicted(i) {\n    const t = i.graphics3DGraphic.graphic.uid,\n          s = i.info[this.visibilityGroup];\n\n    for (let e = Math.floor(s.aabr[0] / this.accBinsSizeX); e <= Math.floor(s.aabr[2] / this.accBinsSizeX); e++) if (!(e < 0 || e >= this.accBinsNumX)) for (let i = Math.floor(s.aabr[1] / this.accBinsSizeY); i <= Math.floor(s.aabr[3] / this.accBinsSizeY); i++) {\n      if (i < 0 || i >= this.accBinsNumY) continue;\n      const r = this.accBins[e][i];\n\n      for (let i = 0; i < r.length; i++) {\n        const e = r.data[i],\n              a = e.info[this.visibilityGroup];\n        if (a && a.visible && e.graphics3DGraphic.graphic.uid !== t && (this.accNumTests++, V(a.aabr, s.aabr))) return !0;\n      }\n    }\n\n    return !1;\n  }\n\n  _initBins(i, t) {\n    if (null == this.accBins) {\n      this.accBins = [];\n\n      for (let i = 0; i < this.accBinsNumX; i++) {\n        this.accBins.push([]);\n        const i = this.accBins[this.accBins.length - 1];\n\n        for (let t = 0; t < this.accBinsNumY; t++) i.push(new a());\n      }\n    } else for (let s = 0; s < this.accBinsNumX; s++) for (let i = 0; i < this.accBinsNumY; i++) this.accBins[s][i].clear();\n\n    this.accBinsSizeX = i / this.accBinsNumX, this.accBinsSizeY = t / this.accBinsNumY, this.accNumTests = 0;\n  }\n\n  _addToBins(i) {\n    const t = i.info[this.visibilityGroup],\n          s = Math.floor(t.aabr[0] / this.accBinsSizeX),\n          e = Math.floor(t.aabr[2] / this.accBinsSizeX),\n          r = Math.floor(t.aabr[1] / this.accBinsSizeY),\n          a = Math.floor(t.aabr[3] / this.accBinsSizeY);\n\n    for (let o = s; o <= e; o++) if (!(o < 0 || o >= this.accBinsNumX)) for (let t = r; t <= a; t++) t < 0 || t >= this.accBinsNumY || this.accBins[o][t].push(i);\n  }\n\n  _setGraphicVisibility(i, t) {\n    const s = i.graphics3DGraphic;\n    s.destroyed || (s.setVisibilityFlag(R.DECONFLICTION, t, this.visibilityGroup), this.visibilityGroup === X.LABEL && this.view.labeler.setLabelGraphicVisibility(s, t));\n  }\n\n};\n\nfunction li(i, t) {\n  const s = i.graphics3DGraphic;\n  s.destroyed || s.clearVisibilityFlag(R.DECONFLICTION, t);\n}\n\nfunction* pi(i) {\n  if (Map.prototype.entries) {\n    const t = i.entries();\n\n    for (let i = t.next(); !i.done; i = t.next()) yield i.value[1];\n  } else yield* i.values();\n}\n\nfunction* ui(i, t, s) {\n  t.clear(), i.forEach((i, e) => {\n    const r = t.pushNew();\n    r.id = e, r.prio = i.info ? -i.info[s].distance : Number.MAX_VALUE;\n  }), yield;\n  const e = t.iterableSort((i, t) => t.prio - i.prio);\n\n  for (let r = e.next(); !r.done; r = e.next()) yield;\n\n  t.forAll(t => {\n    const s = i.get(t.id);\n    s && (i.delete(t.id), i.set(t.id, s));\n  }), t.clear();\n}\n\ni([o({\n  constructOnly: !0\n})], hi.prototype, \"view\", void 0), i([o({\n  type: Boolean,\n  readOnly: !0\n})], hi.prototype, \"updating\", null), hi = i([c(\"esri.views.3d.layers.graphics.Deconflictor\")], hi);\nconst di = l();\n\nclass fi {\n  constructor() {\n    this.positionView = g(), this.positionNDC = g(), this.distance = 0, this.distanceWithoutPolygonOffset = 0, this.scaleInfo = {\n      factor: {\n        scale: 0,\n        factor: 0,\n        minPixelSize: 0,\n        paddingPixels: 0\n      },\n      factorAlignment: {\n        scale: 0,\n        factor: 0,\n        minPixelSize: 0,\n        paddingPixels: 0\n      }\n    };\n  }\n\n  get isOutsideScreen() {\n    const i = this.positionNDC;\n    return i[0] < -1 || i[1] < -1 || i[2] < -1 || i[0] >= 1 || i[1] >= 1;\n  }\n\n}\n\nconst mi = new fi();\nexport { hi as Deconflictor, ei as DeconflictorGraphic, ni as DeconflictorViewState, ci as State };","map":{"version":3,"names":["_","i","t","lerp","s","isNone","e","isSome","r","a","property","o","subclass","c","n","h","l","m","p","g","u","d","f","Z","b","v","y","getReferenceEllipsoid","G","create","S","empty","B","offset","w","width","D","height","N","expand","j","intersects","V","I","P","C","A","x","O","M","T","drawAccelerationStruct","z","prepare","E","drawPoly","F","VisibilityGroup","X","VisibilityFlag","R","L","Camera","Y","applyPrecomputedScaleFactor","k","VertexAttribute","W","HUDMaterial","U","H","q","J","K","Q","$","ii","ti","si","constructor","aabr","distance","culled","visible","ei","graphics3DGraphic","slicePlaneEnabled","info","ri","active","Map","clear","ai","oi","sortArray","allocator","ci","Idle","Process","Sort","Deconflict","NumStates","ni","camera","slicePlane","copyFrom","hi","arguments","_dirty","_runningViewState","_state","graphics","iterators","accBinsNumX","accBinsNumY","accBinsSizeX","accBinsSizeY","accBins","accNumTests","dirty","state","destroy","setDirty","size","notifyChange","updating","updatingProgress","running","view","ready","runTask","_startUpdate","madeProgress","_processActiveGraphics","_sortVisibleGraphics","_deconflictVisibleGraphics","modifyGraphics","forEach","addToActiveGraphics","removeFromActiveGraphics","layerSupportsDeconfliction","type","stageObject","geometryRecords","length","material","viewState","fullWidth","fullHeight","_initBins","_resetIterators","visibilityGroup","set","graphic","uid","_removeFromVisibleGraphics","li","delete","_addToVisibleGraphics","_ensureActiveGraphicsIterator","projectionMatrix","viewingMode","map","ground","opacity","relativeElevation","viewMatrix","spatialReference","radius","done","next","_resetActiveGraphicsIterator","value","_collectGraphics3DGraphics","_ensureSortGraphicsIterator","_resetSortGraphicsIterator","_ensureVisibleGraphicsIterator","LABEL","_resetVisibleGraphicsIterator","isVisible","_isConflicted","_addToBins","_setGraphicVisibility","sort","pi","ui","destroyed","GRAPHIC","DECONFLICTION","getGraphicsLayers","_getProjectionInfo","mi","isOutsideScreen","_isCulledBySlice","_isCulledByHorizon","TESTS_DISABLE_OPTIMIZATIONS","_expandBoundingRect","boundingVolumeWorldSpace","bounds","geometry","vertexAttributes","get","NORMAL","data","AUXPOS1","applyShaderOffsetsView","transformation","scaleInfo","positionNDC","applyShaderOffsetsNDC","distanceWithoutPolygonOffset","depthNDCToWorld","positionView","direction","origin","getScreenSize","di","factor","pixelRatio","calculateRelativeScreenBounds","factorAlignment","scale","iconMarginFactor","Math","min","floor","push","setVisibilityFlag","labeler","setLabelGraphicVisibility","clearVisibilityFlag","prototype","entries","values","pushNew","id","prio","Number","MAX_VALUE","iterableSort","forAll","constructOnly","Boolean","readOnly","fi","minPixelSize","paddingPixels","Deconflictor","DeconflictorGraphic","DeconflictorViewState","State"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/graphics/Deconflictor.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import{lerp as s}from\"../../../../core/mathUtils.js\";import{isNone as e,isSome as r}from\"../../../../core/maybe.js\";import a from\"../../../../core/PooledArray.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{a as n}from\"../../../../chunks/mat4.js\";import{c as h}from\"../../../../chunks/mat4f64.js\";import{a as l}from\"../../../../chunks/vec2f64.js\";import{m as p,g as u,s as d,c as f}from\"../../../../chunks/vec3.js\";import{Z as m,c as g}from\"../../../../chunks/vec3f64.js\";import{s as b,t as v,b as y}from\"../../../../chunks/vec4.js\";import{c as _}from\"../../../../chunks/vec4f64.js\";import{getReferenceEllipsoid as G}from\"../../../../geometry/projectionEllipsoid.js\";import{create as S,empty as B,offset as w,width as D,height as N,expand as j,intersects as V}from\"../../../../geometry/support/aaBoundingRect.js\";import{c as I,a as P,e as C}from\"../../../../chunks/boundedPlane.js\";import{create as A}from\"../../../../geometry/support/ray.js\";import{e as x,g as O,h as M,c as T}from\"../../../../chunks/sphere.js\";import{drawAccelerationStruct as z,prepare as E,drawPoly as F}from\"./deconflictorDebug.js\";import{VisibilityGroup as X,VisibilityFlag as R}from\"./enums.js\";import L from\"../../support/debugFlags.js\";import{Camera as Y}from\"../../webgl-engine/lib/Camera.js\";import{applyPrecomputedScaleFactor as k}from\"../../webgl-engine/lib/screenSizePerspectiveUtils.js\";import{VertexAttribute as W}from\"../../webgl-engine/lib/VertexAttribute.js\";import{HUDMaterial as U}from\"../../webgl-engine/materials/HUDMaterial.js\";const H=g(),Z=_(),q=_(),J=g(),K=h(),Q=T(),$=A(),ii=g(),ti=S();class si{constructor(){this.aabr=S(),this.distance=0,this.culled=!1,this.visible=!1}}class ei{constructor(i,t,s={}){this.graphics3DGraphic=i,this.slicePlaneEnabled=t,this.info=s}}class ri{constructor(){this.active=new Map,this.visible=new Map}clear(){this.active.clear(),this.visible.clear()}}class ai{}class oi{constructor(){this.sortArray=new a({allocator:i=>i||new ai})}}var ci;!function(i){i[i.Idle=0]=\"Idle\",i[i.Process=1]=\"Process\",i[i.Sort=2]=\"Sort\",i[i.Deconflict=3]=\"Deconflict\",i[i.NumStates=4]=\"NumStates\"}(ci||(ci={}));class ni{constructor(){this.camera=new Y,this.slicePlane=I(),this.slicePlaneEnabled=!1}copyFrom(i){this.camera.copyFrom(i.camera),P(i.slicePlane,this.slicePlane),this.slicePlaneEnabled=i.slicePlaneEnabled}}let hi=class extends t{constructor(){super(...arguments),this._dirty=!1,this._runningViewState=new ni,this._state=ci.Idle,this.graphics=new ri,this.iterators=new oi,this.accBinsNumX=15,this.accBinsNumY=20,this.accBinsSizeX=0,this.accBinsSizeY=0,this.accBins=null,this.accNumTests=0}get dirty(){return this._dirty}get state(){return this._state}destroy(){this.graphics.clear(),this.iterators=null}setDirty(){!this._dirty&&this.graphics.active.size>0&&(this._dirty=!0,this.notifyChange(\"updating\"))}get updating(){return this._state!==ci.Idle||this._dirty}get updatingProgress(){if(!this.updating)return 1;const i=this._state/ci.NumStates;return this._dirty?.5*i:i}get running(){return this.view.ready&&null!=this.view.state&&this.updating}runTask(i){switch(this._state){case ci.Idle:this._startUpdate(),i.madeProgress();case ci.Process:if(this._state=ci.Process,!this._processActiveGraphics(i))return;case ci.Sort:if(this._state=ci.Sort,!this._sortVisibleGraphics(i))return;case ci.Deconflict:if(this._state=ci.Deconflict,!this._deconflictVisibleGraphics(i))return;default:z(this,this.graphics.visible),this._state=ci.Idle,this.notifyChange(\"updating\")}}modifyGraphics(i,t){t?i.forEach((i=>this.addToActiveGraphics(i))):i.forEach((i=>this.removeFromActiveGraphics(i))),this.setDirty()}layerSupportsDeconfliction(i){if(e(i)||\"object3d\"!==i.type)return!1;const t=i.stageObject;if(1!==(t?t.geometryRecords.length:0))return!1;return t.geometryRecords[0].material instanceof U}_startUpdate(){E(this.view),this._dirty=!1,this._runningViewState.copyFrom(this.viewState);const{fullWidth:i,fullHeight:t}=this._runningViewState.camera;this._initBins(i,t),this._resetIterators()}addToActiveGraphics(i){i.info[this.visibilityGroup]=new si,this.graphics.active.set(i.graphics3DGraphic.graphic.uid,i),this.setDirty()}removeFromActiveGraphics(i){this._removeFromVisibleGraphics(i),li(i,this.visibilityGroup),delete i.info[this.visibilityGroup],this.graphics.active.delete(i.graphics3DGraphic.graphic.uid),this.setDirty()}_addToVisibleGraphics(i){this.graphics.visible.set(i.graphics3DGraphic.graphic.uid,i)}_removeFromVisibleGraphics(i){this.graphics.visible.delete(i.graphics3DGraphic.graphic.uid)}_processActiveGraphics(i){const t=this._ensureActiveGraphicsIterator(),s=n(K,this._runningViewState.camera.projectionMatrix),e=\"global\"===this.view.viewingMode&&1===this.view.map.ground.opacity&&this._runningViewState.camera.relativeElevation>0?Q:null;let a=0;for(r(e)&&(p(e,m,this._runningViewState.camera.viewMatrix),e[3]=G(this.view.spatialReference).radius,a=x(e,m));!i.done;){i.madeProgress();const r=t.next();if(!0===r.done)return this._resetActiveGraphicsIterator(),!0;const o=r.value,c=o&&o.info[this.visibilityGroup];c&&(this._collectGraphics3DGraphics(o,s,e,a),c.culled?this._removeFromVisibleGraphics(o):this._addToVisibleGraphics(o))}return!1}_sortVisibleGraphics(i){const t=this._ensureSortGraphicsIterator();for(;!i.done;){const s=t.next();if(i.madeProgress(),!0===s.done)return this._resetSortGraphicsIterator(),!0}return!1}_deconflictVisibleGraphics(i){const t=this._ensureVisibleGraphicsIterator(),s=this.visibilityGroup===X.LABEL;for(;!i.done;){i.madeProgress();const e=t.next();if(!0===e.done)return this._resetVisibleGraphicsIterator(),!0;const r=e.value,a=r.info[this.visibilityGroup];if(!a||a.culled)continue;const o=r.graphics3DGraphic,c=(!s||o.isVisible())&&!this._isConflicted(r);c&&this._addToBins(r),a.visible=c,this._setGraphicVisibility(r,c),F(a,c)}return!1}_resetIterators(){this.iterators.active=null,this.iterators.visible=null,this.iterators.sort=null}_ensureActiveGraphicsIterator(){return this.iterators.active||(this.iterators.active=pi(this.graphics.active)),this.iterators.active}_resetActiveGraphicsIterator(){this.iterators.active=null}_ensureVisibleGraphicsIterator(){return this.iterators.visible||(this.iterators.visible=pi(this.graphics.visible)),this.iterators.visible}_resetVisibleGraphicsIterator(){this.iterators.visible=null}_ensureSortGraphicsIterator(){return this.iterators.sort||(this.iterators.sort=ui(this.graphics.visible,this.iterators.sortArray,this.visibilityGroup)),this.iterators.sort}_resetSortGraphicsIterator(){this.iterators.sort=null}_collectGraphics3DGraphics(i,t,s,a){const o=i.graphics3DGraphic;if(o.destroyed)return;const c=i.info[this.visibilityGroup];if(!o.isVisible(X.GRAPHIC,R.DECONFLICTION))return void(c.culled=!0);const n=this.getGraphicsLayers(o);B(c.aabr);let h=null;for(const l of n){if(!this.layerSupportsDeconfliction(l))continue;const o=l.stageObject.geometryRecords[0].material;if(e(h)){if(h=this._getProjectionInfo(l,t,mi),h.isOutsideScreen||this._isCulledBySlice(i,H)||r(s)&&this._isCulledByHorizon(h,s,a))return void(c.culled=!0);!L.TESTS_DISABLE_OPTIMIZATIONS&&c.visible&&(h.distance*=.7)}this._expandBoundingRect(c,l,o,h)}e(h)?c.culled=!0:(c.distance=h.distance,c.culled=!1)}_getProjectionInfo(i,t,s){const e=this._runningViewState.camera,r=i.stageObject,a=r.geometryRecords[0],o=a.material,c=O(r.boundingVolumeWorldSpace.bounds);p(H,c,e.viewMatrix);const n=a.geometry.vertexAttributes,h=n.get(W.NORMAL).data,l=n.get(W.AUXPOS1).data;return o.applyShaderOffsetsView(H,h,r.transformation,l,e,s.scaleInfo,H),b(Z,H[0],H[1],H[2],1),v(q,Z,e.projectionMatrix),u(s.positionNDC,q,1/q[3]),o.applyShaderOffsetsNDC(s.positionNDC,l,e,s.positionNDC,J),s.distanceWithoutPolygonOffset=e.depthNDCToWorld(J[2]),s.distance=J[2]===s.positionNDC[2]?s.distanceWithoutPolygonOffset:e.depthNDCToWorld(s.positionNDC[2]),b(q,s.positionNDC[0],s.positionNDC[1],s.positionNDC[2],1),v(Z,q,t),y(Z,Z,1/Z[3]),d(s.positionView,H[0],H[1],H[2]),s}_isCulledByHorizon(i,t,s){return f($.direction,i.positionView),d($.origin,0,0,0),!!M(t,$,ii)&&i.distanceWithoutPolygonOffset>s}_isCulledBySlice(i,t){return i.slicePlaneEnabled&&this._runningViewState.slicePlaneEnabled&&C(this._runningViewState.slicePlane,t)}_expandBoundingRect(i,t,e,{positionNDC:r,scaleInfo:a}){const o=this._runningViewState.camera,c=t.getScreenSize(di);k(c,a.factor,c),c[0]*=o.pixelRatio,c[1]*=o.pixelRatio;const n=w(e.calculateRelativeScreenBounds(c,a.factorAlignment.scale,ti),s(0,o.fullWidth,.5+.5*r[0]),s(0,o.fullHeight,.5+.5*r[1])),h=this.iconMarginFactor;if(0!==h){const i=h*Math.min(D(n),N(n));n[0]-=i,n[1]-=i,n[2]+=i,n[3]+=i}j(i.aabr,n,i.aabr)}_isConflicted(i){const t=i.graphics3DGraphic.graphic.uid,s=i.info[this.visibilityGroup];for(let e=Math.floor(s.aabr[0]/this.accBinsSizeX);e<=Math.floor(s.aabr[2]/this.accBinsSizeX);e++)if(!(e<0||e>=this.accBinsNumX))for(let i=Math.floor(s.aabr[1]/this.accBinsSizeY);i<=Math.floor(s.aabr[3]/this.accBinsSizeY);i++){if(i<0||i>=this.accBinsNumY)continue;const r=this.accBins[e][i];for(let i=0;i<r.length;i++){const e=r.data[i],a=e.info[this.visibilityGroup];if(a&&a.visible&&(e.graphics3DGraphic.graphic.uid!==t&&(this.accNumTests++,V(a.aabr,s.aabr))))return!0}}return!1}_initBins(i,t){if(null==this.accBins){this.accBins=[];for(let i=0;i<this.accBinsNumX;i++){this.accBins.push([]);const i=this.accBins[this.accBins.length-1];for(let t=0;t<this.accBinsNumY;t++)i.push(new a)}}else for(let s=0;s<this.accBinsNumX;s++)for(let i=0;i<this.accBinsNumY;i++)this.accBins[s][i].clear();this.accBinsSizeX=i/this.accBinsNumX,this.accBinsSizeY=t/this.accBinsNumY,this.accNumTests=0}_addToBins(i){const t=i.info[this.visibilityGroup],s=Math.floor(t.aabr[0]/this.accBinsSizeX),e=Math.floor(t.aabr[2]/this.accBinsSizeX),r=Math.floor(t.aabr[1]/this.accBinsSizeY),a=Math.floor(t.aabr[3]/this.accBinsSizeY);for(let o=s;o<=e;o++)if(!(o<0||o>=this.accBinsNumX))for(let t=r;t<=a;t++)t<0||t>=this.accBinsNumY||this.accBins[o][t].push(i)}_setGraphicVisibility(i,t){const s=i.graphics3DGraphic;s.destroyed||(s.setVisibilityFlag(R.DECONFLICTION,t,this.visibilityGroup),this.visibilityGroup===X.LABEL&&this.view.labeler.setLabelGraphicVisibility(s,t))}};function li(i,t){const s=i.graphics3DGraphic;s.destroyed||s.clearVisibilityFlag(R.DECONFLICTION,t)}function*pi(i){if(Map.prototype.entries){const t=i.entries();for(let i=t.next();!i.done;i=t.next())yield i.value[1]}else yield*i.values()}function*ui(i,t,s){t.clear(),i.forEach(((i,e)=>{const r=t.pushNew();r.id=e,r.prio=i.info?-i.info[s].distance:Number.MAX_VALUE})),yield;const e=t.iterableSort(((i,t)=>t.prio-i.prio));for(let r=e.next();!r.done;r=e.next())yield;t.forAll((t=>{const s=i.get(t.id);s&&(i.delete(t.id),i.set(t.id,s))})),t.clear()}i([o({constructOnly:!0})],hi.prototype,\"view\",void 0),i([o({type:Boolean,readOnly:!0})],hi.prototype,\"updating\",null),hi=i([c(\"esri.views.3d.layers.graphics.Deconflictor\")],hi);const di=l();class fi{constructor(){this.positionView=g(),this.positionNDC=g(),this.distance=0,this.distanceWithoutPolygonOffset=0,this.scaleInfo={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}}}get isOutsideScreen(){const i=this.positionNDC;return i[0]<-1||i[1]<-1||i[2]<-1||i[0]>=1||i[1]>=1}}const mi=new fi;export{hi as Deconflictor,ei as DeconflictorGraphic,ni as DeconflictorViewState,ci as State};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}