{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*!\n * All material copyright ESRI, All Rights Reserved, unless otherwise specified.\n * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.\n * v1.0.0-beta.82\n */\nimport { proxyCustomElement, HTMLElement, createEvent, h, Host } from '@stencil/core/internal/client';\nimport { a as isSymbol, S as Symbol, d as debounce } from './debounce.js';\nimport { i as isArray, f as forIn } from './forIn.js';\nimport { f as filterComputedPlacements, u as updatePopper, c as createPopper, a as defaultMenuPlacement, p as popperMenuComputedPlacements, C as CSS } from './popper.js';\nimport { g as guid } from './guid.js';\nimport { T as TEXT, C as ComboboxChildSelector, g as getItemAncestors, a as getItemChildren, h as hasActiveChildren, b as ComboboxItem, c as ComboboxItemGroup } from './utils2.js';\nimport { c as connectLabel, d as disconnectLabel, g as getLabelText } from './label.js';\nimport { s as submitForm, c as connectForm, a as afterConnectDefaultValueSet, d as disconnectForm, H as HiddenFormInputSlot } from './form.js';\nimport { c as createObserver } from './observers.js';\nimport { u as updateHostInteraction } from './interactive.js';\nimport { t as toAriaBoolean } from './dom.js';\nimport { d as defineCustomElement$3 } from './chip.js';\nimport { d as defineCustomElement$2 } from './icon.js';\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\n\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n\n  return result;\n}\n/** Used as references for various `Number` constants. */\n\n\nvar INFINITY = 1 / 0;\n/** Used to convert symbols to primitives and strings. */\n\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\n\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n\n  var result = value + '';\n  return result == '0' && 1 / value == -INFINITY ? '-0' : result;\n}\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\n\n\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\n\n\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n    reHasRegExpChar = RegExp(reRegExpChar.source);\n/**\n * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to escape.\n * @returns {string} Returns the escaped string.\n * @example\n *\n * _.escapeRegExp('[lodash](https://lodash.com/)');\n * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n */\n\nfunction escapeRegExp(string) {\n  string = toString(string);\n  return string && reHasRegExpChar.test(string) ? string.replace(reRegExpChar, '\\\\$&') : string;\n}\n\nconst filter = (data, value) => {\n  const escapedValue = escapeRegExp(value);\n  const regex = new RegExp(escapedValue, \"i\");\n\n  if (data.length === 0) {\n    console.warn(`No data was passed to the filter function.\n    The data argument should be an array of objects`);\n  }\n\n  const find = (input, RE) => {\n    var _a;\n\n    if ((_a = input) === null || _a === void 0 ? void 0 : _a.constant) {\n      return true;\n    }\n\n    let found = false;\n    forIn(input, val => {\n      if (typeof val === \"function\" || val == null\n      /* intentional == to catch undefined */\n      ) {\n        return;\n      }\n\n      if (Array.isArray(val) || typeof val === \"object\" && val !== null) {\n        if (find(val, RE)) {\n          found = true;\n        }\n      } else if (RE.test(val)) {\n        found = true;\n      }\n    });\n    return found;\n  };\n\n  const result = data.filter(item => {\n    return find(item, regex);\n  });\n  return result;\n};\n\nconst comboboxCss = \"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{position:relative;display:block}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){font-size:var(--calcite-font-size--2);--calcite-combobox-item-spacing-unit-l:0.5rem;--calcite-combobox-item-spacing-unit-s:0.25rem;--calcite-combobox-input-height:1.5rem}:host([scale=m]){font-size:var(--calcite-font-size--1);--calcite-combobox-item-spacing-unit-l:0.75rem;--calcite-combobox-item-spacing-unit-s:0.5rem;--calcite-combobox-input-height:2rem}:host([scale=l]){font-size:var(--calcite-font-size-0);--calcite-combobox-item-spacing-unit-l:1rem;--calcite-combobox-item-spacing-unit-s:0.75rem;--calcite-combobox-input-height:2.75rem}.wrapper{display:-ms-flexbox;display:flex;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;-webkit-box-shadow:inset 0 0 0 1px var(--calcite-ui-border-input);box-shadow:inset 0 0 0 1px var(--calcite-ui-border-input);padding:calc(var(--calcite-combobox-item-spacing-unit-s) / 4) var(--calcite-combobox-item-spacing-unit-l)}:host(:focus-within) .wrapper,.wrapper--active{outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}.wrapper--single{padding:0 var(--calcite-combobox-item-spacing-unit-l);cursor:pointer;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.grid-input{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0px}.input{-ms-flex-positive:1;flex-grow:1;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-style:none;background-color:transparent;padding:0px;font-family:inherit;color:var(--calcite-ui-text-1);font-size:inherit;height:var(--calcite-combobox-input-height);line-height:var(--calcite-combobox-input-height);min-width:120px;margin-bottom:var(--calcite-combobox-item-spacing-unit-s)}.input:focus{outline:2px solid transparent;outline-offset:2px}.input--transparent{opacity:0}.input--single{margin-bottom:0px;margin-top:0px;padding:0px}.wrapper--active .input-single{cursor:text}.input--hidden{pointer-events:none;width:0px;min-width:0px;opacity:0}.input--icon{padding:0 var(--calcite-combobox-item-spacing-unit-l)}.input-wrap{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1}.input-wrap--single{-ms-flex:1 1 0%;flex:1 1 0%;overflow:hidden}.label{pointer-events:none;display:-ms-flexbox;display:flex;max-width:100%;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0px;font-weight:var(--calcite-font-weight-normal);height:var(--calcite-combobox-input-height);line-height:var(--calcite-combobox-input-height)}.label--spaced{padding-top:0px;padding-bottom:0px;padding-left:var(--calcite-combobox-item-spacing-unit-l);padding-right:var(--calcite-combobox-item-spacing-unit-l)}.icon-end,.icon-start{display:-ms-flexbox;display:flex;width:1rem;cursor:pointer;-ms-flex-align:center;align-items:center}.icon-end{-ms-flex:none;flex:none}.popper-container{width:100%;display:block;position:absolute;z-index:900;-webkit-transform:scale(0);transform:scale(0);visibility:hidden;pointer-events:none}.popper-container .calcite-popper-anim{position:relative;z-index:1;-webkit-transition:var(--calcite-popper-transition);transition:var(--calcite-popper-transition);visibility:hidden;-webkit-transition-property:visibility, opacity, -webkit-transform;transition-property:visibility, opacity, -webkit-transform;transition-property:transform, visibility, opacity;transition-property:transform, visibility, opacity, -webkit-transform;opacity:0;-webkit-box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);border-radius:0.25rem}.popper-container[data-popper-placement^=bottom] .calcite-popper-anim{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.popper-container[data-popper-placement^=top] .calcite-popper-anim{-webkit-transform:translateY(5px);transform:translateY(5px)}.popper-container[data-popper-placement^=left] .calcite-popper-anim{-webkit-transform:translateX(5px);transform:translateX(5px)}.popper-container[data-popper-placement^=right] .calcite-popper-anim{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.popper-container[data-popper-placement] .calcite-popper-anim--active{opacity:1;visibility:visible;-webkit-transform:translate(0);transform:translate(0)}.popper-container--active{pointer-events:initial;visibility:visible}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.list-container{max-height:100vh;overflow-y:auto;background-color:var(--calcite-ui-foreground-1);width:var(--calcite-dropdown-width)}.list{margin:0px;display:block;padding:0px}.list--hide{height:0px;overflow:hidden}.chip{margin-block:calc(var(--calcite-combobox-item-spacing-unit-s) / 4);margin-inline:0 var(--calcite-combobox-item-spacing-unit-s);max-width:100%}.chip--active{background-color:var(--calcite-ui-foreground-3)}.item{display:block}::slotted(input[slot=hidden-form-input]){bottom:0 !important;left:0 !important;margin:0 !important;opacity:0 !important;outline:none !important;padding:0 !important;position:absolute !important;right:0 !important;top:0 !important;-webkit-transform:none !important;transform:none !important;-webkit-appearance:none !important;z-index:-1 !important}\";\n\nconst isGroup = el => el.tagName === ComboboxItemGroup;\n\nconst itemUidPrefix = \"combobox-item-\";\nconst chipUidPrefix = \"combobox-chip-\";\nconst labelUidPrefix = \"combobox-label-\";\nconst listboxUidPrefix = \"combobox-listbox-\";\nconst inputUidPrefix = \"combobox-input-\";\nconst Combobox = /*@__PURE__*/proxyCustomElement(class extends HTMLElement {\n  constructor() {\n    super();\n\n    this.__registerHost();\n\n    this.__attachShadow();\n\n    this.calciteLookupChange = createEvent(this, \"calciteLookupChange\", 7);\n    this.calciteComboboxChange = createEvent(this, \"calciteComboboxChange\", 7);\n    this.calciteComboboxFilterChange = createEvent(this, \"calciteComboboxFilterChange\", 7);\n    this.calciteComboboxChipDismiss = createEvent(this, \"calciteComboboxChipDismiss\", 7);\n    this.calciteComboboxOpen = createEvent(this, \"calciteComboboxOpen\", 7);\n    this.calciteComboboxClose = createEvent(this, \"calciteComboboxClose\", 7); //--------------------------------------------------------------------------\n    //\n    //  Public Properties\n    //\n    //--------------------------------------------------------------------------\n\n    /** Opens or closes the combobox */\n\n    this.active = false;\n    /** Disable combobox input */\n\n    this.disabled = false;\n    /** Specify the maximum number of combobox items (including nested children) to display before showing the scroller */\n\n    this.maxItems = 0;\n    /** Describes the type of positioning to use for the overlaid content. If your element is in a fixed container, use the 'fixed' value. */\n\n    this.overlayPositioning = \"absolute\";\n    /**\n     * When true, makes the component required for form-submission.\n     *\n     * @internal\n     */\n\n    this.required = false;\n    /** specify the selection mode\n     * - multi: allow any number of selected items (default)\n     * - single: only one selection)\n     * - ancestors: like multi, but show ancestors of selected items as selected, only deepest children shown in chips\n     */\n\n    this.selectionMode = \"multi\";\n    /** Specify the scale of the combobox, defaults to m */\n\n    this.scale = \"m\";\n    /** The value(s) of the selectedItem(s) */\n\n    this.value = null;\n    /** string to override the English \"Remove tag\" text for when an item is selected.\n     * @default \"Remove tag\"\n     */\n\n    this.intlRemoveTag = TEXT.removeTag;\n    this.internalValueChangeFlag = false;\n    this.items = [];\n    this.groupItems = [];\n    this.selectedItems = [];\n    this.visibleItems = [];\n    this.activeItemIndex = -1;\n    this.activeChipIndex = -1;\n    this.activeDescendant = \"\";\n    this.text = \"\";\n    this.textInput = null;\n    this.mutationObserver = createObserver(\"mutation\", () => this.updateItems());\n    this.resizeObserver = createObserver(\"resize\", () => this.setMaxScrollerHeight());\n    this.guid = guid();\n    this.inputHeight = 0;\n    this.ignoreSelectedEventsFlag = false;\n    this.activeTransitionProp = \"opacity\"; // --------------------------------------------------------------------------\n    //\n    //  Private Methods\n    //\n    // --------------------------------------------------------------------------\n\n    this.setFilteredPlacements = () => {\n      const {\n        el,\n        flipPlacements\n      } = this;\n      this.filteredFlipPlacements = flipPlacements ? filterComputedPlacements(flipPlacements, el) : null;\n    };\n\n    this.getValue = () => {\n      const items = this.selectedItems.map(item => {\n        var _a;\n\n        return (_a = item === null || item === void 0 ? void 0 : item.value) === null || _a === void 0 ? void 0 : _a.toString();\n      });\n      return (items === null || items === void 0 ? void 0 : items.length) ? items.length > 1 ? items : items[0] : \"\";\n    };\n\n    this.onLabelClick = () => {\n      this.setFocus();\n    };\n\n    this.keydownHandler = event => {\n      const {\n        key\n      } = event;\n\n      switch (key) {\n        case \"Tab\":\n          this.activeChipIndex = -1;\n          this.activeItemIndex = -1;\n\n          if (this.allowCustomValues && this.text) {\n            this.addCustomChip(this.text, true);\n            event.preventDefault();\n          } else if (this.active) {\n            this.active = false;\n            event.preventDefault();\n          }\n\n          break;\n\n        case \"ArrowLeft\":\n          this.previousChip();\n          break;\n\n        case \"ArrowRight\":\n          this.nextChip();\n          break;\n\n        case \"ArrowUp\":\n          this.shiftActiveItemIndex(-1);\n\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n\n          break;\n\n        case \"ArrowDown\":\n          if (!this.active) {\n            event.preventDefault();\n            this.active = true;\n          }\n\n          this.shiftActiveItemIndex(1);\n\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n\n          break;\n\n        case \" \":\n          if (!this.textInput.value) {\n            event.preventDefault();\n            this.active = true;\n            this.shiftActiveItemIndex(1);\n          }\n\n          break;\n\n        case \"Home\":\n          if (this.active) {\n            event.preventDefault();\n          }\n\n          this.updateActiveItemIndex(0);\n          this.scrollToActiveItem();\n\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n\n          break;\n\n        case \"End\":\n          if (this.active) {\n            event.preventDefault();\n          }\n\n          this.updateActiveItemIndex(this.visibleItems.length - 1);\n          this.scrollToActiveItem();\n\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n\n          break;\n\n        case \"Escape\":\n          this.active = false;\n          break;\n\n        case \"Enter\":\n          if (this.activeItemIndex > -1) {\n            this.toggleSelection(this.visibleItems[this.activeItemIndex]);\n          } else if (this.activeChipIndex > -1) {\n            this.removeActiveChip();\n          } else if (this.allowCustomValues && this.text) {\n            this.addCustomChip(this.text, true);\n          } else if (!event.defaultPrevented) {\n            submitForm(this);\n          }\n\n          break;\n\n        case \"Delete\":\n        case \"Backspace\":\n          if (this.activeChipIndex > -1) {\n            this.removeActiveChip();\n          } else if (!this.text && this.isMulti()) {\n            this.removeLastChip();\n          }\n\n          break;\n      }\n    };\n\n    this.toggleCloseEnd = () => {\n      this.active = false;\n      this.el.removeEventListener(\"calciteComboboxClose\", this.toggleCloseEnd);\n    };\n\n    this.toggleOpenEnd = () => {\n      this.active = true;\n      this.el.removeEventListener(\"calciteComboboxOpen\", this.toggleOpenEnd);\n    };\n\n    this.transitionEnd = event => {\n      if (event.propertyName === this.activeTransitionProp) {\n        this.active ? this.calciteComboboxOpen.emit() : this.calciteComboboxClose.emit();\n      }\n    };\n\n    this.setMaxScrollerHeight = () => {\n      const {\n        active,\n        listContainerEl\n      } = this;\n\n      if (!listContainerEl || !active) {\n        return;\n      }\n\n      this.reposition();\n      const maxScrollerHeight = this.getMaxScrollerHeight();\n      listContainerEl.style.maxHeight = maxScrollerHeight > 0 ? `${maxScrollerHeight}px` : \"\";\n      this.reposition();\n    };\n\n    this.calciteChipDismissHandler = (event, comboboxItem) => {\n      this.active = false;\n      const selection = this.items.find(item => item === comboboxItem);\n\n      if (selection) {\n        this.toggleSelection(selection, false);\n      }\n\n      this.calciteComboboxChipDismiss.emit(event.detail);\n    };\n\n    this.clickHandler = event => {\n      if (event.composedPath().some(node => node.tagName === \"CALCITE-CHIP\")) {\n        return;\n      }\n\n      this.active = !this.active;\n      this.updateActiveItemIndex(0);\n      this.setFocus();\n    };\n\n    this.setInactiveIfNotContained = event => {\n      const composedPath = event.composedPath();\n\n      if (!this.active || composedPath.includes(this.el) || composedPath.includes(this.referenceEl)) {\n        return;\n      }\n\n      if (this.allowCustomValues && this.text.trim().length) {\n        this.addCustomChip(this.text);\n      }\n\n      if (this.selectionMode === \"single\") {\n        if (this.textInput) {\n          this.textInput.value = \"\";\n        }\n\n        this.text = \"\";\n        this.filterItems(\"\");\n        this.updateActiveItemIndex(-1);\n      }\n\n      this.active = false;\n    };\n\n    this.setMenuEl = el => {\n      this.menuEl = el;\n    };\n\n    this.setListContainerEl = el => {\n      this.resizeObserver.observe(el);\n      this.listContainerEl = el;\n    };\n\n    this.setReferenceEl = el => {\n      this.referenceEl = el;\n    };\n\n    this.inputHandler = event => {\n      const value = event.target.value;\n      this.text = value;\n      this.filterItems(value);\n\n      if (value) {\n        this.activeChipIndex = -1;\n      }\n    };\n\n    this.filterItems = (() => {\n      const find = (item, filteredData) => item && filteredData.some(({\n        label,\n        value\n      }) => {\n        if (isGroup(item)) {\n          return value === item.label;\n        }\n\n        return value === item.textLabel || value === item.value || label === item.textLabel || label === item.value;\n      });\n\n      return debounce(text => {\n        const filteredData = filter(this.data, text);\n        const items = this.getCombinedItems();\n        items.forEach(item => {\n          const hidden = !find(item, filteredData);\n          item.hidden = hidden;\n          const [parent, grandparent] = item.ancestors;\n\n          if (find(parent, filteredData) || find(grandparent, filteredData)) {\n            item.hidden = false;\n          }\n\n          if (!hidden) {\n            item.ancestors.forEach(ancestor => ancestor.hidden = false);\n          }\n        });\n        this.visibleItems = this.getVisibleItems();\n        this.calciteComboboxFilterChange.emit({\n          visibleItems: [...this.visibleItems],\n          text: text\n        });\n      }, 100);\n    })();\n\n    this.internalCalciteLookupChangeEvent = () => {\n      this.calciteLookupChange.emit(this.selectedItems);\n    };\n\n    this.emitCalciteLookupChange = debounce(this.internalCalciteLookupChangeEvent, 0);\n\n    this.internalComboboxChangeEvent = () => {\n      const {\n        selectedItems\n      } = this;\n      this.calciteComboboxChange.emit({\n        selectedItems\n      });\n    };\n\n    this.emitComboboxChange = debounce(this.internalComboboxChangeEvent, 0);\n\n    this.updateItems = () => {\n      this.items = this.getItems();\n      this.groupItems = this.getGroupItems();\n      this.data = this.getData();\n      this.selectedItems = this.getSelectedItems();\n      this.visibleItems = this.getVisibleItems();\n      this.needsIcon = this.getNeedsIcon();\n\n      if (!this.allowCustomValues) {\n        this.setMaxScrollerHeight();\n      }\n    };\n\n    this.scrollToActiveItem = () => {\n      const activeItem = this.visibleItems[this.activeItemIndex];\n      const height = this.calculateSingleItemHeight(activeItem);\n      const {\n        offsetHeight,\n        scrollTop\n      } = this.listContainerEl;\n\n      if (offsetHeight + scrollTop < activeItem.offsetTop + height) {\n        this.listContainerEl.scrollTop = activeItem.offsetTop - offsetHeight + height;\n      } else if (activeItem.offsetTop < scrollTop) {\n        this.listContainerEl.scrollTop = activeItem.offsetTop;\n      }\n    };\n\n    this.comboboxFocusHandler = () => {\n      var _a;\n\n      (_a = this.textInput) === null || _a === void 0 ? void 0 : _a.focus();\n    };\n\n    this.comboboxBlurHandler = event => {\n      this.setInactiveIfNotContained(event);\n    };\n  }\n\n  activeHandler() {\n    if (this.disabled) {\n      this.active = false;\n      return;\n    }\n\n    this.reposition();\n  }\n\n  handleDisabledChange(value) {\n    if (!value) {\n      this.active = false;\n    }\n  }\n\n  maxItemsHandler() {\n    this.setMaxScrollerHeight();\n  }\n\n  valueHandler(value) {\n    if (!this.internalValueChangeFlag) {\n      const items = this.getItems();\n\n      if (Array.isArray(value)) {\n        items.forEach(item => item.selected = value.includes(item.value));\n      } else if (value) {\n        items.forEach(item => item.selected = value === item.value);\n      } else {\n        items.forEach(item => item.selected = false);\n      }\n\n      this.updateItems();\n    }\n  }\n\n  flipPlacementsHandler() {\n    this.setFilteredPlacements();\n  } //--------------------------------------------------------------------------\n  //\n  //  Event Listeners\n  //\n  //--------------------------------------------------------------------------\n\n\n  documentClickHandler(event) {\n    this.setInactiveIfNotContained(event);\n  }\n\n  calciteComboboxItemChangeHandler(event) {\n    if (this.ignoreSelectedEventsFlag) {\n      return;\n    }\n\n    const target = event.target;\n    const newIndex = this.visibleItems.indexOf(target);\n    this.updateActiveItemIndex(newIndex);\n    this.toggleSelection(target, target.selected);\n  } //--------------------------------------------------------------------------\n  //\n  //  Public Methods\n  //\n  //--------------------------------------------------------------------------\n\n  /** Updates the position of the component. */\n\n\n  async reposition() {\n    const {\n      popper,\n      menuEl\n    } = this;\n    const modifiers = this.getModifiers();\n    popper ? await updatePopper({\n      el: menuEl,\n      modifiers,\n      placement: defaultMenuPlacement,\n      popper\n    }) : this.createPopper();\n  }\n  /** Sets focus on the component. */\n\n\n  async setFocus() {\n    var _a;\n\n    (_a = this.textInput) === null || _a === void 0 ? void 0 : _a.focus();\n    this.activeChipIndex = -1;\n    this.activeItemIndex = -1;\n  } // --------------------------------------------------------------------------\n  //\n  //  Lifecycle\n  //\n  // --------------------------------------------------------------------------\n\n\n  connectedCallback() {\n    var _a;\n\n    this.internalValueChangeFlag = true;\n    this.value = this.getValue();\n    this.internalValueChangeFlag = false;\n    (_a = this.mutationObserver) === null || _a === void 0 ? void 0 : _a.observe(this.el, {\n      childList: true,\n      subtree: true\n    });\n    this.createPopper();\n    connectLabel(this);\n    connectForm(this);\n    this.setFilteredPlacements();\n  }\n\n  componentWillLoad() {\n    this.updateItems();\n  }\n\n  componentDidLoad() {\n    afterConnectDefaultValueSet(this, this.getValue());\n  }\n\n  componentDidRender() {\n    if (this.el.offsetHeight !== this.inputHeight) {\n      this.reposition();\n      this.inputHeight = this.el.offsetHeight;\n    }\n\n    updateHostInteraction(this);\n  }\n\n  disconnectedCallback() {\n    var _a, _b;\n\n    (_a = this.mutationObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n    (_b = this.resizeObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n    this.destroyPopper();\n    disconnectLabel(this);\n    disconnectForm(this);\n  }\n\n  selectedItemsHandler() {\n    this.internalValueChangeFlag = true;\n    this.value = this.getValue();\n    this.internalValueChangeFlag = false;\n  }\n  /** when search text is cleared, reset active to  */\n\n\n  textHandler() {\n    this.updateActiveItemIndex(-1);\n  }\n\n  comboboxInViewport() {\n    const bounding = this.el.getBoundingClientRect();\n    return bounding.top >= 0 && bounding.left >= 0 && bounding.right <= (window.innerWidth || document.documentElement.clientWidth) && bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight);\n  }\n\n  getModifiers() {\n    const flipModifier = {\n      name: \"flip\",\n      enabled: true\n    };\n    flipModifier.options = {\n      fallbackPlacements: this.filteredFlipPlacements || popperMenuComputedPlacements\n    };\n    const eventListenerModifier = {\n      name: \"eventListeners\",\n      enabled: this.active\n    };\n    return [flipModifier, eventListenerModifier];\n  }\n\n  createPopper() {\n    this.destroyPopper();\n    const {\n      menuEl,\n      referenceEl,\n      overlayPositioning\n    } = this;\n    const modifiers = this.getModifiers();\n    this.popper = createPopper({\n      el: menuEl,\n      modifiers,\n      overlayPositioning,\n      placement: defaultMenuPlacement,\n      referenceEl\n    });\n  }\n\n  destroyPopper() {\n    const {\n      popper\n    } = this;\n\n    if (popper) {\n      popper.destroy();\n    }\n\n    this.popper = null;\n  }\n\n  getMaxScrollerHeight() {\n    const items = this.getCombinedItems().filter(item => !item.hidden);\n    const {\n      maxItems\n    } = this;\n    let itemsToProcess = 0;\n    let maxScrollerHeight = 0;\n\n    if (items.length > maxItems) {\n      items.forEach(item => {\n        if (itemsToProcess < maxItems && maxItems > 0) {\n          const height = this.calculateSingleItemHeight(item);\n\n          if (height > 0) {\n            maxScrollerHeight += height;\n            itemsToProcess++;\n          }\n        }\n      });\n    }\n\n    return maxScrollerHeight;\n  }\n\n  calculateSingleItemHeight(item) {\n    let height = item.offsetHeight; // if item has children items, don't count their height twice\n\n    const children = Array.from(item.querySelectorAll(ComboboxChildSelector));\n    children.map(child => child === null || child === void 0 ? void 0 : child.offsetHeight).forEach(offsetHeight => {\n      height -= offsetHeight;\n    });\n    return height;\n  }\n\n  getCombinedItems() {\n    return [...this.groupItems, ...this.items];\n  }\n\n  toggleSelection(item, value = !item.selected) {\n    if (!item) {\n      return;\n    }\n\n    if (this.isMulti()) {\n      item.selected = value;\n      this.updateAncestors(item);\n      this.selectedItems = this.getSelectedItems();\n      this.emitCalciteLookupChange();\n      this.emitComboboxChange();\n      this.resetText();\n      this.filterItems(\"\");\n    } else {\n      this.ignoreSelectedEventsFlag = true;\n      this.items.forEach(el => el.selected = el === item ? value : false);\n      this.ignoreSelectedEventsFlag = false;\n      this.selectedItems = this.getSelectedItems();\n      this.emitComboboxChange();\n\n      if (this.textInput) {\n        this.textInput.value = item.textLabel;\n      }\n\n      this.active = false;\n      this.updateActiveItemIndex(-1);\n      this.resetText();\n      this.filterItems(\"\");\n    }\n  }\n\n  updateAncestors(item) {\n    if (this.selectionMode !== \"ancestors\") {\n      return;\n    }\n\n    const ancestors = getItemAncestors(item);\n    const children = getItemChildren(item);\n\n    if (item.selected) {\n      ancestors.forEach(el => {\n        el.selected = true;\n      });\n    } else {\n      children.forEach(el => el.selected = false);\n      [...ancestors].forEach(el => {\n        if (!hasActiveChildren(el)) {\n          el.selected = false;\n        }\n      });\n    }\n  }\n\n  getVisibleItems() {\n    return this.items.filter(item => !item.hidden);\n  }\n\n  getSelectedItems() {\n    if (!this.isMulti()) {\n      const match = this.items.find(({\n        selected\n      }) => selected);\n      return match ? [match] : [];\n    }\n\n    return this.items.filter(item => item.selected && (this.selectionMode !== \"ancestors\" || !hasActiveChildren(item)))\n    /** Preserve order of entered tags */\n    .sort((a, b) => {\n      const aIdx = this.selectedItems.indexOf(a);\n      const bIdx = this.selectedItems.indexOf(b);\n\n      if (aIdx > -1 && bIdx > -1) {\n        return aIdx - bIdx;\n      }\n\n      return bIdx - aIdx;\n    });\n  }\n\n  getData() {\n    return this.items.map(item => ({\n      constant: item.constant,\n      value: item.value,\n      label: item.textLabel\n    }));\n  }\n\n  getNeedsIcon() {\n    return this.selectionMode === \"single\" && this.items.some(item => item.icon);\n  }\n\n  resetText() {\n    if (this.textInput) {\n      this.textInput.value = \"\";\n    }\n\n    this.text = \"\";\n  }\n\n  getItems() {\n    const items = Array.from(this.el.querySelectorAll(ComboboxItem));\n    return items.filter(item => !item.disabled);\n  }\n\n  getGroupItems() {\n    return Array.from(this.el.querySelectorAll(ComboboxItemGroup));\n  }\n\n  addCustomChip(value, focus) {\n    const existingItem = this.items.find(el => el.textLabel === value);\n\n    if (existingItem) {\n      this.toggleSelection(existingItem, true);\n    } else {\n      if (!this.isMulti()) {\n        this.toggleSelection(this.selectedItems[this.selectedItems.length - 1], false);\n      }\n\n      const item = document.createElement(ComboboxItem);\n      item.value = value;\n      item.textLabel = value;\n      item.selected = true;\n      this.el.appendChild(item);\n      this.resetText();\n\n      if (focus) {\n        this.setFocus();\n      }\n\n      this.updateItems();\n      this.filterItems(\"\");\n      this.emitCalciteLookupChange();\n      this.emitComboboxChange();\n    }\n  }\n\n  removeActiveChip() {\n    this.toggleSelection(this.selectedItems[this.activeChipIndex], false);\n    this.setFocus();\n  }\n\n  removeLastChip() {\n    this.toggleSelection(this.selectedItems[this.selectedItems.length - 1], false);\n    this.setFocus();\n  }\n\n  previousChip() {\n    if (this.text) {\n      return;\n    }\n\n    const length = this.selectedItems.length - 1;\n    const active = this.activeChipIndex;\n    this.activeChipIndex = active === -1 ? length : Math.max(active - 1, 0);\n    this.updateActiveItemIndex(-1);\n    this.focusChip();\n  }\n\n  nextChip() {\n    if (this.text || this.activeChipIndex === -1) {\n      return;\n    }\n\n    const last = this.selectedItems.length - 1;\n    const newIndex = this.activeChipIndex + 1;\n\n    if (newIndex > last) {\n      this.activeChipIndex = -1;\n      this.setFocus();\n    } else {\n      this.activeChipIndex = newIndex;\n      this.focusChip();\n    }\n\n    this.updateActiveItemIndex(-1);\n  }\n\n  focusChip() {\n    var _a;\n\n    const guid = (_a = this.selectedItems[this.activeChipIndex]) === null || _a === void 0 ? void 0 : _a.guid;\n    const chip = guid ? this.referenceEl.querySelector(`#${chipUidPrefix}${guid}`) : null;\n    chip === null || chip === void 0 ? void 0 : chip.setFocus();\n  }\n\n  shiftActiveItemIndex(delta) {\n    const {\n      length\n    } = this.visibleItems;\n    const newIndex = (this.activeItemIndex + length + delta) % length;\n    this.updateActiveItemIndex(newIndex);\n    this.scrollToActiveItem();\n  }\n\n  updateActiveItemIndex(index) {\n    var _a;\n\n    this.activeItemIndex = index;\n    let activeDescendant = null;\n    this.visibleItems.forEach((el, i) => {\n      if (i === index) {\n        el.active = true;\n        activeDescendant = el.guid;\n      } else {\n        el.active = false;\n      }\n    });\n    this.activeDescendant = activeDescendant;\n\n    if (this.activeItemIndex > -1) {\n      this.activeChipIndex = -1;\n      (_a = this.textInput) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n  }\n\n  isMulti() {\n    return this.selectionMode !== \"single\";\n  } //--------------------------------------------------------------------------\n  //\n  //  Render Methods\n  //\n  //--------------------------------------------------------------------------\n\n\n  renderChips() {\n    const {\n      activeChipIndex,\n      scale,\n      selectionMode,\n      intlRemoveTag\n    } = this;\n    return this.selectedItems.map((item, i) => {\n      const chipClasses = {\n        chip: true,\n        \"chip--active\": activeChipIndex === i\n      };\n      const ancestors = [...getItemAncestors(item)].reverse();\n      const pathLabel = [...ancestors, item].map(el => el.textLabel);\n      const label = selectionMode !== \"ancestors\" ? item.textLabel : pathLabel.join(\" / \");\n      return h(\"calcite-chip\", {\n        class: chipClasses,\n        dismissLabel: intlRemoveTag,\n        dismissible: true,\n        icon: item.icon,\n        id: item.guid ? `${chipUidPrefix}${item.guid}` : null,\n        key: item.textLabel,\n        onCalciteChipDismiss: event => this.calciteChipDismissHandler(event, item),\n        scale: scale,\n        title: label,\n        value: item.value\n      }, label);\n    });\n  }\n\n  renderInput() {\n    const {\n      guid,\n      active,\n      disabled,\n      placeholder,\n      selectionMode,\n      needsIcon,\n      selectedItems\n    } = this;\n    const single = selectionMode === \"single\";\n    const selectedItem = selectedItems[0];\n    const showLabel = !active && single && !!selectedItem;\n    return h(\"span\", {\n      class: {\n        \"input-wrap\": true,\n        \"input-wrap--single\": single\n      }\n    }, showLabel && h(\"span\", {\n      class: {\n        label: true,\n        \"label--spaced\": needsIcon\n      },\n      key: \"label\"\n    }, selectedItem.textLabel), h(\"input\", {\n      \"aria-activedescendant\": this.activeDescendant,\n      \"aria-autocomplete\": \"list\",\n      \"aria-controls\": `${listboxUidPrefix}${guid}`,\n      \"aria-label\": getLabelText(this),\n      class: {\n        input: true,\n        \"input--single\": true,\n        \"input--transparent\": this.activeChipIndex > -1,\n        \"input--hidden\": showLabel,\n        \"input--icon\": single && needsIcon\n      },\n      disabled: disabled,\n      id: `${inputUidPrefix}${guid}`,\n      key: \"input\",\n      onBlur: this.comboboxBlurHandler,\n      onFocus: this.comboboxFocusHandler,\n      onInput: this.inputHandler,\n      placeholder: placeholder,\n      ref: el => this.textInput = el,\n      type: \"text\"\n    }));\n  }\n\n  renderListBoxOptions() {\n    return this.visibleItems.map(item => h(\"li\", {\n      \"aria-selected\": toAriaBoolean(item.selected),\n      id: item.guid ? `${itemUidPrefix}${item.guid}` : null,\n      role: \"option\",\n      tabindex: \"-1\"\n    }, item.textLabel));\n  }\n\n  renderPopperContainer() {\n    const {\n      active,\n      setMenuEl,\n      setListContainerEl\n    } = this;\n    const classes = {\n      \"list-container\": true,\n      [CSS.animation]: true,\n      [CSS.animationActive]: active\n    };\n    return h(\"div\", {\n      \"aria-hidden\": \"true\",\n      class: {\n        \"popper-container\": true,\n        \"popper-container--active\": active\n      },\n      ref: setMenuEl\n    }, h(\"div\", {\n      class: classes,\n      onTransitionEnd: this.transitionEnd,\n      ref: setListContainerEl\n    }, h(\"ul\", {\n      class: {\n        list: true,\n        \"list--hide\": !active\n      }\n    }, h(\"slot\", null))));\n  }\n\n  renderIconStart() {\n    const {\n      selectionMode,\n      needsIcon,\n      selectedItems\n    } = this;\n    const selectedItem = selectedItems[0];\n    return selectionMode === \"single\" && needsIcon && h(\"span\", {\n      class: \"icon-start\"\n    }, (selectedItem === null || selectedItem === void 0 ? void 0 : selectedItem.icon) && h(\"calcite-icon\", {\n      class: \"selected-icon\",\n      icon: selectedItem.icon,\n      scale: \"s\"\n    }));\n  }\n\n  renderIconEnd() {\n    const {\n      active\n    } = this;\n    return h(\"span\", {\n      class: \"icon-end\"\n    }, h(\"calcite-icon\", {\n      icon: active ? \"chevron-up\" : \"chevron-down\",\n      scale: \"s\"\n    }));\n  }\n\n  render() {\n    const {\n      active,\n      guid,\n      label\n    } = this;\n    const single = this.selectionMode === \"single\";\n    return h(Host, {\n      onKeyDown: this.keydownHandler\n    }, h(\"div\", {\n      \"aria-autocomplete\": \"list\",\n      \"aria-expanded\": toAriaBoolean(active),\n      \"aria-haspopup\": \"listbox\",\n      \"aria-labelledby\": `${labelUidPrefix}${guid}`,\n      \"aria-owns\": `${listboxUidPrefix}${guid}`,\n      class: {\n        wrapper: true,\n        \"wrapper--single\": single || !this.selectedItems.length,\n        \"wrapper--active\": active\n      },\n      onClick: this.clickHandler,\n      ref: this.setReferenceEl,\n      role: \"combobox\"\n    }, h(\"div\", {\n      class: \"grid-input\"\n    }, this.renderIconStart(), !single && this.renderChips(), h(\"label\", {\n      class: \"screen-readers-only\",\n      htmlFor: `${inputUidPrefix}${guid}`,\n      id: `${labelUidPrefix}${guid}`\n    }, label), this.renderInput()), this.renderIconEnd()), h(\"ul\", {\n      \"aria-labelledby\": `${labelUidPrefix}${guid}`,\n      \"aria-multiselectable\": \"true\",\n      class: \"screen-readers-only\",\n      id: `${listboxUidPrefix}${guid}`,\n      role: \"listbox\",\n      tabIndex: -1\n    }, this.renderListBoxOptions()), this.renderPopperContainer(), h(HiddenFormInputSlot, {\n      component: this\n    }));\n  }\n\n  get el() {\n    return this;\n  }\n\n  static get watchers() {\n    return {\n      \"active\": [\"activeHandler\"],\n      \"disabled\": [\"handleDisabledChange\"],\n      \"maxItems\": [\"maxItemsHandler\"],\n      \"value\": [\"valueHandler\"],\n      \"flipPlacements\": [\"flipPlacementsHandler\"],\n      \"selectedItems\": [\"selectedItemsHandler\"],\n      \"text\": [\"textHandler\"]\n    };\n  }\n\n  static get style() {\n    return comboboxCss;\n  }\n\n}, [1, \"calcite-combobox\", {\n  \"active\": [1540],\n  \"disabled\": [516],\n  \"label\": [1],\n  \"placeholder\": [1],\n  \"maxItems\": [2, \"max-items\"],\n  \"name\": [513],\n  \"allowCustomValues\": [4, \"allow-custom-values\"],\n  \"overlayPositioning\": [1, \"overlay-positioning\"],\n  \"required\": [4],\n  \"selectionMode\": [513, \"selection-mode\"],\n  \"scale\": [513],\n  \"value\": [1025],\n  \"intlRemoveTag\": [1, \"intl-remove-tag\"],\n  \"flipPlacements\": [16],\n  \"items\": [32],\n  \"groupItems\": [32],\n  \"selectedItems\": [32],\n  \"visibleItems\": [32],\n  \"needsIcon\": [32],\n  \"activeItemIndex\": [32],\n  \"activeChipIndex\": [32],\n  \"activeDescendant\": [32],\n  \"text\": [32],\n  \"reposition\": [64],\n  \"setFocus\": [64]\n}, [[4, \"click\", \"documentClickHandler\"], [0, \"calciteComboboxItemChange\", \"calciteComboboxItemChangeHandler\"]]]);\n\nfunction defineCustomElement$1() {\n  if (typeof customElements === \"undefined\") {\n    return;\n  }\n\n  const components = [\"calcite-combobox\", \"calcite-chip\", \"calcite-icon\"];\n  components.forEach(tagName => {\n    switch (tagName) {\n      case \"calcite-combobox\":\n        if (!customElements.get(tagName)) {\n          customElements.define(tagName, Combobox);\n        }\n\n        break;\n\n      case \"calcite-chip\":\n        if (!customElements.get(tagName)) {\n          defineCustomElement$3();\n        }\n\n        break;\n\n      case \"calcite-icon\":\n        if (!customElements.get(tagName)) {\n          defineCustomElement$2();\n        }\n\n        break;\n    }\n  });\n}\n\ndefineCustomElement$1();\nconst CalciteCombobox = Combobox;\nconst defineCustomElement = defineCustomElement$1;\nexport { CalciteCombobox, defineCustomElement };","map":{"version":3,"names":["proxyCustomElement","HTMLElement","createEvent","h","Host","a","isSymbol","S","Symbol","d","debounce","i","isArray","f","forIn","filterComputedPlacements","u","updatePopper","c","createPopper","defaultMenuPlacement","p","popperMenuComputedPlacements","C","CSS","g","guid","T","TEXT","ComboboxChildSelector","getItemAncestors","getItemChildren","hasActiveChildren","b","ComboboxItem","ComboboxItemGroup","connectLabel","disconnectLabel","getLabelText","s","submitForm","connectForm","afterConnectDefaultValueSet","disconnectForm","H","HiddenFormInputSlot","createObserver","updateHostInteraction","t","toAriaBoolean","defineCustomElement$3","defineCustomElement$2","arrayMap","array","iteratee","index","length","result","Array","INFINITY","symbolProto","prototype","undefined","symbolToString","toString","baseToString","value","call","reRegExpChar","reHasRegExpChar","RegExp","source","escapeRegExp","string","test","replace","filter","data","escapedValue","regex","console","warn","find","input","RE","_a","constant","found","val","item","comboboxCss","isGroup","el","tagName","itemUidPrefix","chipUidPrefix","labelUidPrefix","listboxUidPrefix","inputUidPrefix","Combobox","constructor","__registerHost","__attachShadow","calciteLookupChange","calciteComboboxChange","calciteComboboxFilterChange","calciteComboboxChipDismiss","calciteComboboxOpen","calciteComboboxClose","active","disabled","maxItems","overlayPositioning","required","selectionMode","scale","intlRemoveTag","removeTag","internalValueChangeFlag","items","groupItems","selectedItems","visibleItems","activeItemIndex","activeChipIndex","activeDescendant","text","textInput","mutationObserver","updateItems","resizeObserver","setMaxScrollerHeight","inputHeight","ignoreSelectedEventsFlag","activeTransitionProp","setFilteredPlacements","flipPlacements","filteredFlipPlacements","getValue","map","onLabelClick","setFocus","keydownHandler","event","key","allowCustomValues","addCustomChip","preventDefault","previousChip","nextChip","shiftActiveItemIndex","comboboxInViewport","scrollIntoView","updateActiveItemIndex","scrollToActiveItem","toggleSelection","removeActiveChip","defaultPrevented","isMulti","removeLastChip","toggleCloseEnd","removeEventListener","toggleOpenEnd","transitionEnd","propertyName","emit","listContainerEl","reposition","maxScrollerHeight","getMaxScrollerHeight","style","maxHeight","calciteChipDismissHandler","comboboxItem","selection","detail","clickHandler","composedPath","some","node","setInactiveIfNotContained","includes","referenceEl","trim","filterItems","setMenuEl","menuEl","setListContainerEl","observe","setReferenceEl","inputHandler","target","filteredData","label","textLabel","getCombinedItems","forEach","hidden","parent","grandparent","ancestors","ancestor","getVisibleItems","internalCalciteLookupChangeEvent","emitCalciteLookupChange","internalComboboxChangeEvent","emitComboboxChange","getItems","getGroupItems","getData","getSelectedItems","needsIcon","getNeedsIcon","activeItem","height","calculateSingleItemHeight","offsetHeight","scrollTop","offsetTop","comboboxFocusHandler","focus","comboboxBlurHandler","activeHandler","handleDisabledChange","maxItemsHandler","valueHandler","selected","flipPlacementsHandler","documentClickHandler","calciteComboboxItemChangeHandler","newIndex","indexOf","popper","modifiers","getModifiers","placement","connectedCallback","childList","subtree","componentWillLoad","componentDidLoad","componentDidRender","disconnectedCallback","_b","disconnect","destroyPopper","selectedItemsHandler","textHandler","bounding","getBoundingClientRect","top","left","right","window","innerWidth","document","documentElement","clientWidth","bottom","innerHeight","clientHeight","flipModifier","name","enabled","options","fallbackPlacements","eventListenerModifier","destroy","itemsToProcess","children","from","querySelectorAll","child","updateAncestors","resetText","match","sort","aIdx","bIdx","icon","existingItem","createElement","appendChild","Math","max","focusChip","last","chip","querySelector","delta","renderChips","chipClasses","reverse","pathLabel","join","class","dismissLabel","dismissible","id","onCalciteChipDismiss","title","renderInput","placeholder","single","selectedItem","showLabel","onBlur","onFocus","onInput","ref","type","renderListBoxOptions","role","tabindex","renderPopperContainer","classes","animation","animationActive","onTransitionEnd","list","renderIconStart","renderIconEnd","render","onKeyDown","wrapper","onClick","htmlFor","tabIndex","component","watchers","defineCustomElement$1","customElements","components","get","define","CalciteCombobox","defineCustomElement"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@esri/calcite-components/dist/components/calcite-combobox.js"],"sourcesContent":["/*!\n * All material copyright ESRI, All Rights Reserved, unless otherwise specified.\n * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.\n * v1.0.0-beta.82\n */\nimport { proxyCustomElement, HTMLElement, createEvent, h, Host } from '@stencil/core/internal/client';\nimport { a as isSymbol, S as Symbol, d as debounce } from './debounce.js';\nimport { i as isArray, f as forIn } from './forIn.js';\nimport { f as filterComputedPlacements, u as updatePopper, c as createPopper, a as defaultMenuPlacement, p as popperMenuComputedPlacements, C as CSS } from './popper.js';\nimport { g as guid } from './guid.js';\nimport { T as TEXT, C as ComboboxChildSelector, g as getItemAncestors, a as getItemChildren, h as hasActiveChildren, b as ComboboxItem, c as ComboboxItemGroup } from './utils2.js';\nimport { c as connectLabel, d as disconnectLabel, g as getLabelText } from './label.js';\nimport { s as submitForm, c as connectForm, a as afterConnectDefaultValueSet, d as disconnectForm, H as HiddenFormInputSlot } from './form.js';\nimport { c as createObserver } from './observers.js';\nimport { u as updateHostInteraction } from './interactive.js';\nimport { t as toAriaBoolean } from './dom.js';\nimport { d as defineCustomElement$3 } from './chip.js';\nimport { d as defineCustomElement$2 } from './icon.js';\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n    reHasRegExpChar = RegExp(reRegExpChar.source);\n\n/**\n * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to escape.\n * @returns {string} Returns the escaped string.\n * @example\n *\n * _.escapeRegExp('[lodash](https://lodash.com/)');\n * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n */\nfunction escapeRegExp(string) {\n  string = toString(string);\n  return (string && reHasRegExpChar.test(string))\n    ? string.replace(reRegExpChar, '\\\\$&')\n    : string;\n}\n\nconst filter = (data, value) => {\n  const escapedValue = escapeRegExp(value);\n  const regex = new RegExp(escapedValue, \"i\");\n  if (data.length === 0) {\n    console.warn(`No data was passed to the filter function.\n    The data argument should be an array of objects`);\n  }\n  const find = (input, RE) => {\n    var _a;\n    if ((_a = input) === null || _a === void 0 ? void 0 : _a.constant) {\n      return true;\n    }\n    let found = false;\n    forIn(input, (val) => {\n      if (typeof val === \"function\" || val == null /* intentional == to catch undefined */) {\n        return;\n      }\n      if (Array.isArray(val) || (typeof val === \"object\" && val !== null)) {\n        if (find(val, RE)) {\n          found = true;\n        }\n      }\n      else if (RE.test(val)) {\n        found = true;\n      }\n    });\n    return found;\n  };\n  const result = data.filter((item) => {\n    return find(item, regex);\n  });\n  return result;\n};\n\nconst comboboxCss = \"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{position:relative;display:block}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){font-size:var(--calcite-font-size--2);--calcite-combobox-item-spacing-unit-l:0.5rem;--calcite-combobox-item-spacing-unit-s:0.25rem;--calcite-combobox-input-height:1.5rem}:host([scale=m]){font-size:var(--calcite-font-size--1);--calcite-combobox-item-spacing-unit-l:0.75rem;--calcite-combobox-item-spacing-unit-s:0.5rem;--calcite-combobox-input-height:2rem}:host([scale=l]){font-size:var(--calcite-font-size-0);--calcite-combobox-item-spacing-unit-l:1rem;--calcite-combobox-item-spacing-unit-s:0.75rem;--calcite-combobox-input-height:2.75rem}.wrapper{display:-ms-flexbox;display:flex;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;-webkit-box-shadow:inset 0 0 0 1px var(--calcite-ui-border-input);box-shadow:inset 0 0 0 1px var(--calcite-ui-border-input);padding:calc(var(--calcite-combobox-item-spacing-unit-s) / 4) var(--calcite-combobox-item-spacing-unit-l)}:host(:focus-within) .wrapper,.wrapper--active{outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}.wrapper--single{padding:0 var(--calcite-combobox-item-spacing-unit-l);cursor:pointer;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.grid-input{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0px}.input{-ms-flex-positive:1;flex-grow:1;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-style:none;background-color:transparent;padding:0px;font-family:inherit;color:var(--calcite-ui-text-1);font-size:inherit;height:var(--calcite-combobox-input-height);line-height:var(--calcite-combobox-input-height);min-width:120px;margin-bottom:var(--calcite-combobox-item-spacing-unit-s)}.input:focus{outline:2px solid transparent;outline-offset:2px}.input--transparent{opacity:0}.input--single{margin-bottom:0px;margin-top:0px;padding:0px}.wrapper--active .input-single{cursor:text}.input--hidden{pointer-events:none;width:0px;min-width:0px;opacity:0}.input--icon{padding:0 var(--calcite-combobox-item-spacing-unit-l)}.input-wrap{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1}.input-wrap--single{-ms-flex:1 1 0%;flex:1 1 0%;overflow:hidden}.label{pointer-events:none;display:-ms-flexbox;display:flex;max-width:100%;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0px;font-weight:var(--calcite-font-weight-normal);height:var(--calcite-combobox-input-height);line-height:var(--calcite-combobox-input-height)}.label--spaced{padding-top:0px;padding-bottom:0px;padding-left:var(--calcite-combobox-item-spacing-unit-l);padding-right:var(--calcite-combobox-item-spacing-unit-l)}.icon-end,.icon-start{display:-ms-flexbox;display:flex;width:1rem;cursor:pointer;-ms-flex-align:center;align-items:center}.icon-end{-ms-flex:none;flex:none}.popper-container{width:100%;display:block;position:absolute;z-index:900;-webkit-transform:scale(0);transform:scale(0);visibility:hidden;pointer-events:none}.popper-container .calcite-popper-anim{position:relative;z-index:1;-webkit-transition:var(--calcite-popper-transition);transition:var(--calcite-popper-transition);visibility:hidden;-webkit-transition-property:visibility, opacity, -webkit-transform;transition-property:visibility, opacity, -webkit-transform;transition-property:transform, visibility, opacity;transition-property:transform, visibility, opacity, -webkit-transform;opacity:0;-webkit-box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);border-radius:0.25rem}.popper-container[data-popper-placement^=bottom] .calcite-popper-anim{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.popper-container[data-popper-placement^=top] .calcite-popper-anim{-webkit-transform:translateY(5px);transform:translateY(5px)}.popper-container[data-popper-placement^=left] .calcite-popper-anim{-webkit-transform:translateX(5px);transform:translateX(5px)}.popper-container[data-popper-placement^=right] .calcite-popper-anim{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.popper-container[data-popper-placement] .calcite-popper-anim--active{opacity:1;visibility:visible;-webkit-transform:translate(0);transform:translate(0)}.popper-container--active{pointer-events:initial;visibility:visible}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.list-container{max-height:100vh;overflow-y:auto;background-color:var(--calcite-ui-foreground-1);width:var(--calcite-dropdown-width)}.list{margin:0px;display:block;padding:0px}.list--hide{height:0px;overflow:hidden}.chip{margin-block:calc(var(--calcite-combobox-item-spacing-unit-s) / 4);margin-inline:0 var(--calcite-combobox-item-spacing-unit-s);max-width:100%}.chip--active{background-color:var(--calcite-ui-foreground-3)}.item{display:block}::slotted(input[slot=hidden-form-input]){bottom:0 !important;left:0 !important;margin:0 !important;opacity:0 !important;outline:none !important;padding:0 !important;position:absolute !important;right:0 !important;top:0 !important;-webkit-transform:none !important;transform:none !important;-webkit-appearance:none !important;z-index:-1 !important}\";\n\nconst isGroup = (el) => el.tagName === ComboboxItemGroup;\nconst itemUidPrefix = \"combobox-item-\";\nconst chipUidPrefix = \"combobox-chip-\";\nconst labelUidPrefix = \"combobox-label-\";\nconst listboxUidPrefix = \"combobox-listbox-\";\nconst inputUidPrefix = \"combobox-input-\";\nconst Combobox = /*@__PURE__*/ proxyCustomElement(class extends HTMLElement {\n  constructor() {\n    super();\n    this.__registerHost();\n    this.__attachShadow();\n    this.calciteLookupChange = createEvent(this, \"calciteLookupChange\", 7);\n    this.calciteComboboxChange = createEvent(this, \"calciteComboboxChange\", 7);\n    this.calciteComboboxFilterChange = createEvent(this, \"calciteComboboxFilterChange\", 7);\n    this.calciteComboboxChipDismiss = createEvent(this, \"calciteComboboxChipDismiss\", 7);\n    this.calciteComboboxOpen = createEvent(this, \"calciteComboboxOpen\", 7);\n    this.calciteComboboxClose = createEvent(this, \"calciteComboboxClose\", 7);\n    //--------------------------------------------------------------------------\n    //\n    //  Public Properties\n    //\n    //--------------------------------------------------------------------------\n    /** Opens or closes the combobox */\n    this.active = false;\n    /** Disable combobox input */\n    this.disabled = false;\n    /** Specify the maximum number of combobox items (including nested children) to display before showing the scroller */\n    this.maxItems = 0;\n    /** Describes the type of positioning to use for the overlaid content. If your element is in a fixed container, use the 'fixed' value. */\n    this.overlayPositioning = \"absolute\";\n    /**\n     * When true, makes the component required for form-submission.\n     *\n     * @internal\n     */\n    this.required = false;\n    /** specify the selection mode\n     * - multi: allow any number of selected items (default)\n     * - single: only one selection)\n     * - ancestors: like multi, but show ancestors of selected items as selected, only deepest children shown in chips\n     */\n    this.selectionMode = \"multi\";\n    /** Specify the scale of the combobox, defaults to m */\n    this.scale = \"m\";\n    /** The value(s) of the selectedItem(s) */\n    this.value = null;\n    /** string to override the English \"Remove tag\" text for when an item is selected.\n     * @default \"Remove tag\"\n     */\n    this.intlRemoveTag = TEXT.removeTag;\n    this.internalValueChangeFlag = false;\n    this.items = [];\n    this.groupItems = [];\n    this.selectedItems = [];\n    this.visibleItems = [];\n    this.activeItemIndex = -1;\n    this.activeChipIndex = -1;\n    this.activeDescendant = \"\";\n    this.text = \"\";\n    this.textInput = null;\n    this.mutationObserver = createObserver(\"mutation\", () => this.updateItems());\n    this.resizeObserver = createObserver(\"resize\", () => this.setMaxScrollerHeight());\n    this.guid = guid();\n    this.inputHeight = 0;\n    this.ignoreSelectedEventsFlag = false;\n    this.activeTransitionProp = \"opacity\";\n    // --------------------------------------------------------------------------\n    //\n    //  Private Methods\n    //\n    // --------------------------------------------------------------------------\n    this.setFilteredPlacements = () => {\n      const { el, flipPlacements } = this;\n      this.filteredFlipPlacements = flipPlacements\n        ? filterComputedPlacements(flipPlacements, el)\n        : null;\n    };\n    this.getValue = () => {\n      const items = this.selectedItems.map((item) => { var _a; return (_a = item === null || item === void 0 ? void 0 : item.value) === null || _a === void 0 ? void 0 : _a.toString(); });\n      return (items === null || items === void 0 ? void 0 : items.length) ? (items.length > 1 ? items : items[0]) : \"\";\n    };\n    this.onLabelClick = () => {\n      this.setFocus();\n    };\n    this.keydownHandler = (event) => {\n      const { key } = event;\n      switch (key) {\n        case \"Tab\":\n          this.activeChipIndex = -1;\n          this.activeItemIndex = -1;\n          if (this.allowCustomValues && this.text) {\n            this.addCustomChip(this.text, true);\n            event.preventDefault();\n          }\n          else if (this.active) {\n            this.active = false;\n            event.preventDefault();\n          }\n          break;\n        case \"ArrowLeft\":\n          this.previousChip();\n          break;\n        case \"ArrowRight\":\n          this.nextChip();\n          break;\n        case \"ArrowUp\":\n          this.shiftActiveItemIndex(-1);\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n          break;\n        case \"ArrowDown\":\n          if (!this.active) {\n            event.preventDefault();\n            this.active = true;\n          }\n          this.shiftActiveItemIndex(1);\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n          break;\n        case \" \":\n          if (!this.textInput.value) {\n            event.preventDefault();\n            this.active = true;\n            this.shiftActiveItemIndex(1);\n          }\n          break;\n        case \"Home\":\n          if (this.active) {\n            event.preventDefault();\n          }\n          this.updateActiveItemIndex(0);\n          this.scrollToActiveItem();\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n          break;\n        case \"End\":\n          if (this.active) {\n            event.preventDefault();\n          }\n          this.updateActiveItemIndex(this.visibleItems.length - 1);\n          this.scrollToActiveItem();\n          if (!this.comboboxInViewport()) {\n            this.el.scrollIntoView();\n          }\n          break;\n        case \"Escape\":\n          this.active = false;\n          break;\n        case \"Enter\":\n          if (this.activeItemIndex > -1) {\n            this.toggleSelection(this.visibleItems[this.activeItemIndex]);\n          }\n          else if (this.activeChipIndex > -1) {\n            this.removeActiveChip();\n          }\n          else if (this.allowCustomValues && this.text) {\n            this.addCustomChip(this.text, true);\n          }\n          else if (!event.defaultPrevented) {\n            submitForm(this);\n          }\n          break;\n        case \"Delete\":\n        case \"Backspace\":\n          if (this.activeChipIndex > -1) {\n            this.removeActiveChip();\n          }\n          else if (!this.text && this.isMulti()) {\n            this.removeLastChip();\n          }\n          break;\n      }\n    };\n    this.toggleCloseEnd = () => {\n      this.active = false;\n      this.el.removeEventListener(\"calciteComboboxClose\", this.toggleCloseEnd);\n    };\n    this.toggleOpenEnd = () => {\n      this.active = true;\n      this.el.removeEventListener(\"calciteComboboxOpen\", this.toggleOpenEnd);\n    };\n    this.transitionEnd = (event) => {\n      if (event.propertyName === this.activeTransitionProp) {\n        this.active ? this.calciteComboboxOpen.emit() : this.calciteComboboxClose.emit();\n      }\n    };\n    this.setMaxScrollerHeight = () => {\n      const { active, listContainerEl } = this;\n      if (!listContainerEl || !active) {\n        return;\n      }\n      this.reposition();\n      const maxScrollerHeight = this.getMaxScrollerHeight();\n      listContainerEl.style.maxHeight = maxScrollerHeight > 0 ? `${maxScrollerHeight}px` : \"\";\n      this.reposition();\n    };\n    this.calciteChipDismissHandler = (event, comboboxItem) => {\n      this.active = false;\n      const selection = this.items.find((item) => item === comboboxItem);\n      if (selection) {\n        this.toggleSelection(selection, false);\n      }\n      this.calciteComboboxChipDismiss.emit(event.detail);\n    };\n    this.clickHandler = (event) => {\n      if (event.composedPath().some((node) => node.tagName === \"CALCITE-CHIP\")) {\n        return;\n      }\n      this.active = !this.active;\n      this.updateActiveItemIndex(0);\n      this.setFocus();\n    };\n    this.setInactiveIfNotContained = (event) => {\n      const composedPath = event.composedPath();\n      if (!this.active || composedPath.includes(this.el) || composedPath.includes(this.referenceEl)) {\n        return;\n      }\n      if (this.allowCustomValues && this.text.trim().length) {\n        this.addCustomChip(this.text);\n      }\n      if (this.selectionMode === \"single\") {\n        if (this.textInput) {\n          this.textInput.value = \"\";\n        }\n        this.text = \"\";\n        this.filterItems(\"\");\n        this.updateActiveItemIndex(-1);\n      }\n      this.active = false;\n    };\n    this.setMenuEl = (el) => {\n      this.menuEl = el;\n    };\n    this.setListContainerEl = (el) => {\n      this.resizeObserver.observe(el);\n      this.listContainerEl = el;\n    };\n    this.setReferenceEl = (el) => {\n      this.referenceEl = el;\n    };\n    this.inputHandler = (event) => {\n      const value = event.target.value;\n      this.text = value;\n      this.filterItems(value);\n      if (value) {\n        this.activeChipIndex = -1;\n      }\n    };\n    this.filterItems = (() => {\n      const find = (item, filteredData) => item &&\n        filteredData.some(({ label, value }) => {\n          if (isGroup(item)) {\n            return value === item.label;\n          }\n          return (value === item.textLabel ||\n            value === item.value ||\n            label === item.textLabel ||\n            label === item.value);\n        });\n      return debounce((text) => {\n        const filteredData = filter(this.data, text);\n        const items = this.getCombinedItems();\n        items.forEach((item) => {\n          const hidden = !find(item, filteredData);\n          item.hidden = hidden;\n          const [parent, grandparent] = item.ancestors;\n          if (find(parent, filteredData) || find(grandparent, filteredData)) {\n            item.hidden = false;\n          }\n          if (!hidden) {\n            item.ancestors.forEach((ancestor) => (ancestor.hidden = false));\n          }\n        });\n        this.visibleItems = this.getVisibleItems();\n        this.calciteComboboxFilterChange.emit({ visibleItems: [...this.visibleItems], text: text });\n      }, 100);\n    })();\n    this.internalCalciteLookupChangeEvent = () => {\n      this.calciteLookupChange.emit(this.selectedItems);\n    };\n    this.emitCalciteLookupChange = debounce(this.internalCalciteLookupChangeEvent, 0);\n    this.internalComboboxChangeEvent = () => {\n      const { selectedItems } = this;\n      this.calciteComboboxChange.emit({ selectedItems });\n    };\n    this.emitComboboxChange = debounce(this.internalComboboxChangeEvent, 0);\n    this.updateItems = () => {\n      this.items = this.getItems();\n      this.groupItems = this.getGroupItems();\n      this.data = this.getData();\n      this.selectedItems = this.getSelectedItems();\n      this.visibleItems = this.getVisibleItems();\n      this.needsIcon = this.getNeedsIcon();\n      if (!this.allowCustomValues) {\n        this.setMaxScrollerHeight();\n      }\n    };\n    this.scrollToActiveItem = () => {\n      const activeItem = this.visibleItems[this.activeItemIndex];\n      const height = this.calculateSingleItemHeight(activeItem);\n      const { offsetHeight, scrollTop } = this.listContainerEl;\n      if (offsetHeight + scrollTop < activeItem.offsetTop + height) {\n        this.listContainerEl.scrollTop = activeItem.offsetTop - offsetHeight + height;\n      }\n      else if (activeItem.offsetTop < scrollTop) {\n        this.listContainerEl.scrollTop = activeItem.offsetTop;\n      }\n    };\n    this.comboboxFocusHandler = () => {\n      var _a;\n      (_a = this.textInput) === null || _a === void 0 ? void 0 : _a.focus();\n    };\n    this.comboboxBlurHandler = (event) => {\n      this.setInactiveIfNotContained(event);\n    };\n  }\n  activeHandler() {\n    if (this.disabled) {\n      this.active = false;\n      return;\n    }\n    this.reposition();\n  }\n  handleDisabledChange(value) {\n    if (!value) {\n      this.active = false;\n    }\n  }\n  maxItemsHandler() {\n    this.setMaxScrollerHeight();\n  }\n  valueHandler(value) {\n    if (!this.internalValueChangeFlag) {\n      const items = this.getItems();\n      if (Array.isArray(value)) {\n        items.forEach((item) => (item.selected = value.includes(item.value)));\n      }\n      else if (value) {\n        items.forEach((item) => (item.selected = value === item.value));\n      }\n      else {\n        items.forEach((item) => (item.selected = false));\n      }\n      this.updateItems();\n    }\n  }\n  flipPlacementsHandler() {\n    this.setFilteredPlacements();\n  }\n  //--------------------------------------------------------------------------\n  //\n  //  Event Listeners\n  //\n  //--------------------------------------------------------------------------\n  documentClickHandler(event) {\n    this.setInactiveIfNotContained(event);\n  }\n  calciteComboboxItemChangeHandler(event) {\n    if (this.ignoreSelectedEventsFlag) {\n      return;\n    }\n    const target = event.target;\n    const newIndex = this.visibleItems.indexOf(target);\n    this.updateActiveItemIndex(newIndex);\n    this.toggleSelection(target, target.selected);\n  }\n  //--------------------------------------------------------------------------\n  //\n  //  Public Methods\n  //\n  //--------------------------------------------------------------------------\n  /** Updates the position of the component. */\n  async reposition() {\n    const { popper, menuEl } = this;\n    const modifiers = this.getModifiers();\n    popper\n      ? await updatePopper({\n        el: menuEl,\n        modifiers,\n        placement: defaultMenuPlacement,\n        popper\n      })\n      : this.createPopper();\n  }\n  /** Sets focus on the component. */\n  async setFocus() {\n    var _a;\n    (_a = this.textInput) === null || _a === void 0 ? void 0 : _a.focus();\n    this.activeChipIndex = -1;\n    this.activeItemIndex = -1;\n  }\n  // --------------------------------------------------------------------------\n  //\n  //  Lifecycle\n  //\n  // --------------------------------------------------------------------------\n  connectedCallback() {\n    var _a;\n    this.internalValueChangeFlag = true;\n    this.value = this.getValue();\n    this.internalValueChangeFlag = false;\n    (_a = this.mutationObserver) === null || _a === void 0 ? void 0 : _a.observe(this.el, { childList: true, subtree: true });\n    this.createPopper();\n    connectLabel(this);\n    connectForm(this);\n    this.setFilteredPlacements();\n  }\n  componentWillLoad() {\n    this.updateItems();\n  }\n  componentDidLoad() {\n    afterConnectDefaultValueSet(this, this.getValue());\n  }\n  componentDidRender() {\n    if (this.el.offsetHeight !== this.inputHeight) {\n      this.reposition();\n      this.inputHeight = this.el.offsetHeight;\n    }\n    updateHostInteraction(this);\n  }\n  disconnectedCallback() {\n    var _a, _b;\n    (_a = this.mutationObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n    (_b = this.resizeObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n    this.destroyPopper();\n    disconnectLabel(this);\n    disconnectForm(this);\n  }\n  selectedItemsHandler() {\n    this.internalValueChangeFlag = true;\n    this.value = this.getValue();\n    this.internalValueChangeFlag = false;\n  }\n  /** when search text is cleared, reset active to  */\n  textHandler() {\n    this.updateActiveItemIndex(-1);\n  }\n  comboboxInViewport() {\n    const bounding = this.el.getBoundingClientRect();\n    return (bounding.top >= 0 &&\n      bounding.left >= 0 &&\n      bounding.right <= (window.innerWidth || document.documentElement.clientWidth) &&\n      bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight));\n  }\n  getModifiers() {\n    const flipModifier = {\n      name: \"flip\",\n      enabled: true\n    };\n    flipModifier.options = {\n      fallbackPlacements: this.filteredFlipPlacements || popperMenuComputedPlacements\n    };\n    const eventListenerModifier = {\n      name: \"eventListeners\",\n      enabled: this.active\n    };\n    return [flipModifier, eventListenerModifier];\n  }\n  createPopper() {\n    this.destroyPopper();\n    const { menuEl, referenceEl, overlayPositioning } = this;\n    const modifiers = this.getModifiers();\n    this.popper = createPopper({\n      el: menuEl,\n      modifiers,\n      overlayPositioning,\n      placement: defaultMenuPlacement,\n      referenceEl\n    });\n  }\n  destroyPopper() {\n    const { popper } = this;\n    if (popper) {\n      popper.destroy();\n    }\n    this.popper = null;\n  }\n  getMaxScrollerHeight() {\n    const items = this.getCombinedItems().filter((item) => !item.hidden);\n    const { maxItems } = this;\n    let itemsToProcess = 0;\n    let maxScrollerHeight = 0;\n    if (items.length > maxItems) {\n      items.forEach((item) => {\n        if (itemsToProcess < maxItems && maxItems > 0) {\n          const height = this.calculateSingleItemHeight(item);\n          if (height > 0) {\n            maxScrollerHeight += height;\n            itemsToProcess++;\n          }\n        }\n      });\n    }\n    return maxScrollerHeight;\n  }\n  calculateSingleItemHeight(item) {\n    let height = item.offsetHeight;\n    // if item has children items, don't count their height twice\n    const children = Array.from(item.querySelectorAll(ComboboxChildSelector));\n    children\n      .map((child) => child === null || child === void 0 ? void 0 : child.offsetHeight)\n      .forEach((offsetHeight) => {\n      height -= offsetHeight;\n    });\n    return height;\n  }\n  getCombinedItems() {\n    return [...this.groupItems, ...this.items];\n  }\n  toggleSelection(item, value = !item.selected) {\n    if (!item) {\n      return;\n    }\n    if (this.isMulti()) {\n      item.selected = value;\n      this.updateAncestors(item);\n      this.selectedItems = this.getSelectedItems();\n      this.emitCalciteLookupChange();\n      this.emitComboboxChange();\n      this.resetText();\n      this.filterItems(\"\");\n    }\n    else {\n      this.ignoreSelectedEventsFlag = true;\n      this.items.forEach((el) => (el.selected = el === item ? value : false));\n      this.ignoreSelectedEventsFlag = false;\n      this.selectedItems = this.getSelectedItems();\n      this.emitComboboxChange();\n      if (this.textInput) {\n        this.textInput.value = item.textLabel;\n      }\n      this.active = false;\n      this.updateActiveItemIndex(-1);\n      this.resetText();\n      this.filterItems(\"\");\n    }\n  }\n  updateAncestors(item) {\n    if (this.selectionMode !== \"ancestors\") {\n      return;\n    }\n    const ancestors = getItemAncestors(item);\n    const children = getItemChildren(item);\n    if (item.selected) {\n      ancestors.forEach((el) => {\n        el.selected = true;\n      });\n    }\n    else {\n      children.forEach((el) => (el.selected = false));\n      [...ancestors].forEach((el) => {\n        if (!hasActiveChildren(el)) {\n          el.selected = false;\n        }\n      });\n    }\n  }\n  getVisibleItems() {\n    return this.items.filter((item) => !item.hidden);\n  }\n  getSelectedItems() {\n    if (!this.isMulti()) {\n      const match = this.items.find(({ selected }) => selected);\n      return match ? [match] : [];\n    }\n    return (this.items\n      .filter((item) => item.selected && (this.selectionMode !== \"ancestors\" || !hasActiveChildren(item)))\n      /** Preserve order of entered tags */\n      .sort((a, b) => {\n      const aIdx = this.selectedItems.indexOf(a);\n      const bIdx = this.selectedItems.indexOf(b);\n      if (aIdx > -1 && bIdx > -1) {\n        return aIdx - bIdx;\n      }\n      return bIdx - aIdx;\n    }));\n  }\n  getData() {\n    return this.items.map((item) => ({\n      constant: item.constant,\n      value: item.value,\n      label: item.textLabel\n    }));\n  }\n  getNeedsIcon() {\n    return this.selectionMode === \"single\" && this.items.some((item) => item.icon);\n  }\n  resetText() {\n    if (this.textInput) {\n      this.textInput.value = \"\";\n    }\n    this.text = \"\";\n  }\n  getItems() {\n    const items = Array.from(this.el.querySelectorAll(ComboboxItem));\n    return items.filter((item) => !item.disabled);\n  }\n  getGroupItems() {\n    return Array.from(this.el.querySelectorAll(ComboboxItemGroup));\n  }\n  addCustomChip(value, focus) {\n    const existingItem = this.items.find((el) => el.textLabel === value);\n    if (existingItem) {\n      this.toggleSelection(existingItem, true);\n    }\n    else {\n      if (!this.isMulti()) {\n        this.toggleSelection(this.selectedItems[this.selectedItems.length - 1], false);\n      }\n      const item = document.createElement(ComboboxItem);\n      item.value = value;\n      item.textLabel = value;\n      item.selected = true;\n      this.el.appendChild(item);\n      this.resetText();\n      if (focus) {\n        this.setFocus();\n      }\n      this.updateItems();\n      this.filterItems(\"\");\n      this.emitCalciteLookupChange();\n      this.emitComboboxChange();\n    }\n  }\n  removeActiveChip() {\n    this.toggleSelection(this.selectedItems[this.activeChipIndex], false);\n    this.setFocus();\n  }\n  removeLastChip() {\n    this.toggleSelection(this.selectedItems[this.selectedItems.length - 1], false);\n    this.setFocus();\n  }\n  previousChip() {\n    if (this.text) {\n      return;\n    }\n    const length = this.selectedItems.length - 1;\n    const active = this.activeChipIndex;\n    this.activeChipIndex = active === -1 ? length : Math.max(active - 1, 0);\n    this.updateActiveItemIndex(-1);\n    this.focusChip();\n  }\n  nextChip() {\n    if (this.text || this.activeChipIndex === -1) {\n      return;\n    }\n    const last = this.selectedItems.length - 1;\n    const newIndex = this.activeChipIndex + 1;\n    if (newIndex > last) {\n      this.activeChipIndex = -1;\n      this.setFocus();\n    }\n    else {\n      this.activeChipIndex = newIndex;\n      this.focusChip();\n    }\n    this.updateActiveItemIndex(-1);\n  }\n  focusChip() {\n    var _a;\n    const guid = (_a = this.selectedItems[this.activeChipIndex]) === null || _a === void 0 ? void 0 : _a.guid;\n    const chip = guid\n      ? this.referenceEl.querySelector(`#${chipUidPrefix}${guid}`)\n      : null;\n    chip === null || chip === void 0 ? void 0 : chip.setFocus();\n  }\n  shiftActiveItemIndex(delta) {\n    const { length } = this.visibleItems;\n    const newIndex = (this.activeItemIndex + length + delta) % length;\n    this.updateActiveItemIndex(newIndex);\n    this.scrollToActiveItem();\n  }\n  updateActiveItemIndex(index) {\n    var _a;\n    this.activeItemIndex = index;\n    let activeDescendant = null;\n    this.visibleItems.forEach((el, i) => {\n      if (i === index) {\n        el.active = true;\n        activeDescendant = el.guid;\n      }\n      else {\n        el.active = false;\n      }\n    });\n    this.activeDescendant = activeDescendant;\n    if (this.activeItemIndex > -1) {\n      this.activeChipIndex = -1;\n      (_a = this.textInput) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n  }\n  isMulti() {\n    return this.selectionMode !== \"single\";\n  }\n  //--------------------------------------------------------------------------\n  //\n  //  Render Methods\n  //\n  //--------------------------------------------------------------------------\n  renderChips() {\n    const { activeChipIndex, scale, selectionMode, intlRemoveTag } = this;\n    return this.selectedItems.map((item, i) => {\n      const chipClasses = {\n        chip: true,\n        \"chip--active\": activeChipIndex === i\n      };\n      const ancestors = [...getItemAncestors(item)].reverse();\n      const pathLabel = [...ancestors, item].map((el) => el.textLabel);\n      const label = selectionMode !== \"ancestors\" ? item.textLabel : pathLabel.join(\" / \");\n      return (h(\"calcite-chip\", { class: chipClasses, dismissLabel: intlRemoveTag, dismissible: true, icon: item.icon, id: item.guid ? `${chipUidPrefix}${item.guid}` : null, key: item.textLabel, onCalciteChipDismiss: (event) => this.calciteChipDismissHandler(event, item), scale: scale, title: label, value: item.value }, label));\n    });\n  }\n  renderInput() {\n    const { guid, active, disabled, placeholder, selectionMode, needsIcon, selectedItems } = this;\n    const single = selectionMode === \"single\";\n    const selectedItem = selectedItems[0];\n    const showLabel = !active && single && !!selectedItem;\n    return (h(\"span\", { class: {\n        \"input-wrap\": true,\n        \"input-wrap--single\": single\n      } }, showLabel && (h(\"span\", { class: {\n        label: true,\n        \"label--spaced\": needsIcon\n      }, key: \"label\" }, selectedItem.textLabel)), h(\"input\", { \"aria-activedescendant\": this.activeDescendant, \"aria-autocomplete\": \"list\", \"aria-controls\": `${listboxUidPrefix}${guid}`, \"aria-label\": getLabelText(this), class: {\n        input: true,\n        \"input--single\": true,\n        \"input--transparent\": this.activeChipIndex > -1,\n        \"input--hidden\": showLabel,\n        \"input--icon\": single && needsIcon\n      }, disabled: disabled, id: `${inputUidPrefix}${guid}`, key: \"input\", onBlur: this.comboboxBlurHandler, onFocus: this.comboboxFocusHandler, onInput: this.inputHandler, placeholder: placeholder, ref: (el) => (this.textInput = el), type: \"text\" })));\n  }\n  renderListBoxOptions() {\n    return this.visibleItems.map((item) => (h(\"li\", { \"aria-selected\": toAriaBoolean(item.selected), id: item.guid ? `${itemUidPrefix}${item.guid}` : null, role: \"option\", tabindex: \"-1\" }, item.textLabel)));\n  }\n  renderPopperContainer() {\n    const { active, setMenuEl, setListContainerEl } = this;\n    const classes = {\n      \"list-container\": true,\n      [CSS.animation]: true,\n      [CSS.animationActive]: active\n    };\n    return (h(\"div\", { \"aria-hidden\": \"true\", class: { \"popper-container\": true, \"popper-container--active\": active }, ref: setMenuEl }, h(\"div\", { class: classes, onTransitionEnd: this.transitionEnd, ref: setListContainerEl }, h(\"ul\", { class: { list: true, \"list--hide\": !active } }, h(\"slot\", null)))));\n  }\n  renderIconStart() {\n    const { selectionMode, needsIcon, selectedItems } = this;\n    const selectedItem = selectedItems[0];\n    return (selectionMode === \"single\" &&\n      needsIcon && (h(\"span\", { class: \"icon-start\" }, (selectedItem === null || selectedItem === void 0 ? void 0 : selectedItem.icon) && (h(\"calcite-icon\", { class: \"selected-icon\", icon: selectedItem.icon, scale: \"s\" })))));\n  }\n  renderIconEnd() {\n    const { active } = this;\n    return (h(\"span\", { class: \"icon-end\" }, h(\"calcite-icon\", { icon: active ? \"chevron-up\" : \"chevron-down\", scale: \"s\" })));\n  }\n  render() {\n    const { active, guid, label } = this;\n    const single = this.selectionMode === \"single\";\n    return (h(Host, { onKeyDown: this.keydownHandler }, h(\"div\", { \"aria-autocomplete\": \"list\", \"aria-expanded\": toAriaBoolean(active), \"aria-haspopup\": \"listbox\", \"aria-labelledby\": `${labelUidPrefix}${guid}`, \"aria-owns\": `${listboxUidPrefix}${guid}`, class: {\n        wrapper: true,\n        \"wrapper--single\": single || !this.selectedItems.length,\n        \"wrapper--active\": active\n      }, onClick: this.clickHandler, ref: this.setReferenceEl, role: \"combobox\" }, h(\"div\", { class: \"grid-input\" }, this.renderIconStart(), !single && this.renderChips(), h(\"label\", { class: \"screen-readers-only\", htmlFor: `${inputUidPrefix}${guid}`, id: `${labelUidPrefix}${guid}` }, label), this.renderInput()), this.renderIconEnd()), h(\"ul\", { \"aria-labelledby\": `${labelUidPrefix}${guid}`, \"aria-multiselectable\": \"true\", class: \"screen-readers-only\", id: `${listboxUidPrefix}${guid}`, role: \"listbox\", tabIndex: -1 }, this.renderListBoxOptions()), this.renderPopperContainer(), h(HiddenFormInputSlot, { component: this })));\n  }\n  get el() { return this; }\n  static get watchers() { return {\n    \"active\": [\"activeHandler\"],\n    \"disabled\": [\"handleDisabledChange\"],\n    \"maxItems\": [\"maxItemsHandler\"],\n    \"value\": [\"valueHandler\"],\n    \"flipPlacements\": [\"flipPlacementsHandler\"],\n    \"selectedItems\": [\"selectedItemsHandler\"],\n    \"text\": [\"textHandler\"]\n  }; }\n  static get style() { return comboboxCss; }\n}, [1, \"calcite-combobox\", {\n    \"active\": [1540],\n    \"disabled\": [516],\n    \"label\": [1],\n    \"placeholder\": [1],\n    \"maxItems\": [2, \"max-items\"],\n    \"name\": [513],\n    \"allowCustomValues\": [4, \"allow-custom-values\"],\n    \"overlayPositioning\": [1, \"overlay-positioning\"],\n    \"required\": [4],\n    \"selectionMode\": [513, \"selection-mode\"],\n    \"scale\": [513],\n    \"value\": [1025],\n    \"intlRemoveTag\": [1, \"intl-remove-tag\"],\n    \"flipPlacements\": [16],\n    \"items\": [32],\n    \"groupItems\": [32],\n    \"selectedItems\": [32],\n    \"visibleItems\": [32],\n    \"needsIcon\": [32],\n    \"activeItemIndex\": [32],\n    \"activeChipIndex\": [32],\n    \"activeDescendant\": [32],\n    \"text\": [32],\n    \"reposition\": [64],\n    \"setFocus\": [64]\n  }, [[4, \"click\", \"documentClickHandler\"], [0, \"calciteComboboxItemChange\", \"calciteComboboxItemChangeHandler\"]]]);\nfunction defineCustomElement$1() {\n  if (typeof customElements === \"undefined\") {\n    return;\n  }\n  const components = [\"calcite-combobox\", \"calcite-chip\", \"calcite-icon\"];\n  components.forEach(tagName => { switch (tagName) {\n    case \"calcite-combobox\":\n      if (!customElements.get(tagName)) {\n        customElements.define(tagName, Combobox);\n      }\n      break;\n    case \"calcite-chip\":\n      if (!customElements.get(tagName)) {\n        defineCustomElement$3();\n      }\n      break;\n    case \"calcite-icon\":\n      if (!customElements.get(tagName)) {\n        defineCustomElement$2();\n      }\n      break;\n  } });\n}\ndefineCustomElement$1();\n\nconst CalciteCombobox = Combobox;\nconst defineCustomElement = defineCustomElement$1;\n\nexport { CalciteCombobox, defineCustomElement };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}