{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Collection.js\";\nimport \"../../core/has.js\";\nimport \"../../core/Error.js\";\nimport \"../../core/Logger.js\";\nimport \"../../core/accessorSupport/watch.js\";\nimport { autorun as r } from \"../../core/accessorSupport/trackingUtils.js\";\nconst t = new e(),\n      o = new WeakMap();\n\nfunction n(e) {\n  c(e) && t.push(e);\n}\n\nfunction s(e) {\n  c(e) && t.includes(e) && t.remove(e);\n}\n\nfunction c(e) {\n  return null != e && \"object\" == typeof e && \"refreshInterval\" in e && \"refresh\" in e;\n}\n\nfunction i(e, r) {\n  return Number.isFinite(e) && Number.isFinite(r) ? r <= 0 ? e : i(r, e % r) : 0;\n}\n\nlet f = 0,\n    a = 0;\n\nfunction l() {\n  const e = Date.now();\n\n  for (const r of t) if (r.refreshInterval) {\n    e - (o.get(r) ?? 0) + 5 >= 6e4 * r.refreshInterval && (o.set(r, e), r.refresh(e));\n  }\n}\n\nr(() => {\n  const e = Date.now();\n  let r = 0;\n\n  for (const n of t) r = i(Math.round(6e4 * n.refreshInterval), r), n.refreshInterval ? o.get(n) || o.set(n, e) : o.delete(n);\n\n  if (r !== a) {\n    if (a = r, clearInterval(f), 0 === a) return void (f = 0);\n    f = setInterval(l, a);\n  }\n});\nconst u = {\n  get hasRefreshTimer() {\n    return f > 0;\n  },\n\n  get tickInterval() {\n    return a;\n  },\n\n  forceRefresh() {\n    l();\n  },\n\n  hasLayer: e => c(e) && t.includes(e),\n\n  clear() {\n    for (const e of t) o.delete(e);\n\n    t.removeAll();\n  }\n\n};\nexport { n as registerLayer, u as test, s as unregisterLayer };","map":{"version":3,"names":["e","autorun","r","t","o","WeakMap","n","c","push","s","includes","remove","i","Number","isFinite","f","a","l","Date","now","refreshInterval","get","set","refresh","Math","round","delete","clearInterval","setInterval","u","hasRefreshTimer","tickInterval","forceRefresh","hasLayer","clear","removeAll","registerLayer","test","unregisterLayer"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/mixins/refresh.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import\"../../core/has.js\";import\"../../core/Error.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/watch.js\";import{autorun as r}from\"../../core/accessorSupport/trackingUtils.js\";const t=new e,o=new WeakMap;function n(e){c(e)&&t.push(e)}function s(e){c(e)&&t.includes(e)&&t.remove(e)}function c(e){return null!=e&&\"object\"==typeof e&&\"refreshInterval\"in e&&\"refresh\"in e}function i(e,r){return Number.isFinite(e)&&Number.isFinite(r)?r<=0?e:i(r,e%r):0}let f=0,a=0;function l(){const e=Date.now();for(const r of t)if(r.refreshInterval){e-(o.get(r)??0)+5>=6e4*r.refreshInterval&&(o.set(r,e),r.refresh(e))}}r((()=>{const e=Date.now();let r=0;for(const n of t)r=i(Math.round(6e4*n.refreshInterval),r),n.refreshInterval?o.get(n)||o.set(n,e):o.delete(n);if(r!==a){if(a=r,clearInterval(f),0===a)return void(f=0);f=setInterval(l,a)}}));const u={get hasRefreshTimer(){return f>0},get tickInterval(){return a},forceRefresh(){l()},hasLayer:e=>c(e)&&t.includes(e),clear(){for(const e of t)o.delete(e);t.removeAll()}};export{n as registerLayer,u as test,s as unregisterLayer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}