{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../../../core/maybe.js\";\nimport { TEXTURE_BINDING_BITMAP as t } from \"../definitions.js\";\nimport i from \"../VertexStream.js\";\nimport s from \"./WGLBrush.js\";\nimport { TextureSamplingMode as n, BlendFactor as r, CompareFunction as a } from \"../../../../webgl/enums.js\";\n\nconst o = {\n  nearest: {\n    defines: [],\n    samplingMode: n.NEAREST,\n    mips: !1\n  },\n  bilinear: {\n    defines: [],\n    samplingMode: n.LINEAR,\n    mips: !1\n  },\n  bicubic: {\n    defines: [\"bicubic\"],\n    samplingMode: n.LINEAR,\n    mips: !1\n  },\n  trilinear: {\n    defines: [],\n    samplingMode: n.LINEAR_MIPMAP_LINEAR,\n    mips: !0\n  }\n},\n      d = (e, t, i) => {\n  if (\"dynamic\" === i.samplingMode) {\n    const {\n      state: i\n    } = e,\n          s = t.resolution / t.pixelRatio / i.resolution,\n          n = Math.round(e.pixelRatio) !== e.pixelRatio,\n          r = s > 1.05 || s < .95;\n    return i.rotation || r || n || t.isSourceScaled || t.rotation ? o.bilinear : o.nearest;\n  }\n\n  return o[i.samplingMode];\n};\n\nclass m extends s {\n  constructor() {\n    super(...arguments), this._desc = {\n      vsPath: \"raster/bitmap\",\n      fsPath: \"raster/bitmap\",\n      attributes: new Map([[\"a_pos\", 0]])\n    };\n  }\n\n  dispose() {\n    this._quad && this._quad.dispose();\n  }\n\n  prepareState({\n    context: e\n  }) {\n    e.setBlendingEnabled(!0), e.setColorMask(!0, !0, !0, !0), e.setStencilWriteMask(0), e.setStencilTestEnabled(!0);\n  }\n\n  draw(s, n) {\n    const {\n      context: o,\n      renderingOptions: m,\n      painter: l,\n      requestRender: c,\n      allowDelayedRender: p\n    } = s;\n    if (!n.source || !n.isReady) return;\n    const u = d(s, n, m),\n          f = l.materialManager.getProgram(this._desc, u.defines);\n    if (p && e(c) && !f.isCompiled) return void c();\n    s.timeline.begin(this.name), \"additive\" === n.blendFunction ? o.setBlendFunctionSeparate(r.ONE, r.ONE, r.ONE, r.ONE) : o.setBlendFunctionSeparate(r.ONE, r.ONE_MINUS_SRC_ALPHA, r.ONE, r.ONE_MINUS_SRC_ALPHA), o.setStencilFunction(a.EQUAL, n.stencilRef, 255), this._quad || (this._quad = new i(o, [0, 0, 1, 0, 0, 1, 1, 1]));\n    const {\n      coordScale: _,\n      computedOpacity: E,\n      transforms: M\n    } = n;\n    n.setSamplingProfile(u), n.bind(s.context, t), o.useProgram(f), f.setUniformMatrix3fv(\"u_dvsMat3\", M.dvs), f.setUniform1i(\"u_texture\", t), f.setUniform2fv(\"u_coordScale\", _), f.setUniform1f(\"u_opacity\", E), this._quad.draw(), s.timeline.end(this.name);\n  }\n\n}\n\nexport { m as default };","map":{"version":3,"names":["isSome","e","TEXTURE_BINDING_BITMAP","t","i","s","TextureSamplingMode","n","BlendFactor","r","CompareFunction","a","o","nearest","defines","samplingMode","NEAREST","mips","bilinear","LINEAR","bicubic","trilinear","LINEAR_MIPMAP_LINEAR","d","state","resolution","pixelRatio","Math","round","rotation","isSourceScaled","m","constructor","arguments","_desc","vsPath","fsPath","attributes","Map","dispose","_quad","prepareState","context","setBlendingEnabled","setColorMask","setStencilWriteMask","setStencilTestEnabled","draw","renderingOptions","painter","l","requestRender","c","allowDelayedRender","p","source","isReady","u","f","materialManager","getProgram","isCompiled","timeline","begin","name","blendFunction","setBlendFunctionSeparate","ONE","ONE_MINUS_SRC_ALPHA","setStencilFunction","EQUAL","stencilRef","coordScale","_","computedOpacity","E","transforms","M","setSamplingProfile","bind","useProgram","setUniformMatrix3fv","dvs","setUniform1i","setUniform2fv","setUniform1f","end","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/BrushBitmap.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../../core/maybe.js\";import{TEXTURE_BINDING_BITMAP as t}from\"../definitions.js\";import i from\"../VertexStream.js\";import s from\"./WGLBrush.js\";import{TextureSamplingMode as n,BlendFactor as r,CompareFunction as a}from\"../../../../webgl/enums.js\";const o={nearest:{defines:[],samplingMode:n.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:n.LINEAR,mips:!1},bicubic:{defines:[\"bicubic\"],samplingMode:n.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:n.LINEAR_MIPMAP_LINEAR,mips:!0}},d=(e,t,i)=>{if(\"dynamic\"===i.samplingMode){const{state:i}=e,s=t.resolution/t.pixelRatio/i.resolution,n=Math.round(e.pixelRatio)!==e.pixelRatio,r=s>1.05||s<.95;return i.rotation||r||n||t.isSourceScaled||t.rotation?o.bilinear:o.nearest}return o[i.samplingMode]};class m extends s{constructor(){super(...arguments),this._desc={vsPath:\"raster/bitmap\",fsPath:\"raster/bitmap\",attributes:new Map([[\"a_pos\",0]])}}dispose(){this._quad&&this._quad.dispose()}prepareState({context:e}){e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0)}draw(s,n){const{context:o,renderingOptions:m,painter:l,requestRender:c,allowDelayedRender:p}=s;if(!n.source||!n.isReady)return;const u=d(s,n,m),f=l.materialManager.getProgram(this._desc,u.defines);if(p&&e(c)&&!f.isCompiled)return void c();s.timeline.begin(this.name),\"additive\"===n.blendFunction?o.setBlendFunctionSeparate(r.ONE,r.ONE,r.ONE,r.ONE):o.setBlendFunctionSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),o.setStencilFunction(a.EQUAL,n.stencilRef,255),this._quad||(this._quad=new i(o,[0,0,1,0,0,1,1,1]));const{coordScale:_,computedOpacity:E,transforms:M}=n;n.setSamplingProfile(u),n.bind(s.context,t),o.useProgram(f),f.setUniformMatrix3fv(\"u_dvsMat3\",M.dvs),f.setUniform1i(\"u_texture\",t),f.setUniform2fv(\"u_coordScale\",_),f.setUniform1f(\"u_opacity\",E),this._quad.draw(),s.timeline.end(this.name)}}export{m as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}