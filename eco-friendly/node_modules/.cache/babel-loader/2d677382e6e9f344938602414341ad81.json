{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { getOrCreateMapValue as e } from \"../../../../core/MapUtils.js\";\nimport { eachAlwaysValues as t } from \"../../../../core/promiseUtils.js\";\nimport { isDataProtocol as r, dataComponents as s, dataToArrayBuffer as n, makeAbsolute as o } from \"../../../../core/urlUtils.js\";\nimport { Version as a } from \"../../../../core/Version.js\";\nimport { y as i, m as u, v as c, e as f, k as d } from \"../../../../chunks/mat4.js\";\nimport { c as p, b as m } from \"../../../../chunks/mat4f64.js\";\nimport { g as l } from \"../../../../chunks/quat.js\";\nimport { a as h } from \"../../../../chunks/quatf64.js\";\nimport { BufferViewUint32 as y, BufferViewUint16 as b, BufferViewUint8 as T, BufferViewVec3f as _, BufferViewVec4f as x, BufferViewVec2f as w, BufferViewVec4u8 as O, BufferViewVec4u16 as N, BufferViewVec3u8 as g, BufferViewVec3u16 as C, BufferViewVec2u32 as S, BufferViewVec2u16 as U, BufferViewVec2i16 as I, BufferViewVec2u8 as L, BufferViewVec2i8 as A } from \"../../../../geometry/support/buffer/BufferView.js\";\nimport { m as E } from \"../../../../chunks/scalar.js\";\nimport { BinaryStreamReader as R } from \"./BinaryStreamReader.js\";\nimport { AttributeType as v } from \"./enums.js\";\nimport { material as B, textureSampler as D } from \"./fillDefaults.js\";\nimport { splitURI as G } from \"./pathUtils.js\";\nimport { DataType as j } from \"../../../webgl/enums.js\";\nconst M = {\n  MAGIC: 1179937895,\n  CHUNK_TYPE_JSON: 1313821514,\n  CHUNK_TYPE_BIN: 5130562,\n  MIN_HEADER_LENGTH: 20\n};\n\nclass F {\n  constructor(e, t, r, s, n) {\n    this._context = e, this._errorContext = t, this.uri = r, this.json = s, this._glbBuffer = n, this._bufferLoaders = new Map(), this._textureLoaders = new Map(), this._textureCache = new Map(), this._materialCache = new Map(), this._nodeParentMap = new Map(), this._nodeTransformCache = new Map(), this._baseUri = G(this.uri).dirPart, this._checkVersionSupported(), this._checkRequiredExtensionsSupported(), t.errorUnsupportedIf(null == s.scenes, \"Scenes must be defined.\"), t.errorUnsupportedIf(null == s.meshes, \"Meshes must be defined\"), t.errorUnsupportedIf(null == s.nodes, \"Nodes must be defined.\"), this._computeNodeParents();\n  }\n\n  static async load(e, t, o, a) {\n    if (r(o)) {\n      const r = s(o);\n      if (r && \"model/gltf-binary\" !== r.mediaType) try {\n        const s = JSON.parse(r.isBase64 ? atob(r.data) : r.data);\n        return new F(e, t, o, s);\n      } catch {}\n      const a = n(o);\n      if (F._isGLBData(a)) return this._fromGLBData(e, t, o, a);\n    }\n\n    if (o.endsWith(\".gltf\")) {\n      const r = await e.loadJSON(o, a);\n      return new F(e, t, o, r);\n    }\n\n    const i = await e.loadBinary(o, a);\n    if (F._isGLBData(i)) return this._fromGLBData(e, t, o, i);\n    const u = await e.loadJSON(o, a);\n    return new F(e, t, o, u);\n  }\n\n  static _isGLBData(e) {\n    if (null == e) return !1;\n    const t = new R(e);\n    return t.remainingBytes() >= 4 && t.readUint32() === M.MAGIC;\n  }\n\n  static async _fromGLBData(e, t, r, s) {\n    const n = await F._parseGLBData(t, s);\n    return new F(e, t, r, n.json, n.binaryData);\n  }\n\n  static async _parseGLBData(e, t) {\n    const r = new R(t);\n    e.assert(r.remainingBytes() >= 12, \"GLB binary data is insufficiently large.\");\n    const s = r.readUint32(),\n          n = r.readUint32(),\n          o = r.readUint32();\n    e.assert(s === M.MAGIC, \"Magic first 4 bytes do not fit to expected GLB value.\"), e.assert(t.byteLength >= o, \"GLB binary data is smaller than header specifies.\"), e.errorUnsupportedIf(2 !== n, \"An unsupported GLB container version was detected. Only version 2 is supported.\");\n    let a,\n        i,\n        u = 0;\n\n    for (; r.remainingBytes() >= 8;) {\n      const t = r.readUint32(),\n            s = r.readUint32();\n      0 === u ? (e.assert(s === M.CHUNK_TYPE_JSON, \"First GLB chunk must be JSON.\"), e.assert(t >= 0, \"No JSON data found.\"), a = await K(r.readUint8Array(t))) : 1 === u ? (e.errorUnsupportedIf(s !== M.CHUNK_TYPE_BIN, \"Second GLB chunk expected to be BIN.\"), i = r.readUint8Array(t)) : e.warnUnsupported(\"More than 2 GLB chunks detected. Skipping.\"), u += 1;\n    }\n\n    return a || e.error(\"No GLB JSON chunk detected.\"), {\n      json: a,\n      binaryData: i\n    };\n  }\n\n  async getBuffer(e, t) {\n    const r = this.json.buffers[e],\n          s = this._errorContext;\n    if (null == r.uri) return s.assert(null != this._glbBuffer, \"GLB buffer not present\"), this._glbBuffer;\n    const n = await this._getBufferLoader(e, t);\n    return s.assert(n.byteLength === r.byteLength, \"Buffer byte lengths should match.\"), n;\n  }\n\n  async _getBufferLoader(e, t) {\n    const r = this._bufferLoaders.get(e);\n\n    if (r) return r;\n\n    const s = this.json.buffers[e].uri,\n          n = this._context.loadBinary(this._resolveUri(s), t).then(e => new Uint8Array(e));\n\n    return this._bufferLoaders.set(e, n), n;\n  }\n\n  async getAccessor(e, t) {\n    const r = this._errorContext;\n    r.errorUnsupportedIf(!this.json.accessors, \"Accessors missing.\");\n    const s = this.json.accessors[e];\n    r.errorUnsupportedIf(null == s?.bufferView, \"Some accessor does not specify a bufferView.\"), r.errorUnsupportedIf(s.type in [v.MAT2, v.MAT3, v.MAT4], `AttributeType ${s.type} is not supported`);\n    const n = this.json.bufferViews[s.bufferView],\n          o = await this.getBuffer(n.buffer, t),\n          a = V[s.type],\n          i = Y[s.componentType],\n          u = a * i,\n          c = n.byteStride || u;\n    return {\n      raw: o.buffer,\n      byteStride: c,\n      byteOffset: o.byteOffset + (n.byteOffset || 0) + (s.byteOffset || 0),\n      entryCount: s.count,\n      isDenselyPacked: c === u,\n      componentCount: a,\n      componentByteSize: i,\n      componentType: s.componentType,\n      min: s.min,\n      max: s.max,\n      normalized: !!s.normalized\n    };\n  }\n\n  async getIndexData(e, t) {\n    if (null == e.indices) return;\n    const r = await this.getAccessor(e.indices, t);\n    if (r.isDenselyPacked) switch (r.componentType) {\n      case j.UNSIGNED_BYTE:\n        return new Uint8Array(r.raw, r.byteOffset, r.entryCount);\n\n      case j.UNSIGNED_SHORT:\n        return new Uint16Array(r.raw, r.byteOffset, r.entryCount);\n\n      case j.UNSIGNED_INT:\n        return new Uint32Array(r.raw, r.byteOffset, r.entryCount);\n    } else switch (r.componentType) {\n      case j.UNSIGNED_BYTE:\n        return E(this._wrapAccessor(T, r));\n\n      case j.UNSIGNED_SHORT:\n        return E(this._wrapAccessor(b, r));\n\n      case j.UNSIGNED_INT:\n        return E(this._wrapAccessor(y, r));\n    }\n  }\n\n  async getPositionData(e, t) {\n    const r = this._errorContext;\n    r.errorUnsupportedIf(null == e.attributes.POSITION, \"No POSITION vertex data found.\");\n    const s = await this.getAccessor(e.attributes.POSITION, t);\n    return r.errorUnsupportedIf(s.componentType !== j.FLOAT, \"Expected type FLOAT for POSITION vertex attribute, but found \" + j[s.componentType]), r.errorUnsupportedIf(3 !== s.componentCount, \"POSITION vertex attribute must have 3 components, but found \" + s.componentCount.toFixed()), this._wrapAccessor(_, s);\n  }\n\n  async getNormalData(e, t) {\n    const r = this._errorContext;\n    r.assert(null != e.attributes.NORMAL, \"No NORMAL vertex data found.\");\n    const s = await this.getAccessor(e.attributes.NORMAL, t);\n    return r.errorUnsupportedIf(s.componentType !== j.FLOAT, \"Expected type FLOAT for NORMAL vertex attribute, but found \" + j[s.componentType]), r.errorUnsupportedIf(3 !== s.componentCount, \"NORMAL vertex attribute must have 3 components, but found \" + s.componentCount.toFixed()), this._wrapAccessor(_, s);\n  }\n\n  async getTangentData(e, t) {\n    const r = this._errorContext;\n    r.assert(null != e.attributes.TANGENT, \"No TANGENT vertex data found.\");\n    const s = await this.getAccessor(e.attributes.TANGENT, t);\n    return r.errorUnsupportedIf(s.componentType !== j.FLOAT, \"Expected type FLOAT for TANGENT vertex attribute, but found \" + j[s.componentType]), r.errorUnsupportedIf(4 !== s.componentCount, \"TANGENT vertex attribute must have 4 components, but found \" + s.componentCount.toFixed()), new x(s.raw, s.byteOffset, s.byteStride, s.byteOffset + s.byteStride * s.entryCount);\n  }\n\n  async getTextureCoordinates(e, t) {\n    const r = this._errorContext;\n    r.assert(null != e.attributes.TEXCOORD_0, \"No TEXCOORD_0 vertex data found.\");\n    const s = await this.getAccessor(e.attributes.TEXCOORD_0, t);\n    return r.errorUnsupportedIf(2 !== s.componentCount, \"TEXCOORD_0 vertex attribute must have 2 components, but found \" + s.componentCount.toFixed()), s.componentType === j.FLOAT ? this._wrapAccessor(w, s) : (r.errorUnsupportedIf(!s.normalized, \"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\"), J(s));\n  }\n\n  async getVertexColors(e, t) {\n    const r = this._errorContext;\n    r.assert(null != e.attributes.COLOR_0, \"No COLOR_0 vertex data found.\");\n    const s = await this.getAccessor(e.attributes.COLOR_0, t);\n\n    if (r.errorUnsupportedIf(4 !== s.componentCount && 3 !== s.componentCount, \"COLOR_0 attribute must have 3 or 4 components, but found \" + s.componentCount.toFixed()), 4 === s.componentCount) {\n      if (s.componentType === j.FLOAT) return this._wrapAccessor(x, s);\n      if (s.componentType === j.UNSIGNED_BYTE) return this._wrapAccessor(O, s);\n      if (s.componentType === j.UNSIGNED_SHORT) return this._wrapAccessor(N, s);\n    } else if (3 === s.componentCount) {\n      if (s.componentType === j.FLOAT) return this._wrapAccessor(_, s);\n      if (s.componentType === j.UNSIGNED_BYTE) return this._wrapAccessor(g, s);\n      if (s.componentType === j.UNSIGNED_SHORT) return this._wrapAccessor(C, s);\n    }\n\n    r.errorUnsupported(\"Unsupported component type for COLOR_0 attribute: \" + j[s.componentType]);\n  }\n\n  hasPositions(e) {\n    return void 0 !== e.attributes.POSITION;\n  }\n\n  hasNormals(e) {\n    return void 0 !== e.attributes.NORMAL;\n  }\n\n  hasVertexColors(e) {\n    return void 0 !== e.attributes.COLOR_0;\n  }\n\n  hasTextureCoordinates(e) {\n    return void 0 !== e.attributes.TEXCOORD_0;\n  }\n\n  hasTangents(e) {\n    return void 0 !== e.attributes.TANGENT;\n  }\n\n  async getMaterial(e, t, r) {\n    let s = e.material ? this._materialCache.get(e.material) : void 0;\n\n    if (!s) {\n      const n = null != e.material ? B(this.json.materials[e.material]) : B(),\n            o = n.pbrMetallicRoughness,\n            a = this.hasVertexColors(e),\n            i = this.getTexture(o.baseColorTexture, t),\n            u = this.getTexture(n.normalTexture, t),\n            c = r ? this.getTexture(n.occlusionTexture, t) : void 0,\n            f = r ? this.getTexture(n.emissiveTexture, t) : void 0,\n            d = r ? this.getTexture(o.metallicRoughnessTexture, t) : void 0,\n            p = null != e.material ? e.material : -1;\n      s = {\n        alphaMode: n.alphaMode,\n        alphaCutoff: n.alphaCutoff,\n        color: o.baseColorFactor,\n        doubleSided: !!n.doubleSided,\n        colorTexture: await i,\n        normalTexture: await u,\n        name: n.name,\n        id: p,\n        occlusionTexture: await c,\n        emissiveTexture: await f,\n        emissiveFactor: n.emissiveFactor,\n        metallicFactor: o.metallicFactor,\n        roughnessFactor: o.roughnessFactor,\n        metallicRoughnessTexture: await d,\n        hasVertexColors: a,\n        ESRI_externalColorMixMode: n.extras.ESRI_externalColorMixMode,\n        colorTextureTransform: o?.baseColorTexture?.extensions?.KHR_texture_transform,\n        normalTextureTransform: n.normalTexture?.extensions?.KHR_texture_transform,\n        occlusionTextureTransform: n.occlusionTexture?.extensions?.KHR_texture_transform,\n        emissiveTextureTransform: n.emissiveTexture?.extensions?.KHR_texture_transform,\n        metallicRoughnessTextureTransform: o?.metallicRoughnessTexture?.extensions?.KHR_texture_transform\n      };\n    }\n\n    return s;\n  }\n\n  async getTexture(t, r) {\n    if (!t) return;\n\n    this._errorContext.errorUnsupportedIf(0 !== (t.texCoord || 0), \"Only TEXCOORD with index 0 is supported.\");\n\n    const s = t.index,\n          n = this._errorContext,\n          o = this.json.textures[s],\n          a = D(null != o.sampler ? this.json.samplers[o.sampler] : {});\n    n.errorUnsupportedIf(null == o.source, \"Source is expected to be defined for a texture.\");\n    const i = this.json.images[o.source],\n          u = await this._loadTextureImageData(s, o, r);\n    return e(this._textureCache, s, () => {\n      const e = e => 33071 === e || 33648 === e || 10497 === e,\n            t = e => (n.error(`Unexpected TextureSampler WrapMode: ${e}. Using default REPEAT(10497).`), 10497);\n\n      return {\n        data: u,\n        wrapS: e(a.wrapS) ? a.wrapS : t(a.wrapS),\n        wrapT: e(a.wrapT) ? a.wrapT : t(a.wrapT),\n        minFilter: a.minFilter,\n        name: i.name,\n        id: s\n      };\n    });\n  }\n\n  getNodeTransform(e) {\n    if (void 0 === e) return k;\n\n    let t = this._nodeTransformCache.get(e);\n\n    if (!t) {\n      const r = this.getNodeTransform(this._getNodeParent(e)),\n            s = this.json.nodes[e];\n      s.matrix ? t = u(p(), r, s.matrix) : s.translation || s.rotation || s.scale ? (t = m(r), s.translation && c(t, t, s.translation), s.rotation && (H[3] = l(H, s.rotation), f(t, t, H[3], H)), s.scale && d(t, t, s.scale)) : t = r, this._nodeTransformCache.set(e, t);\n    }\n\n    return t;\n  }\n\n  _wrapAccessor(e, t) {\n    return new e(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * (t.entryCount - 1) + t.componentByteSize * t.componentCount);\n  }\n\n  _resolveUri(e) {\n    return o(e, this._baseUri);\n  }\n\n  _getNodeParent(e) {\n    return this._nodeParentMap.get(e);\n  }\n\n  _checkVersionSupported() {\n    const e = a.parse(this.json.asset.version, \"glTF\");\n    P.validate(e);\n  }\n\n  _checkRequiredExtensionsSupported() {\n    const e = this.json,\n          t = this._errorContext;\n    e.extensionsRequired && 0 !== e.extensionsRequired.length && t.errorUnsupported(\"gltf loader was not able to load unsupported feature. Required extensions: \" + e.extensionsRequired.join(\", \"));\n  }\n\n  _computeNodeParents() {\n    this.json.nodes.forEach((e, t) => {\n      e.children && e.children.forEach(e => {\n        this._nodeParentMap.set(e, t);\n      });\n    });\n  }\n\n  async _loadTextureImageData(e, t, r) {\n    const s = this._textureLoaders.get(e);\n\n    if (s) return s;\n\n    const n = this._createTextureLoader(t, r);\n\n    return this._textureLoaders.set(e, n), n;\n  }\n\n  async _createTextureLoader(e, t) {\n    const r = this.json.images[e.source];\n    if (r.uri) return this._context.loadImage(this._resolveUri(r.uri), t);\n    const s = this._errorContext;\n    s.errorUnsupportedIf(null == r.bufferView, \"Image bufferView must be defined.\"), s.errorUnsupportedIf(null == r.mimeType, \"Image mimeType must be defined.\");\n    const n = this.json.bufferViews[r.bufferView],\n          o = await this.getBuffer(n.buffer, t);\n    return s.errorUnsupportedIf(null != n.byteStride, \"byteStride not supported for image buffer\"), q(new Uint8Array(o.buffer, o.byteOffset + (n.byteOffset || 0), n.byteLength), r.mimeType);\n  }\n\n  async getLoadedBuffersSize() {\n    if (this._glbBuffer) return this._glbBuffer.byteLength;\n    const e = await t(Array.from(this._bufferLoaders.values())),\n          r = await t(Array.from(this._textureLoaders.values()));\n    return e.reduce((e, t) => e + (t?.byteLength ?? 0), 0) + r.reduce((e, t) => e + (t ? t.width * t.height * 4 : 0), 0);\n  }\n\n}\n\nconst P = new a(2, 0, \"glTF\"),\n      k = i(p(), Math.PI / 2),\n      H = h(),\n      V = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4\n},\n      Y = {\n  [j.BYTE]: 1,\n  [j.UNSIGNED_BYTE]: 1,\n  [j.SHORT]: 2,\n  [j.UNSIGNED_SHORT]: 2,\n  [j.FLOAT]: 4,\n  [j.UNSIGNED_INT]: 4\n};\n\nfunction J(e) {\n  switch (e.componentType) {\n    case j.BYTE:\n      return new A(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n\n    case j.UNSIGNED_BYTE:\n      return new L(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n\n    case j.SHORT:\n      return new I(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n\n    case j.UNSIGNED_SHORT:\n      return new U(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n\n    case j.UNSIGNED_INT:\n      return new S(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n\n    case j.FLOAT:\n      return new w(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n  }\n}\n\nasync function K(e) {\n  return new Promise((t, r) => {\n    const s = new Blob([e]),\n          n = new FileReader();\n    n.onload = () => {\n      const e = n.result;\n      t(JSON.parse(e));\n    }, n.onerror = e => {\n      r(e);\n    }, n.readAsText(s);\n  });\n}\n\nasync function q(e, t) {\n  return new Promise((r, s) => {\n    const n = new Blob([e], {\n      type: t\n    }),\n          o = URL.createObjectURL(n),\n          a = new Image(),\n          i = () => {\n      URL.revokeObjectURL(o), \"decode\" in a ? a.decode().then(() => r(a), () => r(a)).then(c) : (r(a), c());\n    },\n          u = e => {\n      URL.revokeObjectURL(o), s(e), c();\n    },\n          c = () => {\n      a.removeEventListener(\"load\", i), a.removeEventListener(\"error\", u);\n    };\n\n    a.addEventListener(\"load\", i), a.addEventListener(\"error\", u), a.src = o;\n  });\n}\n\nexport { F as GLTFResource };","map":{"version":3,"names":["getOrCreateMapValue","e","eachAlwaysValues","t","isDataProtocol","r","dataComponents","s","dataToArrayBuffer","n","makeAbsolute","o","Version","a","y","i","m","u","v","c","f","k","d","p","b","g","l","h","BufferViewUint32","BufferViewUint16","BufferViewUint8","T","BufferViewVec3f","_","BufferViewVec4f","x","BufferViewVec2f","w","BufferViewVec4u8","O","BufferViewVec4u16","N","BufferViewVec3u8","BufferViewVec3u16","C","BufferViewVec2u32","S","BufferViewVec2u16","U","BufferViewVec2i16","I","BufferViewVec2u8","L","BufferViewVec2i8","A","E","BinaryStreamReader","R","AttributeType","material","B","textureSampler","D","splitURI","G","DataType","j","M","MAGIC","CHUNK_TYPE_JSON","CHUNK_TYPE_BIN","MIN_HEADER_LENGTH","F","constructor","_context","_errorContext","uri","json","_glbBuffer","_bufferLoaders","Map","_textureLoaders","_textureCache","_materialCache","_nodeParentMap","_nodeTransformCache","_baseUri","dirPart","_checkVersionSupported","_checkRequiredExtensionsSupported","errorUnsupportedIf","scenes","meshes","nodes","_computeNodeParents","load","mediaType","JSON","parse","isBase64","atob","data","_isGLBData","_fromGLBData","endsWith","loadJSON","loadBinary","remainingBytes","readUint32","_parseGLBData","binaryData","assert","byteLength","K","readUint8Array","warnUnsupported","error","getBuffer","buffers","_getBufferLoader","get","_resolveUri","then","Uint8Array","set","getAccessor","accessors","bufferView","type","MAT2","MAT3","MAT4","bufferViews","buffer","V","Y","componentType","byteStride","raw","byteOffset","entryCount","count","isDenselyPacked","componentCount","componentByteSize","min","max","normalized","getIndexData","indices","UNSIGNED_BYTE","UNSIGNED_SHORT","Uint16Array","UNSIGNED_INT","Uint32Array","_wrapAccessor","getPositionData","attributes","POSITION","FLOAT","toFixed","getNormalData","NORMAL","getTangentData","TANGENT","getTextureCoordinates","TEXCOORD_0","J","getVertexColors","COLOR_0","errorUnsupported","hasPositions","hasNormals","hasVertexColors","hasTextureCoordinates","hasTangents","getMaterial","materials","pbrMetallicRoughness","getTexture","baseColorTexture","normalTexture","occlusionTexture","emissiveTexture","metallicRoughnessTexture","alphaMode","alphaCutoff","color","baseColorFactor","doubleSided","colorTexture","name","id","emissiveFactor","metallicFactor","roughnessFactor","ESRI_externalColorMixMode","extras","colorTextureTransform","extensions","KHR_texture_transform","normalTextureTransform","occlusionTextureTransform","emissiveTextureTransform","metallicRoughnessTextureTransform","texCoord","index","textures","sampler","samplers","source","images","_loadTextureImageData","wrapS","wrapT","minFilter","getNodeTransform","_getNodeParent","matrix","translation","rotation","scale","H","asset","version","P","validate","extensionsRequired","length","join","forEach","children","_createTextureLoader","loadImage","mimeType","q","getLoadedBuffersSize","Array","from","values","reduce","width","height","Math","PI","SCALAR","VEC2","VEC3","VEC4","BYTE","SHORT","Promise","Blob","FileReader","onload","result","onerror","readAsText","URL","createObjectURL","Image","revokeObjectURL","decode","removeEventListener","addEventListener","src","GLTFResource"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/glTF/internal/Resource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{getOrCreateMapValue as e}from\"../../../../core/MapUtils.js\";import{eachAlwaysValues as t}from\"../../../../core/promiseUtils.js\";import{isDataProtocol as r,dataComponents as s,dataToArrayBuffer as n,makeAbsolute as o}from\"../../../../core/urlUtils.js\";import{Version as a}from\"../../../../core/Version.js\";import{y as i,m as u,v as c,e as f,k as d}from\"../../../../chunks/mat4.js\";import{c as p,b as m}from\"../../../../chunks/mat4f64.js\";import{g as l}from\"../../../../chunks/quat.js\";import{a as h}from\"../../../../chunks/quatf64.js\";import{BufferViewUint32 as y,BufferViewUint16 as b,BufferViewUint8 as T,BufferViewVec3f as _,BufferViewVec4f as x,BufferViewVec2f as w,BufferViewVec4u8 as O,BufferViewVec4u16 as N,BufferViewVec3u8 as g,BufferViewVec3u16 as C,BufferViewVec2u32 as S,BufferViewVec2u16 as U,BufferViewVec2i16 as I,BufferViewVec2u8 as L,BufferViewVec2i8 as A}from\"../../../../geometry/support/buffer/BufferView.js\";import{m as E}from\"../../../../chunks/scalar.js\";import{BinaryStreamReader as R}from\"./BinaryStreamReader.js\";import{AttributeType as v}from\"./enums.js\";import{material as B,textureSampler as D}from\"./fillDefaults.js\";import{splitURI as G}from\"./pathUtils.js\";import{DataType as j}from\"../../../webgl/enums.js\";const M={MAGIC:1179937895,CHUNK_TYPE_JSON:1313821514,CHUNK_TYPE_BIN:5130562,MIN_HEADER_LENGTH:20};class F{constructor(e,t,r,s,n){this._context=e,this._errorContext=t,this.uri=r,this.json=s,this._glbBuffer=n,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._baseUri=G(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),t.errorUnsupportedIf(null==s.scenes,\"Scenes must be defined.\"),t.errorUnsupportedIf(null==s.meshes,\"Meshes must be defined\"),t.errorUnsupportedIf(null==s.nodes,\"Nodes must be defined.\"),this._computeNodeParents()}static async load(e,t,o,a){if(r(o)){const r=s(o);if(r&&\"model/gltf-binary\"!==r.mediaType)try{const s=JSON.parse(r.isBase64?atob(r.data):r.data);return new F(e,t,o,s)}catch{}const a=n(o);if(F._isGLBData(a))return this._fromGLBData(e,t,o,a)}if(o.endsWith(\".gltf\")){const r=await e.loadJSON(o,a);return new F(e,t,o,r)}const i=await e.loadBinary(o,a);if(F._isGLBData(i))return this._fromGLBData(e,t,o,i);const u=await e.loadJSON(o,a);return new F(e,t,o,u)}static _isGLBData(e){if(null==e)return!1;const t=new R(e);return t.remainingBytes()>=4&&t.readUint32()===M.MAGIC}static async _fromGLBData(e,t,r,s){const n=await F._parseGLBData(t,s);return new F(e,t,r,n.json,n.binaryData)}static async _parseGLBData(e,t){const r=new R(t);e.assert(r.remainingBytes()>=12,\"GLB binary data is insufficiently large.\");const s=r.readUint32(),n=r.readUint32(),o=r.readUint32();e.assert(s===M.MAGIC,\"Magic first 4 bytes do not fit to expected GLB value.\"),e.assert(t.byteLength>=o,\"GLB binary data is smaller than header specifies.\"),e.errorUnsupportedIf(2!==n,\"An unsupported GLB container version was detected. Only version 2 is supported.\");let a,i,u=0;for(;r.remainingBytes()>=8;){const t=r.readUint32(),s=r.readUint32();0===u?(e.assert(s===M.CHUNK_TYPE_JSON,\"First GLB chunk must be JSON.\"),e.assert(t>=0,\"No JSON data found.\"),a=await K(r.readUint8Array(t))):1===u?(e.errorUnsupportedIf(s!==M.CHUNK_TYPE_BIN,\"Second GLB chunk expected to be BIN.\"),i=r.readUint8Array(t)):e.warnUnsupported(\"More than 2 GLB chunks detected. Skipping.\"),u+=1}return a||e.error(\"No GLB JSON chunk detected.\"),{json:a,binaryData:i}}async getBuffer(e,t){const r=this.json.buffers[e],s=this._errorContext;if(null==r.uri)return s.assert(null!=this._glbBuffer,\"GLB buffer not present\"),this._glbBuffer;const n=await this._getBufferLoader(e,t);return s.assert(n.byteLength===r.byteLength,\"Buffer byte lengths should match.\"),n}async _getBufferLoader(e,t){const r=this._bufferLoaders.get(e);if(r)return r;const s=this.json.buffers[e].uri,n=this._context.loadBinary(this._resolveUri(s),t).then((e=>new Uint8Array(e)));return this._bufferLoaders.set(e,n),n}async getAccessor(e,t){const r=this._errorContext;r.errorUnsupportedIf(!this.json.accessors,\"Accessors missing.\");const s=this.json.accessors[e];r.errorUnsupportedIf(null==s?.bufferView,\"Some accessor does not specify a bufferView.\"),r.errorUnsupportedIf(s.type in[v.MAT2,v.MAT3,v.MAT4],`AttributeType ${s.type} is not supported`);const n=this.json.bufferViews[s.bufferView],o=await this.getBuffer(n.buffer,t),a=V[s.type],i=Y[s.componentType],u=a*i,c=n.byteStride||u;return{raw:o.buffer,byteStride:c,byteOffset:o.byteOffset+(n.byteOffset||0)+(s.byteOffset||0),entryCount:s.count,isDenselyPacked:c===u,componentCount:a,componentByteSize:i,componentType:s.componentType,min:s.min,max:s.max,normalized:!!s.normalized}}async getIndexData(e,t){if(null==e.indices)return;const r=await this.getAccessor(e.indices,t);if(r.isDenselyPacked)switch(r.componentType){case j.UNSIGNED_BYTE:return new Uint8Array(r.raw,r.byteOffset,r.entryCount);case j.UNSIGNED_SHORT:return new Uint16Array(r.raw,r.byteOffset,r.entryCount);case j.UNSIGNED_INT:return new Uint32Array(r.raw,r.byteOffset,r.entryCount)}else switch(r.componentType){case j.UNSIGNED_BYTE:return E(this._wrapAccessor(T,r));case j.UNSIGNED_SHORT:return E(this._wrapAccessor(b,r));case j.UNSIGNED_INT:return E(this._wrapAccessor(y,r))}}async getPositionData(e,t){const r=this._errorContext;r.errorUnsupportedIf(null==e.attributes.POSITION,\"No POSITION vertex data found.\");const s=await this.getAccessor(e.attributes.POSITION,t);return r.errorUnsupportedIf(s.componentType!==j.FLOAT,\"Expected type FLOAT for POSITION vertex attribute, but found \"+j[s.componentType]),r.errorUnsupportedIf(3!==s.componentCount,\"POSITION vertex attribute must have 3 components, but found \"+s.componentCount.toFixed()),this._wrapAccessor(_,s)}async getNormalData(e,t){const r=this._errorContext;r.assert(null!=e.attributes.NORMAL,\"No NORMAL vertex data found.\");const s=await this.getAccessor(e.attributes.NORMAL,t);return r.errorUnsupportedIf(s.componentType!==j.FLOAT,\"Expected type FLOAT for NORMAL vertex attribute, but found \"+j[s.componentType]),r.errorUnsupportedIf(3!==s.componentCount,\"NORMAL vertex attribute must have 3 components, but found \"+s.componentCount.toFixed()),this._wrapAccessor(_,s)}async getTangentData(e,t){const r=this._errorContext;r.assert(null!=e.attributes.TANGENT,\"No TANGENT vertex data found.\");const s=await this.getAccessor(e.attributes.TANGENT,t);return r.errorUnsupportedIf(s.componentType!==j.FLOAT,\"Expected type FLOAT for TANGENT vertex attribute, but found \"+j[s.componentType]),r.errorUnsupportedIf(4!==s.componentCount,\"TANGENT vertex attribute must have 4 components, but found \"+s.componentCount.toFixed()),new x(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount)}async getTextureCoordinates(e,t){const r=this._errorContext;r.assert(null!=e.attributes.TEXCOORD_0,\"No TEXCOORD_0 vertex data found.\");const s=await this.getAccessor(e.attributes.TEXCOORD_0,t);return r.errorUnsupportedIf(2!==s.componentCount,\"TEXCOORD_0 vertex attribute must have 2 components, but found \"+s.componentCount.toFixed()),s.componentType===j.FLOAT?this._wrapAccessor(w,s):(r.errorUnsupportedIf(!s.normalized,\"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\"),J(s))}async getVertexColors(e,t){const r=this._errorContext;r.assert(null!=e.attributes.COLOR_0,\"No COLOR_0 vertex data found.\");const s=await this.getAccessor(e.attributes.COLOR_0,t);if(r.errorUnsupportedIf(4!==s.componentCount&&3!==s.componentCount,\"COLOR_0 attribute must have 3 or 4 components, but found \"+s.componentCount.toFixed()),4===s.componentCount){if(s.componentType===j.FLOAT)return this._wrapAccessor(x,s);if(s.componentType===j.UNSIGNED_BYTE)return this._wrapAccessor(O,s);if(s.componentType===j.UNSIGNED_SHORT)return this._wrapAccessor(N,s)}else if(3===s.componentCount){if(s.componentType===j.FLOAT)return this._wrapAccessor(_,s);if(s.componentType===j.UNSIGNED_BYTE)return this._wrapAccessor(g,s);if(s.componentType===j.UNSIGNED_SHORT)return this._wrapAccessor(C,s)}r.errorUnsupported(\"Unsupported component type for COLOR_0 attribute: \"+j[s.componentType])}hasPositions(e){return void 0!==e.attributes.POSITION}hasNormals(e){return void 0!==e.attributes.NORMAL}hasVertexColors(e){return void 0!==e.attributes.COLOR_0}hasTextureCoordinates(e){return void 0!==e.attributes.TEXCOORD_0}hasTangents(e){return void 0!==e.attributes.TANGENT}async getMaterial(e,t,r){let s=e.material?this._materialCache.get(e.material):void 0;if(!s){const n=null!=e.material?B(this.json.materials[e.material]):B(),o=n.pbrMetallicRoughness,a=this.hasVertexColors(e),i=this.getTexture(o.baseColorTexture,t),u=this.getTexture(n.normalTexture,t),c=r?this.getTexture(n.occlusionTexture,t):void 0,f=r?this.getTexture(n.emissiveTexture,t):void 0,d=r?this.getTexture(o.metallicRoughnessTexture,t):void 0,p=null!=e.material?e.material:-1;s={alphaMode:n.alphaMode,alphaCutoff:n.alphaCutoff,color:o.baseColorFactor,doubleSided:!!n.doubleSided,colorTexture:await i,normalTexture:await u,name:n.name,id:p,occlusionTexture:await c,emissiveTexture:await f,emissiveFactor:n.emissiveFactor,metallicFactor:o.metallicFactor,roughnessFactor:o.roughnessFactor,metallicRoughnessTexture:await d,hasVertexColors:a,ESRI_externalColorMixMode:n.extras.ESRI_externalColorMixMode,colorTextureTransform:o?.baseColorTexture?.extensions?.KHR_texture_transform,normalTextureTransform:n.normalTexture?.extensions?.KHR_texture_transform,occlusionTextureTransform:n.occlusionTexture?.extensions?.KHR_texture_transform,emissiveTextureTransform:n.emissiveTexture?.extensions?.KHR_texture_transform,metallicRoughnessTextureTransform:o?.metallicRoughnessTexture?.extensions?.KHR_texture_transform}}return s}async getTexture(t,r){if(!t)return;this._errorContext.errorUnsupportedIf(0!==(t.texCoord||0),\"Only TEXCOORD with index 0 is supported.\");const s=t.index,n=this._errorContext,o=this.json.textures[s],a=D(null!=o.sampler?this.json.samplers[o.sampler]:{});n.errorUnsupportedIf(null==o.source,\"Source is expected to be defined for a texture.\");const i=this.json.images[o.source],u=await this._loadTextureImageData(s,o,r);return e(this._textureCache,s,(()=>{const e=e=>33071===e||33648===e||10497===e,t=e=>(n.error(`Unexpected TextureSampler WrapMode: ${e}. Using default REPEAT(10497).`),10497);return{data:u,wrapS:e(a.wrapS)?a.wrapS:t(a.wrapS),wrapT:e(a.wrapT)?a.wrapT:t(a.wrapT),minFilter:a.minFilter,name:i.name,id:s}}))}getNodeTransform(e){if(void 0===e)return k;let t=this._nodeTransformCache.get(e);if(!t){const r=this.getNodeTransform(this._getNodeParent(e)),s=this.json.nodes[e];s.matrix?t=u(p(),r,s.matrix):s.translation||s.rotation||s.scale?(t=m(r),s.translation&&c(t,t,s.translation),s.rotation&&(H[3]=l(H,s.rotation),f(t,t,H[3],H)),s.scale&&d(t,t,s.scale)):t=r,this._nodeTransformCache.set(e,t)}return t}_wrapAccessor(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}_resolveUri(e){return o(e,this._baseUri)}_getNodeParent(e){return this._nodeParentMap.get(e)}_checkVersionSupported(){const e=a.parse(this.json.asset.version,\"glTF\");P.validate(e)}_checkRequiredExtensionsSupported(){const e=this.json,t=this._errorContext;e.extensionsRequired&&0!==e.extensionsRequired.length&&t.errorUnsupported(\"gltf loader was not able to load unsupported feature. Required extensions: \"+e.extensionsRequired.join(\", \"))}_computeNodeParents(){this.json.nodes.forEach(((e,t)=>{e.children&&e.children.forEach((e=>{this._nodeParentMap.set(e,t)}))}))}async _loadTextureImageData(e,t,r){const s=this._textureLoaders.get(e);if(s)return s;const n=this._createTextureLoader(t,r);return this._textureLoaders.set(e,n),n}async _createTextureLoader(e,t){const r=this.json.images[e.source];if(r.uri)return this._context.loadImage(this._resolveUri(r.uri),t);const s=this._errorContext;s.errorUnsupportedIf(null==r.bufferView,\"Image bufferView must be defined.\"),s.errorUnsupportedIf(null==r.mimeType,\"Image mimeType must be defined.\");const n=this.json.bufferViews[r.bufferView],o=await this.getBuffer(n.buffer,t);return s.errorUnsupportedIf(null!=n.byteStride,\"byteStride not supported for image buffer\"),q(new Uint8Array(o.buffer,o.byteOffset+(n.byteOffset||0),n.byteLength),r.mimeType)}async getLoadedBuffersSize(){if(this._glbBuffer)return this._glbBuffer.byteLength;const e=await t(Array.from(this._bufferLoaders.values())),r=await t(Array.from(this._textureLoaders.values()));return e.reduce(((e,t)=>e+(t?.byteLength??0)),0)+r.reduce(((e,t)=>e+(t?t.width*t.height*4:0)),0)}}const P=new a(2,0,\"glTF\"),k=i(p(),Math.PI/2),H=h(),V={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},Y={[j.BYTE]:1,[j.UNSIGNED_BYTE]:1,[j.SHORT]:2,[j.UNSIGNED_SHORT]:2,[j.FLOAT]:4,[j.UNSIGNED_INT]:4};function J(e){switch(e.componentType){case j.BYTE:return new A(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case j.UNSIGNED_BYTE:return new L(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case j.SHORT:return new I(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case j.UNSIGNED_SHORT:return new U(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case j.UNSIGNED_INT:return new S(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case j.FLOAT:return new w(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)}}async function K(e){return new Promise(((t,r)=>{const s=new Blob([e]),n=new FileReader;n.onload=()=>{const e=n.result;t(JSON.parse(e))},n.onerror=e=>{r(e)},n.readAsText(s)}))}async function q(e,t){return new Promise(((r,s)=>{const n=new Blob([e],{type:t}),o=URL.createObjectURL(n),a=new Image,i=()=>{URL.revokeObjectURL(o),\"decode\"in a?a.decode().then((()=>r(a)),(()=>r(a))).then(c):(r(a),c())},u=e=>{URL.revokeObjectURL(o),s(e),c()},c=()=>{a.removeEventListener(\"load\",i),a.removeEventListener(\"error\",u)};a.addEventListener(\"load\",i),a.addEventListener(\"error\",u),a.src=o}))}export{F as GLTFResource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}