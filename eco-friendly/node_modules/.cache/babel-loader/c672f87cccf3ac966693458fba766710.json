{"ast":null,"code":"import * as echarts from 'echarts';\n\nrequire('echarts/extension/bmap/bmap');\n\nfunction isSupportCanvas() {\n  const elem = document.createElement('canvas');\n  return !!(elem.getContext && elem.getContext('2d'));\n}\n\nexport default {\n  name: \"TrackingOfPollutants\",\n\n  mounted() {\n    this.loadScript();\n    this.creatMap();\n    this.drawHeat();\n  },\n\n  methods: {\n    loadScript() {\n      var script = document.createElement(\"script\");\n      script.src = \"https://api.map.baidu.com/api?v=2.0&ak=Tz3pnHtelKyQWPsW0B4Wh22Zib68w8U7&callback=initialize\";\n      document.body.appendChild(script);\n    },\n\n    //是否显示热力图\n    openHeatmap() {\n      this.mapObj.heatmapOverlay.show();\n    },\n\n    closeHeatmap() {\n      this.mapObj.heatmapOverlay.hide();\n    },\n\n    //创建百度地图\n    creatMap() {\n      this.map = new BMap.Map('home');\n      const point = new BMap.Point(118.138979, 24.497246);\n      this.map.centerAndZoom(point, 15); // 初始化地图，设置中心点坐标和地图级别\n\n      this.map.enableScrollWheelZoom(); // 允许滚轮缩放\n\n      const points = [];\n\n      for (let i = 0; i < 600; i++) {\n        points.push({\n          lng: 118.138989 + 0.001 * Math.floor(Math.random() * 10 + 1),\n          lat: 24.497246 + 0.001 * Math.floor(Math.random() * 10 + 1),\n          count: Math.floor(Math.random() * 10 + 1)\n        });\n      }\n\n      if (!isSupportCanvas()) {\n        alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~');\n      } //参数说明如下:\n\n      /* visible 热力图是否显示,默认为true\r\n       * opacity 热力的透明度,1-100\r\n       * radius 势力图的每个点的半径大小\r\n       * gradient  {JSON} 热力图的渐变区间 . gradient如下所示\r\n       * {\r\n        .2:'rgb(0, 255, 255)',\r\n        .5:'rgb(0, 110, 255)',\r\n        .8:'rgb(100, 0, 255)'\r\n      }\r\n      其中 key 表示插值的位置, 0~1.\r\n          value 为颜色值.\r\n       */\n\n\n      this.mapObj.heatmapOverlay = new BMapLib.HeatmapOverlay({\n        radius: 20\n      });\n      this.map.addOverlay(this.mapObj.heatmapOverlay);\n      this.mapObj.heatmapOverlay.setDataSet({\n        data: points,\n        max: 100\n      });\n      this.closeHeatmap();\n\n      function setGradient() {\n        /*格式如下所示:\r\n        {\r\n          0:'rgb(102, 255, 0)',\r\n          .5:'rgb(255, 170, 0)',\r\n          1:'rgb(255, 0, 0)'\r\n        }*/\n        const gradient = {};\n        let colors = document.querySelectorAll('input[type=\\'color\\']');\n        colors = [].slice.call(colors, 0);\n        colors.forEach(function (ele) {\n          gradient[ele.getAttribute('data-key')] = ele.value;\n        });\n        this.heatmapOverlay.setOptions({\n          gradient: gradient\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAQA;;AACAA;;AAEA;EACA;EACA;AACA;;AAEA;EACAC,4BADA;;EAEAC;IACA;IACA;IACA;EACA,CANA;;EAOAC;IACAC;MACA;MACAC;MACAC;IACA,CALA;;IAMA;IACAC;MACA;IACA,CATA;;IAUAC;MACA;IACA,CAZA;;IAaA;IACAC;MACA;MAEA;MACA,kCAJA,CAIA;;MACA,iCALA,CAKA;;MACA;;MACA;QACAC,YACA;UACAC,4DADA;UAEAC,2DAFA;UAGAC;QAHA,CADA;MAOA;;MACA;QACAC,MACA,0CADA;MAGA,CApBA,CAqBA;;MACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;MACA;QAAAC;MAAA;MACA;MACA;QAAAC;QAAAC;MAAA;MACA;;MAEA;QACA;AACA;AACA;AACA;AACA;AACA;QACA;QACA;QACAC;QACAA;UACAC;QACA,CAFA;QAGA;UAAAA;QAAA;MACA;IAEA;;EArEA;AAPA","names":["require","name","mounted","methods","loadScript","script","document","openHeatmap","closeHeatmap","creatMap","points","lng","lat","count","alert","radius","data","max","colors","gradient"],"sourceRoot":"src/views","sources":["TrackingOfPollutants.vue"],"sourcesContent":["<template>\r\n  <div class=\"home\">\r\n    <div ref=\"map\" style=\"width: 100%;height: 100%\"></div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from 'echarts';\r\nrequire('echarts/extension/bmap/bmap')\r\n\r\nfunction isSupportCanvas() {\r\n  const elem = document.createElement('canvas');\r\n  return !!(elem.getContext && elem.getContext('2d'));\r\n}\r\n\r\nexport default {\r\n  name: \"TrackingOfPollutants\",\r\n  mounted() {\r\n    this.loadScript();\r\n    this.creatMap();\r\n    this.drawHeat()\r\n  },\r\n  methods: {\r\n    loadScript() {\r\n      var script = document.createElement(\"script\");\r\n      script.src = \"https://api.map.baidu.com/api?v=2.0&ak=Tz3pnHtelKyQWPsW0B4Wh22Zib68w8U7&callback=initialize\";\r\n      document.body.appendChild(script);\r\n    },\r\n    //是否显示热力图\r\n    openHeatmap() {\r\n      this.mapObj.heatmapOverlay.show();\r\n    },\r\n    closeHeatmap() {\r\n      this.mapObj.heatmapOverlay.hide();\r\n    },\r\n    //创建百度地图\r\n    creatMap() {\r\n      this.map = new BMap.Map('home');\r\n\r\n      const point = new BMap.Point(118.138979, 24.497246);\r\n      this.map.centerAndZoom(point, 15); // 初始化地图，设置中心点坐标和地图级别\r\n      this.map.enableScrollWheelZoom(); // 允许滚轮缩放\r\n      const points = [];\r\n      for (let i = 0; i < 600; i++) {\r\n        points.push(\r\n            {\r\n              lng: 118.138989 + 0.001 * Math.floor(Math.random() * 10 + 1),\r\n              lat: 24.497246 + 0.001 * Math.floor(Math.random() * 10 + 1),\r\n              count: Math.floor(Math.random() * 10 + 1),\r\n            }\r\n        );\r\n      }\r\n      if (!isSupportCanvas()) {\r\n        alert(\r\n            '热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~'\r\n        );\r\n      }\r\n//参数说明如下:\r\n      /* visible 热力图是否显示,默认为true\r\n       * opacity 热力的透明度,1-100\r\n       * radius 势力图的每个点的半径大小\r\n       * gradient  {JSON} 热力图的渐变区间 . gradient如下所示\r\n       * {\r\n        .2:'rgb(0, 255, 255)',\r\n        .5:'rgb(0, 110, 255)',\r\n        .8:'rgb(100, 0, 255)'\r\n      }\r\n      其中 key 表示插值的位置, 0~1.\r\n          value 为颜色值.\r\n       */\r\n      this.mapObj.heatmapOverlay = new BMapLib.HeatmapOverlay({radius: 20});\r\n      this.map.addOverlay(this.mapObj.heatmapOverlay);\r\n      this.mapObj.heatmapOverlay.setDataSet({data: points, max: 100});\r\n      this.closeHeatmap();\r\n\r\n      function setGradient() {\r\n        /*格式如下所示:\r\n      {\r\n          0:'rgb(102, 255, 0)',\r\n          .5:'rgb(255, 170, 0)',\r\n          1:'rgb(255, 0, 0)'\r\n      }*/\r\n        const gradient = {};\r\n        let colors = document.querySelectorAll('input[type=\\'color\\']');\r\n        colors = [].slice.call(colors, 0);\r\n        colors.forEach(function (ele) {\r\n          gradient[ele.getAttribute('data-key')] = ele.value;\r\n        });\r\n        this.heatmapOverlay.setOptions({gradient: gradient});\r\n      }\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}