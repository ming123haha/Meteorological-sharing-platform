{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as t } from \"../../../../../../core/maybe.js\";\nimport { pt2px as e } from \"../../../../../../core/screenUtils.js\";\nimport { premultiplyAlphaRGBA as i } from \"../../color.js\";\nimport { BITSET_GENERIC_LOCK_COLOR as s, BITSET_LINE_SCALE_DASH as r, BITSET_GENERIC_CONSIDER_ALPHA_ONLY as o, SPRITE_PADDING as a, MIN_MAX_ZOOM_PRECISION_FACTOR as l } from \"../../definitions.js\";\nimport { i1616to32 as h } from \"../../number.js\";\nimport { LineMaterialKey as n } from \"../../materialKey/MaterialKey.js\";\nimport { isFunction as c, getLimitCosine as m, getMinMaxZoom as p } from \"./util.js\";\nimport _ from \"./WGLBaseLineTemplate.js\";\nimport f from \"./WGLDynamicMeshTemplate.js\";\nimport { ok as d } from \"../../util/Result.js\";\n\nclass y extends _(f) {\n  constructor(a, n, p) {\n    super(a), this._minMaxZoom = h(Math.round(n * l), Math.round(p * l)), this._cimLineLayer = a;\n    let _ = 0;\n    c(a.width) || (_ = .5 * e(a.width));\n\n    const f = (t, i, s) => c(a.width) ? .5 * e(a.width(t, i, s)) : _;\n\n    this._dynamicPropertyMap.set(\"_halfWidth\", f), c(a.cap) ? this._dynamicPropertyMap.set(\"_capType\", a.cap) : this._capType = a.cap, c(a.join) ? this._dynamicPropertyMap.set(\"_joinType\", a.join) : this._joinType = a.join;\n    const d = a.color;\n\n    if (c(d)) {\n      const t = (t, e, s) => i(d(t, e, s));\n\n      this._dynamicPropertyMap.set(\"_fillColor\", t);\n    } else this._fillColor = d && i(d) || 0;\n\n    const y = a.miterLimit;\n\n    if (c(y)) {\n      const t = (t, e, i) => m(y(t, e, i));\n\n      this._dynamicPropertyMap.set(\"_miterLimitCosine\", t);\n    } else this._miterLimitCosine = m(y);\n\n    if (t(a.effects)) {\n      const t = a.effects;\n      c(t) ? this._dynamicPropertyMap.set(\"_effects\", t) : this._effects = t;\n    }\n\n    this._scaleFactor = a.scaleFactor || 1, this._isDashed = null != a.dashTemplate;\n    const P = a.colorLocked ? s : 0,\n          u = a.scaleDash ? r : 0,\n          j = a.sampleAlphaOnly ? o : 0;\n    this.tessellationProperties._bitset = P | u | j, this._materialKey = a.materialKey, this._initializeTessellator(!0);\n  }\n\n  static fromCIMLine(t, e) {\n    const [i, s] = p(t.scaleInfo, e);\n    return new y(t, i, s);\n  }\n\n  bindFeature(t, e, i) {\n    const s = t.readLegacyFeature();\n    this._dynamicPropertyMap.forEach((t, r) => {\n      this[r] = t(s, e, i);\n    }), this._halfWidth *= this._scaleFactor;\n    const r = this._materialCache,\n          o = (0, this._cimLineLayer.materialHash)(s, e, i),\n          l = r.get(o);\n    let c = null;\n\n    if (l && d(l.spriteMosaicItem) && (c = l.spriteMosaicItem), c) {\n      this._hasPattern = !0;\n      const {\n        rect: t,\n        width: e,\n        height: i\n      } = c,\n            s = t.x + a,\n            r = t.y + a,\n            o = s + e,\n            l = r + i;\n      this.tessellationProperties._tl = h(s, r), this.tessellationProperties._br = h(o, l);\n    } else this._hasPattern = !1, this.tessellationProperties._tl = 0, this.tessellationProperties._br = 0;\n\n    this.tessellationProperties._fillColor = this._fillColor, this.tessellationProperties._halfWidth = this._halfWidth, this.tessellationProperties.offset = 0, this.tessellationProperties._halfReferenceWidth = this.tessellationProperties._halfWidth;\n    const m = n.load(this._materialKey);\n    c && (m.sdf = c.sdf, m.pattern = !0, m.textureBinding = c.textureBinding), this._materialKey = m.data;\n  }\n\n}\n\nexport { y as default };","map":{"version":3,"names":["isSome","t","pt2px","e","premultiplyAlphaRGBA","i","BITSET_GENERIC_LOCK_COLOR","s","BITSET_LINE_SCALE_DASH","r","BITSET_GENERIC_CONSIDER_ALPHA_ONLY","o","SPRITE_PADDING","a","MIN_MAX_ZOOM_PRECISION_FACTOR","l","i1616to32","h","LineMaterialKey","n","isFunction","c","getLimitCosine","m","getMinMaxZoom","p","_","f","ok","d","y","constructor","_minMaxZoom","Math","round","_cimLineLayer","width","_dynamicPropertyMap","set","cap","_capType","join","_joinType","color","_fillColor","miterLimit","_miterLimitCosine","effects","_effects","_scaleFactor","scaleFactor","_isDashed","dashTemplate","P","colorLocked","u","scaleDash","j","sampleAlphaOnly","tessellationProperties","_bitset","_materialKey","materialKey","_initializeTessellator","fromCIMLine","scaleInfo","bindFeature","readLegacyFeature","forEach","_halfWidth","_materialCache","materialHash","get","spriteMosaicItem","_hasPattern","rect","height","x","_tl","_br","offset","_halfReferenceWidth","load","sdf","pattern","textureBinding","data","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../../../../core/maybe.js\";import{pt2px as e}from\"../../../../../../core/screenUtils.js\";import{premultiplyAlphaRGBA as i}from\"../../color.js\";import{BITSET_GENERIC_LOCK_COLOR as s,BITSET_LINE_SCALE_DASH as r,BITSET_GENERIC_CONSIDER_ALPHA_ONLY as o,SPRITE_PADDING as a,MIN_MAX_ZOOM_PRECISION_FACTOR as l}from\"../../definitions.js\";import{i1616to32 as h}from\"../../number.js\";import{LineMaterialKey as n}from\"../../materialKey/MaterialKey.js\";import{isFunction as c,getLimitCosine as m,getMinMaxZoom as p}from\"./util.js\";import _ from\"./WGLBaseLineTemplate.js\";import f from\"./WGLDynamicMeshTemplate.js\";import{ok as d}from\"../../util/Result.js\";class y extends(_(f)){constructor(a,n,p){super(a),this._minMaxZoom=h(Math.round(n*l),Math.round(p*l)),this._cimLineLayer=a;let _=0;c(a.width)||(_=.5*e(a.width));const f=(t,i,s)=>c(a.width)?.5*e(a.width(t,i,s)):_;this._dynamicPropertyMap.set(\"_halfWidth\",f),c(a.cap)?this._dynamicPropertyMap.set(\"_capType\",a.cap):this._capType=a.cap,c(a.join)?this._dynamicPropertyMap.set(\"_joinType\",a.join):this._joinType=a.join;const d=a.color;if(c(d)){const t=(t,e,s)=>i(d(t,e,s));this._dynamicPropertyMap.set(\"_fillColor\",t)}else this._fillColor=d&&i(d)||0;const y=a.miterLimit;if(c(y)){const t=(t,e,i)=>m(y(t,e,i));this._dynamicPropertyMap.set(\"_miterLimitCosine\",t)}else this._miterLimitCosine=m(y);if(t(a.effects)){const t=a.effects;c(t)?this._dynamicPropertyMap.set(\"_effects\",t):this._effects=t}this._scaleFactor=a.scaleFactor||1,this._isDashed=null!=a.dashTemplate;const P=a.colorLocked?s:0,u=a.scaleDash?r:0,j=a.sampleAlphaOnly?o:0;this.tessellationProperties._bitset=P|u|j,this._materialKey=a.materialKey,this._initializeTessellator(!0)}static fromCIMLine(t,e){const[i,s]=p(t.scaleInfo,e);return new y(t,i,s)}bindFeature(t,e,i){const s=t.readLegacyFeature();this._dynamicPropertyMap.forEach(((t,r)=>{this[r]=t(s,e,i)})),this._halfWidth*=this._scaleFactor;const r=this._materialCache,o=(0,this._cimLineLayer.materialHash)(s,e,i),l=r.get(o);let c=null;if(l&&d(l.spriteMosaicItem)&&(c=l.spriteMosaicItem),c){this._hasPattern=!0;const{rect:t,width:e,height:i}=c,s=t.x+a,r=t.y+a,o=s+e,l=r+i;this.tessellationProperties._tl=h(s,r),this.tessellationProperties._br=h(o,l)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const m=n.load(this._materialKey);c&&(m.sdf=c.sdf,m.pattern=!0,m.textureBinding=c.textureBinding),this._materialKey=m.data}}export{y as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}