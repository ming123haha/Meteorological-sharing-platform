{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { createResolver as e } from \"../../../core/promiseUtils.js\";\nimport t from \"../../../core/Queue.js\";\nimport { AttributeStoreView as r } from \"./webgl/AttributeStoreView.js\";\nimport s from \"./webgl/TileContainer.js\";\nimport { WGLRendererInfo as i } from \"./webgl/WGLRendererInfo.js\";\n\nclass o extends s {\n  constructor(e) {\n    super(e), this._rendererInfo = new i(), this._materialItemsRequestQueue = new t(), this.attributeView = new r(() => this.onAttributeStoreUpdate());\n  }\n\n  destroy() {\n    this.children.forEach(e => e.destroy()), this.removeAllChildren(), this.attributeView.destroy(), this._materialItemsRequestQueue.clear();\n  }\n\n  setRendererInfo(e, t, r) {\n    this._rendererInfo.setInfo(e, t, r), this.requestRender();\n  }\n\n  async getMaterialItems(t, r) {\n    if (!t || 0 === t.length) return null;\n    const s = e();\n    return this._materialItemsRequestQueue.push({\n      items: t,\n      abortOptions: r,\n      resolver: s\n    }), this.requestRender(), s.promise;\n  }\n\n  doRender(e) {\n    if (e.context.capabilities.enable(\"textureFloat\"), e.context.capabilities.enable(\"vao\"), this._materialItemsRequestQueue.length > 0) {\n      let t = this._materialItemsRequestQueue.pop();\n\n      for (; t;) this._processMaterialItemRequest(e, t), t = this._materialItemsRequestQueue.pop();\n    }\n\n    super.doRender(e);\n  }\n\n  renderChildren(e) {\n    for (const t of this.children) t.commit(e);\n\n    this._rendererInfo.update(e.state), super.renderChildren(e);\n  }\n\n  updateTransforms(e) {\n    if (this.children.some(e => e.hasData)) for (const t of this.children) t.setTransform(e);\n  }\n\n  createRenderParams(e) {\n    const t = super.createRenderParams(e);\n    return t.rendererInfo = this._rendererInfo, t.attributeView = this.attributeView, t;\n  }\n\n  onAttributeStoreUpdate() {}\n\n  _processMaterialItemRequest(e, {\n    items: t,\n    abortOptions: r,\n    resolver: s\n  }) {\n    const {\n      painter: i,\n      pixelRatio: o\n    } = e,\n          n = t.map(e => i.textureManager.rasterizeItem(e.symbol, o, e.glyphIds, r));\n    Promise.all(n).then(e => {\n      if (!this.stage) return void s.reject();\n      const r = e.map((e, r) => ({\n        id: t[r].id,\n        mosaicItem: e\n      }));\n      s.resolve(r);\n    }, s.reject);\n  }\n\n}\n\nexport { o as FeatureContainer };","map":{"version":3,"names":["createResolver","e","t","AttributeStoreView","r","s","WGLRendererInfo","i","o","constructor","_rendererInfo","_materialItemsRequestQueue","attributeView","onAttributeStoreUpdate","destroy","children","forEach","removeAllChildren","clear","setRendererInfo","setInfo","requestRender","getMaterialItems","length","push","items","abortOptions","resolver","promise","doRender","context","capabilities","enable","pop","_processMaterialItemRequest","renderChildren","commit","update","state","updateTransforms","some","hasData","setTransform","createRenderParams","rendererInfo","painter","pixelRatio","n","map","textureManager","rasterizeItem","symbol","glyphIds","Promise","all","then","stage","reject","id","mosaicItem","resolve","FeatureContainer"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/FeatureContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{createResolver as e}from\"../../../core/promiseUtils.js\";import t from\"../../../core/Queue.js\";import{AttributeStoreView as r}from\"./webgl/AttributeStoreView.js\";import s from\"./webgl/TileContainer.js\";import{WGLRendererInfo as i}from\"./webgl/WGLRendererInfo.js\";class o extends s{constructor(e){super(e),this._rendererInfo=new i,this._materialItemsRequestQueue=new t,this.attributeView=new r((()=>this.onAttributeStoreUpdate()))}destroy(){this.children.forEach((e=>e.destroy())),this.removeAllChildren(),this.attributeView.destroy(),this._materialItemsRequestQueue.clear()}setRendererInfo(e,t,r){this._rendererInfo.setInfo(e,t,r),this.requestRender()}async getMaterialItems(t,r){if(!t||0===t.length)return null;const s=e();return this._materialItemsRequestQueue.push({items:t,abortOptions:r,resolver:s}),this.requestRender(),s.promise}doRender(e){if(e.context.capabilities.enable(\"textureFloat\"),e.context.capabilities.enable(\"vao\"),this._materialItemsRequestQueue.length>0){let t=this._materialItemsRequestQueue.pop();for(;t;)this._processMaterialItemRequest(e,t),t=this._materialItemsRequestQueue.pop()}super.doRender(e)}renderChildren(e){for(const t of this.children)t.commit(e);this._rendererInfo.update(e.state),super.renderChildren(e)}updateTransforms(e){if(this.children.some((e=>e.hasData)))for(const t of this.children)t.setTransform(e)}createRenderParams(e){const t=super.createRenderParams(e);return t.rendererInfo=this._rendererInfo,t.attributeView=this.attributeView,t}onAttributeStoreUpdate(){}_processMaterialItemRequest(e,{items:t,abortOptions:r,resolver:s}){const{painter:i,pixelRatio:o}=e,n=t.map((e=>i.textureManager.rasterizeItem(e.symbol,o,e.glyphIds,r)));Promise.all(n).then((e=>{if(!this.stage)return void s.reject();const r=e.map(((e,r)=>({id:t[r].id,mosaicItem:e})));s.resolve(r)}),s.reject)}}export{o as FeatureContainer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}