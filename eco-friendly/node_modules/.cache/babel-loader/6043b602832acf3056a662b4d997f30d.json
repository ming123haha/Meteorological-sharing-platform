{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { nextPowerOfTwo as t } from \"../../../../../core/mathUtils.js\";\nimport { isSome as r } from \"../../../../../core/maybe.js\";\nimport { c as e } from \"../../../../../chunks/mat3f32.js\";\nimport { f as o } from \"../../../../../chunks/vec4f32.js\";\nimport { VTL_TEXTURE_BINDING_UNIT_SPRITES as i, VTL_HIGH_RES_CUTOFF as s } from \"../definitions.js\";\nimport { WGLDrawPhase as a } from \"../enums.js\";\nimport { u32to4Xu8 as n } from \"../number.js\";\nimport c from \"./WGLBrush.js\";\nimport { BufferObject as m } from \"../../../../webgl/BufferObject.js\";\nimport { TextureSamplingMode as f, CompareFunction as l, PrimitiveType as u, Usage as p } from \"../../../../webgl/enums.js\";\nimport { VertexArrayObject as _ } from \"../../../../webgl/VertexArrayObject.js\";\n\nclass d extends c {\n  constructor() {\n    super(...arguments), this._color = o(1, 0, 0, 1), this._patternMatrix = e(), this._programOptions = {\n      id: !1,\n      pattern: !1\n    };\n  }\n\n  dispose() {\n    this._vao && (this._vao.dispose(), this._vao = null);\n  }\n\n  drawMany(e, o) {\n    const {\n      context: c,\n      painter: m,\n      styleLayerUID: p,\n      requestRender: _\n    } = e;\n\n    this._loadWGLResources(e);\n\n    const d = e.displayLevel,\n          h = e.styleLayer,\n          g = h.backgroundMaterial,\n          v = m.vectorTilesMaterialManager,\n          b = h.getPaintValue(\"background-color\", d),\n          y = h.getPaintValue(\"background-opacity\", d),\n          M = h.getPaintValue(\"background-pattern\", d),\n          x = void 0 !== M,\n          j = b[3] * y,\n          U = 1 | window.devicePixelRatio,\n          L = e.spriteMosaic;\n    let w, A;\n    const P = U > s ? 2 : 1,\n          I = e.drawPhase === a.HITTEST,\n          R = this._programOptions;\n    R.id = I, R.pattern = x;\n    const k = v.getMaterialProgram(c, g, R);\n\n    if (!r(_) || I || k.isCompiled) {\n      if (c.bindVAO(this._vao), c.useProgram(k), x) {\n        const t = L.getMosaicItemPosition(M, !0);\n\n        if (r(t)) {\n          const {\n            tl: e,\n            br: o,\n            page: s\n          } = t;\n          w = o[0] - e[0], A = o[1] - e[1];\n          const a = L.getPageSize(s);\n          r(a) && (L.bind(c, f.LINEAR, s, i), k.setUniform4f(\"u_tlbr\", e[0], e[1], o[0], o[1]), k.setUniform2fv(\"u_mosaicSize\", a), k.setUniform1i(\"u_texture\", i));\n        }\n\n        k.setUniform1f(\"u_opacity\", y);\n      } else this._color[0] = j * b[0], this._color[1] = j * b[1], this._color[2] = j * b[2], this._color[3] = j, k.setUniform4fv(\"u_color\", this._color);\n\n      if (k.setUniform1f(\"u_depth\", h.z || 0), I) {\n        const t = n(p + 1);\n        k.setUniform4fv(\"u_id\", t);\n      }\n\n      for (const r of o) {\n        if (k.setUniform1f(\"u_coord_range\", r.rangeX), k.setUniformMatrix3fv(\"u_dvsMat3\", r.transforms.dvs), x) {\n          const e = Math.max(2 ** (Math.round(d) - r.key.level), 1),\n                o = P * r.width * e,\n                i = o / t(w),\n                s = o / t(A);\n          this._patternMatrix[0] = i, this._patternMatrix[4] = s, k.setUniformMatrix3fv(\"u_pattern_matrix\", this._patternMatrix);\n        }\n\n        c.setStencilFunction(l.EQUAL, r.stencilRef, 255), c.drawArrays(u.TRIANGLE_STRIP, 0, 4);\n      }\n    } else _();\n  }\n\n  _loadWGLResources(t) {\n    if (this._vao) return;\n    const {\n      context: r,\n      styleLayer: e\n    } = t,\n          o = e.backgroundMaterial,\n          i = new Int8Array([0, 0, 1, 0, 0, 1, 1, 1]),\n          s = m.createVertex(r, p.STATIC_DRAW, i),\n          a = new _(r, o.getAttributeLocations(), o.getLayoutInfo(), {\n      geometry: s\n    });\n    this._vao = a;\n  }\n\n}\n\nexport { d as WGLBrushVTLBackground };","map":{"version":3,"names":["nextPowerOfTwo","t","isSome","r","c","e","f","o","VTL_TEXTURE_BINDING_UNIT_SPRITES","i","VTL_HIGH_RES_CUTOFF","s","WGLDrawPhase","a","u32to4Xu8","n","BufferObject","m","TextureSamplingMode","CompareFunction","l","PrimitiveType","u","Usage","p","VertexArrayObject","_","d","constructor","arguments","_color","_patternMatrix","_programOptions","id","pattern","dispose","_vao","drawMany","context","painter","styleLayerUID","requestRender","_loadWGLResources","displayLevel","h","styleLayer","g","backgroundMaterial","v","vectorTilesMaterialManager","b","getPaintValue","y","M","x","j","U","window","devicePixelRatio","L","spriteMosaic","w","A","P","I","drawPhase","HITTEST","R","k","getMaterialProgram","isCompiled","bindVAO","useProgram","getMosaicItemPosition","tl","br","page","getPageSize","bind","LINEAR","setUniform4f","setUniform2fv","setUniform1i","setUniform1f","setUniform4fv","z","rangeX","setUniformMatrix3fv","transforms","dvs","Math","max","round","key","level","width","setStencilFunction","EQUAL","stencilRef","drawArrays","TRIANGLE_STRIP","Int8Array","createVertex","STATIC_DRAW","getAttributeLocations","getLayoutInfo","geometry","WGLBrushVTLBackground"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLBackground.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{nextPowerOfTwo as t}from\"../../../../../core/mathUtils.js\";import{isSome as r}from\"../../../../../core/maybe.js\";import{c as e}from\"../../../../../chunks/mat3f32.js\";import{f as o}from\"../../../../../chunks/vec4f32.js\";import{VTL_TEXTURE_BINDING_UNIT_SPRITES as i,VTL_HIGH_RES_CUTOFF as s}from\"../definitions.js\";import{WGLDrawPhase as a}from\"../enums.js\";import{u32to4Xu8 as n}from\"../number.js\";import c from\"./WGLBrush.js\";import{BufferObject as m}from\"../../../../webgl/BufferObject.js\";import{TextureSamplingMode as f,CompareFunction as l,PrimitiveType as u,Usage as p}from\"../../../../webgl/enums.js\";import{VertexArrayObject as _}from\"../../../../webgl/VertexArrayObject.js\";class d extends c{constructor(){super(...arguments),this._color=o(1,0,0,1),this._patternMatrix=e(),this._programOptions={id:!1,pattern:!1}}dispose(){this._vao&&(this._vao.dispose(),this._vao=null)}drawMany(e,o){const{context:c,painter:m,styleLayerUID:p,requestRender:_}=e;this._loadWGLResources(e);const d=e.displayLevel,h=e.styleLayer,g=h.backgroundMaterial,v=m.vectorTilesMaterialManager,b=h.getPaintValue(\"background-color\",d),y=h.getPaintValue(\"background-opacity\",d),M=h.getPaintValue(\"background-pattern\",d),x=void 0!==M,j=b[3]*y,U=1|window.devicePixelRatio,L=e.spriteMosaic;let w,A;const P=U>s?2:1,I=e.drawPhase===a.HITTEST,R=this._programOptions;R.id=I,R.pattern=x;const k=v.getMaterialProgram(c,g,R);if(!r(_)||I||k.isCompiled){if(c.bindVAO(this._vao),c.useProgram(k),x){const t=L.getMosaicItemPosition(M,!0);if(r(t)){const{tl:e,br:o,page:s}=t;w=o[0]-e[0],A=o[1]-e[1];const a=L.getPageSize(s);r(a)&&(L.bind(c,f.LINEAR,s,i),k.setUniform4f(\"u_tlbr\",e[0],e[1],o[0],o[1]),k.setUniform2fv(\"u_mosaicSize\",a),k.setUniform1i(\"u_texture\",i))}k.setUniform1f(\"u_opacity\",y)}else this._color[0]=j*b[0],this._color[1]=j*b[1],this._color[2]=j*b[2],this._color[3]=j,k.setUniform4fv(\"u_color\",this._color);if(k.setUniform1f(\"u_depth\",h.z||0),I){const t=n(p+1);k.setUniform4fv(\"u_id\",t)}for(const r of o){if(k.setUniform1f(\"u_coord_range\",r.rangeX),k.setUniformMatrix3fv(\"u_dvsMat3\",r.transforms.dvs),x){const e=Math.max(2**(Math.round(d)-r.key.level),1),o=P*r.width*e,i=o/t(w),s=o/t(A);this._patternMatrix[0]=i,this._patternMatrix[4]=s,k.setUniformMatrix3fv(\"u_pattern_matrix\",this._patternMatrix)}c.setStencilFunction(l.EQUAL,r.stencilRef,255),c.drawArrays(u.TRIANGLE_STRIP,0,4)}}else _()}_loadWGLResources(t){if(this._vao)return;const{context:r,styleLayer:e}=t,o=e.backgroundMaterial,i=new Int8Array([0,0,1,0,0,1,1,1]),s=m.createVertex(r,p.STATIC_DRAW,i),a=new _(r,o.getAttributeLocations(),o.getLayoutInfo(),{geometry:s});this._vao=a}}export{d as WGLBrushVTLBackground};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}