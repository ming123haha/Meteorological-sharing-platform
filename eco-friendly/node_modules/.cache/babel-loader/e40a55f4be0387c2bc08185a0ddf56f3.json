{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { createTask as t, resultOrAbort as e } from \"../../../../../core/asyncUtils.js\";\nimport { isNone as s } from \"../../../../../core/maybe.js\";\nimport { create as a, fromExtent as r, intersects as E } from \"../../../../../geometry/support/aaBoundingRect.js\";\n\nclass o {\n  constructor(t, e) {\n    this.data = t, this.resolution = e, this.state = {\n      type: u.CREATED\n    }, this.alive = !0;\n  }\n\n  process(t) {\n    switch (this.state.type) {\n      case u.CREATED:\n        return this.state = this._gotoFetchCount(this.state, t), this.state.task.promise.then(t.resume, t.resume);\n\n      case u.FETCH_COUNT:\n        break;\n\n      case u.FETCHED_COUNT:\n        return this.state = this._gotoFetchFeatures(this.state, t), this.state.task.promise.then(t.resume, t.resume);\n\n      case u.FETCH_FEATURES:\n        break;\n\n      case u.FETCHED_FEATURES:\n        this.state = this._goToDone(this.state, t);\n\n      case u.DONE:\n    }\n\n    return null;\n  }\n\n  get debugInfo() {\n    return {\n      data: this.data,\n      featureCount: this._featureCount,\n      state: this._stateToString\n    };\n  }\n\n  get _featureCount() {\n    switch (this.state.type) {\n      case u.CREATED:\n      case u.FETCH_COUNT:\n        return 0;\n\n      case u.FETCHED_COUNT:\n        return this.state.featureCount;\n\n      case u.FETCH_FEATURES:\n        return this.state.previous.featureCount;\n\n      case u.FETCHED_FEATURES:\n        return this.state.features.length;\n\n      case u.DONE:\n        return this.state.previous.features.length;\n    }\n  }\n\n  get _stateToString() {\n    switch (this.state.type) {\n      case u.CREATED:\n        return \"created\";\n\n      case u.FETCH_COUNT:\n        return \"fetch-count\";\n\n      case u.FETCHED_COUNT:\n        return \"fetched-count\";\n\n      case u.FETCH_FEATURES:\n        return \"fetch-features\";\n\n      case u.FETCHED_FEATURES:\n        return \"fetched-features\";\n\n      case u.DONE:\n        return \"done\";\n    }\n  }\n\n  _gotoFetchCount(s, a) {\n    return {\n      type: u.FETCH_COUNT,\n      previous: s,\n      task: t(async t => {\n        const s = await e(a.fetchCount(this, t));\n        this.state.type === u.FETCH_COUNT && (this.state = this._gotoFetchedCount(this.state, s.ok ? s.value : 1 / 0));\n      })\n    };\n  }\n\n  _gotoFetchedCount(t, e) {\n    return {\n      type: u.FETCHED_COUNT,\n      featureCount: e,\n      previous: t\n    };\n  }\n\n  _gotoFetchFeatures(s, a) {\n    return {\n      type: u.FETCH_FEATURES,\n      previous: s,\n      task: t(async t => {\n        const r = await e(a.fetchFeatures(this, s.featureCount, t));\n        this.state.type === u.FETCH_FEATURES && (this.state = this._gotoFetchedFeatures(this.state, r.ok ? r.value : []));\n      })\n    };\n  }\n\n  _gotoFetchedFeatures(t, e) {\n    return {\n      type: u.FETCHED_FEATURES,\n      previous: t,\n      features: e\n    };\n  }\n\n  _goToDone(t, e) {\n    return e.finish(this, t.features), {\n      type: u.DONE,\n      previous: t\n    };\n  }\n\n  reset() {\n    const t = this.state;\n\n    switch (this.state = {\n      type: u.CREATED\n    }, t.type) {\n      case u.CREATED:\n      case u.FETCHED_COUNT:\n      case u.FETCHED_FEATURES:\n      case u.DONE:\n        break;\n\n      case u.FETCH_COUNT:\n      case u.FETCH_FEATURES:\n        t.task.abort();\n    }\n  }\n\n  intersects(t) {\n    return !(!s(t) && this.data.extent) || (r(t, T), E(this.data.extent, T));\n  }\n\n}\n\nvar u;\n!function (t) {\n  t[t.CREATED = 0] = \"CREATED\", t[t.FETCH_COUNT = 1] = \"FETCH_COUNT\", t[t.FETCHED_COUNT = 2] = \"FETCHED_COUNT\", t[t.FETCH_FEATURES = 3] = \"FETCH_FEATURES\", t[t.FETCHED_FEATURES = 4] = \"FETCHED_FEATURES\", t[t.DONE = 5] = \"DONE\";\n}(u || (u = {}));\nconst T = a();\nexport { o as PendingFeatureTile, u as StateType };","map":{"version":3,"names":["createTask","t","resultOrAbort","e","isNone","s","create","a","fromExtent","r","intersects","E","o","constructor","data","resolution","state","type","u","CREATED","alive","process","_gotoFetchCount","task","promise","then","resume","FETCH_COUNT","FETCHED_COUNT","_gotoFetchFeatures","FETCH_FEATURES","FETCHED_FEATURES","_goToDone","DONE","debugInfo","featureCount","_featureCount","_stateToString","previous","features","length","fetchCount","_gotoFetchedCount","ok","value","fetchFeatures","_gotoFetchedFeatures","finish","reset","abort","extent","T","PendingFeatureTile","StateType"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/PendingFeatureTile.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{createTask as t,resultOrAbort as e}from\"../../../../../core/asyncUtils.js\";import{isNone as s}from\"../../../../../core/maybe.js\";import{create as a,fromExtent as r,intersects as E}from\"../../../../../geometry/support/aaBoundingRect.js\";class o{constructor(t,e){this.data=t,this.resolution=e,this.state={type:u.CREATED},this.alive=!0}process(t){switch(this.state.type){case u.CREATED:return this.state=this._gotoFetchCount(this.state,t),this.state.task.promise.then(t.resume,t.resume);case u.FETCH_COUNT:break;case u.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,t),this.state.task.promise.then(t.resume,t.resume);case u.FETCH_FEATURES:break;case u.FETCHED_FEATURES:this.state=this._goToDone(this.state,t);case u.DONE:}return null}get debugInfo(){return{data:this.data,featureCount:this._featureCount,state:this._stateToString}}get _featureCount(){switch(this.state.type){case u.CREATED:case u.FETCH_COUNT:return 0;case u.FETCHED_COUNT:return this.state.featureCount;case u.FETCH_FEATURES:return this.state.previous.featureCount;case u.FETCHED_FEATURES:return this.state.features.length;case u.DONE:return this.state.previous.features.length}}get _stateToString(){switch(this.state.type){case u.CREATED:return\"created\";case u.FETCH_COUNT:return\"fetch-count\";case u.FETCHED_COUNT:return\"fetched-count\";case u.FETCH_FEATURES:return\"fetch-features\";case u.FETCHED_FEATURES:return\"fetched-features\";case u.DONE:return\"done\"}}_gotoFetchCount(s,a){return{type:u.FETCH_COUNT,previous:s,task:t((async t=>{const s=await e(a.fetchCount(this,t));this.state.type===u.FETCH_COUNT&&(this.state=this._gotoFetchedCount(this.state,s.ok?s.value:1/0))}))}}_gotoFetchedCount(t,e){return{type:u.FETCHED_COUNT,featureCount:e,previous:t}}_gotoFetchFeatures(s,a){return{type:u.FETCH_FEATURES,previous:s,task:t((async t=>{const r=await e(a.fetchFeatures(this,s.featureCount,t));this.state.type===u.FETCH_FEATURES&&(this.state=this._gotoFetchedFeatures(this.state,r.ok?r.value:[]))}))}}_gotoFetchedFeatures(t,e){return{type:u.FETCHED_FEATURES,previous:t,features:e}}_goToDone(t,e){return e.finish(this,t.features),{type:u.DONE,previous:t}}reset(){const t=this.state;switch(this.state={type:u.CREATED},t.type){case u.CREATED:case u.FETCHED_COUNT:case u.FETCHED_FEATURES:case u.DONE:break;case u.FETCH_COUNT:case u.FETCH_FEATURES:t.task.abort()}}intersects(t){return!(!s(t)&&this.data.extent)||(r(t,T),E(this.data.extent,T))}}var u;!function(t){t[t.CREATED=0]=\"CREATED\",t[t.FETCH_COUNT=1]=\"FETCH_COUNT\",t[t.FETCHED_COUNT=2]=\"FETCHED_COUNT\",t[t.FETCH_FEATURES=3]=\"FETCH_FEATURES\",t[t.FETCHED_FEATURES=4]=\"FETCHED_FEATURES\",t[t.DONE=5]=\"DONE\"}(u||(u={}));const T=a();export{o as PendingFeatureTile,u as StateType};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}