{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../chunks/tslib.es6.js\";\nimport e from \"../../../../analysis/SlicePlane.js\";\nimport { clock as i } from \"../../../../core/clock.js\";\nimport a from \"../../../../core/Handles.js\";\nimport { releaseMaybe as s, destroyMaybe as n, isSome as r, isNone as l, removeMaybe as o } from \"../../../../core/maybe.js\";\nimport { watch as h, sync as p, syncAndInitial as u } from \"../../../../core/reactiveUtils.js\";\nimport { addFrameTask as c } from \"../../../../core/scheduling.js\";\nimport { createScreenPoint as d, screenPointObjectToArray as _, createScreenPointArray as v } from \"../../../../core/screenUtils.js\";\nimport { property as P } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as y } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { d as m, u as g, m as w } from \"../../../../chunks/mat4.js\";\nimport { e as f, l as M, c as D, g as T, a as V, m as b, n as k, s as E } from \"../../../../chunks/vec3.js\";\nimport { a as S, c as H } from \"../../../../chunks/vec3f64.js\";\nimport { c as x, a as I, n as R, f as j } from \"../../../../chunks/boundedPlane.js\";\nimport { signedDistance as O, create as C, intersectRay as z, normal as G } from \"../../../../geometry/support/plane.js\";\nimport { create as U } from \"../../../../geometry/support/ray.js\";\nimport { sv3d as L, sm4d as K, sv2d as A } from \"../../../../geometry/support/vectorStacks.js\";\nimport { POINTER_MOVE_TIMER_MS as B, PLANE_PREVIEW_OUTLINE_WIDTH as F, forceVerticalModifier as N, forceHorizontalModifier as q, PREVIEW_FADE_DURATION_SECONDS as Z, PLANE_OUTLINE_COLOR as J, PLANE_BACKGROUND_COLOR as Q, PREVIEW_FADE_DOT_THRESHOLD as W, INITIAL_DEPTH_OFFSET_FRAC as X } from \"./sliceToolConfig.js\";\nimport { createShiftManipulator as Y, createRotateManipulator as $, createResizeManipulator as tt, createGridVisualElement as et, createOutlineVisualElement as it, planeToShape as at, createRotatePlane as st, RotationAxis as nt, resizePlane as rt, calculatePlaneHalfSize as lt, SliceOrientation as ot, createPlane as ht, DidPointerMoveRecentlyFlag as pt, calculateBoundedPlaneTranslateRotate as ut, updateShiftRestartHandle as ct, updateRotateHeadingHandle as dt, updateRotateTiltHandle as _t, updateResizeHandle as vt, createShiftPlane as Pt } from \"./sliceToolUtils.js\";\nimport { getRotateHeadingTexture as yt, getTiltRotateTexture as mt } from \"./images/Factory.js\";\nimport { calculateInputRotationTransform as gt } from \"../../interactive/manipulatorUtils.js\";\nimport { screenToRenderPlane as wt } from \"../../interactive/editingTools/dragEventPipeline3D.js\";\nimport { fromScreen as ft } from \"../../support/geometryUtils/ray.js\";\nimport { newIntersector as Mt } from \"../../webgl-engine/lib/Intersector.js\";\nimport { StoreResults as Dt } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nimport { AnalysisToolBase as Tt } from \"../../../interactive/AnalysisToolBase.js\";\nimport { createManipulatorDragEventPipeline as Vt } from \"../../../interactive/dragEventPipeline.js\";\nimport { createScreenPointFromEvent as bt } from \"../../../support/screenUtils.js\";\nvar kt;\nlet Et = kt = class extends Tt {\n  constructor(t) {\n    super(t), this.clock = i, this._previewPlaneOpacity = 1, this.removeIncompleteOnCancel = !1, this.layersMode = \"none\", this.shiftManipulator = null, this.rotateHeadingManipulator = null, this.rotateTiltManipulator = null, this.resizeManipulators = null, this._handles = new a(), this._viewHandles = new a(), this._frameTask = null, this._pointerMoveTimerMs = B, this._prevPointerMoveTimeout = null, this._previewPlaneGridVisualElement = null, this._previewPlaneOutlineVisualElement = null, this._startPlane = x(), this._previewPlane = null, this._activeKeyModifiers = {}, this._lastCursorPosition = d(), this._resizeHandles = [{\n      direction: [1, 0]\n    }, {\n      direction: [1, 1]\n    }, {\n      direction: [0, 1]\n    }, {\n      direction: [-1, 1]\n    }, {\n      direction: [-1, 0]\n    }, {\n      direction: [-1, -1]\n    }, {\n      direction: [0, -1]\n    }, {\n      direction: [1, -1]\n    }], this._intersector = Mt(t.view.state.viewingMode), this._intersector.options.store = Dt.MIN;\n  }\n\n  initialize() {\n    if (null == this.analysis) throw new Error(\"SliceTool requires valid analysis, but null was provided.\");\n    this.rotateHeadingImage = yt(this.view.toolViewManager.textures), this.rotateTiltImage = mt(this.view.toolViewManager.textures);\n\n    const t = t => {\n      this._updateManipulatorsInteractive(t), t.grabbing || (r(this.analysisViewData.plane) && I(this.analysisViewData.plane, this._startPlane), this.inputState = null);\n    };\n\n    this.shiftManipulator = Y(this.view), this.manipulators.add(this.shiftManipulator), this.shiftManipulator.events.on(\"grab-changed\", e => {\n      this._onShiftGrab(e), t(this.shiftManipulator);\n    }), this._handles.add(this._createShiftDragPipeline(this.shiftManipulator)), this.rotateHeadingManipulator = $(this.view, this.rotateHeadingImage.texture), this.manipulators.add(this.rotateHeadingManipulator), this.rotateHeadingManipulator.events.on(\"grab-changed\", e => {\n      this._onRotateHeadingGrab(e), t(this.rotateHeadingManipulator);\n    }), this._handles.add(this._createRotateHeadingDragPipeline(this.rotateHeadingManipulator)), this.rotateTiltManipulator = $(this.view, this.rotateTiltImage.texture), this.manipulators.add(this.rotateTiltManipulator), this.rotateTiltManipulator.events.on(\"grab-changed\", e => {\n      this._onRotateTiltGrab(e), t(this.rotateTiltManipulator);\n    }), this._handles.add(this._createRotateTiltDragPipeline(this.rotateTiltManipulator)), this.resizeManipulators = this._resizeHandles.map((e, i) => {\n      const a = tt(this.view, e);\n      return a.events.on(\"grab-changed\", e => {\n        this._onResizeGrab(e, i), t(a);\n      }), this._handles.add(this._createResizeDragPipeline(a)), a;\n    }), this.manipulators.addMany(this.resizeManipulators), this._previewPlaneGridVisualElement = et(this.view), this._previewPlaneOutlineVisualElement = it(this.view), this._previewPlaneOutlineVisualElement.width = F, this._handles.add(h(() => this.analysisViewData.plane, () => this._updateManipulators(), p));\n    const e = h(() => this.state, t => {\n      \"sliced\" === t && this.finishToolCreation();\n    }, u);\n\n    this._handles.add([e, h(() => this.view.state.camera, () => this._onCameraChange())]);\n  }\n\n  destroy() {\n    this.rotateHeadingImage = s(this.rotateHeadingImage), this.rotateTiltImage = s(this.rotateTiltImage), this._handles = n(this._handles), this._viewHandles = n(this._viewHandles), this._removeFrameTask(), this._clearPointerMoveTimeout(), this._previewPlaneOutlineVisualElement = n(this._previewPlaneOutlineVisualElement), this._previewPlaneGridVisualElement = n(this._previewPlaneGridVisualElement);\n  }\n\n  get state() {\n    const t = !!this.analysisViewData.plane,\n          e = !!this.inputState;\n    return t ? t && e ? \"slicing\" : t && !e ? \"sliced\" : \"ready\" : \"ready\";\n  }\n\n  get cursor() {\n    return this._isPlacingSlicePlane || \"exclude\" === this.layersMode ? \"crosshair\" : r(this._creatingPointerId) ? \"grabbing\" : null;\n  }\n\n  set analysis(t) {\n    if (null == t) throw new Error(\"SliceTool requires valid analysis, but null was provided.\");\n    this._handles.remove(\"analysis\"), this._set(\"analysis\", t);\n  }\n\n  get inputState() {\n    return this._get(\"inputState\");\n  }\n\n  set inputState(t) {\n    this._set(\"inputState\", t), this.analysisViewData.showGrid = r(t) && \"resize\" === t.type, this._updateMaterials();\n  }\n\n  get _isPlacingSlicePlane() {\n    return !this.inputState && !this.analysisViewData.plane && this.active;\n  }\n\n  get _creatingPointerId() {\n    return r(this.inputState) && \"shift\" === this.inputState.type ? this.inputState.creatingPointerId : null;\n  }\n\n  enterExcludeLayerMode() {\n    l(this.analysisViewData.plane) || (this._set(\"layersMode\", \"exclude\"), this.active || (this.view.activeTool = this));\n  }\n\n  exitExcludeLayerMode() {\n    l(this.analysisViewData.plane) || (this._set(\"layersMode\", \"none\"), this.active && (this.view.activeTool = null));\n  }\n\n  onDeactivate() {\n    this._set(\"layersMode\", \"none\"), this._updatePreviewPlane(null);\n  }\n\n  onShow() {\n    this._updateVisibility(!0);\n  }\n\n  onHide() {\n    this._updateVisibility(!1);\n  }\n\n  _updateVisibility(t) {\n    this.shiftManipulator && (this._updateManipulators(), t || this._clearPointerMoveTimeout());\n  }\n\n  onInputEvent(t) {\n    switch (t.type) {\n      case \"pointer-drag\":\n        if (!Ht(t)) return;\n        this._isPlacingSlicePlane ? this._onClickPlacePlane(t) && t.stopPropagation() : this._onPointerDrag(t) && t.stopPropagation();\n        break;\n\n      case \"pointer-move\":\n        this._onPointerMove(t);\n\n        break;\n\n      case \"pointer-up\":\n        this._onPointerUp(t) && t.stopPropagation();\n        break;\n\n      case \"immediate-click\":\n        if (!Ht(t)) return;\n        this._onClickPlacePlane(t) && t.stopPropagation();\n        break;\n\n      case \"click\":\n        if (!Ht(t)) return;\n        this._onClickExcludeLayer(t) && t.stopPropagation();\n        break;\n\n      case \"drag\":\n        this.inputState && t.stopPropagation();\n        break;\n\n      case \"key-down\":\n        this._onKeyDown(t) && t.stopPropagation();\n        break;\n\n      case \"key-up\":\n        this._onKeyUp(t) && t.stopPropagation();\n    }\n  }\n\n  onEditableChange() {\n    this.analysisViewData.editable = this.editable;\n  }\n\n  _onPointerDrag(t) {\n    const e = this.inputState;\n\n    if (t.pointerId === this._creatingPointerId && r(e) && \"shift\" === e.type) {\n      const i = bt(t);\n      return this.shiftManipulator.events.emit(\"drag\", {\n        action: e.hasBeenDragged ? \"update\" : \"start\",\n        pointerType: t.pointerType,\n        start: i,\n        screenPoint: i\n      }), e.hasBeenDragged = !0, !0;\n    }\n\n    return !1;\n  }\n\n  _onPointerMove(t) {\n    this._lastCursorPosition.x = t.x, this._lastCursorPosition.y = t.y, this._resetPointerMoveTimeout(), \"touch\" !== t.pointerType && this._updatePreviewPlane(bt(t), this._activeKeyModifiers);\n  }\n\n  _onCameraChange() {\n    this._updatePreviewPlane(this._lastCursorPosition, this._activeKeyModifiers), this._updateManipulators();\n  }\n\n  _onPointerUp(t) {\n    if (t.pointerId === this._creatingPointerId && r(this.analysisViewData.plane)) {\n      const e = bt(t);\n      return this.shiftManipulator.events.emit(\"drag\", {\n        action: \"end\",\n        start: e,\n        screenPoint: e\n      }), I(this.analysisViewData.plane, this._startPlane), this.inputState = null, !0;\n    }\n\n    return !1;\n  }\n\n  _onClickPlacePlane(t) {\n    if (\"exclude\" === this.layersMode) return !1;\n\n    if (this._isPlacingSlicePlane) {\n      const i = bt(t),\n            a = x();\n\n      if (this._pickPlane(i, !1, this._activeKeyModifiers, a)) {\n        if (I(a, this._startPlane), this.analysis.shape = at(a, this.view, this.view.spatialReference, new e()), \"pointer-drag\" === t.type) {\n          const e = this._calculatePickRay(i);\n\n          this.inputState = St(e, t.pointerId, a.origin, a);\n        }\n\n        return !0;\n      }\n    }\n\n    return !1;\n  }\n\n  _onClickExcludeLayer(t) {\n    return !(\"exclude\" !== this.layersMode || !this.created) && (this.view.hitTest(bt(t)).then(t => {\n      if (t.results.length) {\n        const e = t.results[0],\n              i = \"graphic\" === e?.type && e.graphic;\n\n        if (i) {\n          const t = i.sourceLayer || i.layer;\n          t && this.analysis.excludedLayers.push(t);\n        }\n      } else t.ground.layer ? this.analysis.excludedLayers.push(t.ground.layer) : this.analysis.excludeGroundSurface = !0;\n    }), this._set(\"layersMode\", \"none\"), this.active && (this.view.activeTool = null), !0);\n  }\n\n  _onKeyDown(t) {\n    return (t.key === N || t.key === q) && (this._activeKeyModifiers[t.key] = !0, r(this._previewPlane) && this._updatePreviewPlane(this._lastCursorPosition, this._activeKeyModifiers), !0);\n  }\n\n  _onKeyUp(t) {\n    return !(t.key !== N && t.key !== q || !this._activeKeyModifiers[t.key]) && (delete this._activeKeyModifiers[t.key], r(this._previewPlane) && this._updatePreviewPlane(this._lastCursorPosition, this._activeKeyModifiers), !0);\n  }\n\n  _onShiftGrab(t) {\n    if (\"start\" !== t.action || l(this.analysisViewData.plane)) return;\n\n    const e = this._calculatePickRay(t.screenPoint);\n\n    I(this.analysisViewData.plane, this._startPlane), this.inputState = St(e, null, this.shiftManipulator.renderLocation, this.analysisViewData.plane);\n  }\n\n  _createShiftDragPipeline(t) {\n    return Vt(t, (t, e, i) => {\n      const a = this.inputState;\n      if (l(a) || \"shift\" !== a.type) return;\n      const s = r(this.analysisViewData.plane) ? I(this.analysisViewData.plane, x()) : null;\n      e.next(wt(this.view, a.shiftPlane)).next(this._shiftDragAdjustSensitivity(a)).next(this._shiftDragUpdatePlane(a)), i.next(() => {\n        r(s) && this._updateBoundedPlane(s);\n      });\n    });\n  }\n\n  _shiftDragAdjustSensitivity(t) {\n    return e => {\n      if (l(this.analysisViewData.plane)) return null;\n      const i = .001,\n            a = Math.min((1 - Math.abs(f(R(this.analysisViewData.plane), e.ray.direction) / M(e.ray.direction))) / i, 1),\n            s = -O(this._startPlane.plane, e.renderEnd),\n            n = -O(this._startPlane.plane, t.startPoint);\n      return t.depth = t.depth * (1 - a) + s * a - n, e;\n    };\n  }\n\n  _shiftDragUpdatePlane(t) {\n    return () => {\n      if (l(this.analysisViewData.plane)) return;\n      const e = D(L.get(), this._startPlane.origin),\n            i = D(L.get(), R(this._startPlane));\n      T(i, i, -t.depth), V(i, i, e);\n      const a = j(i, this.analysisViewData.plane.basis1, this.analysisViewData.plane.basis2, x());\n\n      this._updateBoundedPlane(a);\n    };\n  }\n\n  _onRotateHeadingGrab(t) {\n    if (\"start\" !== t.action || l(this.analysisViewData.plane)) return;\n\n    const e = st(this.analysisViewData.plane, this.view.renderCoordsHelper, nt.HEADING, C()),\n          i = this._calculatePickRay(t.screenPoint),\n          a = H();\n\n    z(e, i, a) && (I(this.analysisViewData.plane, this._startPlane), this.inputState = {\n      type: \"rotate\",\n      rotatePlane: e,\n      startPoint: a\n    });\n  }\n\n  _createRotateHeadingDragPipeline(t) {\n    return Vt(t, (t, e, i) => {\n      const a = this.inputState;\n      if (l(a) || \"rotate\" !== a.type) return;\n      const s = r(this.analysisViewData.plane) ? I(this.analysisViewData.plane, x()) : null;\n      e.next(wt(this.view, a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdatePlaneFromRotate()), i.next(() => {\n        r(s) && this._updateBoundedPlane(s);\n      });\n    });\n  }\n\n  _onRotateTiltGrab(t) {\n    if (\"start\" !== t.action || l(this.analysisViewData.plane)) return;\n\n    const e = st(this.analysisViewData.plane, this.view.renderCoordsHelper, nt.TILT, C()),\n          i = this._calculatePickRay(t.screenPoint),\n          a = H();\n\n    z(e, i, a) && (I(this.analysisViewData.plane, this._startPlane), this.inputState = {\n      type: \"rotate\",\n      rotatePlane: e,\n      startPoint: a\n    });\n  }\n\n  _createRotateTiltDragPipeline(t) {\n    return Vt(t, (t, e, i) => {\n      const a = this.inputState;\n      if (l(a) || \"rotate\" !== a.type) return;\n      const s = r(this.analysisViewData.plane) ? I(this.analysisViewData.plane, x()) : null;\n      e.next(wt(this.view, a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdatePlaneFromRotate()), i.next(() => {\n        r(s) && this._updateBoundedPlane(s);\n      });\n    });\n  }\n\n  _rotateDragRenderPlaneToRotate(t) {\n    return e => {\n      if (l(this.analysisViewData.plane)) return null;\n      const i = G(t.rotatePlane),\n            a = gt(t.startPoint, e.renderEnd, this.analysisViewData.plane.origin, i);\n      return { ...e,\n        rotateAxis: i,\n        rotateAngle: a\n      };\n    };\n  }\n\n  _rotateDragUpdatePlaneFromRotate() {\n    return t => {\n      if (l(this.analysisViewData.plane)) return;\n      const e = m(K.get(), t.rotateAngle, t.rotateAxis);\n      if (l(e)) return;\n      const i = b(L.get(), this._startPlane.basis1, e),\n            a = b(L.get(), this._startPlane.basis2, e),\n            s = j(this.analysisViewData.plane.origin, i, a, x());\n\n      this._updateBoundedPlane(s);\n    };\n  }\n\n  _onResizeGrab(t, e) {\n    if (\"start\" !== t.action || l(this.analysisViewData.plane)) return;\n\n    const i = this._calculatePickRay(t.screenPoint),\n          a = L.get();\n\n    z(this.analysisViewData.plane.plane, i, a) && (I(this.analysisViewData.plane, this._startPlane), this.inputState = {\n      type: \"resize\",\n      activeHandleIdx: e,\n      startPoint: S(a)\n    });\n  }\n\n  _createResizeDragPipeline(t) {\n    return Vt(t, (t, e, i) => {\n      const a = this.inputState;\n      if (l(a) || \"resize\" !== a.type || l(this.analysisViewData.plane)) return;\n      const s = I(this.analysisViewData.plane, x());\n      e.next(wt(this.view, this.analysisViewData.plane.plane)).next(this._resizeDragUpdatePlane(a)), i.next(() => {\n        this._updateBoundedPlane(s);\n      });\n    });\n  }\n\n  _resizeDragUpdatePlane(t) {\n    return e => {\n      if (l(this.analysisViewData.plane)) return;\n      const i = this._resizeHandles[t.activeHandleIdx],\n            a = rt(i, t.startPoint, e.renderEnd, this.view.state.camera, this._startPlane, I(this.analysisViewData.plane));\n\n      this._updateBoundedPlane(a);\n    };\n  }\n\n  _updateBoundedPlane(t) {\n    const e = this.analysisViewData;\n    if (!r(e)) throw new Error(\"valid internal object expected\");\n    e.plane = t;\n  }\n\n  _updatePreviewPlane(t, e = {}) {\n    let i = this._previewPlane;\n    if (this._previewPlane = null, l(t)) return this._removeFrameTask(), void this._updateManipulators();\n\n    if (!this.analysisViewData.plane && this.active) {\n      const a = r(i) ? i : x();\n\n      if (i = r(i) ? I(i, xt) : null, this._pickPlane(t, !0, e, a)) {\n        const t = W;\n        let e = !1;\n        r(i) && (e = f(i.plane, a.plane) < t || f(k(L.get(), i.basis1), k(L.get(), a.basis1)) < t), e && (this._previewPlaneOpacity = 0), this._previewPlane = a;\n      }\n    }\n\n    r(this._previewPlane) && l(this._frameTask) && 0 === this._previewPlaneOpacity ? this._frameTask = c({\n      update: ({\n        deltaTime: t\n      }) => {\n        this._previewPlaneOpacity = Math.min(this._previewPlaneOpacity + t / (1e3 * Z), 1), this._updateManipulators(), 1 === this._previewPlaneOpacity && this._removeFrameTask();\n      }\n    }) : l(this._previewPlane) && r(this._frameTask) ? this._removeFrameTask() : r(this._previewPlane) && this._updateManipulators();\n  }\n\n  _removeFrameTask() {\n    this._frameTask = o(this._frameTask);\n  }\n\n  _calculatePickRay(t) {\n    const e = U(),\n          i = _(t, It);\n\n    return ft(this.view.state.camera, i, e), k(e.direction, e.direction), e;\n  }\n\n  _pickMinResult(t) {\n    const e = _(t, A.get());\n\n    return this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(e, this._intersector), this._intersector.results.min;\n  }\n\n  _pickPlane(t, e, i, a) {\n    const s = this._pickMinResult(t),\n          n = L.get();\n\n    if (!s.getIntersectionPoint(n)) return !1;\n    const r = s.getTransformedNormal(L.get()),\n          l = this.view.state.camera;\n    f(r, l.viewForward) > 0 && T(r, r, -1);\n    const o = lt(n, l),\n          h = (e ? 1 : -1) * o * X,\n          p = T(L.get(), r, h);\n    V(p, p, n);\n    const u = this.analysis.tiltEnabled ? ot.TILTED : ot.HORIZONTAL_OR_VERTICAL,\n          c = i[N] ? ot.VERTICAL : i[q] ? ot.HORIZONTAL : u;\n    return ht(p, r, o, o, l, c, this.view.renderCoordsHelper, a), !0;\n  }\n\n  _clearPointerMoveTimeout() {\n    this._prevPointerMoveTimeout = o(this._prevPointerMoveTimeout);\n  }\n\n  _resetPointerMoveTimeout() {\n    this._clearPointerMoveTimeout(), this.shiftManipulator.state |= pt, this.rotateHeadingManipulator.state |= pt, this.rotateTiltManipulator.state |= pt, this._prevPointerMoveTimeout = this.clock.setTimeout(() => {\n      this.shiftManipulator.state &= ~pt, this.rotateHeadingManipulator.state &= ~pt, this.rotateTiltManipulator.state &= ~pt;\n    }, this._pointerMoveTimerMs);\n  }\n\n  _updateManipulators() {\n    if (kt.disableEngineLayers) return;\n    let t = null,\n        e = !1;\n    if (r(this.analysisViewData.plane)) t = this.analysisViewData.plane, e = !1;else {\n      if (!r(this._previewPlane)) return this.shiftManipulator.available = !1, this.rotateHeadingManipulator.available = !1, this.rotateTiltManipulator.available = !1, this.resizeManipulators.forEach(t => t.available = !1), this._previewPlaneOutlineVisualElement.visible = !1, void (this._previewPlaneGridVisualElement.visible = !1);\n      t = this._previewPlane, e = !0;\n    }\n    const i = ut(t, K.get());\n    e ? (this.shiftManipulator.available = !1, this.rotateHeadingManipulator.available = !1, this.rotateTiltManipulator.available = !1, this.resizeManipulators.forEach(t => t.available = !1), this._previewPlaneOutlineVisualElement.visible = !0, this._previewPlaneGridVisualElement.visible = !0) : (this.shiftManipulator.available = !0, this.rotateHeadingManipulator.available = !0, this.rotateTiltManipulator.available = this.analysis.tiltEnabled, this.resizeManipulators.forEach(t => t.available = !0), ct(this.shiftManipulator, i, t, this.view.state.camera), dt(this.rotateHeadingManipulator, i, t, this.view.renderCoordsHelper), _t(this.rotateTiltManipulator, i, t), this.resizeManipulators.forEach((e, a) => vt(e, this._resizeHandles[a], i, t)), this._previewPlaneOutlineVisualElement.visible = !1, this._previewPlaneGridVisualElement.visible = !1);\n    const a = E(L.get(), M(t.basis1), M(t.basis2), 1),\n          s = g(K.get(), a),\n          n = w(s, i, s);\n    this._previewPlaneOutlineVisualElement.transform = n, this._previewPlaneGridVisualElement.transform = n, this._updateMaterials();\n  }\n\n  _updateMaterials() {\n    const t = [J[0], J[1], J[2], J[3] * this._previewPlaneOpacity];\n    this._previewPlaneOutlineVisualElement.color = t;\n    const e = [Q[0], Q[1], Q[2], Q[3] * this._previewPlaneOpacity],\n          i = [0, 0, 0, 0];\n    this._previewPlaneGridVisualElement.backgroundColor = e, this._previewPlaneGridVisualElement.gridColor = i;\n  }\n\n  _updateManipulatorsInteractive(t) {\n    if (!t.grabbing) return this.shiftManipulator.interactive = !0, this.rotateHeadingManipulator.interactive = !0, this.rotateTiltManipulator.interactive = !0, void this.resizeManipulators.forEach(t => {\n      t.interactive = !0;\n    });\n    this.shiftManipulator.interactive = this.shiftManipulator === t, this.rotateHeadingManipulator.interactive = this.rotateHeadingManipulator === t, this.rotateTiltManipulator.interactive = this.rotateTiltManipulator === t, this.resizeManipulators.forEach(e => {\n      e.interactive = e === t;\n    });\n  }\n\n  testData() {\n    return {\n      plane: this.analysisViewData.plane,\n      setPointerMoveTimerMs: t => {\n        this._pointerMoveTimerMs = t;\n      }\n    };\n  }\n\n};\n\nfunction St(t, e, i, a) {\n  const s = Pt(i, R(a), t.direction, C()),\n        n = H();\n  return z(s, t, n) ? {\n    type: \"shift\",\n    creatingPointerId: e,\n    hasBeenDragged: !1,\n    shiftPlane: s,\n    depth: 0,\n    startPoint: n\n  } : null;\n}\n\nfunction Ht(t) {\n  return \"mouse\" !== t.pointerType || 0 === t.button;\n}\n\nEt.disableEngineLayers = !1, t([P()], Et.prototype, \"clock\", void 0), t([P({\n  constructOnly: !0\n})], Et.prototype, \"view\", void 0), t([P()], Et.prototype, \"analysisViewData\", void 0), t([P({\n  readOnly: !0\n})], Et.prototype, \"state\", null), t([P({\n  readOnly: !0\n})], Et.prototype, \"cursor\", null), t([P()], Et.prototype, \"analysis\", null), t([P()], Et.prototype, \"removeIncompleteOnCancel\", void 0), t([P({\n  readOnly: !0\n})], Et.prototype, \"layersMode\", void 0), t([P({\n  value: null\n})], Et.prototype, \"inputState\", null), t([P()], Et.prototype, \"_isPlacingSlicePlane\", null), t([P()], Et.prototype, \"_creatingPointerId\", null), Et = kt = t([y(\"esri.views.3d.analysis.Slice.SliceTool\")], Et);\nconst xt = x(),\n      It = v(),\n      Rt = Et;\nexport { Rt as default };","map":{"version":3,"names":["_","t","e","clock","i","a","releaseMaybe","s","destroyMaybe","n","isSome","r","isNone","l","removeMaybe","o","watch","h","sync","p","syncAndInitial","u","addFrameTask","c","createScreenPoint","d","screenPointObjectToArray","createScreenPointArray","v","property","P","subclass","y","m","g","w","f","M","D","T","V","b","k","E","S","H","x","I","R","j","signedDistance","O","create","C","intersectRay","z","normal","G","U","sv3d","L","sm4d","K","sv2d","A","POINTER_MOVE_TIMER_MS","B","PLANE_PREVIEW_OUTLINE_WIDTH","F","forceVerticalModifier","N","forceHorizontalModifier","q","PREVIEW_FADE_DURATION_SECONDS","Z","PLANE_OUTLINE_COLOR","J","PLANE_BACKGROUND_COLOR","Q","PREVIEW_FADE_DOT_THRESHOLD","W","INITIAL_DEPTH_OFFSET_FRAC","X","createShiftManipulator","Y","createRotateManipulator","$","createResizeManipulator","tt","createGridVisualElement","et","createOutlineVisualElement","it","planeToShape","at","createRotatePlane","st","RotationAxis","nt","resizePlane","rt","calculatePlaneHalfSize","lt","SliceOrientation","ot","createPlane","ht","DidPointerMoveRecentlyFlag","pt","calculateBoundedPlaneTranslateRotate","ut","updateShiftRestartHandle","ct","updateRotateHeadingHandle","dt","updateRotateTiltHandle","_t","updateResizeHandle","vt","createShiftPlane","Pt","getRotateHeadingTexture","yt","getTiltRotateTexture","mt","calculateInputRotationTransform","gt","screenToRenderPlane","wt","fromScreen","ft","newIntersector","Mt","StoreResults","Dt","AnalysisToolBase","Tt","createManipulatorDragEventPipeline","Vt","createScreenPointFromEvent","bt","kt","Et","constructor","_previewPlaneOpacity","removeIncompleteOnCancel","layersMode","shiftManipulator","rotateHeadingManipulator","rotateTiltManipulator","resizeManipulators","_handles","_viewHandles","_frameTask","_pointerMoveTimerMs","_prevPointerMoveTimeout","_previewPlaneGridVisualElement","_previewPlaneOutlineVisualElement","_startPlane","_previewPlane","_activeKeyModifiers","_lastCursorPosition","_resizeHandles","direction","_intersector","view","state","viewingMode","options","store","MIN","initialize","analysis","Error","rotateHeadingImage","toolViewManager","textures","rotateTiltImage","_updateManipulatorsInteractive","grabbing","analysisViewData","plane","inputState","manipulators","add","events","on","_onShiftGrab","_createShiftDragPipeline","texture","_onRotateHeadingGrab","_createRotateHeadingDragPipeline","_onRotateTiltGrab","_createRotateTiltDragPipeline","map","_onResizeGrab","_createResizeDragPipeline","addMany","width","_updateManipulators","finishToolCreation","camera","_onCameraChange","destroy","_removeFrameTask","_clearPointerMoveTimeout","cursor","_isPlacingSlicePlane","_creatingPointerId","remove","_set","_get","showGrid","type","_updateMaterials","active","creatingPointerId","enterExcludeLayerMode","activeTool","exitExcludeLayerMode","onDeactivate","_updatePreviewPlane","onShow","_updateVisibility","onHide","onInputEvent","Ht","_onClickPlacePlane","stopPropagation","_onPointerDrag","_onPointerMove","_onPointerUp","_onClickExcludeLayer","_onKeyDown","_onKeyUp","onEditableChange","editable","pointerId","emit","action","hasBeenDragged","pointerType","start","screenPoint","_resetPointerMoveTimeout","_pickPlane","shape","spatialReference","_calculatePickRay","St","origin","created","hitTest","then","results","length","graphic","sourceLayer","layer","excludedLayers","push","ground","excludeGroundSurface","key","renderLocation","next","shiftPlane","_shiftDragAdjustSensitivity","_shiftDragUpdatePlane","_updateBoundedPlane","Math","min","abs","ray","renderEnd","startPoint","depth","get","basis1","basis2","renderCoordsHelper","HEADING","rotatePlane","_rotateDragRenderPlaneToRotate","_rotateDragUpdatePlaneFromRotate","TILT","rotateAxis","rotateAngle","activeHandleIdx","_resizeDragUpdatePlane","xt","update","deltaTime","It","_pickMinResult","sceneIntersectionHelper","intersectToolIntersectorScreen","getIntersectionPoint","getTransformedNormal","viewForward","tiltEnabled","TILTED","HORIZONTAL_OR_VERTICAL","VERTICAL","HORIZONTAL","setTimeout","disableEngineLayers","available","forEach","visible","transform","color","backgroundColor","gridColor","interactive","testData","setPointerMoveTimerMs","button","prototype","constructOnly","readOnly","value","Rt","default"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/analysis/Slice/SliceTool.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../analysis/SlicePlane.js\";import{clock as i}from\"../../../../core/clock.js\";import a from\"../../../../core/Handles.js\";import{releaseMaybe as s,destroyMaybe as n,isSome as r,isNone as l,removeMaybe as o}from\"../../../../core/maybe.js\";import{watch as h,sync as p,syncAndInitial as u}from\"../../../../core/reactiveUtils.js\";import{addFrameTask as c}from\"../../../../core/scheduling.js\";import{createScreenPoint as d,screenPointObjectToArray as _,createScreenPointArray as v}from\"../../../../core/screenUtils.js\";import{property as P}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as y}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{d as m,u as g,m as w}from\"../../../../chunks/mat4.js\";import{e as f,l as M,c as D,g as T,a as V,m as b,n as k,s as E}from\"../../../../chunks/vec3.js\";import{a as S,c as H}from\"../../../../chunks/vec3f64.js\";import{c as x,a as I,n as R,f as j}from\"../../../../chunks/boundedPlane.js\";import{signedDistance as O,create as C,intersectRay as z,normal as G}from\"../../../../geometry/support/plane.js\";import{create as U}from\"../../../../geometry/support/ray.js\";import{sv3d as L,sm4d as K,sv2d as A}from\"../../../../geometry/support/vectorStacks.js\";import{POINTER_MOVE_TIMER_MS as B,PLANE_PREVIEW_OUTLINE_WIDTH as F,forceVerticalModifier as N,forceHorizontalModifier as q,PREVIEW_FADE_DURATION_SECONDS as Z,PLANE_OUTLINE_COLOR as J,PLANE_BACKGROUND_COLOR as Q,PREVIEW_FADE_DOT_THRESHOLD as W,INITIAL_DEPTH_OFFSET_FRAC as X}from\"./sliceToolConfig.js\";import{createShiftManipulator as Y,createRotateManipulator as $,createResizeManipulator as tt,createGridVisualElement as et,createOutlineVisualElement as it,planeToShape as at,createRotatePlane as st,RotationAxis as nt,resizePlane as rt,calculatePlaneHalfSize as lt,SliceOrientation as ot,createPlane as ht,DidPointerMoveRecentlyFlag as pt,calculateBoundedPlaneTranslateRotate as ut,updateShiftRestartHandle as ct,updateRotateHeadingHandle as dt,updateRotateTiltHandle as _t,updateResizeHandle as vt,createShiftPlane as Pt}from\"./sliceToolUtils.js\";import{getRotateHeadingTexture as yt,getTiltRotateTexture as mt}from\"./images/Factory.js\";import{calculateInputRotationTransform as gt}from\"../../interactive/manipulatorUtils.js\";import{screenToRenderPlane as wt}from\"../../interactive/editingTools/dragEventPipeline3D.js\";import{fromScreen as ft}from\"../../support/geometryUtils/ray.js\";import{newIntersector as Mt}from\"../../webgl-engine/lib/Intersector.js\";import{StoreResults as Dt}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";import{AnalysisToolBase as Tt}from\"../../../interactive/AnalysisToolBase.js\";import{createManipulatorDragEventPipeline as Vt}from\"../../../interactive/dragEventPipeline.js\";import{createScreenPointFromEvent as bt}from\"../../../support/screenUtils.js\";var kt;let Et=kt=class extends Tt{constructor(t){super(t),this.clock=i,this._previewPlaneOpacity=1,this.removeIncompleteOnCancel=!1,this.layersMode=\"none\",this.shiftManipulator=null,this.rotateHeadingManipulator=null,this.rotateTiltManipulator=null,this.resizeManipulators=null,this._handles=new a,this._viewHandles=new a,this._frameTask=null,this._pointerMoveTimerMs=B,this._prevPointerMoveTimeout=null,this._previewPlaneGridVisualElement=null,this._previewPlaneOutlineVisualElement=null,this._startPlane=x(),this._previewPlane=null,this._activeKeyModifiers={},this._lastCursorPosition=d(),this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._intersector=Mt(t.view.state.viewingMode),this._intersector.options.store=Dt.MIN}initialize(){if(null==this.analysis)throw new Error(\"SliceTool requires valid analysis, but null was provided.\");this.rotateHeadingImage=yt(this.view.toolViewManager.textures),this.rotateTiltImage=mt(this.view.toolViewManager.textures);const t=t=>{this._updateManipulatorsInteractive(t),t.grabbing||(r(this.analysisViewData.plane)&&I(this.analysisViewData.plane,this._startPlane),this.inputState=null)};this.shiftManipulator=Y(this.view),this.manipulators.add(this.shiftManipulator),this.shiftManipulator.events.on(\"grab-changed\",(e=>{this._onShiftGrab(e),t(this.shiftManipulator)})),this._handles.add(this._createShiftDragPipeline(this.shiftManipulator)),this.rotateHeadingManipulator=$(this.view,this.rotateHeadingImage.texture),this.manipulators.add(this.rotateHeadingManipulator),this.rotateHeadingManipulator.events.on(\"grab-changed\",(e=>{this._onRotateHeadingGrab(e),t(this.rotateHeadingManipulator)})),this._handles.add(this._createRotateHeadingDragPipeline(this.rotateHeadingManipulator)),this.rotateTiltManipulator=$(this.view,this.rotateTiltImage.texture),this.manipulators.add(this.rotateTiltManipulator),this.rotateTiltManipulator.events.on(\"grab-changed\",(e=>{this._onRotateTiltGrab(e),t(this.rotateTiltManipulator)})),this._handles.add(this._createRotateTiltDragPipeline(this.rotateTiltManipulator)),this.resizeManipulators=this._resizeHandles.map(((e,i)=>{const a=tt(this.view,e);return a.events.on(\"grab-changed\",(e=>{this._onResizeGrab(e,i),t(a)})),this._handles.add(this._createResizeDragPipeline(a)),a})),this.manipulators.addMany(this.resizeManipulators),this._previewPlaneGridVisualElement=et(this.view),this._previewPlaneOutlineVisualElement=it(this.view),this._previewPlaneOutlineVisualElement.width=F,this._handles.add(h((()=>this.analysisViewData.plane),(()=>this._updateManipulators()),p));const e=h((()=>this.state),(t=>{\"sliced\"===t&&this.finishToolCreation()}),u);this._handles.add([e,h((()=>this.view.state.camera),(()=>this._onCameraChange()))])}destroy(){this.rotateHeadingImage=s(this.rotateHeadingImage),this.rotateTiltImage=s(this.rotateTiltImage),this._handles=n(this._handles),this._viewHandles=n(this._viewHandles),this._removeFrameTask(),this._clearPointerMoveTimeout(),this._previewPlaneOutlineVisualElement=n(this._previewPlaneOutlineVisualElement),this._previewPlaneGridVisualElement=n(this._previewPlaneGridVisualElement)}get state(){const t=!!this.analysisViewData.plane,e=!!this.inputState;return t?t&&e?\"slicing\":t&&!e?\"sliced\":\"ready\":\"ready\"}get cursor(){return this._isPlacingSlicePlane||\"exclude\"===this.layersMode?\"crosshair\":r(this._creatingPointerId)?\"grabbing\":null}set analysis(t){if(null==t)throw new Error(\"SliceTool requires valid analysis, but null was provided.\");this._handles.remove(\"analysis\"),this._set(\"analysis\",t)}get inputState(){return this._get(\"inputState\")}set inputState(t){this._set(\"inputState\",t),this.analysisViewData.showGrid=r(t)&&\"resize\"===t.type,this._updateMaterials()}get _isPlacingSlicePlane(){return!this.inputState&&!this.analysisViewData.plane&&this.active}get _creatingPointerId(){return r(this.inputState)&&\"shift\"===this.inputState.type?this.inputState.creatingPointerId:null}enterExcludeLayerMode(){l(this.analysisViewData.plane)||(this._set(\"layersMode\",\"exclude\"),this.active||(this.view.activeTool=this))}exitExcludeLayerMode(){l(this.analysisViewData.plane)||(this._set(\"layersMode\",\"none\"),this.active&&(this.view.activeTool=null))}onDeactivate(){this._set(\"layersMode\",\"none\"),this._updatePreviewPlane(null)}onShow(){this._updateVisibility(!0)}onHide(){this._updateVisibility(!1)}_updateVisibility(t){this.shiftManipulator&&(this._updateManipulators(),t||this._clearPointerMoveTimeout())}onInputEvent(t){switch(t.type){case\"pointer-drag\":if(!Ht(t))return;this._isPlacingSlicePlane?this._onClickPlacePlane(t)&&t.stopPropagation():this._onPointerDrag(t)&&t.stopPropagation();break;case\"pointer-move\":this._onPointerMove(t);break;case\"pointer-up\":this._onPointerUp(t)&&t.stopPropagation();break;case\"immediate-click\":if(!Ht(t))return;this._onClickPlacePlane(t)&&t.stopPropagation();break;case\"click\":if(!Ht(t))return;this._onClickExcludeLayer(t)&&t.stopPropagation();break;case\"drag\":this.inputState&&t.stopPropagation();break;case\"key-down\":this._onKeyDown(t)&&t.stopPropagation();break;case\"key-up\":this._onKeyUp(t)&&t.stopPropagation()}}onEditableChange(){this.analysisViewData.editable=this.editable}_onPointerDrag(t){const e=this.inputState;if(t.pointerId===this._creatingPointerId&&r(e)&&\"shift\"===e.type){const i=bt(t);return this.shiftManipulator.events.emit(\"drag\",{action:e.hasBeenDragged?\"update\":\"start\",pointerType:t.pointerType,start:i,screenPoint:i}),e.hasBeenDragged=!0,!0}return!1}_onPointerMove(t){this._lastCursorPosition.x=t.x,this._lastCursorPosition.y=t.y,this._resetPointerMoveTimeout(),\"touch\"!==t.pointerType&&this._updatePreviewPlane(bt(t),this._activeKeyModifiers)}_onCameraChange(){this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),this._updateManipulators()}_onPointerUp(t){if(t.pointerId===this._creatingPointerId&&r(this.analysisViewData.plane)){const e=bt(t);return this.shiftManipulator.events.emit(\"drag\",{action:\"end\",start:e,screenPoint:e}),I(this.analysisViewData.plane,this._startPlane),this.inputState=null,!0}return!1}_onClickPlacePlane(t){if(\"exclude\"===this.layersMode)return!1;if(this._isPlacingSlicePlane){const i=bt(t),a=x();if(this._pickPlane(i,!1,this._activeKeyModifiers,a)){if(I(a,this._startPlane),this.analysis.shape=at(a,this.view,this.view.spatialReference,new e),\"pointer-drag\"===t.type){const e=this._calculatePickRay(i);this.inputState=St(e,t.pointerId,a.origin,a)}return!0}}return!1}_onClickExcludeLayer(t){return!(\"exclude\"!==this.layersMode||!this.created)&&(this.view.hitTest(bt(t)).then((t=>{if(t.results.length){const e=t.results[0],i=\"graphic\"===e?.type&&e.graphic;if(i){const t=i.sourceLayer||i.layer;t&&this.analysis.excludedLayers.push(t)}}else t.ground.layer?this.analysis.excludedLayers.push(t.ground.layer):this.analysis.excludeGroundSurface=!0})),this._set(\"layersMode\",\"none\"),this.active&&(this.view.activeTool=null),!0)}_onKeyDown(t){return(t.key===N||t.key===q)&&(this._activeKeyModifiers[t.key]=!0,r(this._previewPlane)&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)}_onKeyUp(t){return!(t.key!==N&&t.key!==q||!this._activeKeyModifiers[t.key])&&(delete this._activeKeyModifiers[t.key],r(this._previewPlane)&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)}_onShiftGrab(t){if(\"start\"!==t.action||l(this.analysisViewData.plane))return;const e=this._calculatePickRay(t.screenPoint);I(this.analysisViewData.plane,this._startPlane),this.inputState=St(e,null,this.shiftManipulator.renderLocation,this.analysisViewData.plane)}_createShiftDragPipeline(t){return Vt(t,((t,e,i)=>{const a=this.inputState;if(l(a)||\"shift\"!==a.type)return;const s=r(this.analysisViewData.plane)?I(this.analysisViewData.plane,x()):null;e.next(wt(this.view,a.shiftPlane)).next(this._shiftDragAdjustSensitivity(a)).next(this._shiftDragUpdatePlane(a)),i.next((()=>{r(s)&&this._updateBoundedPlane(s)}))}))}_shiftDragAdjustSensitivity(t){return e=>{if(l(this.analysisViewData.plane))return null;const i=.001,a=Math.min((1-Math.abs(f(R(this.analysisViewData.plane),e.ray.direction)/M(e.ray.direction)))/i,1),s=-O(this._startPlane.plane,e.renderEnd),n=-O(this._startPlane.plane,t.startPoint);return t.depth=t.depth*(1-a)+s*a-n,e}}_shiftDragUpdatePlane(t){return()=>{if(l(this.analysisViewData.plane))return;const e=D(L.get(),this._startPlane.origin),i=D(L.get(),R(this._startPlane));T(i,i,-t.depth),V(i,i,e);const a=j(i,this.analysisViewData.plane.basis1,this.analysisViewData.plane.basis2,x());this._updateBoundedPlane(a)}}_onRotateHeadingGrab(t){if(\"start\"!==t.action||l(this.analysisViewData.plane))return;const e=st(this.analysisViewData.plane,this.view.renderCoordsHelper,nt.HEADING,C()),i=this._calculatePickRay(t.screenPoint),a=H();z(e,i,a)&&(I(this.analysisViewData.plane,this._startPlane),this.inputState={type:\"rotate\",rotatePlane:e,startPoint:a})}_createRotateHeadingDragPipeline(t){return Vt(t,((t,e,i)=>{const a=this.inputState;if(l(a)||\"rotate\"!==a.type)return;const s=r(this.analysisViewData.plane)?I(this.analysisViewData.plane,x()):null;e.next(wt(this.view,a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdatePlaneFromRotate()),i.next((()=>{r(s)&&this._updateBoundedPlane(s)}))}))}_onRotateTiltGrab(t){if(\"start\"!==t.action||l(this.analysisViewData.plane))return;const e=st(this.analysisViewData.plane,this.view.renderCoordsHelper,nt.TILT,C()),i=this._calculatePickRay(t.screenPoint),a=H();z(e,i,a)&&(I(this.analysisViewData.plane,this._startPlane),this.inputState={type:\"rotate\",rotatePlane:e,startPoint:a})}_createRotateTiltDragPipeline(t){return Vt(t,((t,e,i)=>{const a=this.inputState;if(l(a)||\"rotate\"!==a.type)return;const s=r(this.analysisViewData.plane)?I(this.analysisViewData.plane,x()):null;e.next(wt(this.view,a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdatePlaneFromRotate()),i.next((()=>{r(s)&&this._updateBoundedPlane(s)}))}))}_rotateDragRenderPlaneToRotate(t){return e=>{if(l(this.analysisViewData.plane))return null;const i=G(t.rotatePlane),a=gt(t.startPoint,e.renderEnd,this.analysisViewData.plane.origin,i);return{...e,rotateAxis:i,rotateAngle:a}}}_rotateDragUpdatePlaneFromRotate(){return t=>{if(l(this.analysisViewData.plane))return;const e=m(K.get(),t.rotateAngle,t.rotateAxis);if(l(e))return;const i=b(L.get(),this._startPlane.basis1,e),a=b(L.get(),this._startPlane.basis2,e),s=j(this.analysisViewData.plane.origin,i,a,x());this._updateBoundedPlane(s)}}_onResizeGrab(t,e){if(\"start\"!==t.action||l(this.analysisViewData.plane))return;const i=this._calculatePickRay(t.screenPoint),a=L.get();z(this.analysisViewData.plane.plane,i,a)&&(I(this.analysisViewData.plane,this._startPlane),this.inputState={type:\"resize\",activeHandleIdx:e,startPoint:S(a)})}_createResizeDragPipeline(t){return Vt(t,((t,e,i)=>{const a=this.inputState;if(l(a)||\"resize\"!==a.type||l(this.analysisViewData.plane))return;const s=I(this.analysisViewData.plane,x());e.next(wt(this.view,this.analysisViewData.plane.plane)).next(this._resizeDragUpdatePlane(a)),i.next((()=>{this._updateBoundedPlane(s)}))}))}_resizeDragUpdatePlane(t){return e=>{if(l(this.analysisViewData.plane))return;const i=this._resizeHandles[t.activeHandleIdx],a=rt(i,t.startPoint,e.renderEnd,this.view.state.camera,this._startPlane,I(this.analysisViewData.plane));this._updateBoundedPlane(a)}}_updateBoundedPlane(t){const e=this.analysisViewData;if(!r(e))throw new Error(\"valid internal object expected\");e.plane=t}_updatePreviewPlane(t,e={}){let i=this._previewPlane;if(this._previewPlane=null,l(t))return this._removeFrameTask(),void this._updateManipulators();if(!this.analysisViewData.plane&&this.active){const a=r(i)?i:x();if(i=r(i)?I(i,xt):null,this._pickPlane(t,!0,e,a)){const t=W;let e=!1;r(i)&&(e=f(i.plane,a.plane)<t||f(k(L.get(),i.basis1),k(L.get(),a.basis1))<t),e&&(this._previewPlaneOpacity=0),this._previewPlane=a}}r(this._previewPlane)&&l(this._frameTask)&&0===this._previewPlaneOpacity?this._frameTask=c({update:({deltaTime:t})=>{this._previewPlaneOpacity=Math.min(this._previewPlaneOpacity+t/(1e3*Z),1),this._updateManipulators(),1===this._previewPlaneOpacity&&this._removeFrameTask()}}):l(this._previewPlane)&&r(this._frameTask)?this._removeFrameTask():r(this._previewPlane)&&this._updateManipulators()}_removeFrameTask(){this._frameTask=o(this._frameTask)}_calculatePickRay(t){const e=U(),i=_(t,It);return ft(this.view.state.camera,i,e),k(e.direction,e.direction),e}_pickMinResult(t){const e=_(t,A.get());return this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(e,this._intersector),this._intersector.results.min}_pickPlane(t,e,i,a){const s=this._pickMinResult(t),n=L.get();if(!s.getIntersectionPoint(n))return!1;const r=s.getTransformedNormal(L.get()),l=this.view.state.camera;f(r,l.viewForward)>0&&T(r,r,-1);const o=lt(n,l),h=(e?1:-1)*o*X,p=T(L.get(),r,h);V(p,p,n);const u=this.analysis.tiltEnabled?ot.TILTED:ot.HORIZONTAL_OR_VERTICAL,c=i[N]?ot.VERTICAL:i[q]?ot.HORIZONTAL:u;return ht(p,r,o,o,l,c,this.view.renderCoordsHelper,a),!0}_clearPointerMoveTimeout(){this._prevPointerMoveTimeout=o(this._prevPointerMoveTimeout)}_resetPointerMoveTimeout(){this._clearPointerMoveTimeout(),this.shiftManipulator.state|=pt,this.rotateHeadingManipulator.state|=pt,this.rotateTiltManipulator.state|=pt,this._prevPointerMoveTimeout=this.clock.setTimeout((()=>{this.shiftManipulator.state&=~pt,this.rotateHeadingManipulator.state&=~pt,this.rotateTiltManipulator.state&=~pt}),this._pointerMoveTimerMs)}_updateManipulators(){if(kt.disableEngineLayers)return;let t=null,e=!1;if(r(this.analysisViewData.plane))t=this.analysisViewData.plane,e=!1;else{if(!r(this._previewPlane))return this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach((t=>t.available=!1)),this._previewPlaneOutlineVisualElement.visible=!1,void(this._previewPlaneGridVisualElement.visible=!1);t=this._previewPlane,e=!0}const i=ut(t,K.get());e?(this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach((t=>t.available=!1)),this._previewPlaneOutlineVisualElement.visible=!0,this._previewPlaneGridVisualElement.visible=!0):(this.shiftManipulator.available=!0,this.rotateHeadingManipulator.available=!0,this.rotateTiltManipulator.available=this.analysis.tiltEnabled,this.resizeManipulators.forEach((t=>t.available=!0)),ct(this.shiftManipulator,i,t,this.view.state.camera),dt(this.rotateHeadingManipulator,i,t,this.view.renderCoordsHelper),_t(this.rotateTiltManipulator,i,t),this.resizeManipulators.forEach(((e,a)=>vt(e,this._resizeHandles[a],i,t))),this._previewPlaneOutlineVisualElement.visible=!1,this._previewPlaneGridVisualElement.visible=!1);const a=E(L.get(),M(t.basis1),M(t.basis2),1),s=g(K.get(),a),n=w(s,i,s);this._previewPlaneOutlineVisualElement.transform=n,this._previewPlaneGridVisualElement.transform=n,this._updateMaterials()}_updateMaterials(){const t=[J[0],J[1],J[2],J[3]*this._previewPlaneOpacity];this._previewPlaneOutlineVisualElement.color=t;const e=[Q[0],Q[1],Q[2],Q[3]*this._previewPlaneOpacity],i=[0,0,0,0];this._previewPlaneGridVisualElement.backgroundColor=e,this._previewPlaneGridVisualElement.gridColor=i}_updateManipulatorsInteractive(t){if(!t.grabbing)return this.shiftManipulator.interactive=!0,this.rotateHeadingManipulator.interactive=!0,this.rotateTiltManipulator.interactive=!0,void this.resizeManipulators.forEach((t=>{t.interactive=!0}));this.shiftManipulator.interactive=this.shiftManipulator===t,this.rotateHeadingManipulator.interactive=this.rotateHeadingManipulator===t,this.rotateTiltManipulator.interactive=this.rotateTiltManipulator===t,this.resizeManipulators.forEach((e=>{e.interactive=e===t}))}testData(){return{plane:this.analysisViewData.plane,setPointerMoveTimerMs:t=>{this._pointerMoveTimerMs=t}}}};function St(t,e,i,a){const s=Pt(i,R(a),t.direction,C()),n=H();return z(s,t,n)?{type:\"shift\",creatingPointerId:e,hasBeenDragged:!1,shiftPlane:s,depth:0,startPoint:n}:null}function Ht(t){return\"mouse\"!==t.pointerType||0===t.button}Et.disableEngineLayers=!1,t([P()],Et.prototype,\"clock\",void 0),t([P({constructOnly:!0})],Et.prototype,\"view\",void 0),t([P()],Et.prototype,\"analysisViewData\",void 0),t([P({readOnly:!0})],Et.prototype,\"state\",null),t([P({readOnly:!0})],Et.prototype,\"cursor\",null),t([P()],Et.prototype,\"analysis\",null),t([P()],Et.prototype,\"removeIncompleteOnCancel\",void 0),t([P({readOnly:!0})],Et.prototype,\"layersMode\",void 0),t([P({value:null})],Et.prototype,\"inputState\",null),t([P()],Et.prototype,\"_isPlacingSlicePlane\",null),t([P()],Et.prototype,\"_creatingPointerId\",null),Et=kt=t([y(\"esri.views.3d.analysis.Slice.SliceTool\")],Et);const xt=x(),It=v(),Rt=Et;export{Rt as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}