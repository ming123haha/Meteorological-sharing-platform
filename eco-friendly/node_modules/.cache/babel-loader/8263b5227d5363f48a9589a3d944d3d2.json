{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport { isSome as r } from \"../../../core/maybe.js\";\nimport { property as s } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { TaskPriority as u, ImmediateTask as a } from \"../../support/Scheduler.js\";\nlet i = class extends t {\n  constructor(e, t) {\n    super({}), this._stage = e, this._textureRequests = new Map(), this._frameTask = t?.registerTask(u.TEXTURE_UNLOAD) ?? a;\n  }\n\n  normalizeCtorArgs() {\n    return {};\n  }\n\n  destroy() {\n    super.destroy(), this._frameTask.remove(), this._textureRequests.forEach(e => this._releaseTextureRequest(e)), this._textureRequests.clear();\n  }\n\n  get updating() {\n    return this._frameTask.updating;\n  }\n\n  fromData(e, t, r) {\n    const s = this.makeUid(e);\n\n    let o = this._textureRequests.get(s);\n\n    return o || (o = {\n      referenceCount: 0,\n      texture: t(),\n      textureAsync: null,\n      abortController: null,\n      onRemove: r\n    }, this._stage && (this._stage.add(o.texture), this._stage.loadImmediate(o.texture)), this._textureRequests.set(s, o)), o.referenceCount++, {\n      uid: s,\n      texture: o.texture,\n      release: () => this._release(s)\n    };\n  }\n\n  _release(e) {\n    const t = this._textureRequests.get(e);\n\n    t ? (t.referenceCount < 1 && console.warn(\"TextureCollection: reference count is < 1 for \" + e), t.referenceCount--, t.referenceCount < 1 && this._frameTask.schedule(() => this._releaseNow(e))) : console.warn(`TextureCollection: texture doesn't exist: '${e}'`);\n  }\n\n  get test() {\n    return {\n      textureRequests: this._textureRequests\n    };\n  }\n\n  _releaseNow(e) {\n    if (!this._textureRequests) return;\n\n    const t = this._textureRequests.get(e);\n\n    !t || t.referenceCount > 0 || (this._releaseTextureRequest(t), this._textureRequests.delete(e));\n  }\n\n  _releaseTextureRequest(e) {\n    e.onRemove && e.onRemove(), e.texture ? this._stage?.remove(e.texture) : e.abortController && (e.abortController.abort(), e.abortController = null);\n  }\n\n  makeUid(e, t = null) {\n    return r(t) ? `${e}.${t}px` : e;\n  }\n\n};\ne([s()], i.prototype, \"_frameTask\", void 0), e([s()], i.prototype, \"updating\", null), i = e([o(\"esri.views.3d.support.TextureCollection\")], i);\nexport { i as TextureCollection };","map":{"version":3,"names":["_","e","t","isSome","r","property","s","subclass","o","TaskPriority","u","ImmediateTask","a","i","constructor","_stage","_textureRequests","Map","_frameTask","registerTask","TEXTURE_UNLOAD","normalizeCtorArgs","destroy","remove","forEach","_releaseTextureRequest","clear","updating","fromData","makeUid","get","referenceCount","texture","textureAsync","abortController","onRemove","add","loadImmediate","set","uid","release","_release","console","warn","schedule","_releaseNow","test","textureRequests","delete","abort","prototype","TextureCollection"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/support/TextureCollection.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{isSome as r}from\"../../../core/maybe.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{TaskPriority as u,ImmediateTask as a}from\"../../support/Scheduler.js\";let i=class extends t{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=t?.registerTask(u.TEXTURE_UNLOAD)??a}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach((e=>this._releaseTextureRequest(e))),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,r){const s=this.makeUid(e);let o=this._textureRequests.get(s);return o||(o={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:r},this._stage&&(this._stage.add(o.texture),this._stage.loadImmediate(o.texture)),this._textureRequests.set(s,o)),o.referenceCount++,{uid:s,texture:o.texture,release:()=>this._release(s)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn(\"TextureCollection: reference count is < 1 for \"+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule((()=>this._releaseNow(e)))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){e.onRemove&&e.onRemove(),e.texture?this._stage?.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return r(t)?`${e}.${t}px`:e}};e([s()],i.prototype,\"_frameTask\",void 0),e([s()],i.prototype,\"updating\",null),i=e([o(\"esri.views.3d.support.TextureCollection\")],i);export{i as TextureCollection};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}