{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from \"../../../core/Error.js\";\nimport { isAborted as e, createAbortError as a } from \"../../../core/promiseUtils.js\";\nimport { Z as n } from \"../../../chunks/Zlib.js\";\n\nclass i {\n  constructor(t) {\n    this._canvas = null, this._ctx = null, t && (this._canvas = t.canvas, this._ctx = t.ctx || t.canvas && t.canvas.getContext(\"2d\"));\n  }\n\n  decode(n, s, r) {\n    if (!n || n.byteLength < 10) throw new t(\"imagecanvasdecoder: decode\", \"required a valid encoded data as input.\");\n    let {\n      width: c = 0,\n      height: h = 0,\n      format: o\n    } = s;\n    const {\n      applyJpegMask: l\n    } = s;\n    if (l && (!c || !h)) throw new t(\"imagecanvasdecoder: decode\", \"image width and height are needed to apply jpeg mask directly to canvas\");\n    return new Promise((t, d) => {\n      let g = null;\n      \"jpg\" === o && l && (g = i._getMask(n, {\n        width: c,\n        height: h\n      }));\n      const w = new Blob([new Uint8Array(n)], {\n        type: \"image/\" + o == \"jpg\" ? \"jpeg\" : o\n      }),\n            v = URL.createObjectURL(w),\n            m = new Image();\n\n      let _;\n\n      m.src = v, m.onload = () => {\n        if (URL.revokeObjectURL(v), e(r)) return void d(a());\n        c = m.width, h = m.height, this._canvas && this._ctx ? (this._canvas.width === c && this._canvas.height === h || (this._canvas.width = c, this._canvas.height = h), this._ctx.clearRect(0, 0, c, h)) : (this._canvas = document.createElement(\"canvas\"), this._canvas.width = c, this._canvas.height = h, this._ctx = this._canvas.getContext(\"2d\")), this._ctx.drawImage(m, 0, 0);\n\n        const n = this._ctx.getImageData(0, 0, c, h);\n\n        let i;\n\n        if (_ = n.data, s.renderOnCanvas) {\n          if (g) for (i = 0; i < g.length; i++) g[i] ? _[4 * i + 3] = 255 : _[4 * i + 3] = 0;\n          return this._ctx.putImageData(n, 0, 0), void t(null);\n        }\n\n        const o = c * h,\n              l = new Uint8Array(o),\n              w = new Uint8Array(o),\n              p = new Uint8Array(o);\n        if (g) for (i = 0; i < o; i++) l[i] = _[4 * i], w[i] = _[4 * i + 1], p[i] = _[4 * i + 2];else for (g = new Uint8Array(o), i = 0; i < o; i++) l[i] = _[4 * i], w[i] = _[4 * i + 1], p[i] = _[4 * i + 2], g[i] = _[4 * i + 3];\n        t({\n          width: c,\n          height: h,\n          pixels: [l, w, p],\n          mask: g,\n          pixelType: \"u8\"\n        });\n      }, m.onerror = () => {\n        URL.revokeObjectURL(v), d(\"cannot load image\");\n      };\n    });\n  }\n\n  static _getMask(t, e) {\n    let a = null;\n\n    try {\n      const i = new Uint8Array(t),\n            s = Math.ceil(i.length / 2);\n      let r = 0;\n      const c = i.length - 2;\n\n      for (r = s; r < c && (255 !== i[r] || 217 !== i[r + 1]); r++);\n\n      if (r += 2, r < i.length - 1) {\n        const t = new n(i.subarray(r)).getBytes();\n        a = new Uint8Array(e.width * e.height);\n        let s = 0;\n\n        for (let e = 0; e < t.length; e++) for (let n = 7; n >= 0; n--) a[s++] = t[e] >> n & 1;\n      }\n    } catch (i) {}\n\n    return a;\n  }\n\n}\n\nexport { i as default };","map":{"version":3,"names":["t","isAborted","e","createAbortError","a","Z","n","i","constructor","_canvas","_ctx","canvas","ctx","getContext","decode","s","r","byteLength","width","c","height","h","format","o","applyJpegMask","l","Promise","d","g","_getMask","w","Blob","Uint8Array","type","v","URL","createObjectURL","m","Image","_","src","onload","revokeObjectURL","clearRect","document","createElement","drawImage","getImageData","data","renderOnCanvas","length","putImageData","p","pixels","mask","pixelType","onerror","Math","ceil","subarray","getBytes","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/support/rasterFormats/ImageCanvasDecoder.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Error.js\";import{isAborted as e,createAbortError as a}from\"../../../core/promiseUtils.js\";import{Z as n}from\"../../../chunks/Zlib.js\";class i{constructor(t){this._canvas=null,this._ctx=null,t&&(this._canvas=t.canvas,this._ctx=t.ctx||t.canvas&&t.canvas.getContext(\"2d\"))}decode(n,s,r){if(!n||n.byteLength<10)throw new t(\"imagecanvasdecoder: decode\",\"required a valid encoded data as input.\");let{width:c=0,height:h=0,format:o}=s;const{applyJpegMask:l}=s;if(l&&(!c||!h))throw new t(\"imagecanvasdecoder: decode\",\"image width and height are needed to apply jpeg mask directly to canvas\");return new Promise(((t,d)=>{let g=null;\"jpg\"===o&&l&&(g=i._getMask(n,{width:c,height:h}));const w=new Blob([new Uint8Array(n)],{type:\"image/\"+o==\"jpg\"?\"jpeg\":o}),v=URL.createObjectURL(w),m=new Image;let _;m.src=v,m.onload=()=>{if(URL.revokeObjectURL(v),e(r))return void d(a());c=m.width,h=m.height,this._canvas&&this._ctx?(this._canvas.width===c&&this._canvas.height===h||(this._canvas.width=c,this._canvas.height=h),this._ctx.clearRect(0,0,c,h)):(this._canvas=document.createElement(\"canvas\"),this._canvas.width=c,this._canvas.height=h,this._ctx=this._canvas.getContext(\"2d\")),this._ctx.drawImage(m,0,0);const n=this._ctx.getImageData(0,0,c,h);let i;if(_=n.data,s.renderOnCanvas){if(g)for(i=0;i<g.length;i++)g[i]?_[4*i+3]=255:_[4*i+3]=0;return this._ctx.putImageData(n,0,0),void t(null)}const o=c*h,l=new Uint8Array(o),w=new Uint8Array(o),p=new Uint8Array(o);if(g)for(i=0;i<o;i++)l[i]=_[4*i],w[i]=_[4*i+1],p[i]=_[4*i+2];else for(g=new Uint8Array(o),i=0;i<o;i++)l[i]=_[4*i],w[i]=_[4*i+1],p[i]=_[4*i+2],g[i]=_[4*i+3];t({width:c,height:h,pixels:[l,w,p],mask:g,pixelType:\"u8\"})},m.onerror=()=>{URL.revokeObjectURL(v),d(\"cannot load image\")}}))}static _getMask(t,e){let a=null;try{const i=new Uint8Array(t),s=Math.ceil(i.length/2);let r=0;const c=i.length-2;for(r=s;r<c&&(255!==i[r]||217!==i[r+1]);r++);if(r+=2,r<i.length-1){const t=new n(i.subarray(r)).getBytes();a=new Uint8Array(e.width*e.height);let s=0;for(let e=0;e<t.length;e++)for(let n=7;n>=0;n--)a[s++]=t[e]>>n&1}}catch(i){}return a}}export{i as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}