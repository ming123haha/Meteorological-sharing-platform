{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/Error.js\";\nimport r from \"../../../../../core/Logger.js\";\nimport { disposeMaybe as t, isSome as s } from \"../../../../../core/maybe.js\";\nimport { WGLDrawPhase as i } from \"../enums.js\";\nimport a from \"../VertexStream.js\";\nimport { createProgramTemplate as n } from \"../shaders/BlendPrograms.js\";\nimport { BlendFactor as o, TextureType as d, PixelFormat as u, PixelType as f, TextureWrapMode as c, TextureSamplingMode as m } from \"../../../../webgl/enums.js\";\nimport { Texture as h } from \"../../../../webgl/Texture.js\";\nconst l = r.getLogger(\"esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect\");\n\nclass _ {\n  constructor() {\n    this._size = [0, 0];\n  }\n\n  dispose(e) {\n    this._backBufferTexture = t(this._backBufferTexture), this._quad = t(this._quad);\n  }\n\n  draw(r, t, s, a, d) {\n    const {\n      context: u,\n      drawPhase: f\n    } = r;\n    if (this._setupShader(u), a && \"normal\" !== a && f !== i.LABEL) return void this._drawBlended(r, t, s, a, d);\n    const c = n(\"normal\"),\n          m = u.programCache.acquire(c.shaders.vertexShader, c.shaders.fragmentShader, c.attributes);\n    if (!m) return void l.error(new e(\"mapview-BlendEffect\", 'Error creating shader program for blend mode \"normal\"'));\n    u.useProgram(m), t.setSamplingMode(s), u.bindTexture(t, 0), m.setUniform1i(\"u_layerTexture\", 0), m.setUniform1f(\"u_opacity\", d), u.setBlendingEnabled(!0), u.setBlendFunction(o.ONE, o.ONE_MINUS_SRC_ALPHA);\n    const h = this._quad;\n    h.draw(), h.unbind(), m.dispose();\n  }\n\n  _drawBlended(r, t, i, a, d) {\n    const {\n      context: u,\n      state: f,\n      pixelRatio: c,\n      inFadeTransition: m\n    } = r,\n          {\n      size: h\n    } = f,\n          _ = u.getBoundFramebufferObject();\n\n    let p, b;\n\n    if (s(_)) {\n      const e = _.descriptor;\n      p = e.width, b = e.height;\n    } else p = Math.round(c * h[0]), b = Math.round(c * h[1]);\n\n    this._createOrResizeTexture(r, p, b);\n\n    const g = this._backBufferTexture;\n    _.copyToTexture(0, 0, p, b, 0, 0, g), u.setStencilTestEnabled(!1), u.setStencilWriteMask(0), u.setBlendingEnabled(!0), u.setDepthTestEnabled(!1), u.setDepthWriteEnabled(!1);\n    const x = n(a),\n          E = u.programCache.acquire(x.shaders.vertexShader, x.shaders.fragmentShader, x.attributes);\n    if (!E) return void l.error(new e(\"mapview-BlendEffect\", `Error creating shader program for blend mode ${a}`));\n    u.useProgram(E), g.setSamplingMode(i), u.bindTexture(g, 0), E.setUniform1i(\"u_backbufferTexture\", 0), t.setSamplingMode(i), u.bindTexture(t, 1), E.setUniform1i(\"u_layerTexture\", 1), E.setUniform1f(\"u_opacity\", d), E.setUniform1f(\"u_inFadeOpacity\", m ? 1 : 0), u.setBlendFunction(o.ONE, o.ZERO);\n    const T = this._quad;\n    T.draw(), T.unbind(), E.dispose(), u.setBlendFunction(o.ONE, o.ONE_MINUS_SRC_ALPHA);\n  }\n\n  _setupShader(e) {\n    this._quad || (this._quad = new a(e, [-1, -1, 1, -1, -1, 1, 1, 1]));\n  }\n\n  _createOrResizeTexture(e, r, t) {\n    const {\n      context: s\n    } = e;\n    null !== this._backBufferTexture && r === this._size[0] && t === this._size[1] || (this._backBufferTexture ? this._backBufferTexture.resize(r, t) : this._backBufferTexture = new h(s, {\n      target: d.TEXTURE_2D,\n      pixelFormat: u.RGBA,\n      internalFormat: u.RGBA,\n      dataType: f.UNSIGNED_BYTE,\n      wrapMode: c.CLAMP_TO_EDGE,\n      samplingMode: m.LINEAR,\n      flipped: !1,\n      width: r,\n      height: t\n    }), this._size[0] = r, this._size[1] = t);\n  }\n\n}\n\nexport { _ as BlendEffect };","map":{"version":3,"names":["e","r","disposeMaybe","t","isSome","s","WGLDrawPhase","i","a","createProgramTemplate","n","BlendFactor","o","TextureType","d","PixelFormat","u","PixelType","f","TextureWrapMode","c","TextureSamplingMode","m","Texture","h","l","getLogger","_","constructor","_size","dispose","_backBufferTexture","_quad","draw","context","drawPhase","_setupShader","LABEL","_drawBlended","programCache","acquire","shaders","vertexShader","fragmentShader","attributes","error","useProgram","setSamplingMode","bindTexture","setUniform1i","setUniform1f","setBlendingEnabled","setBlendFunction","ONE","ONE_MINUS_SRC_ALPHA","unbind","state","pixelRatio","inFadeTransition","size","getBoundFramebufferObject","p","b","descriptor","width","height","Math","round","_createOrResizeTexture","g","copyToTexture","setStencilTestEnabled","setStencilWriteMask","setDepthTestEnabled","setDepthWriteEnabled","x","E","ZERO","T","resize","target","TEXTURE_2D","pixelFormat","RGBA","internalFormat","dataType","UNSIGNED_BYTE","wrapMode","CLAMP_TO_EDGE","samplingMode","LINEAR","flipped","BlendEffect"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/effects/BlendEffect.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import r from\"../../../../../core/Logger.js\";import{disposeMaybe as t,isSome as s}from\"../../../../../core/maybe.js\";import{WGLDrawPhase as i}from\"../enums.js\";import a from\"../VertexStream.js\";import{createProgramTemplate as n}from\"../shaders/BlendPrograms.js\";import{BlendFactor as o,TextureType as d,PixelFormat as u,PixelType as f,TextureWrapMode as c,TextureSamplingMode as m}from\"../../../../webgl/enums.js\";import{Texture as h}from\"../../../../webgl/Texture.js\";const l=r.getLogger(\"esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect\");class _{constructor(){this._size=[0,0]}dispose(e){this._backBufferTexture=t(this._backBufferTexture),this._quad=t(this._quad)}draw(r,t,s,a,d){const{context:u,drawPhase:f}=r;if(this._setupShader(u),a&&\"normal\"!==a&&f!==i.LABEL)return void this._drawBlended(r,t,s,a,d);const c=n(\"normal\"),m=u.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes);if(!m)return void l.error(new e(\"mapview-BlendEffect\",'Error creating shader program for blend mode \"normal\"'));u.useProgram(m),t.setSamplingMode(s),u.bindTexture(t,0),m.setUniform1i(\"u_layerTexture\",0),m.setUniform1f(\"u_opacity\",d),u.setBlendingEnabled(!0),u.setBlendFunction(o.ONE,o.ONE_MINUS_SRC_ALPHA);const h=this._quad;h.draw(),h.unbind(),m.dispose()}_drawBlended(r,t,i,a,d){const{context:u,state:f,pixelRatio:c,inFadeTransition:m}=r,{size:h}=f,_=u.getBoundFramebufferObject();let p,b;if(s(_)){const e=_.descriptor;p=e.width,b=e.height}else p=Math.round(c*h[0]),b=Math.round(c*h[1]);this._createOrResizeTexture(r,p,b);const g=this._backBufferTexture;_.copyToTexture(0,0,p,b,0,0,g),u.setStencilTestEnabled(!1),u.setStencilWriteMask(0),u.setBlendingEnabled(!0),u.setDepthTestEnabled(!1),u.setDepthWriteEnabled(!1);const x=n(a),E=u.programCache.acquire(x.shaders.vertexShader,x.shaders.fragmentShader,x.attributes);if(!E)return void l.error(new e(\"mapview-BlendEffect\",`Error creating shader program for blend mode ${a}`));u.useProgram(E),g.setSamplingMode(i),u.bindTexture(g,0),E.setUniform1i(\"u_backbufferTexture\",0),t.setSamplingMode(i),u.bindTexture(t,1),E.setUniform1i(\"u_layerTexture\",1),E.setUniform1f(\"u_opacity\",d),E.setUniform1f(\"u_inFadeOpacity\",m?1:0),u.setBlendFunction(o.ONE,o.ZERO);const T=this._quad;T.draw(),T.unbind(),E.dispose(),u.setBlendFunction(o.ONE,o.ONE_MINUS_SRC_ALPHA)}_setupShader(e){this._quad||(this._quad=new a(e,[-1,-1,1,-1,-1,1,1,1]))}_createOrResizeTexture(e,r,t){const{context:s}=e;null!==this._backBufferTexture&&r===this._size[0]&&t===this._size[1]||(this._backBufferTexture?this._backBufferTexture.resize(r,t):this._backBufferTexture=new h(s,{target:d.TEXTURE_2D,pixelFormat:u.RGBA,internalFormat:u.RGBA,dataType:f.UNSIGNED_BYTE,wrapMode:c.CLAMP_TO_EDGE,samplingMode:m.LINEAR,flipped:!1,width:r,height:t}),this._size[0]=r,this._size[1]=t)}}export{_ as BlendEffect};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}