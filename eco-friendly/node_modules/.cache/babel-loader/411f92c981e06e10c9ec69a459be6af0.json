{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { Milliseconds as t } from \"../../../../../core/time.js\";\nimport { AnimatedSymbolRepeatType as e } from \"../../../../../symbols/cim/enums.js\";\nimport { getMaterialGroup as r, getRandomValue as i } from \"../grouping.js\";\n\nfunction a(e) {\n  return t(e.frameDurations.reduce((t, e) => t + e, 0));\n}\n\nfunction n(t) {\n  const {\n    width: e,\n    height: r\n  } = t;\n  return {\n    frameDurations: t.frameDurations.reverse(),\n    getFrame: e => {\n      const r = t.frameDurations.length - 1 - e;\n      return t.getFrame(r);\n    },\n    width: e,\n    height: r\n  };\n}\n\nfunction s(e, r) {\n  const {\n    width: i,\n    height: n,\n    getFrame: s\n  } = e,\n        o = r / a(e);\n  return {\n    frameDurations: e.frameDurations.map(e => t(e * o)),\n    getFrame: s,\n    width: i,\n    height: n\n  };\n}\n\nfunction o(e, r) {\n  const {\n    width: i,\n    height: a,\n    getFrame: n\n  } = e,\n        s = e.frameDurations.slice(),\n        o = s.shift();\n  return s.unshift(t(o + r)), {\n    frameDurations: s,\n    getFrame: n,\n    width: i,\n    height: a\n  };\n}\n\nfunction m(e, r) {\n  const {\n    width: i,\n    height: a,\n    getFrame: n\n  } = e,\n        s = e.frameDurations.slice(),\n        o = s.pop();\n  return s.push(t(o + r)), {\n    frameDurations: s,\n    getFrame: n,\n    width: i,\n    height: a\n  };\n}\n\nclass h {\n  constructor(t, e, r, i) {\n    this._animation = t, this._repeatType = r, this._onFrameData = i, this._direction = 1, this._currentFrame = 0, this.timeToFrame = this._animation.frameDurations[this._currentFrame];\n    let a = 0;\n\n    for (; e > a;) a += this.timeToFrame, this.nextFrame();\n\n    const n = this._animation.getFrame(this._currentFrame);\n\n    this._onFrameData(n);\n  }\n\n  nextFrame() {\n    if (this._currentFrame += this._direction, this._direction > 0) {\n      if (this._currentFrame === this._animation.frameDurations.length) switch (this._repeatType) {\n        case e.None:\n          this._currentFrame -= this._direction;\n          break;\n\n        case e.Loop:\n          this._currentFrame = 0;\n          break;\n\n        case e.Oscillate:\n          this._currentFrame -= this._direction, this._direction = -1;\n      }\n    } else if (-1 === this._currentFrame) switch (this._repeatType) {\n      case e.None:\n        this._currentFrame -= this._direction;\n        break;\n\n      case e.Loop:\n        this._currentFrame = this._animation.frameDurations.length - 1;\n        break;\n\n      case e.Oscillate:\n        this._currentFrame -= this._direction, this._direction = 1;\n    }\n\n    this.timeToFrame = this._animation.frameDurations[this._currentFrame];\n\n    const t = this._animation.getFrame(this._currentFrame);\n\n    this._onFrameData(t);\n  }\n\n}\n\nfunction c(c, u, f, l) {\n  let _,\n      {\n    repeatType: F\n  } = u;\n\n  if (null == F && (F = e.Loop), !0 === u.reverseAnimation && (c = n(c)), null != u.duration && (c = s(c, t(1e3 * u.duration))), null != u.repeatDelay) {\n    const r = 1e3 * u.repeatDelay;\n    F === e.Loop ? c = m(c, t(r)) : F === e.Oscillate && (c = o(m(c, t(r / 2)), t(r / 2)));\n  }\n\n  if (null != u.startTimeOffset) _ = t(1e3 * u.startTimeOffset);else if (null != u.randomizeStartTime) {\n    const e = r(f),\n          n = 82749913,\n          s = null != u.randomizeStartSeed ? u.randomizeStartSeed : n,\n          o = i(e, s);\n    _ = t(o * a(c));\n  } else _ = t(0);\n  return new h(c, _, F, l);\n}\n\nfunction u(t, e, r, i) {\n  const a = null == e.playAnimation || e.playAnimation,\n        n = c(t, e, r, i);\n  let s,\n      o = n.timeToFrame;\n\n  function m() {\n    s = a && setTimeout(() => {\n      n.nextFrame(), o = n.timeToFrame, m();\n    }, o);\n  }\n\n  return m(), {\n    remove: () => {\n      a && clearTimeout(s);\n    }\n  };\n}\n\nexport { h as Player, s as adjustDuration, m as appendDelay, c as createPlayer, a as getDuration, u as play, o as prependDelay, n as reverse };","map":{"version":3,"names":["Milliseconds","t","AnimatedSymbolRepeatType","e","getMaterialGroup","r","getRandomValue","i","a","frameDurations","reduce","n","width","height","reverse","getFrame","length","s","o","map","slice","shift","unshift","m","pop","push","h","constructor","_animation","_repeatType","_onFrameData","_direction","_currentFrame","timeToFrame","nextFrame","None","Loop","Oscillate","c","u","f","l","_","repeatType","F","reverseAnimation","duration","repeatDelay","startTimeOffset","randomizeStartTime","randomizeStartSeed","playAnimation","setTimeout","remove","clearTimeout","Player","adjustDuration","appendDelay","createPlayer","getDuration","play","prependDelay"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/animatedFormats/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{Milliseconds as t}from\"../../../../../core/time.js\";import{AnimatedSymbolRepeatType as e}from\"../../../../../symbols/cim/enums.js\";import{getMaterialGroup as r,getRandomValue as i}from\"../grouping.js\";function a(e){return t(e.frameDurations.reduce(((t,e)=>t+e),0))}function n(t){const{width:e,height:r}=t;return{frameDurations:t.frameDurations.reverse(),getFrame:e=>{const r=t.frameDurations.length-1-e;return t.getFrame(r)},width:e,height:r}}function s(e,r){const{width:i,height:n,getFrame:s}=e,o=r/a(e);return{frameDurations:e.frameDurations.map((e=>t(e*o))),getFrame:s,width:i,height:n}}function o(e,r){const{width:i,height:a,getFrame:n}=e,s=e.frameDurations.slice(),o=s.shift();return s.unshift(t(o+r)),{frameDurations:s,getFrame:n,width:i,height:a}}function m(e,r){const{width:i,height:a,getFrame:n}=e,s=e.frameDurations.slice(),o=s.pop();return s.push(t(o+r)),{frameDurations:s,getFrame:n,width:i,height:a}}class h{constructor(t,e,r,i){this._animation=t,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let a=0;for(;e>a;)a+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case e.None:this._currentFrame-=this._direction;break;case e.Loop:this._currentFrame=0;break;case e.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case e.None:this._currentFrame-=this._direction;break;case e.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case e.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const t=this._animation.getFrame(this._currentFrame);this._onFrameData(t)}}function c(c,u,f,l){let _,{repeatType:F}=u;if(null==F&&(F=e.Loop),!0===u.reverseAnimation&&(c=n(c)),null!=u.duration&&(c=s(c,t(1e3*u.duration))),null!=u.repeatDelay){const r=1e3*u.repeatDelay;F===e.Loop?c=m(c,t(r)):F===e.Oscillate&&(c=o(m(c,t(r/2)),t(r/2)))}if(null!=u.startTimeOffset)_=t(1e3*u.startTimeOffset);else if(null!=u.randomizeStartTime){const e=r(f),n=82749913,s=null!=u.randomizeStartSeed?u.randomizeStartSeed:n,o=i(e,s);_=t(o*a(c))}else _=t(0);return new h(c,_,F,l)}function u(t,e,r,i){const a=null==e.playAnimation||e.playAnimation,n=c(t,e,r,i);let s,o=n.timeToFrame;function m(){s=a&&setTimeout((()=>{n.nextFrame(),o=n.timeToFrame,m()}),o)}return m(),{remove:()=>{a&&clearTimeout(s)}}}export{h as Player,s as adjustDuration,m as appendDelay,c as createPlayer,a as getDuration,u as play,o as prependDelay,n as reverse};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,YAAY,IAAIC,CAAvB,QAA6B,6BAA7B;AAA2D,SAAOC,wBAAwB,IAAIC,CAAnC,QAAyC,qCAAzC;AAA+E,SAAOC,gBAAgB,IAAIC,CAA3B,EAA6BC,cAAc,IAAIC,CAA/C,QAAqD,gBAArD;;AAAsE,SAASC,CAAT,CAAWL,CAAX,EAAa;EAAC,OAAOF,CAAC,CAACE,CAAC,CAACM,cAAF,CAAiBC,MAAjB,CAAyB,CAACT,CAAD,EAAGE,CAAH,KAAOF,CAAC,GAACE,CAAlC,EAAqC,CAArC,CAAD,CAAR;AAAkD;;AAAA,SAASQ,CAAT,CAAWV,CAAX,EAAa;EAAC,MAAK;IAACW,KAAK,EAACT,CAAP;IAASU,MAAM,EAACR;EAAhB,IAAmBJ,CAAxB;EAA0B,OAAM;IAACQ,cAAc,EAACR,CAAC,CAACQ,cAAF,CAAiBK,OAAjB,EAAhB;IAA2CC,QAAQ,EAACZ,CAAC,IAAE;MAAC,MAAME,CAAC,GAACJ,CAAC,CAACQ,cAAF,CAAiBO,MAAjB,GAAwB,CAAxB,GAA0Bb,CAAlC;MAAoC,OAAOF,CAAC,CAACc,QAAF,CAAWV,CAAX,CAAP;IAAqB,CAAjH;IAAkHO,KAAK,EAACT,CAAxH;IAA0HU,MAAM,EAACR;EAAjI,CAAN;AAA0I;;AAAA,SAASY,CAAT,CAAWd,CAAX,EAAaE,CAAb,EAAe;EAAC,MAAK;IAACO,KAAK,EAACL,CAAP;IAASM,MAAM,EAACF,CAAhB;IAAkBI,QAAQ,EAACE;EAA3B,IAA8Bd,CAAnC;EAAA,MAAqCe,CAAC,GAACb,CAAC,GAACG,CAAC,CAACL,CAAD,CAA1C;EAA8C,OAAM;IAACM,cAAc,EAACN,CAAC,CAACM,cAAF,CAAiBU,GAAjB,CAAsBhB,CAAC,IAAEF,CAAC,CAACE,CAAC,GAACe,CAAH,CAA1B,CAAhB;IAAkDH,QAAQ,EAACE,CAA3D;IAA6DL,KAAK,EAACL,CAAnE;IAAqEM,MAAM,EAACF;EAA5E,CAAN;AAAqF;;AAAA,SAASO,CAAT,CAAWf,CAAX,EAAaE,CAAb,EAAe;EAAC,MAAK;IAACO,KAAK,EAACL,CAAP;IAASM,MAAM,EAACL,CAAhB;IAAkBO,QAAQ,EAACJ;EAA3B,IAA8BR,CAAnC;EAAA,MAAqCc,CAAC,GAACd,CAAC,CAACM,cAAF,CAAiBW,KAAjB,EAAvC;EAAA,MAAgEF,CAAC,GAACD,CAAC,CAACI,KAAF,EAAlE;EAA4E,OAAOJ,CAAC,CAACK,OAAF,CAAUrB,CAAC,CAACiB,CAAC,GAACb,CAAH,CAAX,GAAkB;IAACI,cAAc,EAACQ,CAAhB;IAAkBF,QAAQ,EAACJ,CAA3B;IAA6BC,KAAK,EAACL,CAAnC;IAAqCM,MAAM,EAACL;EAA5C,CAAzB;AAAwE;;AAAA,SAASe,CAAT,CAAWpB,CAAX,EAAaE,CAAb,EAAe;EAAC,MAAK;IAACO,KAAK,EAACL,CAAP;IAASM,MAAM,EAACL,CAAhB;IAAkBO,QAAQ,EAACJ;EAA3B,IAA8BR,CAAnC;EAAA,MAAqCc,CAAC,GAACd,CAAC,CAACM,cAAF,CAAiBW,KAAjB,EAAvC;EAAA,MAAgEF,CAAC,GAACD,CAAC,CAACO,GAAF,EAAlE;EAA0E,OAAOP,CAAC,CAACQ,IAAF,CAAOxB,CAAC,CAACiB,CAAC,GAACb,CAAH,CAAR,GAAe;IAACI,cAAc,EAACQ,CAAhB;IAAkBF,QAAQ,EAACJ,CAA3B;IAA6BC,KAAK,EAACL,CAAnC;IAAqCM,MAAM,EAACL;EAA5C,CAAtB;AAAqE;;AAAA,MAAMkB,CAAN,CAAO;EAACC,WAAW,CAAC1B,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAAS;IAAC,KAAKqB,UAAL,GAAgB3B,CAAhB,EAAkB,KAAK4B,WAAL,GAAiBxB,CAAnC,EAAqC,KAAKyB,YAAL,GAAkBvB,CAAvD,EAAyD,KAAKwB,UAAL,GAAgB,CAAzE,EAA2E,KAAKC,aAAL,GAAmB,CAA9F,EAAgG,KAAKC,WAAL,GAAiB,KAAKL,UAAL,CAAgBnB,cAAhB,CAA+B,KAAKuB,aAApC,CAAjH;IAAoK,IAAIxB,CAAC,GAAC,CAAN;;IAAQ,OAAKL,CAAC,GAACK,CAAP,GAAUA,CAAC,IAAE,KAAKyB,WAAR,EAAoB,KAAKC,SAAL,EAApB;;IAAqC,MAAMvB,CAAC,GAAC,KAAKiB,UAAL,CAAgBb,QAAhB,CAAyB,KAAKiB,aAA9B,CAAR;;IAAqD,KAAKF,YAAL,CAAkBnB,CAAlB;EAAqB;;EAAAuB,SAAS,GAAE;IAAC,IAAG,KAAKF,aAAL,IAAoB,KAAKD,UAAzB,EAAoC,KAAKA,UAAL,GAAgB,CAAvD,EAAyD;MAAC,IAAG,KAAKC,aAAL,KAAqB,KAAKJ,UAAL,CAAgBnB,cAAhB,CAA+BO,MAAvD,EAA8D,QAAO,KAAKa,WAAZ;QAAyB,KAAK1B,CAAC,CAACgC,IAAP;UAAY,KAAKH,aAAL,IAAoB,KAAKD,UAAzB;UAAoC;;QAAM,KAAK5B,CAAC,CAACiC,IAAP;UAAY,KAAKJ,aAAL,GAAmB,CAAnB;UAAqB;;QAAM,KAAK7B,CAAC,CAACkC,SAAP;UAAiB,KAAKL,aAAL,IAAoB,KAAKD,UAAzB,EAAoC,KAAKA,UAAL,GAAgB,CAAC,CAArD;MAAvI;IAA+L,CAAvT,MAA4T,IAAG,CAAC,CAAD,KAAK,KAAKC,aAAb,EAA2B,QAAO,KAAKH,WAAZ;MAAyB,KAAK1B,CAAC,CAACgC,IAAP;QAAY,KAAKH,aAAL,IAAoB,KAAKD,UAAzB;QAAoC;;MAAM,KAAK5B,CAAC,CAACiC,IAAP;QAAY,KAAKJ,aAAL,GAAmB,KAAKJ,UAAL,CAAgBnB,cAAhB,CAA+BO,MAA/B,GAAsC,CAAzD;QAA2D;;MAAM,KAAKb,CAAC,CAACkC,SAAP;QAAiB,KAAKL,aAAL,IAAoB,KAAKD,UAAzB,EAAoC,KAAKA,UAAL,GAAgB,CAApD;IAA7K;;IAAmO,KAAKE,WAAL,GAAiB,KAAKL,UAAL,CAAgBnB,cAAhB,CAA+B,KAAKuB,aAApC,CAAjB;;IAAoE,MAAM/B,CAAC,GAAC,KAAK2B,UAAL,CAAgBb,QAAhB,CAAyB,KAAKiB,aAA9B,CAAR;;IAAqD,KAAKF,YAAL,CAAkB7B,CAAlB;EAAqB;;AAA/gC;;AAAghC,SAASqC,CAAT,CAAWA,CAAX,EAAaC,CAAb,EAAeC,CAAf,EAAiBC,CAAjB,EAAmB;EAAC,IAAIC,CAAJ;EAAA,IAAM;IAACC,UAAU,EAACC;EAAZ,IAAeL,CAArB;;EAAuB,IAAG,QAAMK,CAAN,KAAUA,CAAC,GAACzC,CAAC,CAACiC,IAAd,GAAoB,CAAC,CAAD,KAAKG,CAAC,CAACM,gBAAP,KAA0BP,CAAC,GAAC3B,CAAC,CAAC2B,CAAD,CAA7B,CAApB,EAAsD,QAAMC,CAAC,CAACO,QAAR,KAAmBR,CAAC,GAACrB,CAAC,CAACqB,CAAD,EAAGrC,CAAC,CAAC,MAAIsC,CAAC,CAACO,QAAP,CAAJ,CAAtB,CAAtD,EAAmG,QAAMP,CAAC,CAACQ,WAA9G,EAA0H;IAAC,MAAM1C,CAAC,GAAC,MAAIkC,CAAC,CAACQ,WAAd;IAA0BH,CAAC,KAAGzC,CAAC,CAACiC,IAAN,GAAWE,CAAC,GAACf,CAAC,CAACe,CAAD,EAAGrC,CAAC,CAACI,CAAD,CAAJ,CAAd,GAAuBuC,CAAC,KAAGzC,CAAC,CAACkC,SAAN,KAAkBC,CAAC,GAACpB,CAAC,CAACK,CAAC,CAACe,CAAD,EAAGrC,CAAC,CAACI,CAAC,GAAC,CAAH,CAAJ,CAAF,EAAaJ,CAAC,CAACI,CAAC,GAAC,CAAH,CAAd,CAArB,CAAvB;EAAkE;;EAAA,IAAG,QAAMkC,CAAC,CAACS,eAAX,EAA2BN,CAAC,GAACzC,CAAC,CAAC,MAAIsC,CAAC,CAACS,eAAP,CAAH,CAA3B,KAA2D,IAAG,QAAMT,CAAC,CAACU,kBAAX,EAA8B;IAAC,MAAM9C,CAAC,GAACE,CAAC,CAACmC,CAAD,CAAT;IAAA,MAAa7B,CAAC,GAAC,QAAf;IAAA,MAAwBM,CAAC,GAAC,QAAMsB,CAAC,CAACW,kBAAR,GAA2BX,CAAC,CAACW,kBAA7B,GAAgDvC,CAA1E;IAAA,MAA4EO,CAAC,GAACX,CAAC,CAACJ,CAAD,EAAGc,CAAH,CAA/E;IAAqFyB,CAAC,GAACzC,CAAC,CAACiB,CAAC,GAACV,CAAC,CAAC8B,CAAD,CAAJ,CAAH;EAAY,CAAhI,MAAqII,CAAC,GAACzC,CAAC,CAAC,CAAD,CAAH;EAAO,OAAO,IAAIyB,CAAJ,CAAMY,CAAN,EAAQI,CAAR,EAAUE,CAAV,EAAYH,CAAZ,CAAP;AAAsB;;AAAA,SAASF,CAAT,CAAWtC,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiBE,CAAjB,EAAmB;EAAC,MAAMC,CAAC,GAAC,QAAML,CAAC,CAACgD,aAAR,IAAuBhD,CAAC,CAACgD,aAAjC;EAAA,MAA+CxC,CAAC,GAAC2B,CAAC,CAACrC,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOE,CAAP,CAAlD;EAA4D,IAAIU,CAAJ;EAAA,IAAMC,CAAC,GAACP,CAAC,CAACsB,WAAV;;EAAsB,SAASV,CAAT,GAAY;IAACN,CAAC,GAACT,CAAC,IAAE4C,UAAU,CAAE,MAAI;MAACzC,CAAC,CAACuB,SAAF,IAAchB,CAAC,GAACP,CAAC,CAACsB,WAAlB,EAA8BV,CAAC,EAA/B;IAAkC,CAAzC,EAA2CL,CAA3C,CAAf;EAA6D;;EAAA,OAAOK,CAAC,IAAG;IAAC8B,MAAM,EAAC,MAAI;MAAC7C,CAAC,IAAE8C,YAAY,CAACrC,CAAD,CAAf;IAAmB;EAAhC,CAAX;AAA6C;;AAAA,SAAOS,CAAC,IAAI6B,MAAZ,EAAmBtC,CAAC,IAAIuC,cAAxB,EAAuCjC,CAAC,IAAIkC,WAA5C,EAAwDnB,CAAC,IAAIoB,YAA7D,EAA0ElD,CAAC,IAAImD,WAA/E,EAA2FpB,CAAC,IAAIqB,IAAhG,EAAqG1C,CAAC,IAAI2C,YAA1G,EAAuHlD,CAAC,IAAIG,OAA5H"},"metadata":{},"sourceType":"module"}