{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from \"../../request.js\";\nimport e from \"../../core/Error.js\";\nimport i from \"../../core/Logger.js\";\nimport { isArrayBuffer as s, isUint8ClampedArray as r } from \"../../core/typedArrayUtil.js\";\nimport { urlToObject as a, objectToQuery as o } from \"../../core/urlUtils.js\";\nconst h = 1.15;\n\nclass n {\n  constructor(t, e) {\n    this._spriteSource = t, this._maxTextureSize = e, this.devicePixelRatio = 1, this._spriteImageFormat = \"png\", this._isRetina = !1, this._spritesData = {}, this.image = null, this.width = null, this.height = null, this.loadStatus = \"not-loaded\", \"url\" === t.type && t.spriteFormat && (this._spriteImageFormat = t.spriteFormat), t.pixelRatio && (this.devicePixelRatio = t.pixelRatio), this.baseURL = t.spriteUrl;\n  }\n\n  get spriteNames() {\n    const t = [];\n\n    for (const e in this._spritesData) t.push(e);\n\n    return t.sort(), t;\n  }\n\n  getSpriteInfo(t) {\n    return this._spritesData ? this._spritesData[t] : null;\n  }\n\n  async load(t) {\n    if (this.baseURL) {\n      this.loadStatus = \"loading\";\n\n      try {\n        await this._loadSprites(t), this.loadStatus = \"loaded\";\n      } catch {\n        this.loadStatus = \"failed\";\n      }\n    } else this.loadStatus = \"failed\";\n  }\n\n  async _loadSprites(t) {\n    this._isRetina = this.devicePixelRatio > h;\n    const {\n      width: s,\n      height: r,\n      data: a,\n      json: o\n    } = await this._getSpriteData(this._spriteSource, t),\n          n = Object.keys(o);\n    if (!n || 0 === n.length || !a) return this._spritesData = this.image = null, void (this.width = this.height = 0);\n    this._spritesData = o, this.width = s, this.height = r;\n    const d = Math.max(this._maxTextureSize, 4096);\n\n    if (s > d || r > d) {\n      const t = `Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${d} pixels}`;\n      throw i.getLogger(\"esri.layers.support.SpriteSource\").error(t), new e(\"SpriteSource\", t);\n    }\n\n    let p;\n\n    for (let e = 0; e < a.length; e += 4) p = a[e + 3] / 255, a[e] = a[e] * p, a[e + 1] = a[e + 1] * p, a[e + 2] = a[e + 2] * p;\n\n    this.image = a;\n  }\n\n  async _getSpriteData(i, n) {\n    if (\"image\" === i.type) {\n      let t, a;\n\n      if (this.devicePixelRatio < h) {\n        if (!i.spriteSource1x) throw new e(\"SpriteSource\", \"no image data provided for low resolution sprites!\");\n        t = i.spriteSource1x.image, a = i.spriteSource1x.json;\n      } else {\n        if (!i.spriteSource2x) throw new e(\"SpriteSource\", \"no image data provided for high resolution sprites!\");\n        t = i.spriteSource2x.image, a = i.spriteSource2x.json;\n      }\n\n      return \"width\" in t && \"height\" in t && \"data\" in t && (s(t.data) || r(t.data)) ? {\n        width: t.width,\n        height: t.height,\n        data: new Uint8Array(t.data),\n        json: a\n      } : { ...d(t),\n        json: a\n      };\n    }\n\n    const p = a(this.baseURL),\n          l = p.query ? \"?\" + o(p.query) : \"\",\n          g = this._isRetina ? \"@2x\" : \"\",\n          u = `${p.path}${g}.${this._spriteImageFormat}${l}`,\n          c = `${p.path}${g}.json${l}`,\n          [m, S] = await Promise.all([t(c, n), t(u, {\n      responseType: \"image\",\n      ...n\n    })]);\n    return { ...d(S.data),\n      json: m.data\n    };\n  }\n\n}\n\nfunction d(t) {\n  const e = document.createElement(\"canvas\"),\n        i = e.getContext(\"2d\");\n  e.width = t.width, e.height = t.height, i.drawImage(t, 0, 0, t.width, t.height);\n  const s = i.getImageData(0, 0, t.width, t.height);\n  return {\n    width: t.width,\n    height: t.height,\n    data: new Uint8Array(s.data)\n  };\n}\n\nexport { n as default };","map":{"version":3,"names":["t","e","i","isArrayBuffer","s","isUint8ClampedArray","r","urlToObject","a","objectToQuery","o","h","n","constructor","_spriteSource","_maxTextureSize","devicePixelRatio","_spriteImageFormat","_isRetina","_spritesData","image","width","height","loadStatus","type","spriteFormat","pixelRatio","baseURL","spriteUrl","spriteNames","push","sort","getSpriteInfo","load","_loadSprites","data","json","_getSpriteData","Object","keys","length","d","Math","max","getLogger","error","p","spriteSource1x","spriteSource2x","Uint8Array","l","query","g","u","path","c","m","S","Promise","all","responseType","document","createElement","getContext","drawImage","getImageData","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/layers/support/SpriteSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import e from\"../../core/Error.js\";import i from\"../../core/Logger.js\";import{isArrayBuffer as s,isUint8ClampedArray as r}from\"../../core/typedArrayUtil.js\";import{urlToObject as a,objectToQuery as o}from\"../../core/urlUtils.js\";const h=1.15;class n{constructor(t,e){this._spriteSource=t,this._maxTextureSize=e,this.devicePixelRatio=1,this._spriteImageFormat=\"png\",this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus=\"not-loaded\",\"url\"===t.type&&t.spriteFormat&&(this._spriteImageFormat=t.spriteFormat),t.pixelRatio&&(this.devicePixelRatio=t.pixelRatio),this.baseURL=t.spriteUrl}get spriteNames(){const t=[];for(const e in this._spritesData)t.push(e);return t.sort(),t}getSpriteInfo(t){return this._spritesData?this._spritesData[t]:null}async load(t){if(this.baseURL){this.loadStatus=\"loading\";try{await this._loadSprites(t),this.loadStatus=\"loaded\"}catch{this.loadStatus=\"failed\"}}else this.loadStatus=\"failed\"}async _loadSprites(t){this._isRetina=this.devicePixelRatio>h;const{width:s,height:r,data:a,json:o}=await this._getSpriteData(this._spriteSource,t),n=Object.keys(o);if(!n||0===n.length||!a)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=o,this.width=s,this.height=r;const d=Math.max(this._maxTextureSize,4096);if(s>d||r>d){const t=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${d} pixels}`;throw i.getLogger(\"esri.layers.support.SpriteSource\").error(t),new e(\"SpriteSource\",t)}let p;for(let e=0;e<a.length;e+=4)p=a[e+3]/255,a[e]=a[e]*p,a[e+1]=a[e+1]*p,a[e+2]=a[e+2]*p;this.image=a}async _getSpriteData(i,n){if(\"image\"===i.type){let t,a;if(this.devicePixelRatio<h){if(!i.spriteSource1x)throw new e(\"SpriteSource\",\"no image data provided for low resolution sprites!\");t=i.spriteSource1x.image,a=i.spriteSource1x.json}else{if(!i.spriteSource2x)throw new e(\"SpriteSource\",\"no image data provided for high resolution sprites!\");t=i.spriteSource2x.image,a=i.spriteSource2x.json}return\"width\"in t&&\"height\"in t&&\"data\"in t&&(s(t.data)||r(t.data))?{width:t.width,height:t.height,data:new Uint8Array(t.data),json:a}:{...d(t),json:a}}const p=a(this.baseURL),l=p.query?\"?\"+o(p.query):\"\",g=this._isRetina?\"@2x\":\"\",u=`${p.path}${g}.${this._spriteImageFormat}${l}`,c=`${p.path}${g}.json${l}`,[m,S]=await Promise.all([t(c,n),t(u,{responseType:\"image\",...n})]);return{...d(S.data),json:m.data}}}function d(t){const e=document.createElement(\"canvas\"),i=e.getContext(\"2d\");e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height);const s=i.getImageData(0,0,t.width,t.height);return{width:t.width,height:t.height,data:new Uint8Array(s.data)}}export{n as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}