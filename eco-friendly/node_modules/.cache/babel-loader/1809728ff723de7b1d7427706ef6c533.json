{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { isSome as o } from \"../../../../../../core/maybe.js\";\nimport { I as r } from \"../../../../../../chunks/mat4f64.js\";\nimport { addNearFar as e } from \"../ForwardLinearDepth.glsl.js\";\nimport { ShaderOutput as t } from \"../ShaderOutput.js\";\nimport { SliceDraw as i } from \"../Slice.glsl.js\";\nimport { Transform as a } from \"../Transform.glsl.js\";\nimport { NormalAttribute as s, NormalAttributeType as l } from \"../attributes/NormalAttribute.glsl.js\";\nimport { ObjectAndLayerIdColor as d } from \"../attributes/ObjectAndLayerIdColor.glsl.js\";\nimport { TextureCoordinateAttribute as n } from \"../attributes/TextureCoordinateAttribute.glsl.js\";\nimport { VertexNormal as c } from \"../attributes/VertexNormal.glsl.js\";\nimport { OutputDepth as u } from \"../output/OutputDepth.glsl.js\";\nimport { OutputHighlight as m } from \"../output/OutputHighlight.glsl.js\";\nimport { VisualVariables as p } from \"../shading/VisualVariables.glsl.js\";\nimport { DiscardOrAdjustAlphaPass as v } from \"../util/AlphaDiscard.glsl.js\";\nimport { addProjViewLocalOrigin as f } from \"../util/View.glsl.js\";\nimport { glsl as g } from \"../../shaderModules/interfaces.js\";\nimport { Matrix4PassUniform as h } from \"../../shaderModules/Matrix4PassUniform.js\";\nimport { Texture2DPassUniform as x } from \"../../shaderModules/Texture2DPassUniform.js\";\nimport { AlphaDiscardMode as j } from \"../../../lib/basicInterfaces.js\";\n\nfunction b(b, O) {\n  const {\n    vertex: w,\n    fragment: C\n  } = b,\n        T = O.hasModelTransformation;\n  T && w.uniforms.add(new h(\"model\", e => o(e.modelTransformation) ? e.modelTransformation : r));\n  const V = O.hasColorTexture && O.alphaDiscardMode !== j.Opaque;\n\n  switch (O.output) {\n    case t.Depth:\n    case t.Shadow:\n    case t.ShadowHighlight:\n    case t.ShadowExludeHighlight:\n    case t.ObjectAndLayerIdColor:\n      f(w, O), b.include(a, O), b.include(n, O), b.include(p, O), b.include(u, O), b.include(i, O), b.include(d, O), e(b), b.varyings.add(\"depth\", \"float\"), V && C.uniforms.add(new x(\"tex\", o => o.texture)), w.code.add(g`\n          void main(void) {\n            vpos = calculateVPos();\n            vpos = subtractOrigin(vpos);\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPositionWithDepth(proj, view, ${T ? \"model,\" : \"\"} vpos, nearFar, depth);\n            forwardTextureCoordinates();\n            forwardObjectAndLayerIdColor();\n          }\n        `), b.include(v, O), C.code.add(g`\n          void main(void) {\n            discardBySlice(vpos);\n            ${V ? g`\n                    vec4 texColor = texture2D(tex, ${O.hasColorTextureTransform ? g`colorUV` : g`vuv0`});\n                    discardOrAdjustAlpha(texColor);` : \"\"}\n            ${O.output === t.ObjectAndLayerIdColor ? g`outputObjectAndLayerIdColor();` : g`outputDepth(depth);`}\n          }\n        `);\n      break;\n\n    case t.Normal:\n      f(w, O), b.include(a, O), b.include(s, O), b.include(c, O), b.include(n, O), b.include(p, O), V && C.uniforms.add(new x(\"tex\", o => o.texture)), b.varyings.add(\"vPositionView\", \"vec3\"), w.code.add(g`\n          void main(void) {\n            vpos = calculateVPos();\n            vpos = subtractOrigin(vpos);\n            ${O.normalType === l.Attribute ? g`\n            vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));` : \"\"}\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, ${T ? \"model,\" : \"\"} vpos);\n            forwardTextureCoordinates();\n          }\n        `), b.include(i, O), b.include(v, O), C.code.add(g`\n          void main() {\n            discardBySlice(vpos);\n            ${V ? g`\n                    vec4 texColor = texture2D(tex, ${O.hasColorTextureTransform ? g`colorUV` : g`vuv0`});\n                    discardOrAdjustAlpha(texColor);` : \"\"}\n\n            ${O.normalType === l.ScreenDerivative ? g`\n                vec3 normal = screenDerivativeNormal(vPositionView);` : g`\n                vec3 normal = normalize(vNormalWorld);\n                if (gl_FrontFacing == false) normal = -normal;`}\n            gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n          }\n        `);\n      break;\n\n    case t.Highlight:\n      f(w, O), b.include(a, O), b.include(n, O), b.include(p, O), V && C.uniforms.add(new x(\"tex\", o => o.texture)), w.code.add(g`\n          void main(void) {\n            vpos = calculateVPos();\n            vpos = subtractOrigin(vpos);\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, ${T ? \"model,\" : \"\"} vpos);\n            forwardTextureCoordinates();\n          }\n        `), b.include(i, O), b.include(v, O), b.include(m, O), C.code.add(g`\n          void main() {\n            discardBySlice(vpos);\n            ${V ? g`\n                    vec4 texColor = texture2D(tex, ${O.hasColorTextureTransform ? g`colorUV` : g`vuv0`});\n                    discardOrAdjustAlpha(texColor);` : \"\"}\n            outputHighlight();\n          }\n        `);\n  }\n}\n\nexport { b as DefaultMaterialAuxiliaryPasses };","map":{"version":3,"names":["isSome","o","I","r","addNearFar","e","ShaderOutput","t","SliceDraw","i","Transform","a","NormalAttribute","s","NormalAttributeType","l","ObjectAndLayerIdColor","d","TextureCoordinateAttribute","n","VertexNormal","c","OutputDepth","u","OutputHighlight","m","VisualVariables","p","DiscardOrAdjustAlphaPass","v","addProjViewLocalOrigin","f","glsl","g","Matrix4PassUniform","h","Texture2DPassUniform","x","AlphaDiscardMode","j","b","O","vertex","w","fragment","C","T","hasModelTransformation","uniforms","add","modelTransformation","V","hasColorTexture","alphaDiscardMode","Opaque","output","Depth","Shadow","ShadowHighlight","ShadowExludeHighlight","include","varyings","texture","code","hasColorTextureTransform","Normal","normalType","Attribute","ScreenDerivative","Highlight","DefaultMaterialAuxiliaryPasses"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as o}from\"../../../../../../core/maybe.js\";import{I as r}from\"../../../../../../chunks/mat4f64.js\";import{addNearFar as e}from\"../ForwardLinearDepth.glsl.js\";import{ShaderOutput as t}from\"../ShaderOutput.js\";import{SliceDraw as i}from\"../Slice.glsl.js\";import{Transform as a}from\"../Transform.glsl.js\";import{NormalAttribute as s,NormalAttributeType as l}from\"../attributes/NormalAttribute.glsl.js\";import{ObjectAndLayerIdColor as d}from\"../attributes/ObjectAndLayerIdColor.glsl.js\";import{TextureCoordinateAttribute as n}from\"../attributes/TextureCoordinateAttribute.glsl.js\";import{VertexNormal as c}from\"../attributes/VertexNormal.glsl.js\";import{OutputDepth as u}from\"../output/OutputDepth.glsl.js\";import{OutputHighlight as m}from\"../output/OutputHighlight.glsl.js\";import{VisualVariables as p}from\"../shading/VisualVariables.glsl.js\";import{DiscardOrAdjustAlphaPass as v}from\"../util/AlphaDiscard.glsl.js\";import{addProjViewLocalOrigin as f}from\"../util/View.glsl.js\";import{glsl as g}from\"../../shaderModules/interfaces.js\";import{Matrix4PassUniform as h}from\"../../shaderModules/Matrix4PassUniform.js\";import{Texture2DPassUniform as x}from\"../../shaderModules/Texture2DPassUniform.js\";import{AlphaDiscardMode as j}from\"../../../lib/basicInterfaces.js\";function b(b,O){const{vertex:w,fragment:C}=b,T=O.hasModelTransformation;T&&w.uniforms.add(new h(\"model\",(e=>o(e.modelTransformation)?e.modelTransformation:r)));const V=O.hasColorTexture&&O.alphaDiscardMode!==j.Opaque;switch(O.output){case t.Depth:case t.Shadow:case t.ShadowHighlight:case t.ShadowExludeHighlight:case t.ObjectAndLayerIdColor:f(w,O),b.include(a,O),b.include(n,O),b.include(p,O),b.include(u,O),b.include(i,O),b.include(d,O),e(b),b.varyings.add(\"depth\",\"float\"),V&&C.uniforms.add(new x(\"tex\",(o=>o.texture))),w.code.add(g`\n          void main(void) {\n            vpos = calculateVPos();\n            vpos = subtractOrigin(vpos);\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPositionWithDepth(proj, view, ${T?\"model,\":\"\"} vpos, nearFar, depth);\n            forwardTextureCoordinates();\n            forwardObjectAndLayerIdColor();\n          }\n        `),b.include(v,O),C.code.add(g`\n          void main(void) {\n            discardBySlice(vpos);\n            ${V?g`\n                    vec4 texColor = texture2D(tex, ${O.hasColorTextureTransform?g`colorUV`:g`vuv0`});\n                    discardOrAdjustAlpha(texColor);`:\"\"}\n            ${O.output===t.ObjectAndLayerIdColor?g`outputObjectAndLayerIdColor();`:g`outputDepth(depth);`}\n          }\n        `);break;case t.Normal:f(w,O),b.include(a,O),b.include(s,O),b.include(c,O),b.include(n,O),b.include(p,O),V&&C.uniforms.add(new x(\"tex\",(o=>o.texture))),b.varyings.add(\"vPositionView\",\"vec3\"),w.code.add(g`\n          void main(void) {\n            vpos = calculateVPos();\n            vpos = subtractOrigin(vpos);\n            ${O.normalType===l.Attribute?g`\n            vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));`:\"\"}\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, ${T?\"model,\":\"\"} vpos);\n            forwardTextureCoordinates();\n          }\n        `),b.include(i,O),b.include(v,O),C.code.add(g`\n          void main() {\n            discardBySlice(vpos);\n            ${V?g`\n                    vec4 texColor = texture2D(tex, ${O.hasColorTextureTransform?g`colorUV`:g`vuv0`});\n                    discardOrAdjustAlpha(texColor);`:\"\"}\n\n            ${O.normalType===l.ScreenDerivative?g`\n                vec3 normal = screenDerivativeNormal(vPositionView);`:g`\n                vec3 normal = normalize(vNormalWorld);\n                if (gl_FrontFacing == false) normal = -normal;`}\n            gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n          }\n        `);break;case t.Highlight:f(w,O),b.include(a,O),b.include(n,O),b.include(p,O),V&&C.uniforms.add(new x(\"tex\",(o=>o.texture))),w.code.add(g`\n          void main(void) {\n            vpos = calculateVPos();\n            vpos = subtractOrigin(vpos);\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, ${T?\"model,\":\"\"} vpos);\n            forwardTextureCoordinates();\n          }\n        `),b.include(i,O),b.include(v,O),b.include(m,O),C.code.add(g`\n          void main() {\n            discardBySlice(vpos);\n            ${V?g`\n                    vec4 texColor = texture2D(tex, ${O.hasColorTextureTransform?g`colorUV`:g`vuv0`});\n                    discardOrAdjustAlpha(texColor);`:\"\"}\n            outputHighlight();\n          }\n        `)}}export{b as DefaultMaterialAuxiliaryPasses};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}