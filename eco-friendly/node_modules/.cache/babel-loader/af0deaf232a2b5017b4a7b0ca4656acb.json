{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../chunks/tslib.es6.js\";\nimport { isAbortError as e } from \"../../../../core/promiseUtils.js\";\nimport { on as r } from \"../../../../core/reactiveUtils.js\";\nimport { property as o } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as i } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { i as s, k as n, c as a } from \"../../../../chunks/vec3.js\";\nimport { c } from \"../../../../chunks/vec3f64.js\";\nimport d from \"../../../../geometry/Point.js\";\nimport { distanceToScale as l } from \"../cameraUtils.js\";\nimport { PropertiesPool as p } from \"../PropertiesPool.js\";\nimport { PointOfInterest as h } from \"./PointOfInterest.js\";\nconst u = Array;\nlet m = class extends h {\n  constructor(t) {\n    super(t), this._dirty = !1, this._propertiesPool = new p({\n      location: d,\n      renderLocation: u\n    }, this), this._estimatedSurfaceAltitude = 0, this._pendingElevationQueryController = null, this.cameraName = \"camera\", this.renderLocation = c(), this.tmpPoint = new d();\n  }\n\n  initialize() {\n    if (this.scheduler && this.handles.add(this.scheduler.registerTask(this.task, this)), this.runTask(), this.map) {\n      const t = () => this._setDirty();\n\n      this.handles.add(r(() => this.map?.ground?.layers, \"change\", t, {\n        onListenerAdd: t,\n        onListenerRemove: t\n      }));\n    }\n\n    this._updateRenderLocation();\n  }\n\n  destroy() {\n    this._cancelPendingRequest(), this._propertiesPool.destroy(), this._propertiesPool = null;\n  }\n\n  get _camera() {\n    return this.state[this.cameraName];\n  }\n\n  get location() {\n    const t = this._propertiesPool.get(\"location\");\n\n    return this.renderCoordsHelper.fromRenderCoords(this.renderLocation, t, this.state.spatialReference), t;\n  }\n\n  get scale() {\n    const t = this._camera,\n          e = s(t.eye, this.renderLocation),\n          r = {\n      renderCoordsHelper: this.renderCoordsHelper,\n      state: {\n        camera: t\n      }\n    };\n    return l(r, e, 0);\n  }\n\n  get updating() {\n    return this._dirty || null != this._pendingElevationQueryController;\n  }\n\n  updateRenderLocation() {\n    this._setDirty(), this._updateRenderLocation();\n  }\n\n  _setDirty() {\n    this._dirty || (this._dirty = !0, this.notifyChange(\"updating\"));\n  }\n\n  _cancelPendingRequest() {\n    const t = this._pendingElevationQueryController;\n    t && (this._pendingElevationQueryController = null, t.abort(), this.notifyChange(\"updating\"));\n  }\n\n  get running() {\n    return !this._pendingElevationQueryController && this._dirty;\n  }\n\n  runTask() {\n    if (this._cancelPendingRequest(), this._dirty = !1, this.notifyChange(\"updating\"), !this.map || !this.map.ground) return void this._updateSurfaceAltitude(0);\n    this.renderCoordsHelper.fromRenderCoords(this._camera.eye, this.tmpPoint, this.state.spatialReference);\n    let t = new AbortController();\n    this.map.ground.queryElevation(this.tmpPoint, {\n      signal: t.signal,\n      cache: this.cache\n    }).then(t => this._updateSurfaceAltitude(t.geometry.z)).catch(t => {\n      e(t) || this._updateSurfaceAltitude(0);\n    }).catch(() => {}).then(() => {\n      this._pendingElevationQueryController === t && (this._pendingElevationQueryController = null, this.notifyChange(\"updating\")), t = null;\n    }), this._pendingElevationQueryController = t;\n  }\n\n  _updateSurfaceAltitude(t) {\n    this._estimatedSurfaceAltitude !== t && (this._estimatedSurfaceAltitude = t, this._updateRenderLocation());\n  }\n\n  _updateRenderLocation() {\n    this.renderCoordsHelper.setAltitude(y, this._estimatedSurfaceAltitude, this._camera.eye), n(this._get(\"renderLocation\"), y) || this._set(\"renderLocation\", a(this._propertiesPool.get(\"renderLocation\"), y));\n  }\n\n};\nt([o({\n  constructOnly: !0\n})], m.prototype, \"scheduler\", void 0), t([o({\n  constructOnly: !0\n})], m.prototype, \"cache\", void 0), t([o({\n  constructOnly: !0\n})], m.prototype, \"task\", void 0), t([o({\n  constructOnly: !0\n})], m.prototype, \"cameraName\", void 0), t([o({\n  readOnly: !0\n})], m.prototype, \"location\", null), t([o({\n  constructOnly: !0\n})], m.prototype, \"map\", void 0), t([o({\n  readOnly: !0\n})], m.prototype, \"renderLocation\", void 0), t([o({\n  readOnly: !0\n})], m.prototype, \"scale\", null), t([o({\n  readOnly: !0\n})], m.prototype, \"updating\", null), m = t([i(\"esri.views.3d.support.CameraOnSurface\")], m);\nconst y = c();\nexport { m as CameraOnSurface };","map":{"version":3,"names":["_","t","isAbortError","e","on","r","property","o","subclass","i","s","k","n","c","a","d","distanceToScale","l","PropertiesPool","p","PointOfInterest","h","u","Array","m","constructor","_dirty","_propertiesPool","location","renderLocation","_estimatedSurfaceAltitude","_pendingElevationQueryController","cameraName","tmpPoint","initialize","scheduler","handles","add","registerTask","task","runTask","map","_setDirty","ground","layers","onListenerAdd","onListenerRemove","_updateRenderLocation","destroy","_cancelPendingRequest","_camera","state","get","renderCoordsHelper","fromRenderCoords","spatialReference","scale","eye","camera","updating","updateRenderLocation","notifyChange","abort","running","_updateSurfaceAltitude","AbortController","queryElevation","signal","cache","then","geometry","z","catch","setAltitude","y","_get","_set","constructOnly","prototype","readOnly","CameraOnSurface"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/support/pointsOfInterest/CameraOnSurface.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{isAbortError as e}from\"../../../../core/promiseUtils.js\";import{on as r}from\"../../../../core/reactiveUtils.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{i as s,k as n,c as a}from\"../../../../chunks/vec3.js\";import{c}from\"../../../../chunks/vec3f64.js\";import d from\"../../../../geometry/Point.js\";import{distanceToScale as l}from\"../cameraUtils.js\";import{PropertiesPool as p}from\"../PropertiesPool.js\";import{PointOfInterest as h}from\"./PointOfInterest.js\";const u=Array;let m=class extends h{constructor(t){super(t),this._dirty=!1,this._propertiesPool=new p({location:d,renderLocation:u},this),this._estimatedSurfaceAltitude=0,this._pendingElevationQueryController=null,this.cameraName=\"camera\",this.renderLocation=c(),this.tmpPoint=new d}initialize(){if(this.scheduler&&this.handles.add(this.scheduler.registerTask(this.task,this)),this.runTask(),this.map){const t=()=>this._setDirty();this.handles.add(r((()=>this.map?.ground?.layers),\"change\",t,{onListenerAdd:t,onListenerRemove:t}))}this._updateRenderLocation()}destroy(){this._cancelPendingRequest(),this._propertiesPool.destroy(),this._propertiesPool=null}get _camera(){return this.state[this.cameraName]}get location(){const t=this._propertiesPool.get(\"location\");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,t,this.state.spatialReference),t}get scale(){const t=this._camera,e=s(t.eye,this.renderLocation),r={renderCoordsHelper:this.renderCoordsHelper,state:{camera:t}};return l(r,e,0)}get updating(){return this._dirty||null!=this._pendingElevationQueryController}updateRenderLocation(){this._setDirty(),this._updateRenderLocation()}_setDirty(){this._dirty||(this._dirty=!0,this.notifyChange(\"updating\"))}_cancelPendingRequest(){const t=this._pendingElevationQueryController;t&&(this._pendingElevationQueryController=null,t.abort(),this.notifyChange(\"updating\"))}get running(){return!this._pendingElevationQueryController&&this._dirty}runTask(){if(this._cancelPendingRequest(),this._dirty=!1,this.notifyChange(\"updating\"),!this.map||!this.map.ground)return void this._updateSurfaceAltitude(0);this.renderCoordsHelper.fromRenderCoords(this._camera.eye,this.tmpPoint,this.state.spatialReference);let t=new AbortController;this.map.ground.queryElevation(this.tmpPoint,{signal:t.signal,cache:this.cache}).then((t=>this._updateSurfaceAltitude(t.geometry.z))).catch((t=>{e(t)||this._updateSurfaceAltitude(0)})).catch((()=>{})).then((()=>{this._pendingElevationQueryController===t&&(this._pendingElevationQueryController=null,this.notifyChange(\"updating\")),t=null})),this._pendingElevationQueryController=t}_updateSurfaceAltitude(t){this._estimatedSurfaceAltitude!==t&&(this._estimatedSurfaceAltitude=t,this._updateRenderLocation())}_updateRenderLocation(){this.renderCoordsHelper.setAltitude(y,this._estimatedSurfaceAltitude,this._camera.eye),n(this._get(\"renderLocation\"),y)||this._set(\"renderLocation\",a(this._propertiesPool.get(\"renderLocation\"),y))}};t([o({constructOnly:!0})],m.prototype,\"scheduler\",void 0),t([o({constructOnly:!0})],m.prototype,\"cache\",void 0),t([o({constructOnly:!0})],m.prototype,\"task\",void 0),t([o({constructOnly:!0})],m.prototype,\"cameraName\",void 0),t([o({readOnly:!0})],m.prototype,\"location\",null),t([o({constructOnly:!0})],m.prototype,\"map\",void 0),t([o({readOnly:!0})],m.prototype,\"renderLocation\",void 0),t([o({readOnly:!0})],m.prototype,\"scale\",null),t([o({readOnly:!0})],m.prototype,\"updating\",null),m=t([i(\"esri.views.3d.support.CameraOnSurface\")],m);const y=c();export{m as CameraOnSurface};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}