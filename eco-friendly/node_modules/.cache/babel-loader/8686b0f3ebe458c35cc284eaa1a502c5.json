{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isSome as t, isNone as i } from \"../../../../../core/maybe.js\";\nimport { HITTEST_RADIUS as e, ATTRIBUTE_DATA_GPGPU as s } from \"../definitions.js\";\nimport { Effect as o } from \"./Effect.js\";\nimport { PixelFormat as n, PixelType as r } from \"../../../../webgl/enums.js\";\n\nclass c extends o {\n  constructor() {\n    super(...arguments), this.name = this.constructor.name, this.defines = [\"hittest\"];\n  }\n\n  dispose() {\n    t(this._fbo) && this._fbo.dispose();\n  }\n\n  createOptions({\n    pixelRatio: t\n  }, i, s = e) {\n    if (!i.length) return null;\n    const o = i.shift(),\n          n = o.point.x,\n          r = o.point.y;\n    return this._outstanding = o, {\n      type: \"hittest\",\n      distance: s * t,\n      position: [n, r]\n    };\n  }\n\n  bind(t) {\n    const {\n      context: e,\n      attributeView: o\n    } = t;\n    if (!o.size) return;\n    const n = o.getBlock(s);\n    if (i(n)) return;\n    const r = n.getFBO(e);\n    e.setViewport(0, 0, o.size, o.size), e.bindFramebuffer(r), e.setColorMask(!0, !0, !0, !0), e.setClearColor(0, 0, 0, 0), e.clear(e.gl.COLOR_BUFFER_BIT | e.gl.DEPTH_BUFFER_BIT);\n  }\n\n  unbind(t) {}\n\n  draw(t) {\n    const {\n      context: e,\n      attributeView: o\n    } = t,\n          c = o.getBlock(s);\n    if (i(this._outstanding)) return;\n    const d = this._outstanding.resolver;\n    if (i(c)) return d.resolve([]), void (this._outstanding = null);\n    const l = c.getFBO(e),\n          u = new Uint8Array(l.width * l.height * 4);\n    l.readPixels(0, 0, l.width, l.height, n.RGBA, r.UNSIGNED_BYTE, u);\n    const a = [];\n\n    for (let i = 0; i < u.length; i += 4) {\n      const t = u[i],\n            e = u[i + 3];\n      t && a.push({\n        id: i / 4,\n        directHits: e\n      });\n    }\n\n    this._outstanding = null, a.sort((t, i) => i.directHits === t.directHits ? i.id - t.id : i.directHits - t.directHits), d.resolve(a.map(t => t.id));\n  }\n\n}\n\nexport { c as HittestEffect };","map":{"version":3,"names":["isSome","t","isNone","i","HITTEST_RADIUS","e","ATTRIBUTE_DATA_GPGPU","s","Effect","o","PixelFormat","n","PixelType","r","c","constructor","arguments","name","defines","dispose","_fbo","createOptions","pixelRatio","length","shift","point","x","y","_outstanding","type","distance","position","bind","context","attributeView","size","getBlock","getFBO","setViewport","bindFramebuffer","setColorMask","setClearColor","clear","gl","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","unbind","draw","d","resolver","resolve","l","u","Uint8Array","width","height","readPixels","RGBA","UNSIGNED_BYTE","a","push","id","directHits","sort","map","HittestEffect"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/effects/HittestEffect.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as i}from\"../../../../../core/maybe.js\";import{HITTEST_RADIUS as e,ATTRIBUTE_DATA_GPGPU as s}from\"../definitions.js\";import{Effect as o}from\"./Effect.js\";import{PixelFormat as n,PixelType as r}from\"../../../../webgl/enums.js\";class c extends o{constructor(){super(...arguments),this.name=this.constructor.name,this.defines=[\"hittest\"]}dispose(){t(this._fbo)&&this._fbo.dispose()}createOptions({pixelRatio:t},i,s=e){if(!i.length)return null;const o=i.shift(),n=o.point.x,r=o.point.y;return this._outstanding=o,{type:\"hittest\",distance:s*t,position:[n,r]}}bind(t){const{context:e,attributeView:o}=t;if(!o.size)return;const n=o.getBlock(s);if(i(n))return;const r=n.getFBO(e);e.setViewport(0,0,o.size,o.size),e.bindFramebuffer(r),e.setColorMask(!0,!0,!0,!0),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT)}unbind(t){}draw(t){const{context:e,attributeView:o}=t,c=o.getBlock(s);if(i(this._outstanding))return;const d=this._outstanding.resolver;if(i(c))return d.resolve([]),void(this._outstanding=null);const l=c.getFBO(e),u=new Uint8Array(l.width*l.height*4);l.readPixels(0,0,l.width,l.height,n.RGBA,r.UNSIGNED_BYTE,u);const a=[];for(let i=0;i<u.length;i+=4){const t=u[i],e=u[i+3];t&&a.push({id:i/4,directHits:e})}this._outstanding=null,a.sort(((t,i)=>i.directHits===t.directHits?i.id-t.id:i.directHits-t.directHits)),d.resolve(a.map((t=>t.id)))}}export{c as HittestEffect};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}