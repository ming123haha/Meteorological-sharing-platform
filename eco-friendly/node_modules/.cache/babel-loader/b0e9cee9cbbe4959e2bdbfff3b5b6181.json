{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport \"../../../../core/has.js\";\nimport { isNone as e, isSome as r } from \"../../../../core/maybe.js\";\nimport { c as s } from \"../../../../chunks/mat3f32.js\";\nimport { brushes as t } from \"../brushes.js\";\nimport { Container as i } from \"../Container.js\";\nimport n from \"./ClippingInfo.js\";\nimport { WGLDrawPhase as a } from \"./enums.js\";\n\nclass o extends i {\n  constructor() {\n    super(...arguments), this.name = this.constructor.name;\n  }\n\n  set clips(e) {\n    this._clips = e, this.children.forEach(r => r.clips = e), this._updateClippingInfo();\n  }\n\n  beforeRender(e) {\n    super.beforeRender(e), this.updateTransforms(e.state);\n  }\n\n  _createTransforms() {\n    return {\n      dvs: s()\n    };\n  }\n\n  doRender(e) {\n    const r = this.createRenderParams(e),\n          {\n      painter: s,\n      globalOpacity: t,\n      profiler: i,\n      drawPhase: n\n    } = r,\n          o = n === a.LABEL || n === a.HIGHLIGHT ? 1 : t * this.computedOpacity;\n    i.recordContainerStart(this.name), s.beforeRenderLayer(r, this._clippingInfos ? 255 : 0, o), this.renderChildren(r), s.compositeLayer(r, o), i.recordContainerEnd();\n  }\n\n  renderChildren(r) {\n    e(this._renderPasses) && (this._renderPasses = this.prepareRenderPasses(r.painter));\n\n    for (const e of this._renderPasses) try {\n      e.render(r);\n    } catch (s) {}\n  }\n\n  createRenderParams(e) {\n    return e.requireFBO = this.requiresDedicatedFBO, e;\n  }\n\n  prepareRenderPasses(e) {\n    return [e.registerRenderPass({\n      name: \"clip\",\n      brushes: [t.clip],\n      target: () => this._clippingInfos,\n      drawPhase: a.MAP | a.LABEL | a.LABEL_ALPHA | a.DEBUG | a.HIGHLIGHT\n    })];\n  }\n\n  updateTransforms(e) {\n    for (const r of this.children) r.setTransform(e);\n  }\n\n  onAttach() {\n    super.onAttach(), this._updateClippingInfo();\n  }\n\n  onDetach() {\n    super.onDetach(), this._updateClippingInfo();\n  }\n\n  _updateClippingInfo() {\n    if (r(this._clippingInfos) && (this._clippingInfos.forEach(e => e.destroy()), this._clippingInfos = null), !this.stage) return;\n    const e = this._clips;\n    r(e) && e.length && (this._clippingInfos = e.items.map(e => n.fromClipArea(this.stage, e))), this.requestRender();\n  }\n\n}\n\nexport { o as default };","map":{"version":3,"names":["isNone","e","isSome","r","c","s","brushes","t","Container","i","n","WGLDrawPhase","a","o","constructor","arguments","name","clips","_clips","children","forEach","_updateClippingInfo","beforeRender","updateTransforms","state","_createTransforms","dvs","doRender","createRenderParams","painter","globalOpacity","profiler","drawPhase","LABEL","HIGHLIGHT","computedOpacity","recordContainerStart","beforeRenderLayer","_clippingInfos","renderChildren","compositeLayer","recordContainerEnd","_renderPasses","prepareRenderPasses","render","requireFBO","requiresDedicatedFBO","registerRenderPass","clip","target","MAP","LABEL_ALPHA","DEBUG","setTransform","onAttach","onDetach","destroy","stage","length","items","map","fromClipArea","requestRender","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/WGLContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{isNone as e,isSome as r}from\"../../../../core/maybe.js\";import{c as s}from\"../../../../chunks/mat3f32.js\";import{brushes as t}from\"../brushes.js\";import{Container as i}from\"../Container.js\";import n from\"./ClippingInfo.js\";import{WGLDrawPhase as a}from\"./enums.js\";class o extends i{constructor(){super(...arguments),this.name=this.constructor.name}set clips(e){this._clips=e,this.children.forEach((r=>r.clips=e)),this._updateClippingInfo()}beforeRender(e){super.beforeRender(e),this.updateTransforms(e.state)}_createTransforms(){return{dvs:s()}}doRender(e){const r=this.createRenderParams(e),{painter:s,globalOpacity:t,profiler:i,drawPhase:n}=r,o=n===a.LABEL||n===a.HIGHLIGHT?1:t*this.computedOpacity;i.recordContainerStart(this.name),s.beforeRenderLayer(r,this._clippingInfos?255:0,o),this.renderChildren(r),s.compositeLayer(r,o),i.recordContainerEnd()}renderChildren(r){e(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(r.painter));for(const e of this._renderPasses)try{e.render(r)}catch(s){}}createRenderParams(e){return e.requireFBO=this.requiresDedicatedFBO,e}prepareRenderPasses(e){return[e.registerRenderPass({name:\"clip\",brushes:[t.clip],target:()=>this._clippingInfos,drawPhase:a.MAP|a.LABEL|a.LABEL_ALPHA|a.DEBUG|a.HIGHLIGHT})]}updateTransforms(e){for(const r of this.children)r.setTransform(e)}onAttach(){super.onAttach(),this._updateClippingInfo()}onDetach(){super.onDetach(),this._updateClippingInfo()}_updateClippingInfo(){if(r(this._clippingInfos)&&(this._clippingInfos.forEach((e=>e.destroy())),this._clippingInfos=null),!this.stage)return;const e=this._clips;r(e)&&e.length&&(this._clippingInfos=e.items.map((e=>n.fromClipArea(this.stage,e)))),this.requestRender()}}export{o as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}