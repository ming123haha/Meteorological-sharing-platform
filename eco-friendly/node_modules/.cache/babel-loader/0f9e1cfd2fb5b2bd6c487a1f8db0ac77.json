{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport { isSome as e, isNone as t } from \"../../../../../core/maybe.js\";\nimport { TranslateAnchor as i } from \"../../vectorTiles/style/StyleDefinition.js\";\nimport { VTL_TEXTURE_BINDING_UNIT_SPRITES as n } from \"../definitions.js\";\nimport { WGLDrawPhase as r } from \"../enums.js\";\nimport { u32to4Xu8 as a } from \"../number.js\";\nimport o from \"./WGLBrush.js\";\nimport { TextureSamplingMode as s, CompareFunction as l, PrimitiveType as f, DataType as m } from \"../../../../webgl/enums.js\";\n\nclass u extends o {\n  constructor() {\n    super(...arguments), this._programOptions = {\n      id: !1,\n      pattern: !1,\n      sdf: !1\n    };\n  }\n\n  dispose() {}\n\n  drawMany(o, u) {\n    const {\n      context: c,\n      displayLevel: d,\n      state: p,\n      drawPhase: g,\n      painter: y,\n      pixelRatio: E,\n      spriteMosaic: M,\n      styleLayerUID: _,\n      requestRender: v\n    } = o;\n    if (!u.some(e => e.layerData.get(_)?.lineIndexCount ?? !1)) return;\n    const U = o.styleLayer,\n          I = U.lineMaterial,\n          P = y.vectorTilesMaterialManager,\n          x = U.getPaintValue(\"line-translate\", d),\n          T = U.getPaintValue(\"line-translate-anchor\", d),\n          S = U.getPaintProperty(\"line-pattern\"),\n          D = void 0 !== S,\n          L = D && S.isDataDriven;\n    let N, R;\n\n    if (D && !L) {\n      const e = S.getValue(d);\n      N = M.getMosaicItemPosition(e);\n    }\n\n    let V = !1;\n\n    if (!D) {\n      const e = U.getPaintProperty(\"line-dasharray\");\n\n      if (R = void 0 !== e, V = R && e.isDataDriven, R && !V) {\n        const t = e.getValue(d),\n              i = U.getDashKey(t, U.getLayoutValue(\"line-cap\", d));\n        N = M.getMosaicItemPosition(i);\n      }\n    }\n\n    const h = 1 / E,\n          A = g === r.HITTEST,\n          j = this._programOptions;\n    j.id = A, j.pattern = D, j.sdf = R;\n    const w = P.getMaterialProgram(c, I, j);\n    if (e(v) && !A && !w.isCompiled) return void v();\n\n    if (c.useProgram(w), w.setUniformMatrix3fv(\"u_displayViewMat3\", p.displayViewMat3), w.setUniformMatrix3fv(\"u_displayMat3\", T === i.VIEWPORT ? p.displayMat3 : p.displayViewMat3), w.setUniform2fv(\"u_lineTranslation\", x), w.setUniform1f(\"u_depth\", U.z), w.setUniform1f(\"u_antialiasing\", h), A) {\n      const e = a(_ + 1);\n      w.setUniform4fv(\"u_id\", e);\n    }\n\n    if (N && e(N)) {\n      const {\n        page: t\n      } = N,\n            i = M.getPageSize(t);\n      e(i) && (M.bind(c, s.LINEAR, t, n), w.setUniform2fv(\"u_mosaicSize\", i), w.setUniform1i(\"u_texture\", n));\n    }\n\n    let b = -1;\n\n    for (const i of u) {\n      if (!i.layerData.has(_)) continue;\n      i.key.level !== b && (b = i.key.level, I.setDataUniforms(w, d, U, b, M));\n      const r = 2 ** (d - b) / E;\n      w.setUniform1f(\"u_zoomFactor\", r);\n      const a = i.layerData.get(_);\n      if (!a.lineIndexCount) continue;\n      a.prepareForRendering(c);\n      const o = a.lineVertexArrayObject;\n\n      if (!t(o)) {\n        if (c.bindVAO(o), w.setUniformMatrix3fv(\"u_dvsMat3\", i.transforms.dvs), c.setStencilFunction(l.EQUAL, i.stencilRef, 255), L || V) {\n          const t = a.patternMap;\n          if (!t) continue;\n\n          for (const [i, r] of t) {\n            const t = M.getPageSize(i);\n            e(t) && (M.bind(c, s.LINEAR, i, n), w.setUniform2fv(\"u_mosaicSize\", t), w.setUniform1i(\"u_texture\", n), c.drawElements(f.TRIANGLES, r[1], m.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * r[0]));\n          }\n        } else c.drawElements(f.TRIANGLES, a.lineIndexCount, m.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * a.lineIndexStart);\n\n        i.triangleCount += a.lineIndexCount / 3;\n      }\n    }\n  }\n\n}\n\nexport { u as WGLBrushVTLLine };","map":{"version":3,"names":["isSome","e","isNone","t","TranslateAnchor","i","VTL_TEXTURE_BINDING_UNIT_SPRITES","n","WGLDrawPhase","r","u32to4Xu8","a","o","TextureSamplingMode","s","CompareFunction","l","PrimitiveType","f","DataType","m","u","constructor","arguments","_programOptions","id","pattern","sdf","dispose","drawMany","context","c","displayLevel","d","state","p","drawPhase","g","painter","y","pixelRatio","E","spriteMosaic","M","styleLayerUID","_","requestRender","v","some","layerData","get","lineIndexCount","U","styleLayer","I","lineMaterial","P","vectorTilesMaterialManager","x","getPaintValue","T","S","getPaintProperty","D","L","isDataDriven","N","R","getValue","getMosaicItemPosition","V","getDashKey","getLayoutValue","h","A","HITTEST","j","w","getMaterialProgram","isCompiled","useProgram","setUniformMatrix3fv","displayViewMat3","VIEWPORT","displayMat3","setUniform2fv","setUniform1f","z","setUniform4fv","page","getPageSize","bind","LINEAR","setUniform1i","b","has","key","level","setDataUniforms","prepareForRendering","lineVertexArrayObject","bindVAO","transforms","dvs","setStencilFunction","EQUAL","stencilRef","patternMap","drawElements","TRIANGLES","UNSIGNED_INT","Uint32Array","BYTES_PER_ELEMENT","lineIndexStart","triangleCount","WGLBrushVTLLine"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLLine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../../core/maybe.js\";import{TranslateAnchor as i}from\"../../vectorTiles/style/StyleDefinition.js\";import{VTL_TEXTURE_BINDING_UNIT_SPRITES as n}from\"../definitions.js\";import{WGLDrawPhase as r}from\"../enums.js\";import{u32to4Xu8 as a}from\"../number.js\";import o from\"./WGLBrush.js\";import{TextureSamplingMode as s,CompareFunction as l,PrimitiveType as f,DataType as m}from\"../../../../webgl/enums.js\";class u extends o{constructor(){super(...arguments),this._programOptions={id:!1,pattern:!1,sdf:!1}}dispose(){}drawMany(o,u){const{context:c,displayLevel:d,state:p,drawPhase:g,painter:y,pixelRatio:E,spriteMosaic:M,styleLayerUID:_,requestRender:v}=o;if(!u.some((e=>e.layerData.get(_)?.lineIndexCount??!1)))return;const U=o.styleLayer,I=U.lineMaterial,P=y.vectorTilesMaterialManager,x=U.getPaintValue(\"line-translate\",d),T=U.getPaintValue(\"line-translate-anchor\",d),S=U.getPaintProperty(\"line-pattern\"),D=void 0!==S,L=D&&S.isDataDriven;let N,R;if(D&&!L){const e=S.getValue(d);N=M.getMosaicItemPosition(e)}let V=!1;if(!D){const e=U.getPaintProperty(\"line-dasharray\");if(R=void 0!==e,V=R&&e.isDataDriven,R&&!V){const t=e.getValue(d),i=U.getDashKey(t,U.getLayoutValue(\"line-cap\",d));N=M.getMosaicItemPosition(i)}}const h=1/E,A=g===r.HITTEST,j=this._programOptions;j.id=A,j.pattern=D,j.sdf=R;const w=P.getMaterialProgram(c,I,j);if(e(v)&&!A&&!w.isCompiled)return void v();if(c.useProgram(w),w.setUniformMatrix3fv(\"u_displayViewMat3\",p.displayViewMat3),w.setUniformMatrix3fv(\"u_displayMat3\",T===i.VIEWPORT?p.displayMat3:p.displayViewMat3),w.setUniform2fv(\"u_lineTranslation\",x),w.setUniform1f(\"u_depth\",U.z),w.setUniform1f(\"u_antialiasing\",h),A){const e=a(_+1);w.setUniform4fv(\"u_id\",e)}if(N&&e(N)){const{page:t}=N,i=M.getPageSize(t);e(i)&&(M.bind(c,s.LINEAR,t,n),w.setUniform2fv(\"u_mosaicSize\",i),w.setUniform1i(\"u_texture\",n))}let b=-1;for(const i of u){if(!i.layerData.has(_))continue;i.key.level!==b&&(b=i.key.level,I.setDataUniforms(w,d,U,b,M));const r=2**(d-b)/E;w.setUniform1f(\"u_zoomFactor\",r);const a=i.layerData.get(_);if(!a.lineIndexCount)continue;a.prepareForRendering(c);const o=a.lineVertexArrayObject;if(!t(o)){if(c.bindVAO(o),w.setUniformMatrix3fv(\"u_dvsMat3\",i.transforms.dvs),c.setStencilFunction(l.EQUAL,i.stencilRef,255),L||V){const t=a.patternMap;if(!t)continue;for(const[i,r]of t){const t=M.getPageSize(i);e(t)&&(M.bind(c,s.LINEAR,i,n),w.setUniform2fv(\"u_mosaicSize\",t),w.setUniform1i(\"u_texture\",n),c.drawElements(f.TRIANGLES,r[1],m.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*r[0]))}}else c.drawElements(f.TRIANGLES,a.lineIndexCount,m.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*a.lineIndexStart);i.triangleCount+=a.lineIndexCount/3}}}}export{u as WGLBrushVTLLine};\n"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,8BAAnC;AAAkE,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,4CAAhC;AAA6E,SAAOC,gCAAgC,IAAIC,CAA3C,QAAiD,mBAAjD;AAAqE,SAAOC,YAAY,IAAIC,CAAvB,QAA6B,aAA7B;AAA2C,SAAOC,SAAS,IAAIC,CAApB,QAA0B,cAA1B;AAAyC,OAAOC,CAAP,MAAa,eAAb;AAA6B,SAAOC,mBAAmB,IAAIC,CAA9B,EAAgCC,eAAe,IAAIC,CAAnD,EAAqDC,aAAa,IAAIC,CAAtE,EAAwEC,QAAQ,IAAIC,CAApF,QAA0F,4BAA1F;;AAAuH,MAAMC,CAAN,SAAgBT,CAAhB,CAAiB;EAACU,WAAW,GAAE;IAAC,MAAM,GAAGC,SAAT,GAAoB,KAAKC,eAAL,GAAqB;MAACC,EAAE,EAAC,CAAC,CAAL;MAAOC,OAAO,EAAC,CAAC,CAAhB;MAAkBC,GAAG,EAAC,CAAC;IAAvB,CAAzC;EAAmE;;EAAAC,OAAO,GAAE,CAAE;;EAAAC,QAAQ,CAACjB,CAAD,EAAGS,CAAH,EAAK;IAAC,MAAK;MAACS,OAAO,EAACC,CAAT;MAAWC,YAAY,EAACC,CAAxB;MAA0BC,KAAK,EAACC,CAAhC;MAAkCC,SAAS,EAACC,CAA5C;MAA8CC,OAAO,EAACC,CAAtD;MAAwDC,UAAU,EAACC,CAAnE;MAAqEC,YAAY,EAACC,CAAlF;MAAoFC,aAAa,EAACC,CAAlG;MAAoGC,aAAa,EAACC;IAAlH,IAAqHnC,CAA1H;IAA4H,IAAG,CAACS,CAAC,CAAC2B,IAAF,CAAQ/C,CAAC,IAAEA,CAAC,CAACgD,SAAF,CAAYC,GAAZ,CAAgBL,CAAhB,GAAoBM,cAApB,IAAoC,CAAC,CAAhD,CAAJ,EAAwD;IAAO,MAAMC,CAAC,GAACxC,CAAC,CAACyC,UAAV;IAAA,MAAqBC,CAAC,GAACF,CAAC,CAACG,YAAzB;IAAA,MAAsCC,CAAC,GAACjB,CAAC,CAACkB,0BAA1C;IAAA,MAAqEC,CAAC,GAACN,CAAC,CAACO,aAAF,CAAgB,gBAAhB,EAAiC1B,CAAjC,CAAvE;IAAA,MAA2G2B,CAAC,GAACR,CAAC,CAACO,aAAF,CAAgB,uBAAhB,EAAwC1B,CAAxC,CAA7G;IAAA,MAAwJ4B,CAAC,GAACT,CAAC,CAACU,gBAAF,CAAmB,cAAnB,CAA1J;IAAA,MAA6LC,CAAC,GAAC,KAAK,CAAL,KAASF,CAAxM;IAAA,MAA0MG,CAAC,GAACD,CAAC,IAAEF,CAAC,CAACI,YAAjN;IAA8N,IAAIC,CAAJ,EAAMC,CAAN;;IAAQ,IAAGJ,CAAC,IAAE,CAACC,CAAP,EAAS;MAAC,MAAM/D,CAAC,GAAC4D,CAAC,CAACO,QAAF,CAAWnC,CAAX,CAAR;MAAsBiC,CAAC,GAACvB,CAAC,CAAC0B,qBAAF,CAAwBpE,CAAxB,CAAF;IAA6B;;IAAA,IAAIqE,CAAC,GAAC,CAAC,CAAP;;IAAS,IAAG,CAACP,CAAJ,EAAM;MAAC,MAAM9D,CAAC,GAACmD,CAAC,CAACU,gBAAF,CAAmB,gBAAnB,CAAR;;MAA6C,IAAGK,CAAC,GAAC,KAAK,CAAL,KAASlE,CAAX,EAAaqE,CAAC,GAACH,CAAC,IAAElE,CAAC,CAACgE,YAApB,EAAiCE,CAAC,IAAE,CAACG,CAAxC,EAA0C;QAAC,MAAMnE,CAAC,GAACF,CAAC,CAACmE,QAAF,CAAWnC,CAAX,CAAR;QAAA,MAAsB5B,CAAC,GAAC+C,CAAC,CAACmB,UAAF,CAAapE,CAAb,EAAeiD,CAAC,CAACoB,cAAF,CAAiB,UAAjB,EAA4BvC,CAA5B,CAAf,CAAxB;QAAuEiC,CAAC,GAACvB,CAAC,CAAC0B,qBAAF,CAAwBhE,CAAxB,CAAF;MAA6B;IAAC;;IAAA,MAAMoE,CAAC,GAAC,IAAEhC,CAAV;IAAA,MAAYiC,CAAC,GAACrC,CAAC,KAAG5B,CAAC,CAACkE,OAApB;IAAA,MAA4BC,CAAC,GAAC,KAAKpD,eAAnC;IAAmDoD,CAAC,CAACnD,EAAF,GAAKiD,CAAL,EAAOE,CAAC,CAAClD,OAAF,GAAUqC,CAAjB,EAAmBa,CAAC,CAACjD,GAAF,GAAMwC,CAAzB;IAA2B,MAAMU,CAAC,GAACrB,CAAC,CAACsB,kBAAF,CAAqB/C,CAArB,EAAuBuB,CAAvB,EAAyBsB,CAAzB,CAAR;IAAoC,IAAG3E,CAAC,CAAC8C,CAAD,CAAD,IAAM,CAAC2B,CAAP,IAAU,CAACG,CAAC,CAACE,UAAhB,EAA2B,OAAO,KAAKhC,CAAC,EAAb;;IAAgB,IAAGhB,CAAC,CAACiD,UAAF,CAAaH,CAAb,GAAgBA,CAAC,CAACI,mBAAF,CAAsB,mBAAtB,EAA0C9C,CAAC,CAAC+C,eAA5C,CAAhB,EAA6EL,CAAC,CAACI,mBAAF,CAAsB,eAAtB,EAAsCrB,CAAC,KAAGvD,CAAC,CAAC8E,QAAN,GAAehD,CAAC,CAACiD,WAAjB,GAA6BjD,CAAC,CAAC+C,eAArE,CAA7E,EAAmKL,CAAC,CAACQ,aAAF,CAAgB,mBAAhB,EAAoC3B,CAApC,CAAnK,EAA0MmB,CAAC,CAACS,YAAF,CAAe,SAAf,EAAyBlC,CAAC,CAACmC,CAA3B,CAA1M,EAAwOV,CAAC,CAACS,YAAF,CAAe,gBAAf,EAAgCb,CAAhC,CAAxO,EAA2QC,CAA9Q,EAAgR;MAAC,MAAMzE,CAAC,GAACU,CAAC,CAACkC,CAAC,GAAC,CAAH,CAAT;MAAegC,CAAC,CAACW,aAAF,CAAgB,MAAhB,EAAuBvF,CAAvB;IAA0B;;IAAA,IAAGiE,CAAC,IAAEjE,CAAC,CAACiE,CAAD,CAAP,EAAW;MAAC,MAAK;QAACuB,IAAI,EAACtF;MAAN,IAAS+D,CAAd;MAAA,MAAgB7D,CAAC,GAACsC,CAAC,CAAC+C,WAAF,CAAcvF,CAAd,CAAlB;MAAmCF,CAAC,CAACI,CAAD,CAAD,KAAOsC,CAAC,CAACgD,IAAF,CAAO5D,CAAP,EAASjB,CAAC,CAAC8E,MAAX,EAAkBzF,CAAlB,EAAoBI,CAApB,GAAuBsE,CAAC,CAACQ,aAAF,CAAgB,cAAhB,EAA+BhF,CAA/B,CAAvB,EAAyDwE,CAAC,CAACgB,YAAF,CAAe,WAAf,EAA2BtF,CAA3B,CAAhE;IAA+F;;IAAA,IAAIuF,CAAC,GAAC,CAAC,CAAP;;IAAS,KAAI,MAAMzF,CAAV,IAAegB,CAAf,EAAiB;MAAC,IAAG,CAAChB,CAAC,CAAC4C,SAAF,CAAY8C,GAAZ,CAAgBlD,CAAhB,CAAJ,EAAuB;MAASxC,CAAC,CAAC2F,GAAF,CAAMC,KAAN,KAAcH,CAAd,KAAkBA,CAAC,GAACzF,CAAC,CAAC2F,GAAF,CAAMC,KAAR,EAAc3C,CAAC,CAAC4C,eAAF,CAAkBrB,CAAlB,EAAoB5C,CAApB,EAAsBmB,CAAtB,EAAwB0C,CAAxB,EAA0BnD,CAA1B,CAAhC;MAA8D,MAAMlC,CAAC,GAAC,MAAIwB,CAAC,GAAC6D,CAAN,IAASrD,CAAjB;MAAmBoC,CAAC,CAACS,YAAF,CAAe,cAAf,EAA8B7E,CAA9B;MAAiC,MAAME,CAAC,GAACN,CAAC,CAAC4C,SAAF,CAAYC,GAAZ,CAAgBL,CAAhB,CAAR;MAA2B,IAAG,CAAClC,CAAC,CAACwC,cAAN,EAAqB;MAASxC,CAAC,CAACwF,mBAAF,CAAsBpE,CAAtB;MAAyB,MAAMnB,CAAC,GAACD,CAAC,CAACyF,qBAAV;;MAAgC,IAAG,CAACjG,CAAC,CAACS,CAAD,CAAL,EAAS;QAAC,IAAGmB,CAAC,CAACsE,OAAF,CAAUzF,CAAV,GAAaiE,CAAC,CAACI,mBAAF,CAAsB,WAAtB,EAAkC5E,CAAC,CAACiG,UAAF,CAAaC,GAA/C,CAAb,EAAiExE,CAAC,CAACyE,kBAAF,CAAqBxF,CAAC,CAACyF,KAAvB,EAA6BpG,CAAC,CAACqG,UAA/B,EAA0C,GAA1C,CAAjE,EAAgH1C,CAAC,IAAEM,CAAtH,EAAwH;UAAC,MAAMnE,CAAC,GAACQ,CAAC,CAACgG,UAAV;UAAqB,IAAG,CAACxG,CAAJ,EAAM;;UAAS,KAAI,MAAK,CAACE,CAAD,EAAGI,CAAH,CAAT,IAAiBN,CAAjB,EAAmB;YAAC,MAAMA,CAAC,GAACwC,CAAC,CAAC+C,WAAF,CAAcrF,CAAd,CAAR;YAAyBJ,CAAC,CAACE,CAAD,CAAD,KAAOwC,CAAC,CAACgD,IAAF,CAAO5D,CAAP,EAASjB,CAAC,CAAC8E,MAAX,EAAkBvF,CAAlB,EAAoBE,CAApB,GAAuBsE,CAAC,CAACQ,aAAF,CAAgB,cAAhB,EAA+BlF,CAA/B,CAAvB,EAAyD0E,CAAC,CAACgB,YAAF,CAAe,WAAf,EAA2BtF,CAA3B,CAAzD,EAAuFwB,CAAC,CAAC6E,YAAF,CAAe1F,CAAC,CAAC2F,SAAjB,EAA2BpG,CAAC,CAAC,CAAD,CAA5B,EAAgCW,CAAC,CAAC0F,YAAlC,EAA+CC,WAAW,CAACC,iBAAZ,GAA8BvG,CAAC,CAAC,CAAD,CAA9E,CAA9F;UAAkL;QAAC,CAA7X,MAAkYsB,CAAC,CAAC6E,YAAF,CAAe1F,CAAC,CAAC2F,SAAjB,EAA2BlG,CAAC,CAACwC,cAA7B,EAA4C/B,CAAC,CAAC0F,YAA9C,EAA2DC,WAAW,CAACC,iBAAZ,GAA8BrG,CAAC,CAACsG,cAA3F;;QAA2G5G,CAAC,CAAC6G,aAAF,IAAiBvG,CAAC,CAACwC,cAAF,GAAiB,CAAlC;MAAoC;IAAC;EAAC;;AAAvrE;;AAAwrE,SAAO9B,CAAC,IAAI8F,eAAZ"},"metadata":{},"sourceType":"module"}