{"ast":null,"code":"import \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport s from \"../../../core/Logger.js\";\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport t from \"../../../core/PooledArray.js\";\nimport { WorkerHandle as o } from \"../../../core/workers/WorkerHandle.js\";\nimport { canProjectWithoutEngine as p, projectVectorToVector as r } from \"../../../geometry/projection.js\";\nimport { ModificationType as h } from \"../../../libs/i3s/enums.js\";\nconst i = s.getLogger(\"esri.views.3d.layers.I3SMeshWorkerHandle\");\n\nclass u extends o {\n  constructor(s) {\n    super(\"SceneLayerWorker\", \"process\", {\n      process: s => [s.geometryBuffer]\n    }, s, {\n      hasInitialize: !0\n    });\n  }\n\n  setModifications(s, e, t, o) {\n    const p = {\n      context: s,\n      modifications: c(e, t, o),\n      isGeodetic: o.isGeographic\n    };\n    this.broadcast(p, \"setModifications\");\n  }\n\n  setLegacySchema(s, e) {\n    const t = JSON.stringify(e);\n    this.broadcast({\n      context: s,\n      jsonSchema: t\n    }, \"setLegacySchema\");\n  }\n\n  destroyContext(s) {\n    return this.broadcast(s, \"destroyContext\");\n  }\n\n}\n\nconst n = new t({\n  deallocator: null\n}),\n      a = [0, 0, 0];\n\nfunction c(s, t, o) {\n  n.clear();\n  let u = 1 / 0,\n      c = 1 / 0,\n      f = -1 / 0,\n      l = -1 / 0,\n      m = !1;\n\n  for (const e of t) {\n    const s = \"clip\" === e.type ? h.Inside : \"mask\" === e.type ? h.Outside : h.Replace,\n          t = e.geometry;\n\n    let d = s => s;\n\n    if (t.spatialReference) {\n      if (!p(t.spatialReference, o)) {\n        i.warn(\"Can't project modification polygon into layer spatial reference, ignoring modification\");\n        continue;\n      }\n\n      d = s => (r(s, t.spatialReference, a, o), a);\n    } else t.hasZ || (a[2] = 0, d = s => (a[0] = s[0], a[1] = s[1], a));\n\n    m = m || s === h.Outside, n.push(s), n.push(t.rings.length);\n\n    for (const e of t.rings) {\n      n.push(e.length);\n\n      for (const s of e) {\n        const e = d(s);\n        n.push(e[0]), n.push(e[1]), n.push(e[2]), u = Math.min(u, e[0]), c = Math.min(c, e[1]), f = Math.max(f, e[0]), l = Math.max(l, e[1]);\n      }\n    }\n  }\n\n  if (e(s)) if (m) {\n    const e = 1e-4;\n    n.push(h.Inside), n.push(2), n.push(4), n.push(u - e), n.push(c - e), n.push(0), n.push(f + e), n.push(c - e), n.push(0), n.push(f + e), n.push(l + e), n.push(0), n.push(u - e), n.push(l + e), n.push(0), n.push(4), n.push(s[0]), n.push(s[1]), n.push(0), n.push(s[2]), n.push(s[1]), n.push(0), n.push(s[2]), n.push(s[3]), n.push(0), n.push(s[0]), n.push(s[3]), n.push(0);\n  } else n.push(h.Outside), n.push(1), n.push(4), n.push(s[0]), n.push(s[1]), n.push(0), n.push(s[2]), n.push(s[1]), n.push(0), n.push(s[2]), n.push(s[3]), n.push(0), n.push(s[0]), n.push(s[3]), n.push(0);\n  n.push(h.Finished);\n  const d = new Float64Array(n.length);\n\n  for (let e = 0; e < n.length; ++e) d[e] = n.getItemAt(e);\n\n  return d;\n}\n\nexport { u as I3SMeshWorkerHandle, c as toWasmModification };","map":{"version":3,"names":["s","isSome","e","t","WorkerHandle","o","canProjectWithoutEngine","p","projectVectorToVector","r","ModificationType","h","i","getLogger","u","constructor","process","geometryBuffer","hasInitialize","setModifications","context","modifications","c","isGeodetic","isGeographic","broadcast","setLegacySchema","JSON","stringify","jsonSchema","destroyContext","n","deallocator","a","clear","f","l","m","type","Inside","Outside","Replace","geometry","d","spatialReference","warn","hasZ","push","rings","length","Math","min","max","Finished","Float64Array","getItemAt","I3SMeshWorkerHandle","toWasmModification"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/3d/layers/I3SMeshWorkerHandle.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport s from\"../../../core/Logger.js\";import{isSome as e}from\"../../../core/maybe.js\";import t from\"../../../core/PooledArray.js\";import{WorkerHandle as o}from\"../../../core/workers/WorkerHandle.js\";import{canProjectWithoutEngine as p,projectVectorToVector as r}from\"../../../geometry/projection.js\";import{ModificationType as h}from\"../../../libs/i3s/enums.js\";const i=s.getLogger(\"esri.views.3d.layers.I3SMeshWorkerHandle\");class u extends o{constructor(s){super(\"SceneLayerWorker\",\"process\",{process:s=>[s.geometryBuffer]},s,{hasInitialize:!0})}setModifications(s,e,t,o){const p={context:s,modifications:c(e,t,o),isGeodetic:o.isGeographic};this.broadcast(p,\"setModifications\")}setLegacySchema(s,e){const t=JSON.stringify(e);this.broadcast({context:s,jsonSchema:t},\"setLegacySchema\")}destroyContext(s){return this.broadcast(s,\"destroyContext\")}}const n=new t({deallocator:null}),a=[0,0,0];function c(s,t,o){n.clear();let u=1/0,c=1/0,f=-1/0,l=-1/0,m=!1;for(const e of t){const s=\"clip\"===e.type?h.Inside:\"mask\"===e.type?h.Outside:h.Replace,t=e.geometry;let d=s=>s;if(t.spatialReference){if(!p(t.spatialReference,o)){i.warn(\"Can't project modification polygon into layer spatial reference, ignoring modification\");continue}d=s=>(r(s,t.spatialReference,a,o),a)}else t.hasZ||(a[2]=0,d=s=>(a[0]=s[0],a[1]=s[1],a));m=m||s===h.Outside,n.push(s),n.push(t.rings.length);for(const e of t.rings){n.push(e.length);for(const s of e){const e=d(s);n.push(e[0]),n.push(e[1]),n.push(e[2]),u=Math.min(u,e[0]),c=Math.min(c,e[1]),f=Math.max(f,e[0]),l=Math.max(l,e[1])}}}if(e(s))if(m){const e=1e-4;n.push(h.Inside),n.push(2),n.push(4),n.push(u-e),n.push(c-e),n.push(0),n.push(f+e),n.push(c-e),n.push(0),n.push(f+e),n.push(l+e),n.push(0),n.push(u-e),n.push(l+e),n.push(0),n.push(4),n.push(s[0]),n.push(s[1]),n.push(0),n.push(s[2]),n.push(s[1]),n.push(0),n.push(s[2]),n.push(s[3]),n.push(0),n.push(s[0]),n.push(s[3]),n.push(0)}else n.push(h.Outside),n.push(1),n.push(4),n.push(s[0]),n.push(s[1]),n.push(0),n.push(s[2]),n.push(s[1]),n.push(0),n.push(s[2]),n.push(s[3]),n.push(0),n.push(s[0]),n.push(s[3]),n.push(0);n.push(h.Finished);const d=new Float64Array(n.length);for(let e=0;e<n.length;++e)d[e]=n.getItemAt(e);return d}export{u as I3SMeshWorkerHandle,c as toWasmModification};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}