{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport \"../../../../../geometry.js\";\nimport e from \"../../../../../core/Evented.js\";\nimport t from \"../../../../../core/has.js\";\nimport { isNone as s, isSome as r, applySome as i } from \"../../../../../core/maybe.js\";\nimport { diff as a, hasDiff as o } from \"../../../../../core/accessorSupport/diffUtils.js\";\nimport { GeohashTree as h } from \"../../../../../geohash/GeohashTree.js\";\nimport { setGeohashBuf as l, setGeohashXY as n } from \"../../../../../geohash/geohashUtils.js\";\nimport { earth as u } from \"../../../../../geometry/support/Ellipsoid.js\";\nimport { getInfo as c } from \"../../../../../geometry/support/spatialReferenceUtils.js\";\nimport { quantizeX as g, quantizeY as d } from \"../../../../../layers/graphics/featureConversionUtils.js\";\nimport { OptimizedFeatureWithGeometry as f, OptimizedFeature as p } from \"../../../../../layers/graphics/OptimizedFeature.js\";\nimport _ from \"../../../../../layers/graphics/OptimizedGeometry.js\";\nimport { checkProjectionSupport as m, project as y } from \"../../../../../layers/graphics/data/projectionSupport.js\";\nimport { TILE_SIZE as I } from \"../../../engine/webgl/definitions.js\";\nimport { DISPLAY_ID_TEXEL_MASK as v } from \"../../../engine/webgl/DisplayId.js\";\nimport { Store2D as b } from \"../Store2D.js\";\nimport { FeatureSetReaderJSON as R } from \"./FeatureSetReaderJSON.js\";\nimport C from \"../../../../../geometry/SpatialReference.js\";\nconst M = 12,\n      x = 1;\n\nclass L extends f {\n  constructor(e, t, s, r, i) {\n    super(new _([], [t, s]), r, null, e), this.geohashBoundsInfo = i;\n  }\n\n  get count() {\n    return this.attributes.cluster_count;\n  }\n\n  static create(e, t, s, r, i, a, o, h) {\n    const l = new L(t, s, r, a, o);\n    return l.displayId = e.createDisplayId(!0), l.referenceId = h, l.tileLevel = i, l;\n  }\n\n  update(e, t, s, r, i, a) {\n    return this.geometry.coords[0] = e, this.geometry.coords[1] = t, this.tileLevel = s, this.attributes = r, this.geohashBoundsInfo = i, this.referenceId = null, this.referenceId = a, this;\n  }\n\n  toJSON() {\n    return {\n      objectId: this.objectId,\n      referenceId: 1 === this.attributes.cluster_count ? this.referenceId : null,\n      attributes: { ...this.attributes,\n        clusterId: this.objectId\n      },\n      geometry: {\n        x: this.geometry.coords[0],\n        y: this.geometry.coords[1]\n      }\n    };\n  }\n\n}\n\nfunction j(e) {\n  return 57.29577951308232 * e;\n}\n\nclass w extends b {\n  constructor(t, s, r, i) {\n    super(t, r), this.events = new e(), this._geohashLevel = 0, this._tileLevel = 0, this._aggregateValueRanges = {}, this._aggregateValueRangesChanged = !1, this._geohashBuf = [], this._clusters = new Map(), this._tiles = new Map(), this._serviceInfo = i, this.geometryInfo = t.geometryInfo, this._spatialReference = s, this._projectionSupportCheck = m(s, C.WGS84), this._bitsets.geohash = r.getBitset(r.createBitset()), this._bitsets.inserted = r.getBitset(r.createBitset());\n  }\n\n  destroy() {\n    this._tree.destroy();\n  }\n\n  async updateSchema(e, r) {\n    const i = this._schema;\n\n    try {\n      await super.updateSchema(e, r), await this._projectionSupportCheck;\n    } catch (n) {}\n\n    const l = a(i, r);\n    r && (!s(l) || e.source || e.storage.filters) ? ((o(l, \"params.fields\") || !this._tree || e.source) && (this._tree && this._tree.destroy(), this._tree = new h(this._statisticFields, this._serviceInfo), this._rebuildTree(), t(\"esri-2d-update-debug\") && console.debug(\"Aggregate mesh needs update due to tree changing\")), t(\"esri-2d-update-debug\") && console.debug(\"Applying Update - ClusterStore:\", l), e.targets[r.name] = !0, e.mesh = !1, this._aggregateValueRanges = {}) : i && (e.mesh = !0);\n  }\n\n  clear() {\n    this._rebuildTree();\n  }\n\n  sweepFeatures(e, t) {\n    this._bitsets.inserted.forEachSet(s => {\n      if (!e.has(s)) {\n        const e = t.lookupByDisplayIdUnsafe(s);\n\n        this._remove(e);\n      }\n    });\n  }\n\n  sweepAggregates(e, t, s) {\n    this._clusters.forEach((r, i) => {\n      r && r.tileLevel !== s && (e.releaseDisplayId(r.displayId), t.unsetAttributeData(r.displayId), this._clusters.delete(i));\n    });\n  }\n\n  onTileData(e, t, r, i, a = !0) {\n    if (!this._schema || s(t.addOrUpdate)) return t;\n\n    const o = this._getTransforms(e, this._spatialReference);\n\n    {\n      const e = t.addOrUpdate.getCursor();\n\n      for (; e.next();) this._update(e, i);\n    }\n    if (t.status.mesh || !a) return t;\n    const h = new Array(),\n          l = this._schema.params.clusterRadius;\n    this._getClustersForTile(h, e, l, r, o), t.addOrUpdate = R.fromOptimizedFeatures(h, this._serviceInfo), t.addOrUpdate.attachStorage(r), t.clear = !0, t.end = !0;\n    {\n      const s = t.addOrUpdate.getCursor();\n\n      for (; s.next();) {\n        const t = s.getDisplayId();\n        this._bitsets.computed.unset(t), this.setComputedAttributes(r, s, t, e.scale);\n      }\n    }\n    return this._aggregateValueRangesChanged && t.end && (this.events.emit(\"valueRangesChanged\", {\n      valueRanges: this._aggregateValueRanges\n    }), this._aggregateValueRangesChanged = !1), t;\n  }\n\n  onTileUpdate({\n    added: e,\n    removed: t\n  }) {\n    if (e.length) {\n      const t = e[0].level;\n      this._tileLevel = t, this._setGeohashLevel(t);\n    }\n\n    if (!this._schema) return;\n    const s = this._schema.params.clusterRadius;\n    t.forEach(e => {\n      this._tiles.delete(e.key.id), this._markTileClustersForDeletion(e, s);\n    });\n  }\n\n  getAggregate(e) {\n    for (const t of this._clusters.values()) if ((t?.displayId & v) == (e & v)) return t.toJSON();\n\n    return null;\n  }\n\n  getAggregates() {\n    const e = [];\n\n    for (const t of this._clusters.values()) t?.tileLevel === this._tileLevel && e.push(t.toJSON());\n\n    return e;\n  }\n\n  getDisplayId(e) {\n    const t = this._clusters.get(e);\n\n    return t ? t.displayId : null;\n  }\n\n  getFeatureDisplayIdsForAggregate(e) {\n    const t = this._clusters.get(e);\n\n    if (!t) return [];\n    const s = t.geohashBoundsInfo;\n    return this._tree.getRegionDisplayIds(s.xLL, s.yLL, s.xTR, s.yTR, s.level);\n  }\n\n  getDisplayIdForReferenceId(e) {\n    for (const t of this._clusters.values()) if (t?.referenceId === e) return t.displayId;\n\n    return null;\n  }\n\n  getAggregateValueRanges() {\n    return this._aggregateValueRanges;\n  }\n\n  forEach(e) {\n    for (const [t, s] of this._clusters) s && e(s, t);\n  }\n\n  size() {\n    let e = 0;\n    return this.forEach(t => e++), e;\n  }\n\n  _rebuildTree() {\n    this._bitsets.computed.clear(), this._bitsets.inserted.clear(), this._tree && this._tree.clear();\n  }\n\n  _remove(e) {\n    const t = e.getDisplayId(),\n          s = e.getXHydrated(),\n          r = e.getYHydrated(),\n          i = this._geohashBuf[2 * t],\n          a = this._geohashBuf[2 * t + 1];\n    this._bitsets.inserted.has(t) && (this._bitsets.inserted.unset(t), this._tree.removeCursor(e, s, r, i, a, this._geohashLevel));\n  }\n\n  _update(e, t) {\n    const s = e.getDisplayId(),\n          r = this._bitsets.inserted,\n          i = t.isVisible(s);\n    if (i === r.has(s)) return;\n    if (!i) return void this._remove(e);\n    const a = e.getXHydrated(),\n          o = e.getYHydrated();\n    if (!this._setGeohash(s, a, o)) return;\n    const h = this._geohashBuf[2 * s],\n          l = this._geohashBuf[2 * s + 1];\n    this._tree.insertCursor(e, s, a, o, h, l, this._geohashLevel), r.set(s);\n  }\n\n  _setGeohash(e, t, s) {\n    if (this._bitsets.geohash.has(e)) return !0;\n    const r = this._geohashBuf;\n\n    if (this._spatialReference.isWebMercator) {\n      const i = j(t / u.radius),\n            a = i - 360 * Math.floor((i + 180) / 360),\n            o = j(Math.PI / 2 - 2 * Math.atan(Math.exp(-s / u.radius)));\n      l(r, e, o, a, M);\n    } else {\n      const i = y({\n        x: t,\n        y: s\n      }, this._spatialReference, C.WGS84);\n      if (!i) return !1;\n      l(r, e, i.y, i.x, M);\n    }\n\n    return this._bitsets.geohash.set(e), !0;\n  }\n\n  _getClustersForTile(e, t, a, o, h, l = !0) {\n    const n = this._schema.params.clusterPixelBuffer,\n          u = 2 * a,\n          c = this._getGeohashLevel(t.key.level),\n          f = Math.ceil(2 ** t.key.level * I / u),\n          _ = Math.ceil(n / u) + 0,\n          m = Math.ceil(I / u),\n          {\n      row: y,\n      col: v\n    } = t.key,\n          b = v * I,\n          R = y * I,\n          C = Math.floor(b / u) - _,\n          M = Math.floor(R / u) - _,\n          x = C + m + 2 * _,\n          L = M + m + 2 * _,\n          j = t.tileInfoView.getLODInfoAt(t.key.level);\n\n    for (let I = C; I <= x; I++) for (let a = M; a <= L; a++) {\n      let n = I;\n      j.wrap && (n = I < 0 ? I + f : I % f);\n\n      const u = j.wrap && I < 0,\n            _ = j.wrap && I % f !== I,\n            m = this._lookupCluster(o, j, t.key.level, n, a, c);\n\n      if (r(m)) {\n        const t = i(h, e => u ? e.left : _ ? e.right : e.tile);\n        if (l && s(t)) continue;\n        if (!m.count) continue;\n\n        if (r(t) && l) {\n          const s = m.geometry.clone();\n          let i = m.attributes;\n          s.coords[0] = g(t, s.coords[0]), s.coords[1] = d(t, s.coords[1]), 1 === m.count && r(m.referenceId) && (i = { ...m.attributes,\n            referenceId: m.referenceId\n          });\n          const a = new p(s, i);\n          a.displayId = m.displayId, e.push(a);\n        }\n      }\n    }\n  }\n\n  _getGeohashLevel(e) {\n    return Math.min(Math.ceil(e / 2 + 2), M);\n  }\n\n  _setGeohashLevel(e) {\n    const t = this._getGeohashLevel(e),\n          s = (Math.floor(t / x) + 1) * x - 1;\n\n    if (this._geohashLevel !== s) return this._geohashLevel = s, this._rebuildTree(), void this._bitsets.geohash.clear();\n  }\n\n  _getTransforms(e, t) {\n    const s = {\n      originPosition: \"upperLeft\",\n      scale: [e.resolution, e.resolution],\n      translate: [e.bounds[0], e.bounds[3]]\n    },\n          r = c(t);\n    if (!r) return {\n      tile: s,\n      left: null,\n      right: null\n    };\n    const [i, a] = r.valid;\n    return {\n      tile: s,\n      left: { ...s,\n        translate: [a, e.bounds[3]]\n      },\n      right: { ...s,\n        translate: [i - a + e.bounds[0], e.bounds[3]]\n      }\n    };\n  }\n\n  _getClusterId(e, t, s) {\n    return (15 & e) << 28 | (16383 & t) << 14 | 16383 & s;\n  }\n\n  _markForDeletion(e, t, s) {\n    const r = this._getClusterId(e, t, s);\n\n    this._clusters.delete(r);\n  }\n\n  _getClusterBounds(e, t, s) {\n    const r = this._schema.params.clusterRadius,\n          i = 2 * r;\n    let a = s % 2 ? t * i : t * i - r;\n    const o = s * i;\n    let h = a + i;\n    const l = o - i,\n          n = 2 ** e.level * I;\n    e.wrap && a < 0 && (a = 0), e.wrap && h > n && (h = n);\n    const u = a / I,\n          c = o / I,\n          g = h / I,\n          d = l / I;\n    return [e.getXForColumn(u), e.getYForRow(c), e.getXForColumn(g), e.getYForRow(d)];\n  }\n\n  _lookupCluster(e, t, s, i, a, o) {\n    const h = this._getClusterId(s, i, a),\n          l = this._clusters.get(h),\n          [c, g, d, f] = this._getClusterBounds(t, i, a),\n          p = {\n      x: c,\n      y: g\n    },\n          _ = {\n      x: d,\n      y: f\n    };\n\n    let m = 0,\n        I = 0,\n        v = 0,\n        b = 0;\n\n    if (this._spatialReference.isWebMercator) {\n      {\n        const e = j(p.x / u.radius);\n        m = e - 360 * Math.floor((e + 180) / 360), I = j(Math.PI / 2 - 2 * Math.atan(Math.exp(-p.y / u.radius)));\n      }\n      {\n        const e = j(_.x / u.radius);\n        v = e - 360 * Math.floor((e + 180) / 360), b = j(Math.PI / 2 - 2 * Math.atan(Math.exp(-_.y / u.radius)));\n      }\n    } else {\n      const e = y(p, this._spatialReference, C.WGS84),\n            t = y(_, this._spatialReference, C.WGS84);\n      if (!e || !t) return null;\n      m = e.x, I = e.y, v = t.x, b = t.y;\n    }\n\n    const R = {\n      geohashX: 0,\n      geohashY: 0\n    },\n          M = {\n      geohashX: 0,\n      geohashY: 0\n    };\n    n(R, I, m, o), n(M, b, v, o);\n\n    const x = R.geohashX,\n          w = R.geohashY,\n          V = M.geohashX,\n          S = M.geohashY,\n          F = {\n      xLL: x,\n      yLL: w,\n      xTR: V,\n      yTR: S,\n      level: o\n    },\n          D = this._tree.getRegionStatistics(x, w, V, S, o),\n          {\n      count: T,\n      xTotal: k,\n      yTotal: B,\n      referenceId: A\n    } = D,\n          G = T ? k / T : 0,\n          O = T ? B / T : 0;\n\n    if (0 === T) return this._clusters.set(h, null), null;\n    const U = {\n      cluster_count: T,\n      ...D.attributes\n    },\n          X = r(l) ? l.update(G, O, s, U, F, A) : L.create(e, h, G, O, s, U, F, A);\n    return 0 === T && (X.geometry.coords[0] = (c + d) / 2, X.geometry.coords[1] = (g + f) / 2), this._clusters.set(h, X), this._updateAggregateValueRangeForCluster(X, X.tileLevel), X;\n  }\n\n  _updateAggregateValueRangeForCluster(e, t) {\n    const s = this._aggregateValueRanges[t] || {\n      minValue: 1 / 0,\n      maxValue: 0\n    },\n          r = s.minValue,\n          i = s.maxValue;\n    s.minValue = Math.min(r, e.count), s.maxValue = Math.max(i, e.count), this._aggregateValueRanges[t] = s, r === s.minValue && i === s.maxValue || (this._aggregateValueRangesChanged = !0);\n  }\n\n  _markTileClustersForDeletion(e, t) {\n    const s = 2 * t,\n          r = Math.ceil(I / s),\n          {\n      row: i,\n      col: a\n    } = e.key,\n          o = a * I,\n          h = i * I,\n          l = Math.floor(o / s),\n          n = Math.floor(h / s);\n\n    for (let u = l; u < l + r; u++) for (let t = n; t < n + r; t++) this._markForDeletion(e.key.level, u, t);\n  }\n\n}\n\nexport { L as ClusterInfo, w as ClusterStore };","map":{"version":3,"names":["e","t","isNone","s","isSome","r","applySome","i","diff","a","hasDiff","o","GeohashTree","h","setGeohashBuf","l","setGeohashXY","n","earth","u","getInfo","c","quantizeX","g","quantizeY","d","OptimizedFeatureWithGeometry","f","OptimizedFeature","p","_","checkProjectionSupport","m","project","y","TILE_SIZE","I","DISPLAY_ID_TEXEL_MASK","v","Store2D","b","FeatureSetReaderJSON","R","C","M","x","L","constructor","geohashBoundsInfo","count","attributes","cluster_count","create","displayId","createDisplayId","referenceId","tileLevel","update","geometry","coords","toJSON","objectId","clusterId","j","w","events","_geohashLevel","_tileLevel","_aggregateValueRanges","_aggregateValueRangesChanged","_geohashBuf","_clusters","Map","_tiles","_serviceInfo","geometryInfo","_spatialReference","_projectionSupportCheck","WGS84","_bitsets","geohash","getBitset","createBitset","inserted","destroy","_tree","updateSchema","_schema","source","storage","filters","_statisticFields","_rebuildTree","console","debug","targets","name","mesh","clear","sweepFeatures","forEachSet","has","lookupByDisplayIdUnsafe","_remove","sweepAggregates","forEach","releaseDisplayId","unsetAttributeData","delete","onTileData","addOrUpdate","_getTransforms","getCursor","next","_update","status","Array","params","clusterRadius","_getClustersForTile","fromOptimizedFeatures","attachStorage","end","getDisplayId","computed","unset","setComputedAttributes","scale","emit","valueRanges","onTileUpdate","added","removed","length","level","_setGeohashLevel","key","id","_markTileClustersForDeletion","getAggregate","values","getAggregates","push","get","getFeatureDisplayIdsForAggregate","getRegionDisplayIds","xLL","yLL","xTR","yTR","getDisplayIdForReferenceId","getAggregateValueRanges","size","getXHydrated","getYHydrated","removeCursor","isVisible","_setGeohash","insertCursor","set","isWebMercator","radius","Math","floor","PI","atan","exp","clusterPixelBuffer","_getGeohashLevel","ceil","row","col","tileInfoView","getLODInfoAt","wrap","_lookupCluster","left","right","tile","clone","min","originPosition","resolution","translate","bounds","valid","_getClusterId","_markForDeletion","_getClusterBounds","getXForColumn","getYForRow","geohashX","geohashY","V","S","F","D","getRegionStatistics","T","xTotal","k","yTotal","B","A","G","O","U","X","_updateAggregateValueRangeForCluster","minValue","maxValue","max","ClusterInfo","ClusterStore"],"sources":["C:/Users/hp/Desktop/eco-friendly atmosphere/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/features/support/ClusterStore.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport\"../../../../../geometry.js\";import e from\"../../../../../core/Evented.js\";import t from\"../../../../../core/has.js\";import{isNone as s,isSome as r,applySome as i}from\"../../../../../core/maybe.js\";import{diff as a,hasDiff as o}from\"../../../../../core/accessorSupport/diffUtils.js\";import{GeohashTree as h}from\"../../../../../geohash/GeohashTree.js\";import{setGeohashBuf as l,setGeohashXY as n}from\"../../../../../geohash/geohashUtils.js\";import{earth as u}from\"../../../../../geometry/support/Ellipsoid.js\";import{getInfo as c}from\"../../../../../geometry/support/spatialReferenceUtils.js\";import{quantizeX as g,quantizeY as d}from\"../../../../../layers/graphics/featureConversionUtils.js\";import{OptimizedFeatureWithGeometry as f,OptimizedFeature as p}from\"../../../../../layers/graphics/OptimizedFeature.js\";import _ from\"../../../../../layers/graphics/OptimizedGeometry.js\";import{checkProjectionSupport as m,project as y}from\"../../../../../layers/graphics/data/projectionSupport.js\";import{TILE_SIZE as I}from\"../../../engine/webgl/definitions.js\";import{DISPLAY_ID_TEXEL_MASK as v}from\"../../../engine/webgl/DisplayId.js\";import{Store2D as b}from\"../Store2D.js\";import{FeatureSetReaderJSON as R}from\"./FeatureSetReaderJSON.js\";import C from\"../../../../../geometry/SpatialReference.js\";const M=12,x=1;class L extends f{constructor(e,t,s,r,i){super(new _([],[t,s]),r,null,e),this.geohashBoundsInfo=i}get count(){return this.attributes.cluster_count}static create(e,t,s,r,i,a,o,h){const l=new L(t,s,r,a,o);return l.displayId=e.createDisplayId(!0),l.referenceId=h,l.tileLevel=i,l}update(e,t,s,r,i,a){return this.geometry.coords[0]=e,this.geometry.coords[1]=t,this.tileLevel=s,this.attributes=r,this.geohashBoundsInfo=i,this.referenceId=null,this.referenceId=a,this}toJSON(){return{objectId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null,attributes:{...this.attributes,clusterId:this.objectId},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}}}function j(e){return 57.29577951308232*e}class w extends b{constructor(t,s,r,i){super(t,r),this.events=new e,this._geohashLevel=0,this._tileLevel=0,this._aggregateValueRanges={},this._aggregateValueRangesChanged=!1,this._geohashBuf=[],this._clusters=new Map,this._tiles=new Map,this._serviceInfo=i,this.geometryInfo=t.geometryInfo,this._spatialReference=s,this._projectionSupportCheck=m(s,C.WGS84),this._bitsets.geohash=r.getBitset(r.createBitset()),this._bitsets.inserted=r.getBitset(r.createBitset())}destroy(){this._tree.destroy()}async updateSchema(e,r){const i=this._schema;try{await super.updateSchema(e,r),await this._projectionSupportCheck}catch(n){}const l=a(i,r);r&&(!s(l)||e.source||e.storage.filters)?((o(l,\"params.fields\")||!this._tree||e.source)&&(this._tree&&this._tree.destroy(),this._tree=new h(this._statisticFields,this._serviceInfo),this._rebuildTree(),t(\"esri-2d-update-debug\")&&console.debug(\"Aggregate mesh needs update due to tree changing\")),t(\"esri-2d-update-debug\")&&console.debug(\"Applying Update - ClusterStore:\",l),e.targets[r.name]=!0,e.mesh=!1,this._aggregateValueRanges={}):i&&(e.mesh=!0)}clear(){this._rebuildTree()}sweepFeatures(e,t){this._bitsets.inserted.forEachSet((s=>{if(!e.has(s)){const e=t.lookupByDisplayIdUnsafe(s);this._remove(e)}}))}sweepAggregates(e,t,s){this._clusters.forEach(((r,i)=>{r&&r.tileLevel!==s&&(e.releaseDisplayId(r.displayId),t.unsetAttributeData(r.displayId),this._clusters.delete(i))}))}onTileData(e,t,r,i,a=!0){if(!this._schema||s(t.addOrUpdate))return t;const o=this._getTransforms(e,this._spatialReference);{const e=t.addOrUpdate.getCursor();for(;e.next();)this._update(e,i)}if(t.status.mesh||!a)return t;const h=new Array,l=this._schema.params.clusterRadius;this._getClustersForTile(h,e,l,r,o),t.addOrUpdate=R.fromOptimizedFeatures(h,this._serviceInfo),t.addOrUpdate.attachStorage(r),t.clear=!0,t.end=!0;{const s=t.addOrUpdate.getCursor();for(;s.next();){const t=s.getDisplayId();this._bitsets.computed.unset(t),this.setComputedAttributes(r,s,t,e.scale)}}return this._aggregateValueRangesChanged&&t.end&&(this.events.emit(\"valueRangesChanged\",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),t}onTileUpdate({added:e,removed:t}){if(e.length){const t=e[0].level;this._tileLevel=t,this._setGeohashLevel(t)}if(!this._schema)return;const s=this._schema.params.clusterRadius;t.forEach((e=>{this._tiles.delete(e.key.id),this._markTileClustersForDeletion(e,s)}))}getAggregate(e){for(const t of this._clusters.values())if((t?.displayId&v)==(e&v))return t.toJSON();return null}getAggregates(){const e=[];for(const t of this._clusters.values())t?.tileLevel===this._tileLevel&&e.push(t.toJSON());return e}getDisplayId(e){const t=this._clusters.get(e);return t?t.displayId:null}getFeatureDisplayIdsForAggregate(e){const t=this._clusters.get(e);if(!t)return[];const s=t.geohashBoundsInfo;return this._tree.getRegionDisplayIds(s.xLL,s.yLL,s.xTR,s.yTR,s.level)}getDisplayIdForReferenceId(e){for(const t of this._clusters.values())if(t?.referenceId===e)return t.displayId;return null}getAggregateValueRanges(){return this._aggregateValueRanges}forEach(e){for(const[t,s]of this._clusters)s&&e(s,t)}size(){let e=0;return this.forEach((t=>e++)),e}_rebuildTree(){this._bitsets.computed.clear(),this._bitsets.inserted.clear(),this._tree&&this._tree.clear()}_remove(e){const t=e.getDisplayId(),s=e.getXHydrated(),r=e.getYHydrated(),i=this._geohashBuf[2*t],a=this._geohashBuf[2*t+1];this._bitsets.inserted.has(t)&&(this._bitsets.inserted.unset(t),this._tree.removeCursor(e,s,r,i,a,this._geohashLevel))}_update(e,t){const s=e.getDisplayId(),r=this._bitsets.inserted,i=t.isVisible(s);if(i===r.has(s))return;if(!i)return void this._remove(e);const a=e.getXHydrated(),o=e.getYHydrated();if(!this._setGeohash(s,a,o))return;const h=this._geohashBuf[2*s],l=this._geohashBuf[2*s+1];this._tree.insertCursor(e,s,a,o,h,l,this._geohashLevel),r.set(s)}_setGeohash(e,t,s){if(this._bitsets.geohash.has(e))return!0;const r=this._geohashBuf;if(this._spatialReference.isWebMercator){const i=j(t/u.radius),a=i-360*Math.floor((i+180)/360),o=j(Math.PI/2-2*Math.atan(Math.exp(-s/u.radius)));l(r,e,o,a,M)}else{const i=y({x:t,y:s},this._spatialReference,C.WGS84);if(!i)return!1;l(r,e,i.y,i.x,M)}return this._bitsets.geohash.set(e),!0}_getClustersForTile(e,t,a,o,h,l=!0){const n=this._schema.params.clusterPixelBuffer,u=2*a,c=this._getGeohashLevel(t.key.level),f=Math.ceil(2**t.key.level*I/u),_=Math.ceil(n/u)+0,m=Math.ceil(I/u),{row:y,col:v}=t.key,b=v*I,R=y*I,C=Math.floor(b/u)-_,M=Math.floor(R/u)-_,x=C+m+2*_,L=M+m+2*_,j=t.tileInfoView.getLODInfoAt(t.key.level);for(let I=C;I<=x;I++)for(let a=M;a<=L;a++){let n=I;j.wrap&&(n=I<0?I+f:I%f);const u=j.wrap&&I<0,_=j.wrap&&I%f!==I,m=this._lookupCluster(o,j,t.key.level,n,a,c);if(r(m)){const t=i(h,(e=>u?e.left:_?e.right:e.tile));if(l&&s(t))continue;if(!m.count)continue;if(r(t)&&l){const s=m.geometry.clone();let i=m.attributes;s.coords[0]=g(t,s.coords[0]),s.coords[1]=d(t,s.coords[1]),1===m.count&&r(m.referenceId)&&(i={...m.attributes,referenceId:m.referenceId});const a=new p(s,i);a.displayId=m.displayId,e.push(a)}}}}_getGeohashLevel(e){return Math.min(Math.ceil(e/2+2),M)}_setGeohashLevel(e){const t=this._getGeohashLevel(e),s=(Math.floor(t/x)+1)*x-1;if(this._geohashLevel!==s)return this._geohashLevel=s,this._rebuildTree(),void this._bitsets.geohash.clear()}_getTransforms(e,t){const s={originPosition:\"upperLeft\",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},r=c(t);if(!r)return{tile:s,left:null,right:null};const[i,a]=r.valid;return{tile:s,left:{...s,translate:[a,e.bounds[3]]},right:{...s,translate:[i-a+e.bounds[0],e.bounds[3]]}}}_getClusterId(e,t,s){return(15&e)<<28|(16383&t)<<14|16383&s}_markForDeletion(e,t,s){const r=this._getClusterId(e,t,s);this._clusters.delete(r)}_getClusterBounds(e,t,s){const r=this._schema.params.clusterRadius,i=2*r;let a=s%2?t*i:t*i-r;const o=s*i;let h=a+i;const l=o-i,n=2**e.level*I;e.wrap&&a<0&&(a=0),e.wrap&&h>n&&(h=n);const u=a/I,c=o/I,g=h/I,d=l/I;return[e.getXForColumn(u),e.getYForRow(c),e.getXForColumn(g),e.getYForRow(d)]}_lookupCluster(e,t,s,i,a,o){const h=this._getClusterId(s,i,a),l=this._clusters.get(h),[c,g,d,f]=this._getClusterBounds(t,i,a),p={x:c,y:g},_={x:d,y:f};let m=0,I=0,v=0,b=0;if(this._spatialReference.isWebMercator){{const e=j(p.x/u.radius);m=e-360*Math.floor((e+180)/360),I=j(Math.PI/2-2*Math.atan(Math.exp(-p.y/u.radius)))}{const e=j(_.x/u.radius);v=e-360*Math.floor((e+180)/360),b=j(Math.PI/2-2*Math.atan(Math.exp(-_.y/u.radius)))}}else{const e=y(p,this._spatialReference,C.WGS84),t=y(_,this._spatialReference,C.WGS84);if(!e||!t)return null;m=e.x,I=e.y,v=t.x,b=t.y}const R={geohashX:0,geohashY:0},M={geohashX:0,geohashY:0};n(R,I,m,o),n(M,b,v,o);const x=R.geohashX,w=R.geohashY,V=M.geohashX,S=M.geohashY,F={xLL:x,yLL:w,xTR:V,yTR:S,level:o},D=this._tree.getRegionStatistics(x,w,V,S,o),{count:T,xTotal:k,yTotal:B,referenceId:A}=D,G=T?k/T:0,O=T?B/T:0;if(0===T)return this._clusters.set(h,null),null;const U={cluster_count:T,...D.attributes},X=r(l)?l.update(G,O,s,U,F,A):L.create(e,h,G,O,s,U,F,A);return 0===T&&(X.geometry.coords[0]=(c+d)/2,X.geometry.coords[1]=(g+f)/2),this._clusters.set(h,X),this._updateAggregateValueRangeForCluster(X,X.tileLevel),X}_updateAggregateValueRangeForCluster(e,t){const s=this._aggregateValueRanges[t]||{minValue:1/0,maxValue:0},r=s.minValue,i=s.maxValue;s.minValue=Math.min(r,e.count),s.maxValue=Math.max(i,e.count),this._aggregateValueRanges[t]=s,r===s.minValue&&i===s.maxValue||(this._aggregateValueRangesChanged=!0)}_markTileClustersForDeletion(e,t){const s=2*t,r=Math.ceil(I/s),{row:i,col:a}=e.key,o=a*I,h=i*I,l=Math.floor(o/s),n=Math.floor(h/s);for(let u=l;u<l+r;u++)for(let t=n;t<n+r;t++)this._markForDeletion(e.key.level,u,t)}}export{L as ClusterInfo,w as ClusterStore};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}