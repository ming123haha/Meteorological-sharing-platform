{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from \"../../../Graphic.js\";\nimport t from \"../../../request.js\";\nimport i from \"../../Attachment.js\";\nimport r from \"../support/FeatureSet.js\";\nimport s from \"../support/IdSet.js\";\nimport { defaultMaxRecords as a, stableStringify as n, FeatureServiceDatabaseType as l, IdState as o, extractServiceUrl as u } from \"../support/shared.js\";\nimport { toWhereClause as d, isSingleField as c } from \"../support/sqlUtils.js\";\nimport { decodeStatType as p } from \"../support/stats.js\";\nimport { createMD5Hash as h, outputTypes as y } from \"../../../core/MD5.js\";\nimport { id as f } from \"../../../kernel.js\";\nimport { fromJSON as _ } from \"../../../geometry/support/jsonUtils.js\";\nimport m from \"../../../layers/FeatureLayer.js\";\nimport { convertToFeatureSet as g } from \"../../../layers/graphics/featureConversionUtils.js\";\nimport \"../../../core/Error.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../layers/support/source/DataLayerSource.js\";\nimport { executeQueryJSON as S } from \"../../../rest/query/executeQueryJSON.js\";\nimport \"../../../config.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/urlUtils.js\";\nimport \"../../../core/unitUtils.js\";\nimport \"../../../geometry/support/spatialReferenceUtils.js\";\nimport { executeQueryPBF as F } from \"../../../rest/query/operations/query.js\";\nimport R from \"../../../rest/support/FeatureSet.js\";\nimport b from \"../../../rest/support/Query.js\";\nimport \"../../../rest/query/support/AttachmentInfo.js\";\nimport \"../../../rest/support/AttachmentQuery.js\";\nimport { executeForCount as w } from \"../../../rest/query/executeForCount.js\";\nimport \"../../../geometry.js\";\nimport { executeForIds as D } from \"../../../rest/query/executeForIds.js\";\nimport \"../../../rest/support/RelationshipQuery.js\";\nimport \"../../../geometry/support/normalizeUtils.js\";\nimport \"../../../rest/support/TopFeaturesQuery.js\";\nimport { OptimizedFeatureSetParserContext as I } from \"../../../rest/query/operations/pbfOptimizedFeatureSet.js\";\nimport x from \"../../../rest/support/StatisticDefinition.js\";\nimport P from \"../../Dictionary.js\";\nimport { FeatureSetError as j, FeatureSetErrorCodes as q } from \"../support/errorsupport.js\";\n\nclass v extends r {\n  constructor(e) {\n    super(e), this.declaredClass = \"esri.arcade.featureset.sources.FeatureLayerDynamic\", this._removeGeometry = !1, this._overrideFields = null, this.formulaCredential = null, this._pageJustIds = !1, this._requestStandardised = !1, this._useDefinitionExpression = !0, e.spatialReference && (this.spatialReference = e.spatialReference), this._transparent = !0, this._maxProcessing = 1e3, this._layer = e.layer, this._wset = null, void 0 !== e.outFields && (this._overrideFields = e.outFields), void 0 !== e.includeGeometry && (this._removeGeometry = !1 === e.includeGeometry);\n  }\n\n  _maxQueryRate() {\n    return a;\n  }\n\n  end() {\n    return this._layer;\n  }\n\n  optimisePagingFeatureQueries(e) {\n    this._pageJustIds = e;\n  }\n\n  convertQueryToLruCacheKey(e) {\n    const t = n(e.toJSON());\n    return h(t, y.String);\n  }\n\n  async loadImpl() {\n    return !0 === this._layer.loaded ? (this._initialiseFeatureSet(), this) : (await this._layer.load(), this._initialiseFeatureSet(), this);\n  }\n\n  _initialiseFeatureSet() {\n    if (null == this.spatialReference && (this.spatialReference = this._layer.spatialReference), this.geometryType = this._layer.geometryType, this.fields = this._layer.fields.slice(0), this._layer.outFields) {\n      if (1 === this._layer.outFields.length && \"*\" === this._layer.outFields[0]) ;else {\n        const e = [];\n\n        for (const t of this.fields) if (\"oid\" === t.type) e.push(t);else for (const i of this._layer.outFields) if (i.toLowerCase() === t.name.toLowerCase()) {\n          e.push(t);\n          break;\n        }\n\n        this.fields = e;\n      }\n    } else ;\n    if (null !== this._overrideFields) if (1 === this._overrideFields.length && \"*\" === this._overrideFields[0]) this._overrideFields = null;else {\n      const e = [],\n            t = [];\n\n      for (const i of this.fields) if (\"oid\" === i.type) e.push(i), t.push(i.name);else for (const r of this._overrideFields) if (r.toLowerCase() === i.name.toLowerCase()) {\n        e.push(i), t.push(i.name);\n        break;\n      }\n\n      this.fields = e, this._overrideFields = t;\n    }\n\n    if (this._layer.source && this._layer.source.sourceJSON) {\n      const e = this._layer.source.sourceJSON.currentVersion;\n      !0 === this._layer.source.sourceJSON.useStandardizedQueries ? (this._databaseType = l.StandardisedNoInterval, null != e && e >= 10.61 && (this._databaseType = l.Standardised)) : null != e && (e >= 10.5 && (this._databaseType = l.StandardisedNoInterval, this._requestStandardised = !0), e >= 10.61 && (this._databaseType = l.Standardised));\n    }\n\n    this.objectIdField = this._layer.objectIdField;\n\n    for (const e of this.fields) \"global-id\" === e.type && (this.globalIdField = e.name);\n\n    this.hasM = this._layer.supportsM, this.hasZ = this._layer.supportsZ, this.typeIdField = this._layer.typeIdField ?? \"\", this.types = this._layer.types;\n  }\n\n  _isInFeatureSet() {\n    return o.InFeatureSet;\n  }\n\n  async _refineSetBlock(e) {\n    return e;\n  }\n\n  _candidateIdTransform(e) {\n    return e;\n  }\n\n  async _getSet(e) {\n    if (null === this._wset) {\n      await this._ensureLoaded();\n      const t = await this._getFilteredSet(\"\", null, null, null, e);\n      return this._wset = t, t;\n    }\n\n    return this._wset;\n  }\n\n  async _runDatabaseProbe(e) {\n    await this._ensureLoaded();\n    const t = new b();\n    t.where = e.replace(\"OBJECTID\", this._layer.objectIdField);\n\n    try {\n      return await this._layer.queryObjectIds(t), !0;\n    } catch (i) {\n      return !1;\n    }\n  }\n\n  _canUsePagination() {\n    return !(!this._layer.capabilities || !this._layer.capabilities.query || !0 !== this._layer.capabilities.query.supportsPagination);\n  }\n\n  _cacheableFeatureSetSourceKey() {\n    return this._layer.url;\n  }\n\n  pbfSupportedForQuery(e) {\n    const t = this._layer?.capabilities?.query;\n    return !e.outStatistics && !0 === t?.supportsFormatPBF && !0 === t?.supportsQuantizationEditMode;\n  }\n\n  async queryPBF(e) {\n    e.quantizationParameters = {\n      mode: \"edit\"\n    };\n    const t = await F(this._layer.parsedUrl, e, new I({}));\n    return R.fromJSON(g(t.data)).unquantize();\n  }\n\n  get gdbVersion() {\n    return this._layer && this._layer.capabilities && this._layer.capabilities.data && this._layer.capabilities.data.isVersioned ? this._layer.gdbVersion ? this._layer.gdbVersion : \"SDE.DEFAULT\" : \"\";\n  }\n\n  nativeCapabilities() {\n    return {\n      title: this._layer.title ?? \"\",\n      source: this,\n      canQueryRelated: !0,\n      capabilities: this._layer.capabilities,\n      databaseType: this._databaseType,\n      requestStandardised: this._requestStandardised\n    };\n  }\n\n  executeQuery(e, t) {\n    const i = \"execute\" === t ? S : \"executeForCount\" === t ? w : D,\n          r = \"execute\" === t && this.pbfSupportedForQuery(e);\n    let s = null;\n\n    if (this.recentlyUsedQueries) {\n      const t = this.convertQueryToLruCacheKey(e);\n      s = this.recentlyUsedQueries.getFromCache(t), null === s && (s = !0 !== r ? i(this._layer.parsedUrl.path, e) : this.queryPBF(e), this.recentlyUsedQueries.addToCache(t, s), s = s.catch(e => {\n        throw this.recentlyUsedQueries?.removeFromCache(t), e;\n      }));\n    }\n\n    return this.featureSetQueryInterceptor && this.featureSetQueryInterceptor.preLayerQueryCallback({\n      layer: this._layer,\n      query: e,\n      method: t\n    }), null === s && (s = !0 !== r ? i(this._layer.parsedUrl.path, e) : this.queryPBF(e)), s;\n  }\n\n  async _getFilteredSet(e, t, i, r, a) {\n    const n = await this.databaseType();\n\n    if (this.isTable() && t && null !== e && \"\" !== e) {\n      return new s([], [], !0, null);\n    }\n\n    if (this._canUsePagination()) return this._getFilteredSetUsingPaging(e, t, i, r, a);\n    let l = \"\",\n        o = !1;\n    null !== r && this._layer.capabilities && this._layer.capabilities.query && !0 === this._layer.capabilities.query.supportsOrderBy && (l = r.constructClause(), o = !0);\n    const u = new b();\n    u.where = null === i ? null === t ? \"1=1\" : \"\" : d(i, n), this._requestStandardised && (u.sqlFormat = \"standard\"), u.spatialRelationship = this._makeRelationshipEnum(e), u.outSpatialReference = this.spatialReference, u.orderByFields = \"\" !== l ? l.split(\",\") : null, u.geometry = null === t ? null : t, u.relationParameter = this._makeRelationshipParam(e);\n    let c = await this.executeQuery(u, \"executeForIds\");\n    null === c && (c = []), this._checkCancelled(a);\n    return new s([], c, o, null);\n  }\n\n  _expandPagedSet(e, t, i, r, s) {\n    return this._expandPagedSetFeatureSet(e, t, i, r, s);\n  }\n\n  async _getFilteredSetUsingPaging(e, t, i, r, a) {\n    let n = \"\",\n        l = !1;\n    null !== r && this._layer.capabilities && this._layer.capabilities.query && !0 === this._layer.capabilities.query.supportsOrderBy && (n = r.constructClause(), l = !0);\n    const o = await this.databaseType();\n    let u = null === i ? null === t ? \"1=1\" : \"\" : d(i, o);\n    this._layer.definitionExpression && this._useDefinitionExpression && (u = \"\" !== u ? \"((\" + this._layer.definitionExpression + \") AND (\" + u + \"))\" : this._layer.definitionExpression);\n\n    let c = this._maxQueryRate();\n\n    const p = this._layer.capabilities?.query.maxRecordCount;\n    void 0 !== p && p < c && (c = p);\n    let h = null;\n    if (!0 === this._pageJustIds) h = new s([], [\"GETPAGES\"], l, {\n      spatialRel: this._makeRelationshipEnum(e),\n      relationParam: this._makeRelationshipParam(e),\n      outFields: this._layer.objectIdField,\n      resultRecordCount: c,\n      resultOffset: 0,\n      geometry: null === t ? null : t,\n      where: u,\n      orderByFields: n,\n      returnGeometry: !1,\n      returnIdsOnly: \"false\",\n      internal: {\n        set: [],\n        lastRetrieved: 0,\n        lastPage: 0,\n        fullyResolved: !1\n      }\n    });else {\n      let i = !0;\n      !0 === this._removeGeometry && (i = !1);\n      const r = null !== this._overrideFields ? this._overrideFields : this._fieldsIncludingObjectId(this._layer.outFields ? this._layer.outFields : [\"*\"]);\n      h = new s([], [\"GETPAGES\"], l, {\n        spatialRel: this._makeRelationshipEnum(e),\n        relationParam: this._makeRelationshipParam(e),\n        outFields: r.join(\",\"),\n        resultRecordCount: c,\n        resultOffset: 0,\n        geometry: null === t ? null : t,\n        where: u,\n        orderByFields: n,\n        returnGeometry: i,\n        returnIdsOnly: \"false\",\n        internal: {\n          set: [],\n          lastRetrieved: 0,\n          lastPage: 0,\n          fullyResolved: !1\n        }\n      });\n    }\n    return await this._expandPagedSet(h, c, 0, 1, a), h;\n  }\n\n  _clonePageDefinition(e) {\n    return null === e ? null : !0 !== e.groupbypage ? {\n      groupbypage: !1,\n      spatialRel: e.spatialRel,\n      relationParam: e.relationParam,\n      outFields: e.outFields,\n      resultRecordCount: e.resultRecordCount,\n      resultOffset: e.resultOffset,\n      geometry: e.geometry,\n      where: e.where,\n      orderByFields: e.orderByFields,\n      returnGeometry: e.returnGeometry,\n      returnIdsOnly: e.returnIdsOnly,\n      internal: e.internal\n    } : {\n      groupbypage: !0,\n      spatialRel: e.spatialRel,\n      relationParam: e.relationParam,\n      outFields: e.outFields,\n      resultRecordCount: e.resultRecordCount,\n      useOIDpagination: e.useOIDpagination,\n      generatedOid: e.generatedOid,\n      groupByFieldsForStatistics: e.groupByFieldsForStatistics,\n      resultOffset: e.resultOffset,\n      outStatistics: e.outStatistics,\n      geometry: e.geometry,\n      where: e.where,\n      orderByFields: e.orderByFields,\n      returnGeometry: e.returnGeometry,\n      returnIdsOnly: e.returnIdsOnly,\n      internal: e.internal\n    };\n  }\n\n  async _getPhysicalPage(e, t, i) {\n    const r = e.pagesDefinition.internal.lastRetrieved,\n          s = r,\n          a = e.pagesDefinition.internal.lastPage,\n          n = new b();\n    this._requestStandardised && (n.sqlFormat = \"standard\"), n.spatialRelationship = e.pagesDefinition.spatialRel, n.relationParameter = e.pagesDefinition.relationParam, n.outFields = e.pagesDefinition.outFields.split(\",\"), n.num = e.pagesDefinition.resultRecordCount, n.start = e.pagesDefinition.internal.lastPage, n.geometry = e.pagesDefinition.geometry, n.where = e.pagesDefinition.where, n.orderByFields = \"\" !== e.pagesDefinition.orderByFields ? e.pagesDefinition.orderByFields.split(\",\") : null, n.returnGeometry = e.pagesDefinition.returnGeometry, n.outSpatialReference = this.spatialReference;\n    const l = await this.executeQuery(n, \"execute\");\n    if (this._checkCancelled(i), e.pagesDefinition.internal.lastPage !== a) return \"done\";\n    const o = this._layer.objectIdField;\n\n    for (let u = 0; u < l.features.length; u++) e.pagesDefinition.internal.set[s + u] = l.features[u].attributes[o];\n\n    if (!1 === this._pageJustIds) for (let u = 0; u < l.features.length; u++) this._featureCache[l.features[u].attributes[o]] = l.features[u];\n    return (void 0 === l.exceededTransferLimit && l.features.length !== e.pagesDefinition.resultRecordCount || !1 === l.exceededTransferLimit) && (e.pagesDefinition.internal.fullyResolved = !0), e.pagesDefinition.internal.lastRetrieved = r + l.features.length, e.pagesDefinition.internal.lastPage += e.pagesDefinition.resultRecordCount, \"done\";\n  }\n\n  _fieldsIncludingObjectId(e) {\n    if (null === e) return [this.objectIdField];\n    const t = e.slice(0);\n    if (t.includes(\"*\")) return t;\n    let i = !1;\n\n    for (const r of t) if (r.toUpperCase() === this.objectIdField.toUpperCase()) {\n      i = !0;\n      break;\n    }\n\n    return !1 === i && t.push(this.objectIdField), t;\n  }\n\n  async _getFeatures(e, t, i, r) {\n    const s = [];\n    if (-1 !== t && void 0 === this._featureCache[t] && s.push(t), !0 === this._checkIfNeedToExpandKnownPage(e, this._maxProcessingRate())) return await this._expandPagedSet(e, this._maxProcessingRate(), 0, 0, r), this._getFeatures(e, t, i, r);\n    let a = 0;\n\n    for (let u = e._lastFetchedIndex; u < e._known.length; u++) {\n      if (e._lastFetchedIndex += 1, a++, void 0 === this._featureCache[e._known[u]]) {\n        let i = !1;\n\n        if (null !== this._layer._mode && void 0 !== this._layer._mode) {\n          const t = this._layer._mode;\n\n          if (void 0 !== t._featureMap[e._known[u]]) {\n            const r = t._featureMap[e._known[u]];\n            null !== r && (i = !0, this._featureCache[e._known[u]] = r);\n          }\n        }\n\n        if (!1 === i && (e._known[u] !== t && s.push(e._known[u]), s.length >= this._maxProcessingRate() - 1)) break;\n      }\n\n      if (a >= i && 0 === s.length) break;\n    }\n\n    if (0 === s.length) return \"success\";\n    const n = new b();\n    this._requestStandardised && (n.sqlFormat = \"standard\"), n.objectIds = s, n.outFields = null !== this._overrideFields ? this._overrideFields : this._fieldsIncludingObjectId(this._layer.outFields ? this._layer.outFields : [\"*\"]), n.returnGeometry = !0, !0 === this._removeGeometry && (n.returnGeometry = !1), n.outSpatialReference = this.spatialReference;\n    const l = await this.executeQuery(n, \"execute\");\n    if (this._checkCancelled(r), void 0 !== l.error) throw new j(q.RequestFailed, {\n      reason: l.error\n    });\n    const o = this._layer.objectIdField;\n\n    for (let u = 0; u < l.features.length; u++) this._featureCache[l.features[u].attributes[o]] = l.features[u];\n\n    return \"success\";\n  }\n\n  async _getDistinctPages(e, t, i, r, s, a, n, l, o) {\n    await this._ensureLoaded();\n    const u = await this.databaseType();\n    let c = i.parseTree.column;\n    const p = this._layer.fields ?? [];\n\n    for (let d = 0; d < p.length; d++) if (p[d].name.toLowerCase() === c.toLowerCase()) {\n      c = p[d].name;\n      break;\n    }\n\n    const h = new b();\n    this._requestStandardised && (h.sqlFormat = \"standard\");\n    let y = null === a ? null === s ? \"1=1\" : \"\" : d(a, u);\n    this._layer.definitionExpression && this._useDefinitionExpression && (y = \"\" !== y ? \"((\" + this._layer.definitionExpression + \") AND (\" + y + \"))\" : this._layer.definitionExpression), h.where = y, h.spatialRelationship = this._makeRelationshipEnum(r), h.relationParameter = this._makeRelationshipParam(r), h.geometry = null === s ? null : s, h.returnDistinctValues = !0, h.returnGeometry = !1, h.outFields = [c];\n    const f = await this.executeQuery(h, \"execute\");\n    if (this._checkCancelled(o), !f.hasOwnProperty(\"features\")) throw new j(q.InvalidStatResponse);\n\n    let _ = !1;\n\n    for (let d = 0; d < p.length; d++) if (p[d].name === c) {\n      \"date\" === p[d].type && (_ = !0);\n      break;\n    }\n\n    for (let d = 0; d < f.features.length; d++) {\n      if (_) {\n        const e = f.features[d].attributes[c];\n        null !== e ? l.push(new Date(e)) : l.push(e);\n      } else l.push(f.features[d].attributes[c]);\n\n      if (l.length >= n) break;\n    }\n\n    if (0 === f.features.length) return l;\n\n    if (f.features.length === this._layer.capabilities?.query.maxRecordCount && l.length < n) {\n      return {\n        calculated: !0,\n        result: await this._getDistinctPages(e + f.features.length, t, i, r, s, a, n, l, o)\n      };\n    }\n\n    return l;\n  }\n\n  async _distinctStat(e, t, i, r, s, a, n) {\n    return {\n      calculated: !0,\n      result: await this._getDistinctPages(0, e, t, i, r, s, a, [], n)\n    };\n  }\n\n  isTable() {\n    return this._layer.isTable || null === this._layer.geometryType || \"table\" === this._layer.type || \"\" === this._layer.geometryType;\n  }\n\n  async _countstat(e, t, i, r) {\n    const s = await this.databaseType(),\n          a = new b();\n    if (this._requestStandardised && (a.sqlFormat = \"standard\"), this.isTable() && i && null !== t && \"\" !== t) return {\n      calculated: !0,\n      result: 0\n    };\n    let n = null === r ? null === i ? \"1=1\" : \"\" : d(r, s);\n    this._layer.definitionExpression && this._useDefinitionExpression && (n = \"\" !== n ? \"((\" + this._layer.definitionExpression + \") AND (\" + n + \"))\" : this._layer.definitionExpression), a.where = n, a.where = n, a.spatialRelationship = this._makeRelationshipEnum(t), a.relationParameter = this._makeRelationshipParam(t), a.geometry = null === i ? null : i, a.returnGeometry = !1;\n    return {\n      calculated: !0,\n      result: await this.executeQuery(a, \"executeForCount\")\n    };\n  }\n\n  async _stats(e, t, i, r, s, a, n) {\n    await this._ensureLoaded();\n    const l = this._layer.capabilities && this._layer.capabilities.query && !0 === this._layer.capabilities.query.supportsSqlExpression,\n          o = this._layer.capabilities && this._layer.capabilities.query && !0 === this._layer.capabilities.query.supportsStatistics,\n          u = this._layer.capabilities && this._layer.capabilities.query && !0 === this._layer.capabilities.query.supportsDistinct;\n    if (\"count\" === e) return u ? this._countstat(e, i, r, s) : {\n      calculated: !1\n    };\n    if (!1 === o || !1 === c(t) && !1 === l || !1 === t.isStandardized) return \"\" !== i || null !== s ? {\n      calculated: !1\n    } : this._manualStat(e, t, a, n);\n    if (\"distinct\" === e) return !1 === u ? \"\" !== i || null !== s ? {\n      calculated: !1\n    } : this._manualStat(e, t, a, n) : this._distinctStat(e, t, i, r, s, a, n);\n    const h = await this.databaseType();\n    if (this.isTable() && r && null !== i && \"\" !== i) return {\n      calculated: !0,\n      result: null\n    };\n    const y = new b();\n    this._requestStandardised && (y.sqlFormat = \"standard\");\n    let f = null === s ? null === r ? \"1=1\" : \"\" : d(s, h);\n    this._layer.definitionExpression && this._useDefinitionExpression && (f = \"\" !== f ? \"((\" + this._layer.definitionExpression + \") AND (\" + f + \"))\" : this._layer.definitionExpression), y.where = f, y.spatialRelationship = this._makeRelationshipEnum(i), y.relationParameter = this._makeRelationshipParam(i), y.geometry = null === r ? null : r;\n\n    const _ = new x();\n\n    _.statisticType = p(e), _.onStatisticField = d(t, h), _.outStatisticFieldName = \"ARCADE_STAT_RESULT\", y.returnGeometry = !1;\n    let m = \"ARCADE_STAT_RESULT\";\n    y.outStatistics = [_];\n    const g = await this.executeQuery(y, \"execute\");\n    if (!g.hasOwnProperty(\"features\") || 0 === g.features.length) throw new j(q.InvalidStatResponse);\n    let S = !1;\n    const F = g.fields ?? [];\n\n    for (let d = 0; d < F.length; d++) if (\"ARCADE_STAT_RESULT\" === F[d].name.toUpperCase()) {\n      m = F[d].name, \"date\" === F[d].type && (S = !0);\n      break;\n    }\n\n    if (S) {\n      let e = g.features[0].attributes[m];\n      return null !== e && (e = new Date(g.features[0].attributes[m])), {\n        calculated: !0,\n        result: e\n      };\n    }\n\n    return {\n      calculated: !0,\n      result: g.features[0].attributes[m]\n    };\n  }\n\n  _stat(e, t, i, r, s, a, n) {\n    return this._stats(e, t, i, r, s, a, n);\n  }\n\n  async _canDoAggregates(e, t) {\n    await this._ensureLoaded();\n    let i = !1;\n    const r = this._layer.capabilities?.query,\n          s = !0 === r?.supportsSqlExpression;\n    if (null != r && !0 === r.supportsStatistics && !0 === r.supportsOrderBy && (i = !0), i) for (let a = 0; a < t.length - 1; a++) (!1 === t[a].workingexpr?.isStandardized || !1 === c(t[a].workingexpr) && !1 === s) && (i = !1);\n    return !1 !== i;\n  }\n\n  _makeRelationshipEnum(e) {\n    if (e.includes(\"esriSpatialRelRelation\")) return \"relation\";\n\n    switch (e) {\n      case \"esriSpatialRelRelation\":\n        return \"relation\";\n\n      case \"esriSpatialRelIntersects\":\n        return \"intersects\";\n\n      case \"esriSpatialRelContains\":\n        return \"contains\";\n\n      case \"esriSpatialRelOverlaps\":\n        return \"overlaps\";\n\n      case \"esriSpatialRelWithin\":\n        return \"within\";\n\n      case \"esriSpatialRelTouches\":\n        return \"touches\";\n\n      case \"esriSpatialRelCrosses\":\n        return \"crosses\";\n\n      case \"esriSpatialRelEnvelopeIntersects\":\n        return \"envelope-intersects\";\n    }\n\n    return e;\n  }\n\n  _makeRelationshipParam(e) {\n    return e.includes(\"esriSpatialRelRelation\") ? e.split(\":\")[1] : \"\";\n  }\n\n  async _getAggregatePagesDataSourceDefinition(e, t, i, r, a, n, l) {\n    await this._ensureLoaded();\n    const o = await this.databaseType();\n    let u = \"\",\n        c = !1,\n        p = !1;\n    null !== n && this._layer.capabilities && this._layer.capabilities.query && !0 === this._layer.capabilities.query.supportsOrderBy && (u = n.constructClause(), p = !0), this._layer.capabilities && this._layer.capabilities.query && !1 === this._layer.capabilities.query.supportsPagination && (p = !1, c = !0, u = this._layer.objectIdField);\n    const h = [];\n\n    for (let s = 0; s < t.length; s++) {\n      const e = new x();\n      e.onStatisticField = null !== t[s].workingexpr ? d(t[s].workingexpr, o) : \"\", e.outStatisticFieldName = t[s].field, e.statisticType = t[s].toStatisticsName(), h.push(e);\n    }\n\n    \"\" === u && (u = e.join(\",\"));\n\n    let y = this._maxQueryRate();\n\n    const f = this._layer.capabilities?.query.maxRecordCount;\n    void 0 !== f && f < y && (y = f);\n\n    let _ = null === a ? null === r ? \"1=1\" : \"\" : d(a, o);\n\n    this._layer.definitionExpression && this._useDefinitionExpression && (_ = \"\" !== _ ? \"((\" + this._layer.definitionExpression + \") AND (\" + _ + \"))\" : this._layer.definitionExpression);\n    return new s([], [\"GETPAGES\"], p, {\n      groupbypage: !0,\n      spatialRel: this._makeRelationshipEnum(i),\n      relationParam: this._makeRelationshipParam(i),\n      outFields: [\"*\"],\n      useOIDpagination: c,\n      generatedOid: l,\n      resultRecordCount: y,\n      resultOffset: 0,\n      groupByFieldsForStatistics: e,\n      outStatistics: h,\n      geometry: null === r ? null : r,\n      where: _,\n      orderByFields: u,\n      returnGeometry: !1,\n      returnIdsOnly: !1,\n      internal: {\n        lastMaxId: -1,\n        set: [],\n        lastRetrieved: 0,\n        lastPage: 0,\n        fullyResolved: !1\n      }\n    });\n  }\n\n  async _getAgregagtePhysicalPage(t, i, r) {\n    let s = t.pagesDefinition.where;\n    !0 === t.pagesDefinition.useOIDpagination && (s = \"\" !== s ? \"(\" + s + \") AND (\" + t.pagesDefinition.generatedOid + \">\" + t.pagesDefinition.internal.lastMaxId.toString() + \")\" : t.pagesDefinition.generatedOid + \">\" + t.pagesDefinition.internal.lastMaxId.toString());\n    const a = t.pagesDefinition.internal.lastRetrieved,\n          n = a,\n          l = t.pagesDefinition.internal.lastPage,\n          o = new b();\n    if (this._requestStandardised && (o.sqlFormat = \"standard\"), o.where = s, o.spatialRelationship = t.pagesDefinition.spatialRel, o.relationParameter = t.pagesDefinition.relationParam, o.outFields = t.pagesDefinition.outFields, o.outStatistics = t.pagesDefinition.outStatistics, o.geometry = t.pagesDefinition.geometry, o.groupByFieldsForStatistics = t.pagesDefinition.groupByFieldsForStatistics, o.num = t.pagesDefinition.resultRecordCount, o.start = t.pagesDefinition.internal.lastPage, o.returnGeometry = t.pagesDefinition.returnGeometry, o.orderByFields = \"\" !== t.pagesDefinition.orderByFields ? t.pagesDefinition.orderByFields.split(\",\") : null, this.isTable() && o.geometry && o.spatialRelationship) return [];\n    const u = await this.executeQuery(o, \"execute\");\n    if (this._checkCancelled(r), !u.hasOwnProperty(\"features\")) throw new j(q.InvalidStatResponse);\n    const d = [];\n    if (t.pagesDefinition.internal.lastPage !== l) return [];\n\n    for (let e = 0; e < u.features.length; e++) t.pagesDefinition.internal.set[n + e] = u.features[e].attributes[t.pagesDefinition.generatedOid];\n\n    for (let c = 0; c < u.features.length; c++) d.push(new e({\n      attributes: u.features[c].attributes,\n      geometry: null\n    }));\n\n    return !0 === t.pagesDefinition.useOIDpagination ? 0 === u.features.length ? t.pagesDefinition.internal.fullyResolved = !0 : t.pagesDefinition.internal.lastMaxId = u.features[u.features.length - 1].attributes[t.pagesDefinition.generatedOid] : (void 0 === u.exceededTransferLimit && u.features.length !== t.pagesDefinition.resultRecordCount || !1 === u.exceededTransferLimit) && (t.pagesDefinition.internal.fullyResolved = !0), t.pagesDefinition.internal.lastRetrieved = a + u.features.length, t.pagesDefinition.internal.lastPage += t.pagesDefinition.resultRecordCount, d;\n  }\n\n  static create(e, t, i, r, s) {\n    const a = new m({\n      url: e,\n      outFields: null === t ? [\"*\"] : t\n    });\n    return new v({\n      layer: a,\n      spatialReference: i,\n      lrucache: r,\n      interceptor: s\n    });\n  }\n\n  relationshipMetaData() {\n    return this._layer && this._layer.source && this._layer.source.sourceJSON && this._layer.source.sourceJSON.relationships ? this._layer.source.sourceJSON.relationships : [];\n  }\n\n  serviceUrl() {\n    return u(this._layer.parsedUrl.path);\n  }\n\n  async queryAttachments(e, t, r, s, a) {\n    const n = this._layer.capabilities;\n\n    if (n?.data.supportsAttachment && n?.operations.supportsQueryAttachments) {\n      const n = {\n        objectIds: [e],\n        returnMetadata: a\n      };\n      (t && t > 0 || r && r > 0) && (n.size = [t && t > 0 ? t : 0, r && r > 0 ? r : t + 1]), s && s.length > 0 && (n.attachmentTypes = s), this.featureSetQueryInterceptor && this.featureSetQueryInterceptor.preLayerQueryCallback({\n        layer: this._layer,\n        query: n,\n        method: \"attachments\"\n      });\n      const l = await this._layer.queryAttachments(n),\n            o = [];\n      return l && l[e] && l[e].forEach(t => {\n        const r = this._layer.parsedUrl.path + \"/\" + e.toString() + \"/attachments/\" + t.id.toString();\n        let s = null;\n        a && t.exifInfo && (s = P.convertJsonToArcade(t.exifInfo, !0)), o.push(new i(t.id, t.name, t.contentType, t.size, r, s));\n      }), o;\n    }\n\n    return [];\n  }\n\n  async queryRelatedFeatures(i) {\n    const r = {\n      f: \"json\",\n      relationshipId: i.relationshipId.toString(),\n      definitionExpression: i.where,\n      outFields: i.outFields?.join(\",\"),\n      returnGeometry: i.returnGeometry.toString()\n    };\n    void 0 !== i.resultOffset && null !== i.resultOffset && (r.resultOffset = i.resultOffset.toString()), void 0 !== i.resultRecordCount && null !== i.resultRecordCount && (r.resultRecordCount = i.resultRecordCount.toString()), i.orderByFields && (r.orderByFields = i.orderByFields.join(\",\")), i.objectIds && i.objectIds.length > 0 && (r.objectIds = i.objectIds.join(\",\")), i.outSpatialReference && (r.outSR = JSON.stringify(i.outSpatialReference.toJSON())), this.featureSetQueryInterceptor && this.featureSetQueryInterceptor.preRequestCallback({\n      layer: this._layer,\n      queryPayload: r,\n      method: \"relatedrecords\",\n      url: this._layer.parsedUrl.path + \"/queryRelatedRecords\"\n    });\n    const s = await t(this._layer.parsedUrl.path + \"/queryRelatedRecords\", {\n      responseType: \"json\",\n      query: r\n    });\n\n    if (s.data) {\n      const t = {},\n            i = s.data;\n\n      if (i && i.relatedRecordGroups) {\n        const r = i.spatialReference;\n\n        for (const s of i.relatedRecordGroups) {\n          const a = s.objectId,\n                n = [];\n\n          for (const t of s.relatedRecords) {\n            t.geometry && (t.geometry.spatialReference = r);\n            const i = new e({\n              geometry: t.geometry ? _(t.geometry) : null,\n              attributes: t.attributes\n            });\n            n.push(i);\n          }\n\n          t[a] = {\n            features: n,\n            exceededTransferLimit: !0 === i.exceededTransferLimit\n          };\n        }\n      }\n\n      return t;\n    }\n\n    throw new j(q.InvalidRequest);\n  }\n\n  async getFeatureByObjectId(e, t) {\n    const i = new b();\n    i.outFields = t, i.returnGeometry = !1, i.outSpatialReference = this.spatialReference, i.where = this.objectIdField + \"=\" + e.toString(), this.featureSetQueryInterceptor && this.featureSetQueryInterceptor.preLayerQueryCallback({\n      layer: this._layer,\n      query: i,\n      method: \"execute\"\n    });\n    const r = await S(this._layer.parsedUrl.path, i);\n    return 1 === r.features.length ? r.features[0] : null;\n  }\n\n  async getIdentityUser() {\n    await this.load();\n    const e = f?.findCredential(this._layer.url);\n    return e ? e.userId : null;\n  }\n\n  async getOwningSystemUrl() {\n    await this.load();\n    const e = f?.findServerInfo(this._layer.url);\n    if (e) return e.owningSystemUrl;\n    let i = this._layer.url;\n    const r = i.toLowerCase().indexOf(\"/rest/services\");\n\n    if (i = r > -1 ? i.substring(0, r) : i, i) {\n      i += \"/rest/info\";\n\n      try {\n        const e = await t(i, {\n          query: {\n            f: \"json\"\n          }\n        });\n        let r = \"\";\n        return e.data && e.data.owningSystemUrl && (r = e.data.owningSystemUrl), r;\n      } catch (s) {\n        return \"\";\n      }\n    }\n\n    return \"\";\n  }\n\n  getDataSourceFeatureSet() {\n    const e = new v({\n      layer: this._layer,\n      spatialReference: this.spatialReference ?? void 0,\n      outFields: this._overrideFields ?? void 0,\n      includeGeometry: !this._removeGeometry,\n      lrucache: this.recentlyUsedQueries ?? void 0,\n      interceptor: this.featureSetQueryInterceptor ?? void 0\n    });\n    return e._useDefinitionExpression = !1, e;\n  }\n\n}\n\nexport { v as default };","map":{"version":3,"names":["e","t","i","r","s","defaultMaxRecords","a","stableStringify","n","FeatureServiceDatabaseType","l","IdState","o","extractServiceUrl","u","toWhereClause","d","isSingleField","c","decodeStatType","p","createMD5Hash","h","outputTypes","y","id","f","fromJSON","_","m","convertToFeatureSet","g","executeQueryJSON","S","executeQueryPBF","F","R","b","executeForCount","w","executeForIds","D","OptimizedFeatureSetParserContext","I","x","P","FeatureSetError","j","FeatureSetErrorCodes","q","v","constructor","declaredClass","_removeGeometry","_overrideFields","formulaCredential","_pageJustIds","_requestStandardised","_useDefinitionExpression","spatialReference","_transparent","_maxProcessing","_layer","layer","_wset","outFields","includeGeometry","_maxQueryRate","end","optimisePagingFeatureQueries","convertQueryToLruCacheKey","toJSON","String","loadImpl","loaded","_initialiseFeatureSet","load","geometryType","fields","slice","length","type","push","toLowerCase","name","source","sourceJSON","currentVersion","useStandardizedQueries","_databaseType","StandardisedNoInterval","Standardised","objectIdField","globalIdField","hasM","supportsM","hasZ","supportsZ","typeIdField","types","_isInFeatureSet","InFeatureSet","_refineSetBlock","_candidateIdTransform","_getSet","_ensureLoaded","_getFilteredSet","_runDatabaseProbe","where","replace","queryObjectIds","_canUsePagination","capabilities","query","supportsPagination","_cacheableFeatureSetSourceKey","url","pbfSupportedForQuery","outStatistics","supportsFormatPBF","supportsQuantizationEditMode","queryPBF","quantizationParameters","mode","parsedUrl","data","unquantize","gdbVersion","isVersioned","nativeCapabilities","title","canQueryRelated","databaseType","requestStandardised","executeQuery","recentlyUsedQueries","getFromCache","path","addToCache","catch","removeFromCache","featureSetQueryInterceptor","preLayerQueryCallback","method","isTable","_getFilteredSetUsingPaging","supportsOrderBy","constructClause","sqlFormat","spatialRelationship","_makeRelationshipEnum","outSpatialReference","orderByFields","split","geometry","relationParameter","_makeRelationshipParam","_checkCancelled","_expandPagedSet","_expandPagedSetFeatureSet","definitionExpression","maxRecordCount","spatialRel","relationParam","resultRecordCount","resultOffset","returnGeometry","returnIdsOnly","internal","set","lastRetrieved","lastPage","fullyResolved","_fieldsIncludingObjectId","join","_clonePageDefinition","groupbypage","useOIDpagination","generatedOid","groupByFieldsForStatistics","_getPhysicalPage","pagesDefinition","num","start","features","attributes","_featureCache","exceededTransferLimit","includes","toUpperCase","_getFeatures","_checkIfNeedToExpandKnownPage","_maxProcessingRate","_lastFetchedIndex","_known","_mode","_featureMap","objectIds","error","RequestFailed","reason","_getDistinctPages","parseTree","column","returnDistinctValues","hasOwnProperty","InvalidStatResponse","Date","calculated","result","_distinctStat","_countstat","_stats","supportsSqlExpression","supportsStatistics","supportsDistinct","isStandardized","_manualStat","statisticType","onStatisticField","outStatisticFieldName","_stat","_canDoAggregates","workingexpr","_getAggregatePagesDataSourceDefinition","field","toStatisticsName","lastMaxId","_getAgregagtePhysicalPage","toString","create","lrucache","interceptor","relationshipMetaData","relationships","serviceUrl","queryAttachments","supportsAttachment","operations","supportsQueryAttachments","returnMetadata","size","attachmentTypes","forEach","exifInfo","convertJsonToArcade","contentType","queryRelatedFeatures","relationshipId","outSR","JSON","stringify","preRequestCallback","queryPayload","responseType","relatedRecordGroups","objectId","relatedRecords","InvalidRequest","getFeatureByObjectId","getIdentityUser","findCredential","userId","getOwningSystemUrl","findServerInfo","owningSystemUrl","indexOf","substring","getDataSourceFeatureSet","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerDynamic.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../../../Graphic.js\";import t from\"../../../request.js\";import i from\"../../Attachment.js\";import r from\"../support/FeatureSet.js\";import s from\"../support/IdSet.js\";import{defaultMaxRecords as a,stableStringify as n,FeatureServiceDatabaseType as l,IdState as o,extractServiceUrl as u}from\"../support/shared.js\";import{toWhereClause as d,isSingleField as c}from\"../support/sqlUtils.js\";import{decodeStatType as p}from\"../support/stats.js\";import{createMD5Hash as h,outputTypes as y}from\"../../../core/MD5.js\";import{id as f}from\"../../../kernel.js\";import{fromJSON as _}from\"../../../geometry/support/jsonUtils.js\";import m from\"../../../layers/FeatureLayer.js\";import{convertToFeatureSet as g}from\"../../../layers/graphics/featureConversionUtils.js\";import\"../../../core/Error.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../layers/support/source/DataLayerSource.js\";import{executeQueryJSON as S}from\"../../../rest/query/executeQueryJSON.js\";import\"../../../config.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/urlUtils.js\";import\"../../../core/unitUtils.js\";import\"../../../geometry/support/spatialReferenceUtils.js\";import{executeQueryPBF as F}from\"../../../rest/query/operations/query.js\";import R from\"../../../rest/support/FeatureSet.js\";import b from\"../../../rest/support/Query.js\";import\"../../../rest/query/support/AttachmentInfo.js\";import\"../../../rest/support/AttachmentQuery.js\";import{executeForCount as w}from\"../../../rest/query/executeForCount.js\";import\"../../../geometry.js\";import{executeForIds as D}from\"../../../rest/query/executeForIds.js\";import\"../../../rest/support/RelationshipQuery.js\";import\"../../../geometry/support/normalizeUtils.js\";import\"../../../rest/support/TopFeaturesQuery.js\";import{OptimizedFeatureSetParserContext as I}from\"../../../rest/query/operations/pbfOptimizedFeatureSet.js\";import x from\"../../../rest/support/StatisticDefinition.js\";import P from\"../../Dictionary.js\";import{FeatureSetError as j,FeatureSetErrorCodes as q}from\"../support/errorsupport.js\";class v extends r{constructor(e){super(e),this.declaredClass=\"esri.arcade.featureset.sources.FeatureLayerDynamic\",this._removeGeometry=!1,this._overrideFields=null,this.formulaCredential=null,this._pageJustIds=!1,this._requestStandardised=!1,this._useDefinitionExpression=!0,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return a}end(){return this._layer}optimisePagingFeatureQueries(e){this._pageJustIds=e}convertQueryToLruCacheKey(e){const t=n(e.toJSON());return h(t,y.String)}async loadImpl(){return!0===this._layer.loaded?(this._initialiseFeatureSet(),this):(await this._layer.load(),this._initialiseFeatureSet(),this)}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&\"*\"===this._layer.outFields[0]);else{const e=[];for(const t of this.fields)if(\"oid\"===t.type)e.push(t);else for(const i of this._layer.outFields)if(i.toLowerCase()===t.name.toLowerCase()){e.push(t);break}this.fields=e}else;if(null!==this._overrideFields)if(1===this._overrideFields.length&&\"*\"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const i of this.fields)if(\"oid\"===i.type)e.push(i),t.push(i.name);else for(const r of this._overrideFields)if(r.toLowerCase()===i.name.toLowerCase()){e.push(i),t.push(i.name);break}this.fields=e,this._overrideFields=t}if(this._layer.source&&this._layer.source.sourceJSON){const e=this._layer.source.sourceJSON.currentVersion;!0===this._layer.source.sourceJSON.useStandardizedQueries?(this._databaseType=l.StandardisedNoInterval,null!=e&&e>=10.61&&(this._databaseType=l.Standardised)):null!=e&&(e>=10.5&&(this._databaseType=l.StandardisedNoInterval,this._requestStandardised=!0),e>=10.61&&(this._databaseType=l.Standardised))}this.objectIdField=this._layer.objectIdField;for(const e of this.fields)\"global-id\"===e.type&&(this.globalIdField=e.name);this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this.typeIdField=this._layer.typeIdField??\"\",this.types=this._layer.types}_isInFeatureSet(){return o.InFeatureSet}async _refineSetBlock(e){return e}_candidateIdTransform(e){return e}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._getFilteredSet(\"\",null,null,null,e);return this._wset=t,t}return this._wset}async _runDatabaseProbe(e){await this._ensureLoaded();const t=new b;t.where=e.replace(\"OBJECTID\",this._layer.objectIdField);try{return await this._layer.queryObjectIds(t),!0}catch(i){return!1}}_canUsePagination(){return!(!this._layer.capabilities||!this._layer.capabilities.query||!0!==this._layer.capabilities.query.supportsPagination)}_cacheableFeatureSetSourceKey(){return this._layer.url}pbfSupportedForQuery(e){const t=this._layer?.capabilities?.query;return!e.outStatistics&&!0===t?.supportsFormatPBF&&!0===t?.supportsQuantizationEditMode}async queryPBF(e){e.quantizationParameters={mode:\"edit\"};const t=await F(this._layer.parsedUrl,e,new I({}));return R.fromJSON(g(t.data)).unquantize()}get gdbVersion(){return this._layer&&this._layer.capabilities&&this._layer.capabilities.data&&this._layer.capabilities.data.isVersioned?this._layer.gdbVersion?this._layer.gdbVersion:\"SDE.DEFAULT\":\"\"}nativeCapabilities(){return{title:this._layer.title??\"\",source:this,canQueryRelated:!0,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:this._requestStandardised}}executeQuery(e,t){const i=\"execute\"===t?S:\"executeForCount\"===t?w:D,r=\"execute\"===t&&this.pbfSupportedForQuery(e);let s=null;if(this.recentlyUsedQueries){const t=this.convertQueryToLruCacheKey(e);s=this.recentlyUsedQueries.getFromCache(t),null===s&&(s=!0!==r?i(this._layer.parsedUrl.path,e):this.queryPBF(e),this.recentlyUsedQueries.addToCache(t,s),s=s.catch((e=>{throw this.recentlyUsedQueries?.removeFromCache(t),e})))}return this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:e,method:t}),null===s&&(s=!0!==r?i(this._layer.parsedUrl.path,e):this.queryPBF(e)),s}async _getFilteredSet(e,t,i,r,a){const n=await this.databaseType();if(this.isTable()&&t&&null!==e&&\"\"!==e){return new s([],[],!0,null)}if(this._canUsePagination())return this._getFilteredSetUsingPaging(e,t,i,r,a);let l=\"\",o=!1;null!==r&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(l=r.constructClause(),o=!0);const u=new b;u.where=null===i?null===t?\"1=1\":\"\":d(i,n),this._requestStandardised&&(u.sqlFormat=\"standard\"),u.spatialRelationship=this._makeRelationshipEnum(e),u.outSpatialReference=this.spatialReference,u.orderByFields=\"\"!==l?l.split(\",\"):null,u.geometry=null===t?null:t,u.relationParameter=this._makeRelationshipParam(e);let c=await this.executeQuery(u,\"executeForIds\");null===c&&(c=[]),this._checkCancelled(a);return new s([],c,o,null)}_expandPagedSet(e,t,i,r,s){return this._expandPagedSetFeatureSet(e,t,i,r,s)}async _getFilteredSetUsingPaging(e,t,i,r,a){let n=\"\",l=!1;null!==r&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(n=r.constructClause(),l=!0);const o=await this.databaseType();let u=null===i?null===t?\"1=1\":\"\":d(i,o);this._layer.definitionExpression&&this._useDefinitionExpression&&(u=\"\"!==u?\"((\"+this._layer.definitionExpression+\") AND (\"+u+\"))\":this._layer.definitionExpression);let c=this._maxQueryRate();const p=this._layer.capabilities?.query.maxRecordCount;void 0!==p&&p<c&&(c=p);let h=null;if(!0===this._pageJustIds)h=new s([],[\"GETPAGES\"],l,{spatialRel:this._makeRelationshipEnum(e),relationParam:this._makeRelationshipParam(e),outFields:this._layer.objectIdField,resultRecordCount:c,resultOffset:0,geometry:null===t?null:t,where:u,orderByFields:n,returnGeometry:!1,returnIdsOnly:\"false\",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}});else{let i=!0;!0===this._removeGeometry&&(i=!1);const r=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:[\"*\"]);h=new s([],[\"GETPAGES\"],l,{spatialRel:this._makeRelationshipEnum(e),relationParam:this._makeRelationshipParam(e),outFields:r.join(\",\"),resultRecordCount:c,resultOffset:0,geometry:null===t?null:t,where:u,orderByFields:n,returnGeometry:i,returnIdsOnly:\"false\",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}return await this._expandPagedSet(h,c,0,1,a),h}_clonePageDefinition(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}async _getPhysicalPage(e,t,i){const r=e.pagesDefinition.internal.lastRetrieved,s=r,a=e.pagesDefinition.internal.lastPage,n=new b;this._requestStandardised&&(n.sqlFormat=\"standard\"),n.spatialRelationship=e.pagesDefinition.spatialRel,n.relationParameter=e.pagesDefinition.relationParam,n.outFields=e.pagesDefinition.outFields.split(\",\"),n.num=e.pagesDefinition.resultRecordCount,n.start=e.pagesDefinition.internal.lastPage,n.geometry=e.pagesDefinition.geometry,n.where=e.pagesDefinition.where,n.orderByFields=\"\"!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(\",\"):null,n.returnGeometry=e.pagesDefinition.returnGeometry,n.outSpatialReference=this.spatialReference;const l=await this.executeQuery(n,\"execute\");if(this._checkCancelled(i),e.pagesDefinition.internal.lastPage!==a)return\"done\";const o=this._layer.objectIdField;for(let u=0;u<l.features.length;u++)e.pagesDefinition.internal.set[s+u]=l.features[u].attributes[o];if(!1===this._pageJustIds)for(let u=0;u<l.features.length;u++)this._featureCache[l.features[u].attributes[o]]=l.features[u];return(void 0===l.exceededTransferLimit&&l.features.length!==e.pagesDefinition.resultRecordCount||!1===l.exceededTransferLimit)&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=r+l.features.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,\"done\"}_fieldsIncludingObjectId(e){if(null===e)return[this.objectIdField];const t=e.slice(0);if(t.includes(\"*\"))return t;let i=!1;for(const r of t)if(r.toUpperCase()===this.objectIdField.toUpperCase()){i=!0;break}return!1===i&&t.push(this.objectIdField),t}async _getFeatures(e,t,i,r){const s=[];if(-1!==t&&void 0===this._featureCache[t]&&s.push(t),!0===this._checkIfNeedToExpandKnownPage(e,this._maxProcessingRate()))return await this._expandPagedSet(e,this._maxProcessingRate(),0,0,r),this._getFeatures(e,t,i,r);let a=0;for(let u=e._lastFetchedIndex;u<e._known.length;u++){if(e._lastFetchedIndex+=1,a++,void 0===this._featureCache[e._known[u]]){let i=!1;if(null!==this._layer._mode&&void 0!==this._layer._mode){const t=this._layer._mode;if(void 0!==t._featureMap[e._known[u]]){const r=t._featureMap[e._known[u]];null!==r&&(i=!0,this._featureCache[e._known[u]]=r)}}if(!1===i&&(e._known[u]!==t&&s.push(e._known[u]),s.length>=this._maxProcessingRate()-1))break}if(a>=i&&0===s.length)break}if(0===s.length)return\"success\";const n=new b;this._requestStandardised&&(n.sqlFormat=\"standard\"),n.objectIds=s,n.outFields=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:[\"*\"]),n.returnGeometry=!0,!0===this._removeGeometry&&(n.returnGeometry=!1),n.outSpatialReference=this.spatialReference;const l=await this.executeQuery(n,\"execute\");if(this._checkCancelled(r),void 0!==l.error)throw new j(q.RequestFailed,{reason:l.error});const o=this._layer.objectIdField;for(let u=0;u<l.features.length;u++)this._featureCache[l.features[u].attributes[o]]=l.features[u];return\"success\"}async _getDistinctPages(e,t,i,r,s,a,n,l,o){await this._ensureLoaded();const u=await this.databaseType();let c=i.parseTree.column;const p=this._layer.fields??[];for(let d=0;d<p.length;d++)if(p[d].name.toLowerCase()===c.toLowerCase()){c=p[d].name;break}const h=new b;this._requestStandardised&&(h.sqlFormat=\"standard\");let y=null===a?null===s?\"1=1\":\"\":d(a,u);this._layer.definitionExpression&&this._useDefinitionExpression&&(y=\"\"!==y?\"((\"+this._layer.definitionExpression+\") AND (\"+y+\"))\":this._layer.definitionExpression),h.where=y,h.spatialRelationship=this._makeRelationshipEnum(r),h.relationParameter=this._makeRelationshipParam(r),h.geometry=null===s?null:s,h.returnDistinctValues=!0,h.returnGeometry=!1,h.outFields=[c];const f=await this.executeQuery(h,\"execute\");if(this._checkCancelled(o),!f.hasOwnProperty(\"features\"))throw new j(q.InvalidStatResponse);let _=!1;for(let d=0;d<p.length;d++)if(p[d].name===c){\"date\"===p[d].type&&(_=!0);break}for(let d=0;d<f.features.length;d++){if(_){const e=f.features[d].attributes[c];null!==e?l.push(new Date(e)):l.push(e)}else l.push(f.features[d].attributes[c]);if(l.length>=n)break}if(0===f.features.length)return l;if(f.features.length===this._layer.capabilities?.query.maxRecordCount&&l.length<n){return{calculated:!0,result:await this._getDistinctPages(e+f.features.length,t,i,r,s,a,n,l,o)}}return l}async _distinctStat(e,t,i,r,s,a,n){return{calculated:!0,result:await this._getDistinctPages(0,e,t,i,r,s,a,[],n)}}isTable(){return this._layer.isTable||null===this._layer.geometryType||\"table\"===this._layer.type||\"\"===this._layer.geometryType}async _countstat(e,t,i,r){const s=await this.databaseType(),a=new b;if(this._requestStandardised&&(a.sqlFormat=\"standard\"),this.isTable()&&i&&null!==t&&\"\"!==t)return{calculated:!0,result:0};let n=null===r?null===i?\"1=1\":\"\":d(r,s);this._layer.definitionExpression&&this._useDefinitionExpression&&(n=\"\"!==n?\"((\"+this._layer.definitionExpression+\") AND (\"+n+\"))\":this._layer.definitionExpression),a.where=n,a.where=n,a.spatialRelationship=this._makeRelationshipEnum(t),a.relationParameter=this._makeRelationshipParam(t),a.geometry=null===i?null:i,a.returnGeometry=!1;return{calculated:!0,result:await this.executeQuery(a,\"executeForCount\")}}async _stats(e,t,i,r,s,a,n){await this._ensureLoaded();const l=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsSqlExpression,o=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsStatistics,u=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsDistinct;if(\"count\"===e)return u?this._countstat(e,i,r,s):{calculated:!1};if(!1===o||!1===c(t)&&!1===l||!1===t.isStandardized)return\"\"!==i||null!==s?{calculated:!1}:this._manualStat(e,t,a,n);if(\"distinct\"===e)return!1===u?\"\"!==i||null!==s?{calculated:!1}:this._manualStat(e,t,a,n):this._distinctStat(e,t,i,r,s,a,n);const h=await this.databaseType();if(this.isTable()&&r&&null!==i&&\"\"!==i)return{calculated:!0,result:null};const y=new b;this._requestStandardised&&(y.sqlFormat=\"standard\");let f=null===s?null===r?\"1=1\":\"\":d(s,h);this._layer.definitionExpression&&this._useDefinitionExpression&&(f=\"\"!==f?\"((\"+this._layer.definitionExpression+\") AND (\"+f+\"))\":this._layer.definitionExpression),y.where=f,y.spatialRelationship=this._makeRelationshipEnum(i),y.relationParameter=this._makeRelationshipParam(i),y.geometry=null===r?null:r;const _=new x;_.statisticType=p(e),_.onStatisticField=d(t,h),_.outStatisticFieldName=\"ARCADE_STAT_RESULT\",y.returnGeometry=!1;let m=\"ARCADE_STAT_RESULT\";y.outStatistics=[_];const g=await this.executeQuery(y,\"execute\");if(!g.hasOwnProperty(\"features\")||0===g.features.length)throw new j(q.InvalidStatResponse);let S=!1;const F=g.fields??[];for(let d=0;d<F.length;d++)if(\"ARCADE_STAT_RESULT\"===F[d].name.toUpperCase()){m=F[d].name,\"date\"===F[d].type&&(S=!0);break}if(S){let e=g.features[0].attributes[m];return null!==e&&(e=new Date(g.features[0].attributes[m])),{calculated:!0,result:e}}return{calculated:!0,result:g.features[0].attributes[m]}}_stat(e,t,i,r,s,a,n){return this._stats(e,t,i,r,s,a,n)}async _canDoAggregates(e,t){await this._ensureLoaded();let i=!1;const r=this._layer.capabilities?.query,s=!0===r?.supportsSqlExpression;if(null!=r&&!0===r.supportsStatistics&&!0===r.supportsOrderBy&&(i=!0),i)for(let a=0;a<t.length-1;a++)(!1===t[a].workingexpr?.isStandardized||!1===c(t[a].workingexpr)&&!1===s)&&(i=!1);return!1!==i}_makeRelationshipEnum(e){if(e.includes(\"esriSpatialRelRelation\"))return\"relation\";switch(e){case\"esriSpatialRelRelation\":return\"relation\";case\"esriSpatialRelIntersects\":return\"intersects\";case\"esriSpatialRelContains\":return\"contains\";case\"esriSpatialRelOverlaps\":return\"overlaps\";case\"esriSpatialRelWithin\":return\"within\";case\"esriSpatialRelTouches\":return\"touches\";case\"esriSpatialRelCrosses\":return\"crosses\";case\"esriSpatialRelEnvelopeIntersects\":return\"envelope-intersects\"}return e}_makeRelationshipParam(e){return e.includes(\"esriSpatialRelRelation\")?e.split(\":\")[1]:\"\"}async _getAggregatePagesDataSourceDefinition(e,t,i,r,a,n,l){await this._ensureLoaded();const o=await this.databaseType();let u=\"\",c=!1,p=!1;null!==n&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(u=n.constructClause(),p=!0),this._layer.capabilities&&this._layer.capabilities.query&&!1===this._layer.capabilities.query.supportsPagination&&(p=!1,c=!0,u=this._layer.objectIdField);const h=[];for(let s=0;s<t.length;s++){const e=new x;e.onStatisticField=null!==t[s].workingexpr?d(t[s].workingexpr,o):\"\",e.outStatisticFieldName=t[s].field,e.statisticType=t[s].toStatisticsName(),h.push(e)}\"\"===u&&(u=e.join(\",\"));let y=this._maxQueryRate();const f=this._layer.capabilities?.query.maxRecordCount;void 0!==f&&f<y&&(y=f);let _=null===a?null===r?\"1=1\":\"\":d(a,o);this._layer.definitionExpression&&this._useDefinitionExpression&&(_=\"\"!==_?\"((\"+this._layer.definitionExpression+\") AND (\"+_+\"))\":this._layer.definitionExpression);return new s([],[\"GETPAGES\"],p,{groupbypage:!0,spatialRel:this._makeRelationshipEnum(i),relationParam:this._makeRelationshipParam(i),outFields:[\"*\"],useOIDpagination:c,generatedOid:l,resultRecordCount:y,resultOffset:0,groupByFieldsForStatistics:e,outStatistics:h,geometry:null===r?null:r,where:_,orderByFields:u,returnGeometry:!1,returnIdsOnly:!1,internal:{lastMaxId:-1,set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}async _getAgregagtePhysicalPage(t,i,r){let s=t.pagesDefinition.where;!0===t.pagesDefinition.useOIDpagination&&(s=\"\"!==s?\"(\"+s+\") AND (\"+t.pagesDefinition.generatedOid+\">\"+t.pagesDefinition.internal.lastMaxId.toString()+\")\":t.pagesDefinition.generatedOid+\">\"+t.pagesDefinition.internal.lastMaxId.toString());const a=t.pagesDefinition.internal.lastRetrieved,n=a,l=t.pagesDefinition.internal.lastPage,o=new b;if(this._requestStandardised&&(o.sqlFormat=\"standard\"),o.where=s,o.spatialRelationship=t.pagesDefinition.spatialRel,o.relationParameter=t.pagesDefinition.relationParam,o.outFields=t.pagesDefinition.outFields,o.outStatistics=t.pagesDefinition.outStatistics,o.geometry=t.pagesDefinition.geometry,o.groupByFieldsForStatistics=t.pagesDefinition.groupByFieldsForStatistics,o.num=t.pagesDefinition.resultRecordCount,o.start=t.pagesDefinition.internal.lastPage,o.returnGeometry=t.pagesDefinition.returnGeometry,o.orderByFields=\"\"!==t.pagesDefinition.orderByFields?t.pagesDefinition.orderByFields.split(\",\"):null,this.isTable()&&o.geometry&&o.spatialRelationship)return[];const u=await this.executeQuery(o,\"execute\");if(this._checkCancelled(r),!u.hasOwnProperty(\"features\"))throw new j(q.InvalidStatResponse);const d=[];if(t.pagesDefinition.internal.lastPage!==l)return[];for(let e=0;e<u.features.length;e++)t.pagesDefinition.internal.set[n+e]=u.features[e].attributes[t.pagesDefinition.generatedOid];for(let c=0;c<u.features.length;c++)d.push(new e({attributes:u.features[c].attributes,geometry:null}));return!0===t.pagesDefinition.useOIDpagination?0===u.features.length?t.pagesDefinition.internal.fullyResolved=!0:t.pagesDefinition.internal.lastMaxId=u.features[u.features.length-1].attributes[t.pagesDefinition.generatedOid]:(void 0===u.exceededTransferLimit&&u.features.length!==t.pagesDefinition.resultRecordCount||!1===u.exceededTransferLimit)&&(t.pagesDefinition.internal.fullyResolved=!0),t.pagesDefinition.internal.lastRetrieved=a+u.features.length,t.pagesDefinition.internal.lastPage+=t.pagesDefinition.resultRecordCount,d}static create(e,t,i,r,s){const a=new m({url:e,outFields:null===t?[\"*\"]:t});return new v({layer:a,spatialReference:i,lrucache:r,interceptor:s})}relationshipMetaData(){return this._layer&&this._layer.source&&this._layer.source.sourceJSON&&this._layer.source.sourceJSON.relationships?this._layer.source.sourceJSON.relationships:[]}serviceUrl(){return u(this._layer.parsedUrl.path)}async queryAttachments(e,t,r,s,a){const n=this._layer.capabilities;if(n?.data.supportsAttachment&&n?.operations.supportsQueryAttachments){const n={objectIds:[e],returnMetadata:a};(t&&t>0||r&&r>0)&&(n.size=[t&&t>0?t:0,r&&r>0?r:t+1]),s&&s.length>0&&(n.attachmentTypes=s),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:n,method:\"attachments\"});const l=await this._layer.queryAttachments(n),o=[];return l&&l[e]&&l[e].forEach((t=>{const r=this._layer.parsedUrl.path+\"/\"+e.toString()+\"/attachments/\"+t.id.toString();let s=null;a&&t.exifInfo&&(s=P.convertJsonToArcade(t.exifInfo,!0)),o.push(new i(t.id,t.name,t.contentType,t.size,r,s))})),o}return[]}async queryRelatedFeatures(i){const r={f:\"json\",relationshipId:i.relationshipId.toString(),definitionExpression:i.where,outFields:i.outFields?.join(\",\"),returnGeometry:i.returnGeometry.toString()};void 0!==i.resultOffset&&null!==i.resultOffset&&(r.resultOffset=i.resultOffset.toString()),void 0!==i.resultRecordCount&&null!==i.resultRecordCount&&(r.resultRecordCount=i.resultRecordCount.toString()),i.orderByFields&&(r.orderByFields=i.orderByFields.join(\",\")),i.objectIds&&i.objectIds.length>0&&(r.objectIds=i.objectIds.join(\",\")),i.outSpatialReference&&(r.outSR=JSON.stringify(i.outSpatialReference.toJSON())),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preRequestCallback({layer:this._layer,queryPayload:r,method:\"relatedrecords\",url:this._layer.parsedUrl.path+\"/queryRelatedRecords\"});const s=await t(this._layer.parsedUrl.path+\"/queryRelatedRecords\",{responseType:\"json\",query:r});if(s.data){const t={},i=s.data;if(i&&i.relatedRecordGroups){const r=i.spatialReference;for(const s of i.relatedRecordGroups){const a=s.objectId,n=[];for(const t of s.relatedRecords){t.geometry&&(t.geometry.spatialReference=r);const i=new e({geometry:t.geometry?_(t.geometry):null,attributes:t.attributes});n.push(i)}t[a]={features:n,exceededTransferLimit:!0===i.exceededTransferLimit}}}return t}throw new j(q.InvalidRequest)}async getFeatureByObjectId(e,t){const i=new b;i.outFields=t,i.returnGeometry=!1,i.outSpatialReference=this.spatialReference,i.where=this.objectIdField+\"=\"+e.toString(),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:i,method:\"execute\"});const r=await S(this._layer.parsedUrl.path,i);return 1===r.features.length?r.features[0]:null}async getIdentityUser(){await this.load();const e=f?.findCredential(this._layer.url);return e?e.userId:null}async getOwningSystemUrl(){await this.load();const e=f?.findServerInfo(this._layer.url);if(e)return e.owningSystemUrl;let i=this._layer.url;const r=i.toLowerCase().indexOf(\"/rest/services\");if(i=r>-1?i.substring(0,r):i,i){i+=\"/rest/info\";try{const e=await t(i,{query:{f:\"json\"}});let r=\"\";return e.data&&e.data.owningSystemUrl&&(r=e.data.owningSystemUrl),r}catch(s){return\"\"}}return\"\"}getDataSourceFeatureSet(){const e=new v({layer:this._layer,spatialReference:this.spatialReference??void 0,outFields:this._overrideFields??void 0,includeGeometry:!this._removeGeometry,lrucache:this.recentlyUsedQueries??void 0,interceptor:this.featureSetQueryInterceptor??void 0});return e._useDefinitionExpression=!1,e}}export{v as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}