{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport \"../../../../../core/Logger.js\";\nimport \"../../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../../core/arrayUtils.js\";\nimport \"../../../../../core/Error.js\";\nimport \"../../../../../core/has.js\";\nimport { subclass as t } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { generateGradient as i } from \"../../../../../renderers/support/heatmapUtils.js\";\nimport { BitmapTileContainer as r } from \"../../../engine/BitmapTileContainer.js\";\nimport s from \"./BaseTileRenderer.js\";\nimport { HeatmapSource as n } from \"./support/HeatmapSource.js\";\nlet o = class extends s {\n  constructor(e) {\n    super(e), this._intensityInfo = {\n      minDensity: 0,\n      maxDensity: 0\n    }, this.type = \"heatmap\", this.featuresView = {\n      attributeView: {\n        initialize: () => {},\n        requestUpdate: () => {}\n      },\n      requestRender: () => {}\n    }, this._container = new r(e.tileInfoView);\n  }\n\n  createTile(e) {\n    const t = this._container.createTile(e);\n\n    return this.tileInfoView.getTileCoords(t.bitmap, e), t.bitmap.resolution = this.tileInfoView.getTileResolution(e), t;\n  }\n\n  onConfigUpdate() {\n    const e = this.layer.renderer;\n\n    if (\"heatmap\" === e.type) {\n      const {\n        minDensity: t,\n        maxDensity: r,\n        colorStops: s\n      } = e;\n      this._intensityInfo.minDensity = t, this._intensityInfo.maxDensity = r, this._gradient = i(s), this.tiles.forEach(e => {\n        const i = e.bitmap.source;\n        i && (i.minDensity = t, i.maxDensity = r, i.gradient = this._gradient, e.bitmap.invalidateTexture());\n      });\n    }\n  }\n\n  hitTest() {\n    return Promise.resolve([]);\n  }\n\n  install(e) {\n    e.addChild(this._container);\n  }\n\n  uninstall(e) {\n    this._container.removeAllChildren(), e.removeChild(this._container);\n  }\n\n  disposeTile(e) {\n    this._container.removeChild(e), e.destroy();\n  }\n\n  supportsRenderer(e) {\n    return e && \"heatmap\" === e.type;\n  }\n\n  onTileData(e) {\n    const t = this.tiles.get(e.tileKey);\n    if (!t) return;\n    const i = e.intensityInfo,\n          {\n      minDensity: r,\n      maxDensity: s\n    } = this._intensityInfo,\n          o = t.bitmap.source || new n();\n    o.intensities = i && i.matrix || null, o.minDensity = r, o.maxDensity = s, o.gradient = this._gradient, t.bitmap.source = o, this._container.addChild(t), this._container.requestRender(), this.requestUpdate();\n  }\n\n  onTileError(e) {\n    console.error(e);\n  }\n\n  lockGPUUploads() {}\n\n  unlockGPUUploads() {}\n\n  fetchResource(e, t) {\n    return console.error(e), Promise.reject();\n  }\n\n};\no = e([t(\"esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer\")], o);\nconst a = o;\nexport { a as default };","map":{"version":3,"names":["_","e","subclass","t","generateGradient","i","BitmapTileContainer","r","s","HeatmapSource","n","o","constructor","_intensityInfo","minDensity","maxDensity","type","featuresView","attributeView","initialize","requestUpdate","requestRender","_container","tileInfoView","createTile","getTileCoords","bitmap","resolution","getTileResolution","onConfigUpdate","layer","renderer","colorStops","_gradient","tiles","forEach","source","gradient","invalidateTexture","hitTest","Promise","resolve","install","addChild","uninstall","removeAllChildren","removeChild","disposeTile","destroy","supportsRenderer","onTileData","get","tileKey","intensityInfo","intensities","matrix","onTileError","console","error","lockGPUUploads","unlockGPUUploads","fetchResource","reject","a","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/HeatmapTileRenderer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/Error.js\";import\"../../../../../core/has.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{generateGradient as i}from\"../../../../../renderers/support/heatmapUtils.js\";import{BitmapTileContainer as r}from\"../../../engine/BitmapTileContainer.js\";import s from\"./BaseTileRenderer.js\";import{HeatmapSource as n}from\"./support/HeatmapSource.js\";let o=class extends s{constructor(e){super(e),this._intensityInfo={minDensity:0,maxDensity:0},this.type=\"heatmap\",this.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}},this._container=new r(e.tileInfoView)}createTile(e){const t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t}onConfigUpdate(){const e=this.layer.renderer;if(\"heatmap\"===e.type){const{minDensity:t,maxDensity:r,colorStops:s}=e;this._intensityInfo.minDensity=t,this._intensityInfo.maxDensity=r,this._gradient=i(s),this.tiles.forEach((e=>{const i=e.bitmap.source;i&&(i.minDensity=t,i.maxDensity=r,i.gradient=this._gradient,e.bitmap.invalidateTexture())}))}}hitTest(){return Promise.resolve([])}install(e){e.addChild(this._container)}uninstall(e){this._container.removeAllChildren(),e.removeChild(this._container)}disposeTile(e){this._container.removeChild(e),e.destroy()}supportsRenderer(e){return e&&\"heatmap\"===e.type}onTileData(e){const t=this.tiles.get(e.tileKey);if(!t)return;const i=e.intensityInfo,{minDensity:r,maxDensity:s}=this._intensityInfo,o=t.bitmap.source||new n;o.intensities=i&&i.matrix||null,o.minDensity=r,o.maxDensity=s,o.gradient=this._gradient,t.bitmap.source=o,this._container.addChild(t),this._container.requestRender(),this.requestUpdate()}onTileError(e){console.error(e)}lockGPUUploads(){}unlockGPUUploads(){}fetchResource(e,t){return console.error(e),Promise.reject()}};o=e([t(\"esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer\")],o);const a=o;export{a as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}