{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Accessor.js\";\nimport r from \"../../../../core/Logger.js\";\nimport { isNone as i } from \"../../../../core/maybe.js\";\nimport { debounce as s, isAbortError as o } from \"../../../../core/promiseUtils.js\";\nimport { property as a } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as n } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport l from \"../../../../geometry/Extent.js\";\nimport { RasterVFDisplayObject as c } from \"../../engine/imagery/RasterVFDisplayObject.js\";\nlet p = class extends t {\n  constructor(e) {\n    super(e), this.update = s((e, t) => this._update(e, t).catch(e => {\n      o(e) || r.getLogger(this.declaredClass).error(e);\n    }));\n  }\n\n  get updating() {\n    return !!this._loading;\n  }\n\n  redraw(e) {\n    if (!this.container.children.length) return;\n    const t = this.container.children[0];\n    t.symbolizerParameters = e, t.invalidateVAO(), this.container.symbolTypes = \"wind_speed\" === e.style ? [\"scalar\", \"triangle\"] : \"simple_scalar\" === e.style ? [\"scalar\"] : [\"triangle\"], this.container.requestRender();\n  }\n\n  async _update(e, t, r) {\n    if (!e.stationary) return;\n    const {\n      extent: i,\n      spatialReference: s\n    } = e.state,\n          o = new l({\n      xmin: i.xmin,\n      ymin: i.ymin,\n      xmax: i.xmax,\n      ymax: i.ymax,\n      spatialReference: s\n    }),\n          [a, n] = e.state.size;\n    this._loading = this.fetchPixels(o, a, n, r);\n    const c = await this._loading;\n    this._addToDisplay(c, t, e.state), this._loading = null;\n  }\n\n  _addToDisplay(e, t, r) {\n    if (i(e.pixelBlock)) return this.container.children.forEach(e => e.destroy()), void this.container.removeAllChildren();\n    const {\n      extent: s,\n      pixelBlock: o\n    } = e,\n          a = new c(o);\n    a.offset = [0, 0], a.symbolizerParameters = t, a.rawPixelData = e, a.invalidateVAO(), a.x = s.xmin, a.y = s.ymax, a.pixelRatio = r.pixelRatio, a.rotation = r.rotation, a.resolution = r.resolution, a.width = o.width * t.symbolTileSize, a.height = o.height * t.symbolTileSize, this.container.children.forEach(e => e.destroy()), this.container.removeAllChildren(), this.container.symbolTypes = \"wind_speed\" === t.style ? [\"scalar\", \"triangle\"] : \"simple_scalar\" === t.style ? [\"scalar\"] : [\"triangle\"], this.container.addChild(a);\n  }\n\n};\ne([a()], p.prototype, \"fetchPixels\", void 0), e([a()], p.prototype, \"container\", void 0), e([a()], p.prototype, \"_loading\", void 0), e([a()], p.prototype, \"updating\", null), p = e([n(\"esri.views.2d.layers.imagery.ImageryVFStrategy\")], p);\nconst m = p;\nexport { m as default };","map":{"version":3,"names":["_","e","t","r","isNone","i","debounce","s","isAbortError","o","property","a","subclass","n","l","RasterVFDisplayObject","c","p","constructor","update","_update","catch","getLogger","declaredClass","error","updating","_loading","redraw","container","children","length","symbolizerParameters","invalidateVAO","symbolTypes","style","requestRender","stationary","extent","spatialReference","state","xmin","ymin","xmax","ymax","size","fetchPixels","_addToDisplay","pixelBlock","forEach","destroy","removeAllChildren","offset","rawPixelData","x","y","pixelRatio","rotation","resolution","width","symbolTileSize","height","addChild","prototype","m","default"],"sources":["E:/各个学科/论文/毕业论文/Atmosphere/eco-friendly/node_modules/@arcgis/core/views/2d/layers/imagery/ImageryVFStrategy.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import r from\"../../../../core/Logger.js\";import{isNone as i}from\"../../../../core/maybe.js\";import{debounce as s,isAbortError as o}from\"../../../../core/promiseUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import l from\"../../../../geometry/Extent.js\";import{RasterVFDisplayObject as c}from\"../../engine/imagery/RasterVFDisplayObject.js\";let p=class extends t{constructor(e){super(e),this.update=s(((e,t)=>this._update(e,t).catch((e=>{o(e)||r.getLogger(this.declaredClass).error(e)}))))}get updating(){return!!this._loading}redraw(e){if(!this.container.children.length)return;const t=this.container.children[0];t.symbolizerParameters=e,t.invalidateVAO(),this.container.symbolTypes=\"wind_speed\"===e.style?[\"scalar\",\"triangle\"]:\"simple_scalar\"===e.style?[\"scalar\"]:[\"triangle\"],this.container.requestRender()}async _update(e,t,r){if(!e.stationary)return;const{extent:i,spatialReference:s}=e.state,o=new l({xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax,spatialReference:s}),[a,n]=e.state.size;this._loading=this.fetchPixels(o,a,n,r);const c=await this._loading;this._addToDisplay(c,t,e.state),this._loading=null}_addToDisplay(e,t,r){if(i(e.pixelBlock))return this.container.children.forEach((e=>e.destroy())),void this.container.removeAllChildren();const{extent:s,pixelBlock:o}=e,a=new c(o);a.offset=[0,0],a.symbolizerParameters=t,a.rawPixelData=e,a.invalidateVAO(),a.x=s.xmin,a.y=s.ymax,a.pixelRatio=r.pixelRatio,a.rotation=r.rotation,a.resolution=r.resolution,a.width=o.width*t.symbolTileSize,a.height=o.height*t.symbolTileSize,this.container.children.forEach((e=>e.destroy())),this.container.removeAllChildren(),this.container.symbolTypes=\"wind_speed\"===t.style?[\"scalar\",\"triangle\"]:\"simple_scalar\"===t.style?[\"scalar\"]:[\"triangle\"],this.container.addChild(a)}};e([a()],p.prototype,\"fetchPixels\",void 0),e([a()],p.prototype,\"container\",void 0),e([a()],p.prototype,\"_loading\",void 0),e([a()],p.prototype,\"updating\",null),p=e([n(\"esri.views.2d.layers.imagery.ImageryVFStrategy\")],p);const m=p;export{m as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}